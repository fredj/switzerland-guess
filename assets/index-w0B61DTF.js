import{c as ha}from"./countries-DSqLr7v5.js";import{R as Rd,S as pi,C as Ad,a as _e,b as Nn,c as Pd,d as _p,e as yp,f as wp,I as vp,g as bp,h as Ep}from"./cesium-BlMsP21M.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function e(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=e(r);fetch(r.href,s)}})();const Ja=new Set,Pi=new Map;let Gn,Ul="ltr",Bl="en";const Ld=typeof MutationObserver<"u"&&typeof document<"u"&&typeof document.documentElement<"u";if(Ld){const i=new MutationObserver(Md);Ul=document.documentElement.dir||"ltr",Bl=document.documentElement.lang||navigator.language,i.observe(document.documentElement,{attributes:!0,attributeFilter:["dir","lang"]})}function jl(...i){i.map(t=>{const e=t.$code.toLowerCase();Pi.has(e)?Pi.set(e,Object.assign(Object.assign({},Pi.get(e)),t)):Pi.set(e,t),Gn||(Gn=t)}),Md()}function Md(){Ld&&(Ul=document.documentElement.dir||"ltr",Bl=document.documentElement.lang||navigator.language),[...Ja.keys()].map(i=>{typeof i.requestUpdate=="function"&&i.requestUpdate()})}let Ji=class{constructor(t){this.host=t,this.host.addController(this)}hostConnected(){Ja.add(this.host)}hostDisconnected(){Ja.delete(this.host)}dir(){return`${this.host.dir||Ul}`.toLowerCase()}lang(){return`${this.host.lang||Bl}`.toLowerCase()}getTranslationData(t){var e,n;const r=new Intl.Locale(t.replace(/_/g,"-")),s=r?.language.toLowerCase(),o=(n=(e=r?.region)===null||e===void 0?void 0:e.toLowerCase())!==null&&n!==void 0?n:"",a=Pi.get(`${s}-${o}`),l=Pi.get(s);return{locale:r,language:s,region:o,primary:a,secondary:l}}exists(t,e){var n;const{primary:r,secondary:s}=this.getTranslationData((n=e.lang)!==null&&n!==void 0?n:this.lang());return e=Object.assign({includeFallback:!1},e),!!(r&&r[t]||s&&s[t]||e.includeFallback&&Gn&&Gn[t])}term(t,...e){const{primary:n,secondary:r}=this.getTranslationData(this.lang());let s;if(n&&n[t])s=n[t];else if(r&&r[t])s=r[t];else if(Gn&&Gn[t])s=Gn[t];else return console.error(`No translation found for: ${String(t)}`),String(t);return typeof s=="function"?s(...e):s}date(t,e){return t=new Date(t),new Intl.DateTimeFormat(this.lang(),e).format(t)}number(t,e){return t=Number(t),isNaN(t)?"":new Intl.NumberFormat(this.lang(),e).format(t)}relativeTime(t,e,n){return new Intl.RelativeTimeFormat(this.lang(),n).format(t,e)}};const Cp={$code:"fr",$name:"Français",$dir:"ltr",choose_country:"Choisir un pays",switzerland:"Suisse",france:"France",germany:"Allemagne",where_are_you:"Où êtes-vous ?",guess:"Deviner",next_round:"Tour suivant",scores:"Scores",points:"points",round:"Tour",game_over:"Vous avez terminé !",your_score:"Votre score",username:"Ton nom",submit_score:"Soumettre le score",new_game:"Rejouer",no_username:"Aucun nom d'utilisateur saisi",username_taken:"Nom d'utilisateur déjà pris",save:"Enregistrer",leaderboard:"Classement"},xp={$code:"en",$name:"English",$dir:"ltr",choose_country:"Choose a country",switzerland:"Switzerland",france:"France",germany:"Germany",where_are_you:"Where are you?",guess:"Guess",next_round:"Next round",scores:"Scores",points:"points",round:"Round",game_over:"You finished!",your_score:"Your score",username:"Your name",submit_score:"Save score",new_game:"Play again",no_username:"No username entered",username_taken:"Username already taken",save:"Save",leaderboard:"Hall of Fame"},Sp={$code:"de",$name:"Deutsch",$dir:"ltr",choose_country:"Wählen Sie ein Land",switzerland:"Schweiz",france:"Frankreich",germany:"Deutschland",where_are_you:"Wo sind Sie?",guess:"Raten",next_round:"Nächste Runde",scores:"Punktestand",points:"Punkte",round:"Runde",game_over:"Sie sind fertig!",your_score:"Ihre Punktzahl",username:"Dein Name",submit_score:"Punktzahl einreichen",new_game:"Nochmal spielen",no_username:"Kein Benutzername eingegeben",username_taken:"Benutzername bereits vergeben",save:"Speichern",leaderboard:"Bestenliste"};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Nt=i=>(t,e)=>{e!==void 0?e.addInitializer(()=>{customElements.define(i,t)}):customElements.define(i,t)};/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Ds=globalThis,Wl=Ds.ShadowRoot&&(Ds.ShadyCSS===void 0||Ds.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,ql=Symbol(),uh=new WeakMap;let Od=class{constructor(t,e,n){if(this._$cssResult$=!0,n!==ql)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t,this.t=e}get styleSheet(){let t=this.o;const e=this.t;if(Wl&&t===void 0){const n=e!==void 0&&e.length===1;n&&(t=uh.get(e)),t===void 0&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),n&&uh.set(e,t))}return t}toString(){return this.cssText}};const kd=i=>new Od(typeof i=="string"?i:i+"",void 0,ql),Dd=(i,...t)=>{const e=i.length===1?i[0]:t.reduce((n,r,s)=>n+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(r)+i[s+1],i[0]);return new Od(e,i,ql)},Ip=(i,t)=>{if(Wl)i.adoptedStyleSheets=t.map(e=>e instanceof CSSStyleSheet?e:e.styleSheet);else for(const e of t){const n=document.createElement("style"),r=Ds.litNonce;r!==void 0&&n.setAttribute("nonce",r),n.textContent=e.cssText,i.appendChild(n)}},dh=Wl?i=>i:i=>i instanceof CSSStyleSheet?(t=>{let e="";for(const n of t.cssRules)e+=n.cssText;return kd(e)})(i):i;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:Tp,defineProperty:Rp,getOwnPropertyDescriptor:Ap,getOwnPropertyNames:Pp,getOwnPropertySymbols:Lp,getPrototypeOf:Mp}=Object,yo=globalThis,fh=yo.trustedTypes,Op=fh?fh.emptyScript:"",kp=yo.reactiveElementPolyfillSupport,br=(i,t)=>i,$s={toAttribute(i,t){switch(t){case Boolean:i=i?Op:null;break;case Object:case Array:i=i==null?i:JSON.stringify(i)}return i},fromAttribute(i,t){let e=i;switch(t){case Boolean:e=i!==null;break;case Number:e=i===null?null:Number(i);break;case Object:case Array:try{e=JSON.parse(i)}catch{e=null}}return e}},Xl=(i,t)=>!Tp(i,t),gh={attribute:!0,type:String,converter:$s,reflect:!1,useDefault:!1,hasChanged:Xl};Symbol.metadata??=Symbol("metadata"),yo.litPropertyMetadata??=new WeakMap;let Si=class extends HTMLElement{static addInitializer(t){this._$Ei(),(this.l??=[]).push(t)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(t,e=gh){if(e.state&&(e.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(t)&&((e=Object.create(e)).wrapped=!0),this.elementProperties.set(t,e),!e.noAccessor){const n=Symbol(),r=this.getPropertyDescriptor(t,n,e);r!==void 0&&Rp(this.prototype,t,r)}}static getPropertyDescriptor(t,e,n){const{get:r,set:s}=Ap(this.prototype,t)??{get(){return this[e]},set(o){this[e]=o}};return{get:r,set(o){const a=r?.call(this);s?.call(this,o),this.requestUpdate(t,a,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)??gh}static _$Ei(){if(this.hasOwnProperty(br("elementProperties")))return;const t=Mp(this);t.finalize(),t.l!==void 0&&(this.l=[...t.l]),this.elementProperties=new Map(t.elementProperties)}static finalize(){if(this.hasOwnProperty(br("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(br("properties"))){const e=this.properties,n=[...Pp(e),...Lp(e)];for(const r of n)this.createProperty(r,e[r])}const t=this[Symbol.metadata];if(t!==null){const e=litPropertyMetadata.get(t);if(e!==void 0)for(const[n,r]of e)this.elementProperties.set(n,r)}this._$Eh=new Map;for(const[e,n]of this.elementProperties){const r=this._$Eu(e,n);r!==void 0&&this._$Eh.set(r,e)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(t){const e=[];if(Array.isArray(t)){const n=new Set(t.flat(1/0).reverse());for(const r of n)e.unshift(dh(r))}else t!==void 0&&e.push(dh(t));return e}static _$Eu(t,e){const n=e.attribute;return n===!1?void 0:typeof n=="string"?n:typeof t=="string"?t.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise(t=>this.enableUpdating=t),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(t=>t(this))}addController(t){(this._$EO??=new Set).add(t),this.renderRoot!==void 0&&this.isConnected&&t.hostConnected?.()}removeController(t){this._$EO?.delete(t)}_$E_(){const t=new Map,e=this.constructor.elementProperties;for(const n of e.keys())this.hasOwnProperty(n)&&(t.set(n,this[n]),delete this[n]);t.size>0&&(this._$Ep=t)}createRenderRoot(){const t=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return Ip(t,this.constructor.elementStyles),t}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach(t=>t.hostConnected?.())}enableUpdating(t){}disconnectedCallback(){this._$EO?.forEach(t=>t.hostDisconnected?.())}attributeChangedCallback(t,e,n){this._$AK(t,n)}_$ET(t,e){const n=this.constructor.elementProperties.get(t),r=this.constructor._$Eu(t,n);if(r!==void 0&&n.reflect===!0){const s=(n.converter?.toAttribute!==void 0?n.converter:$s).toAttribute(e,n.type);this._$Em=t,s==null?this.removeAttribute(r):this.setAttribute(r,s),this._$Em=null}}_$AK(t,e){const n=this.constructor,r=n._$Eh.get(t);if(r!==void 0&&this._$Em!==r){const s=n.getPropertyOptions(r),o=typeof s.converter=="function"?{fromAttribute:s.converter}:s.converter?.fromAttribute!==void 0?s.converter:$s;this._$Em=r;const a=o.fromAttribute(e,s.type);this[r]=a??this._$Ej?.get(r)??a,this._$Em=null}}requestUpdate(t,e,n){if(t!==void 0){const r=this.constructor,s=this[t];if(n??=r.getPropertyOptions(t),!((n.hasChanged??Xl)(s,e)||n.useDefault&&n.reflect&&s===this._$Ej?.get(t)&&!this.hasAttribute(r._$Eu(t,n))))return;this.C(t,e,n)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(t,e,{useDefault:n,reflect:r,wrapped:s},o){n&&!(this._$Ej??=new Map).has(t)&&(this._$Ej.set(t,o??e??this[t]),s!==!0||o!==void 0)||(this._$AL.has(t)||(this.hasUpdated||n||(e=void 0),this._$AL.set(t,e)),r===!0&&this._$Em!==t&&(this._$Eq??=new Set).add(t))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(e){Promise.reject(e)}const t=this.scheduleUpdate();return t!=null&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[r,s]of this._$Ep)this[r]=s;this._$Ep=void 0}const n=this.constructor.elementProperties;if(n.size>0)for(const[r,s]of n){const{wrapped:o}=s,a=this[r];o!==!0||this._$AL.has(r)||a===void 0||this.C(r,void 0,s,a)}}let t=!1;const e=this._$AL;try{t=this.shouldUpdate(e),t?(this.willUpdate(e),this._$EO?.forEach(n=>n.hostUpdate?.()),this.update(e)):this._$EM()}catch(n){throw t=!1,this._$EM(),n}t&&this._$AE(e)}willUpdate(t){}_$AE(t){this._$EO?.forEach(e=>e.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(t){return!0}update(t){this._$Eq&&=this._$Eq.forEach(e=>this._$ET(e,this[e])),this._$EM()}updated(t){}firstUpdated(t){}};Si.elementStyles=[],Si.shadowRootOptions={mode:"open"},Si[br("elementProperties")]=new Map,Si[br("finalized")]=new Map,kp?.({ReactiveElement:Si}),(yo.reactiveElementVersions??=[]).push("2.1.1");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Dp={attribute:!0,type:String,converter:$s,reflect:!1,hasChanged:Xl},Fp=(i=Dp,t,e)=>{const{kind:n,metadata:r}=e;let s=globalThis.litPropertyMetadata.get(r);if(s===void 0&&globalThis.litPropertyMetadata.set(r,s=new Map),n==="setter"&&((i=Object.create(i)).wrapped=!0),s.set(e.name,i),n==="accessor"){const{name:o}=e;return{set(a){const l=t.get.call(this);t.set.call(this,a),this.requestUpdate(o,l,i)},init(a){return a!==void 0&&this.C(o,void 0,i,a),a}}}if(n==="setter"){const{name:o}=e;return function(a){const l=this[o];t.call(this,a),this.requestUpdate(o,l,i)}}throw Error("Unsupported decorator location: "+n)};function M(i){return(t,e)=>typeof e=="object"?Fp(i,t,e):((n,r,s)=>{const o=r.hasOwnProperty(s);return r.constructor.createProperty(s,n),o?Object.getOwnPropertyDescriptor(r,s):void 0})(i,t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function Fe(i){return M({...i,state:!0,attribute:!1})}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Np=(i,t,e)=>(e.configurable=!0,e.enumerable=!0,Reflect.decorate&&typeof t!="object"&&Object.defineProperty(i,t,e),e);/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function Ne(i,t){return(e,n,r)=>{const s=o=>o.renderRoot?.querySelector(i)??null;return Np(e,n,{get(){return s(this)}})}}/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */let Fd=class extends Event{constructor(t,e,n,r){super("context-request",{bubbles:!0,composed:!0}),this.context=t,this.contextTarget=e,this.callback=n,this.subscribe=r??!1}};/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 *//**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */let ph=class{constructor(t,e,n,r){if(this.subscribe=!1,this.provided=!1,this.value=void 0,this.t=(s,o)=>{this.unsubscribe&&(this.unsubscribe!==o&&(this.provided=!1,this.unsubscribe()),this.subscribe||this.unsubscribe()),this.value=s,this.host.requestUpdate(),this.provided&&!this.subscribe||(this.provided=!0,this.callback&&this.callback(s,o)),this.unsubscribe=o},this.host=t,e.context!==void 0){const s=e;this.context=s.context,this.callback=s.callback,this.subscribe=s.subscribe??!1}else this.context=e,this.callback=n,this.subscribe=r??!1;this.host.addController(this)}hostConnected(){this.dispatchRequest()}hostDisconnected(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=void 0)}dispatchRequest(){this.host.dispatchEvent(new Fd(this.context,this.host,this.t,this.subscribe))}};/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */let $p=class{get value(){return this.o}set value(t){this.setValue(t)}setValue(t,e=!1){const n=e||!Object.is(t,this.o);this.o=t,n&&this.updateObservers()}constructor(t){this.subscriptions=new Map,this.updateObservers=()=>{for(const[e,{disposer:n}]of this.subscriptions)e(this.o,n)},t!==void 0&&(this.value=t)}addCallback(t,e,n){if(!n)return void t(this.value);this.subscriptions.has(t)||this.subscriptions.set(t,{disposer:()=>{this.subscriptions.delete(t)},consumerHost:e});const{disposer:r}=this.subscriptions.get(t);t(this.value,r)}clearCallbacks(){this.subscriptions.clear()}};/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */let Vp=class extends Event{constructor(t,e){super("context-provider",{bubbles:!0,composed:!0}),this.context=t,this.contextTarget=e}},mh=class extends $p{constructor(t,e,n){super(e.context!==void 0?e.initialValue:n),this.onContextRequest=r=>{if(r.context!==this.context)return;const s=r.contextTarget??r.composedPath()[0];s!==this.host&&(r.stopPropagation(),this.addCallback(r.callback,s,r.subscribe))},this.onProviderRequest=r=>{if(r.context!==this.context||(r.contextTarget??r.composedPath()[0])===this.host)return;const s=new Set;for(const[o,{consumerHost:a}]of this.subscriptions)s.has(o)||(s.add(o),a.dispatchEvent(new Fd(this.context,a,o,!0)));r.stopPropagation()},this.host=t,e.context!==void 0?this.context=e.context:this.context=e,this.attachListeners(),this.host.addController?.(this)}attachListeners(){this.host.addEventListener("context-request",this.onContextRequest),this.host.addEventListener("context-provider",this.onProviderRequest)}hostConnected(){this.host.dispatchEvent(new Vp(this.context,this.host))}};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function zp({context:i}){return(t,e)=>{const n=new WeakMap;if(typeof e=="object")return{get(){return t.get.call(this)},set(r){return n.get(this).setValue(r),t.set.call(this,r)},init(r){return n.set(this,new mh(this,{context:i,initialValue:r})),r}};{t.constructor.addInitializer(o=>{n.set(o,new mh(o,{context:i}))});const r=Object.getOwnPropertyDescriptor(t,e);let s;if(r===void 0){const o=new WeakMap;s={get(){return o.get(this)},set(a){n.get(this).setValue(a),o.set(this,a)},configurable:!0,enumerable:!0}}else{const o=r.set;s={...r,set(a){n.get(this).setValue(a),o?.call(this,a)}}}return void Object.defineProperty(t,e,s)}}}/**
 * @license
 * Copyright 2022 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function Kl({context:i,subscribe:t}){return(e,n)=>{typeof n=="object"?n.addInitializer(function(){new ph(this,{context:i,callback:r=>{e.set.call(this,r)},subscribe:t})}):e.constructor.addInitializer(r=>{new ph(r,{context:i,callback:s=>{r[n]=s},subscribe:t})})}}function Gp(i,t,e={}){const n={type:"Feature"};return(e.id===0||e.id)&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.properties={},n.geometry=i,n}function ua(i,t,e={}){return Gp({type:"MultiPolygon",coordinates:i},t,e)}function Up(i){return!isNaN(i)&&i!==null&&!Array.isArray(i)}function _h(i){if(!i)throw new Error("bbox is required");if(!Array.isArray(i))throw new Error("bbox must be an Array");if(i.length!==4&&i.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");i.forEach(t=>{if(!Up(t))throw new Error("bbox must only contain numbers")})}function Nd(i,t,e){if(i!==null)for(var n,r,s,o,a,l,c,h=0,u=0,d,f=i.type,m=f==="FeatureCollection",v=f==="Feature",w=m?i.features.length:1,E=0;E<w;E++){c=m?i.features[E].geometry:v?i.geometry:i,d=c?c.type==="GeometryCollection":!1,a=d?c.geometries.length:1;for(var I=0;I<a;I++){var R=0,S=0;if(o=d?c.geometries[I]:c,o!==null){l=o.coordinates;var T=o.type;switch(h=0,T){case null:break;case"Point":if(t(l,u,E,R,S)===!1)return!1;u++,R++;break;case"LineString":case"MultiPoint":for(n=0;n<l.length;n++){if(t(l[n],u,E,R,S)===!1)return!1;u++,T==="MultiPoint"&&R++}T==="LineString"&&R++;break;case"Polygon":case"MultiLineString":for(n=0;n<l.length;n++){for(r=0;r<l[n].length-h;r++){if(t(l[n][r],u,E,R,S)===!1)return!1;u++}T==="MultiLineString"&&R++,T==="Polygon"&&S++}T==="Polygon"&&R++;break;case"MultiPolygon":for(n=0;n<l.length;n++){for(S=0,r=0;r<l[n].length;r++){for(s=0;s<l[n][r].length-h;s++){if(t(l[n][r][s],u,E,R,S)===!1)return!1;u++}S++}R++}break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(Nd(o.geometries[n],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Bp(i,t={}){if(i.bbox!=null&&t.recompute!==!0)return i.bbox;const e=[1/0,1/0,-1/0,-1/0];return Nd(i,n=>{e[0]>n[0]&&(e[0]=n[0]),e[1]>n[1]&&(e[1]=n[1]),e[2]<n[0]&&(e[2]=n[0]),e[3]<n[1]&&(e[3]=n[1])}),e}var Er=Bp;const Ke=11102230246251565e-32,Ot=134217729,jp=(3+8*Ke)*Ke;function da(i,t,e,n,r){let s,o,a,l,c=t[0],h=n[0],u=0,d=0;h>c==h>-c?(s=c,c=t[++u]):(s=h,h=n[++d]);let f=0;if(u<i&&d<e)for(h>c==h>-c?(o=c+s,a=s-(o-c),c=t[++u]):(o=h+s,a=s-(o-h),h=n[++d]),s=o,a!==0&&(r[f++]=a);u<i&&d<e;)h>c==h>-c?(o=s+c,l=o-s,a=s-(o-l)+(c-l),c=t[++u]):(o=s+h,l=o-s,a=s-(o-l)+(h-l),h=n[++d]),s=o,a!==0&&(r[f++]=a);for(;u<i;)o=s+c,l=o-s,a=s-(o-l)+(c-l),c=t[++u],s=o,a!==0&&(r[f++]=a);for(;d<e;)o=s+h,l=o-s,a=s-(o-l)+(h-l),h=n[++d],s=o,a!==0&&(r[f++]=a);return(s!==0||f===0)&&(r[f++]=s),f}function Wp(i,t){let e=t[0];for(let n=1;n<i;n++)e+=t[n];return e}function ts(i){return new Float64Array(i)}const qp=(3+16*Ke)*Ke,Xp=(2+12*Ke)*Ke,Kp=(9+64*Ke)*Ke*Ke,mi=ts(4),yh=ts(8),wh=ts(12),vh=ts(16),zt=ts(4);function Hp(i,t,e,n,r,s,o){let a,l,c,h,u,d,f,m,v,w,E,I,R,S,T,A,y,g;const p=i-r,b=e-r,C=t-s,x=n-s;S=p*x,d=Ot*p,f=d-(d-p),m=p-f,d=Ot*x,v=d-(d-x),w=x-v,T=m*w-(S-f*v-m*v-f*w),A=C*b,d=Ot*C,f=d-(d-C),m=C-f,d=Ot*b,v=d-(d-b),w=b-v,y=m*w-(A-f*v-m*v-f*w),E=T-y,u=T-E,mi[0]=T-(E+u)+(u-y),I=S+E,u=I-S,R=S-(I-u)+(E-u),E=R-A,u=R-E,mi[1]=R-(E+u)+(u-A),g=I+E,u=g-I,mi[2]=I-(g-u)+(E-u),mi[3]=g;let _=Wp(4,mi),V=Xp*o;if(_>=V||-_>=V||(u=i-p,a=i-(p+u)+(u-r),u=e-b,c=e-(b+u)+(u-r),u=t-C,l=t-(C+u)+(u-s),u=n-x,h=n-(x+u)+(u-s),a===0&&l===0&&c===0&&h===0)||(V=Kp*o+jp*Math.abs(_),_+=p*h+x*a-(C*c+b*l),_>=V||-_>=V))return _;S=a*x,d=Ot*a,f=d-(d-a),m=a-f,d=Ot*x,v=d-(d-x),w=x-v,T=m*w-(S-f*v-m*v-f*w),A=l*b,d=Ot*l,f=d-(d-l),m=l-f,d=Ot*b,v=d-(d-b),w=b-v,y=m*w-(A-f*v-m*v-f*w),E=T-y,u=T-E,zt[0]=T-(E+u)+(u-y),I=S+E,u=I-S,R=S-(I-u)+(E-u),E=R-A,u=R-E,zt[1]=R-(E+u)+(u-A),g=I+E,u=g-I,zt[2]=I-(g-u)+(E-u),zt[3]=g;const D=da(4,mi,4,zt,yh);S=p*h,d=Ot*p,f=d-(d-p),m=p-f,d=Ot*h,v=d-(d-h),w=h-v,T=m*w-(S-f*v-m*v-f*w),A=C*c,d=Ot*C,f=d-(d-C),m=C-f,d=Ot*c,v=d-(d-c),w=c-v,y=m*w-(A-f*v-m*v-f*w),E=T-y,u=T-E,zt[0]=T-(E+u)+(u-y),I=S+E,u=I-S,R=S-(I-u)+(E-u),E=R-A,u=R-E,zt[1]=R-(E+u)+(u-A),g=I+E,u=g-I,zt[2]=I-(g-u)+(E-u),zt[3]=g;const B=da(D,yh,4,zt,wh);S=a*h,d=Ot*a,f=d-(d-a),m=a-f,d=Ot*h,v=d-(d-h),w=h-v,T=m*w-(S-f*v-m*v-f*w),A=l*c,d=Ot*l,f=d-(d-l),m=l-f,d=Ot*c,v=d-(d-c),w=c-v,y=m*w-(A-f*v-m*v-f*w),E=T-y,u=T-E,zt[0]=T-(E+u)+(u-y),I=S+E,u=I-S,R=S-(I-u)+(E-u),E=R-A,u=R-E,zt[1]=R-(E+u)+(u-A),g=I+E,u=g-I,zt[2]=I-(g-u)+(E-u),zt[3]=g;const k=da(B,wh,4,zt,vh);return vh[k-1]}function Yp(i,t,e,n,r,s){const o=(t-s)*(e-r),a=(i-r)*(n-s),l=o-a,c=Math.abs(o+a);return Math.abs(l)>=qp*c?l:-Hp(i,t,e,n,r,s,c)}function Zp(i,t){var e,n,r=0,s,o,a,l,c,h,u,d=i[0],f=i[1],m=t.length;for(e=0;e<m;e++){n=0;var v=t[e],w=v.length-1;if(h=v[0],h[0]!==v[w][0]&&h[1]!==v[w][1])throw new Error("First and last coordinates in a ring must be the same");for(o=h[0]-d,a=h[1]-f,n;n<w;n++){if(u=v[n+1],l=u[0]-d,c=u[1]-f,a===0&&c===0){if(l<=0&&o>=0||o<=0&&l>=0)return 0}else if(c>=0&&a<=0||c<=0&&a>=0){if(s=Yp(o,l,a,c,0,0),s===0)return 0;(s>0&&c>0&&a<=0||s<0&&c<=0&&a>0)&&r++}h=u,a=c,o=l}}return r%2!==0}function Jp(i){if(!i)throw new Error("coord is required");if(!Array.isArray(i)){if(i.type==="Feature"&&i.geometry!==null&&i.geometry.type==="Point")return[...i.geometry.coordinates];if(i.type==="Point")return[...i.coordinates]}if(Array.isArray(i)&&i.length>=2&&!Array.isArray(i[0])&&!Array.isArray(i[1]))return[...i];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Qp(i){return i.type==="Feature"?i.geometry:i}function tm(i,t,e={}){if(!i)throw new Error("point is required");if(!t)throw new Error("polygon is required");const n=Jp(i),r=Qp(t),s=r.type,o=t.bbox;let a=r.coordinates;if(o&&em(n,o)===!1)return!1;s==="Polygon"&&(a=[a]);let l=!1;for(var c=0;c<a.length;++c){const h=Zp(n,a[c]);if(h===0)return!e.ignoreBoundary;h&&(l=!0)}return l}function em(i,t){return t[0]<=i[0]&&t[1]<=i[1]&&t[2]>=i[0]&&t[3]>=i[1]}var $d=tm;function bh(i){return im(i),nm(i)}function nm(i){return Array.isArray(i)?Eh(i):i&&i.bbox?Eh(i.bbox):[rm(),sm()]}function im(i){i!=null&&(Array.isArray(i)?_h(i):i.bbox!=null&&_h(i.bbox))}function Vd(){return Math.random()-.5}function rm(){return Vd()*360}function sm(){return Vd()*180}function Eh(i){return[Math.random()*(i[2]-i[0])+i[0],Math.random()*(i[3]-i[1])+i[1]]}function om(i,t,e){let n,r;e=e||He;let s=0,o=i.length,a=!1;for(;s<o;)n=s+(o-s>>1),r=+e(i[n],t),r<0?s=n+1:(o=n,a=!r);return a?s:~s}function He(i,t){return i>t?1:i<t?-1:0}function am(i,t){return i<t?1:i>t?-1:0}function Hl(i,t,e){if(i[0]<=t)return 0;const n=i.length;if(t<=i[n-1])return n-1;if(typeof e=="function"){for(let r=1;r<n;++r){const s=i[r];if(s===t)return r;if(s<t)return e(t,i[r-1],s)>0?r-1:r}return n-1}if(e>0){for(let r=1;r<n;++r)if(i[r]<t)return r-1;return n-1}if(e<0){for(let r=1;r<n;++r)if(i[r]<=t)return r;return n-1}for(let r=1;r<n;++r){if(i[r]==t)return r;if(i[r]<t)return i[r-1]-t<t-i[r]?r-1:r}return n-1}function lm(i,t,e){for(;t<e;){const n=i[t];i[t]=i[e],i[e]=n,++t,--e}}function Oe(i,t){const e=Array.isArray(t)?t:[t],n=e.length;for(let r=0;r<n;r++)i[i.length]=e[r]}function Pn(i,t){const e=i.length;if(e!==t.length)return!1;for(let n=0;n<e;n++)if(i[n]!==t[n])return!1;return!0}function cm(i,t,e){const n=t||He;return i.every(function(r,s){if(s===0)return!0;const o=n(i[s-1],r);return!(o>0||o===0)})}const It={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function Ch(i){const t=fe();for(let e=0,n=i.length;e<n;++e)Cr(t,i[e]);return t}function hm(i,t,e){const n=Math.min.apply(null,i),r=Math.min.apply(null,t),s=Math.max.apply(null,i),o=Math.max.apply(null,t);return Qe(n,r,s,o,e)}function Yl(i,t,e){return e?(e[0]=i[0]-t,e[1]=i[1]-t,e[2]=i[2]+t,e[3]=i[3]+t,e):[i[0]-t,i[1]-t,i[2]+t,i[3]+t]}function zd(i,t){return t?(t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t):i.slice()}function si(i,t,e){let n,r;return t<i[0]?n=i[0]-t:i[2]<t?n=t-i[2]:n=0,e<i[1]?r=i[1]-e:i[3]<e?r=e-i[3]:r=0,n*n+r*r}function $i(i,t){return Zl(i,t[0],t[1])}function mr(i,t){return i[0]<=t[0]&&t[2]<=i[2]&&i[1]<=t[1]&&t[3]<=i[3]}function Zl(i,t,e){return i[0]<=t&&t<=i[2]&&i[1]<=e&&e<=i[3]}function Qa(i,t){const e=i[0],n=i[1],r=i[2],s=i[3],o=t[0],a=t[1];let l=It.UNKNOWN;return o<e?l=l|It.LEFT:o>r&&(l=l|It.RIGHT),a<n?l=l|It.BELOW:a>s&&(l=l|It.ABOVE),l===It.UNKNOWN&&(l=It.INTERSECTING),l}function fe(){return[1/0,1/0,-1/0,-1/0]}function Qe(i,t,e,n,r){return r?(r[0]=i,r[1]=t,r[2]=e,r[3]=n,r):[i,t,e,n]}function Qi(i){return Qe(1/0,1/0,-1/0,-1/0,i)}function Gd(i,t){const e=i[0],n=i[1];return Qe(e,n,e,n,t)}function Jl(i,t,e,n,r){const s=Qi(r);return Bd(s,i,t,e,n)}function Pr(i,t){return i[0]==t[0]&&i[2]==t[2]&&i[1]==t[1]&&i[3]==t[3]}function Ud(i,t){return t[0]<i[0]&&(i[0]=t[0]),t[2]>i[2]&&(i[2]=t[2]),t[1]<i[1]&&(i[1]=t[1]),t[3]>i[3]&&(i[3]=t[3]),i}function Cr(i,t){t[0]<i[0]&&(i[0]=t[0]),t[0]>i[2]&&(i[2]=t[0]),t[1]<i[1]&&(i[1]=t[1]),t[1]>i[3]&&(i[3]=t[1])}function Bd(i,t,e,n,r){for(;e<n;e+=r)um(i,t[e],t[e+1]);return i}function um(i,t,e){i[0]=Math.min(i[0],t),i[1]=Math.min(i[1],e),i[2]=Math.max(i[2],t),i[3]=Math.max(i[3],e)}function jd(i,t){let e;return e=t(wo(i)),e||(e=t(vo(i)),e)||(e=t(bo(i)),e)||(e=t(oi(i)),e)?e:!1}function tl(i){let t=0;return es(i)||(t=ot(i)*Ut(i)),t}function wo(i){return[i[0],i[1]]}function vo(i){return[i[2],i[1]]}function tn(i){return[(i[0]+i[2])/2,(i[1]+i[3])/2]}function dm(i,t){let e;if(t==="bottom-left")e=wo(i);else if(t==="bottom-right")e=vo(i);else if(t==="top-left")e=oi(i);else if(t==="top-right")e=bo(i);else throw new Error("Invalid corner");return e}function el(i,t,e,n,r){const[s,o,a,l,c,h,u,d]=Wd(i,t,e,n);return Qe(Math.min(s,a,c,u),Math.min(o,l,h,d),Math.max(s,a,c,u),Math.max(o,l,h,d),r)}function Wd(i,t,e,n){const r=t*n[0]/2,s=t*n[1]/2,o=Math.cos(e),a=Math.sin(e),l=r*o,c=r*a,h=s*o,u=s*a,d=i[0],f=i[1];return[d-l+u,f-c-h,d-l-u,f-c+h,d+l-u,f+c+h,d+l+u,f+c-h,d-l+u,f-c-h]}function Ut(i){return i[3]-i[1]}function Kn(i,t,e){const n=e||fe();return Xt(i,t)?(i[0]>t[0]?n[0]=i[0]:n[0]=t[0],i[1]>t[1]?n[1]=i[1]:n[1]=t[1],i[2]<t[2]?n[2]=i[2]:n[2]=t[2],i[3]<t[3]?n[3]=i[3]:n[3]=t[3]):Qi(n),n}function oi(i){return[i[0],i[3]]}function bo(i){return[i[2],i[3]]}function ot(i){return i[2]-i[0]}function Xt(i,t){return i[0]<=t[2]&&i[2]>=t[0]&&i[1]<=t[3]&&i[3]>=t[1]}function es(i){return i[2]<i[0]||i[3]<i[1]}function fm(i,t){return t?(t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t):i}function gm(i,t,e){let n=!1;const r=Qa(i,t),s=Qa(i,e);if(r===It.INTERSECTING||s===It.INTERSECTING)n=!0;else{const o=i[0],a=i[1],l=i[2],c=i[3],h=t[0],u=t[1],d=e[0],f=e[1],m=(f-u)/(d-h);let v,w;s&It.ABOVE&&!(r&It.ABOVE)&&(v=d-(f-c)/m,n=v>=o&&v<=l),!n&&s&It.RIGHT&&!(r&It.RIGHT)&&(w=f-(d-l)*m,n=w>=a&&w<=c),!n&&s&It.BELOW&&!(r&It.BELOW)&&(v=d-(f-a)/m,n=v>=o&&v<=l),!n&&s&It.LEFT&&!(r&It.LEFT)&&(w=f-(d-o)*m,n=w>=a&&w<=c)}return n}function pm(i,t,e,n){if(es(i))return Qi(e);let r=[];r=[i[0],i[1],i[2],i[1],i[2],i[3],i[0],i[3]],t(r,r,2);const s=[],o=[];for(let a=0,l=r.length;a<l;a+=2)s.push(r[a]),o.push(r[a+1]);return hm(s,o,e)}function qd(i,t){const e=t.getExtent(),n=tn(i);if(t.canWrapX()&&(n[0]<e[0]||n[0]>=e[2])){const r=ot(e),o=Math.floor((n[0]-e[0])/r)*r;i[0]-=o,i[2]-=o}return i}function Xd(i,t,e){if(t.canWrapX()){const n=t.getExtent();if(!isFinite(i[0])||!isFinite(i[2]))return[[n[0],i[1],n[2],i[3]]];qd(i,t);const r=ot(n);if(ot(i)>r&&!e)return[[n[0],i[1],n[2],i[3]]];if(i[0]<n[0])return[[i[0]+r,i[1],n[2],i[3]],[n[0],i[1],i[2],i[3]]];if(i[2]>n[2])return[[i[0],i[1],n[2],i[3]],[n[0],i[1],i[2]-r,i[3]]]}return[i]}function dt(i,t,e){return Math.min(Math.max(i,t),e)}function mm(i,t,e,n,r,s){const o=r-e,a=s-n;if(o!==0||a!==0){const l=((i-e)*o+(t-n)*a)/(o*o+a*a);l>1?(e=r,n=s):l>0&&(e+=o*l,n+=a*l)}return Hn(i,t,e,n)}function Hn(i,t,e,n){const r=e-i,s=n-t;return r*r+s*s}function _m(i){const t=i.length;for(let n=0;n<t;n++){let r=n,s=Math.abs(i[n][n]);for(let a=n+1;a<t;a++){const l=Math.abs(i[a][n]);l>s&&(s=l,r=a)}if(s===0)return null;const o=i[r];i[r]=i[n],i[n]=o;for(let a=n+1;a<t;a++){const l=-i[a][n]/i[n][n];for(let c=n;c<t+1;c++)n==c?i[a][c]=0:i[a][c]+=l*i[n][c]}}const e=new Array(t);for(let n=t-1;n>=0;n--){e[n]=i[n][t]/i[n][n];for(let r=n-1;r>=0;r--)i[r][t]-=i[r][n]*e[n]}return e}function xh(i){return i*180/Math.PI}function bn(i){return i*Math.PI/180}function Mi(i,t){const e=i%t;return e*t<0?e+t:e}function ee(i,t,e){return i+e*(t-i)}function Eo(i,t){const e=Math.pow(10,t);return Math.round(i*e)/e}function ws(i,t){return Math.floor(Eo(i,t))}function vs(i,t){return Math.ceil(Eo(i,t))}function nl(i,t,e){if(i>=t&&i<e)return i;const n=e-t;return((i-t)%n+n)%n+t}const ym=63710088e-1;function il(i,t,e){e=e||ym;const n=bn(i[1]),r=bn(t[1]),s=(r-n)/2,o=bn(t[0]-i[0])/2,a=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(n)*Math.cos(r);return 2*e*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}function U(){throw new Error("Unimplemented abstract method.")}let wm=0;function et(i){return i.ol_uid||(i.ol_uid=String(++wm))}const Vi={PROPERTYCHANGE:"propertychange"},W={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class Co{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function Lr(){return!0}function xo(){return!1}function Mr(){}function Kd(i){let t,e,n;return function(){const r=Array.prototype.slice.call(arguments);return(!e||this!==n||!Pn(r,e))&&(n=this,e=r,t=i.apply(this,arguments)),t}}function vm(i){function t(){let e;try{e=i()}catch(n){return Promise.reject(n)}return e instanceof Promise?e:Promise.resolve(e)}return t()}function ns(i){for(const t in i)delete i[t]}function Jn(i){let t;for(t in i)return!1;return!t}class on{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}class So extends Co{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const n=this.listeners_||(this.listeners_={}),r=n[t]||(n[t]=[]);r.includes(e)||r.push(e)}dispatchEvent(t){const e=typeof t=="string",n=e?t:t.type,r=this.listeners_&&this.listeners_[n];if(!r)return;const s=e?new on(t):t;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});n in o||(o[n]=0,a[n]=0),++o[n];let l;for(let c=0,h=r.length;c<h;++c)if("handleEvent"in r[c]?l=r[c].handleEvent(s):l=r[c].call(this,s),l===!1||s.propagationStopped){l=!1;break}if(--o[n]===0){let c=a[n];for(delete a[n];c--;)this.removeEventListener(n,Mr);delete o[n]}return l}disposeInternal(){this.listeners_&&ns(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return this.listeners_?t?t in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(t,e){if(!this.listeners_)return;const n=this.listeners_[t];if(!n)return;const r=n.indexOf(e);r!==-1&&(this.pendingRemovals_&&t in this.pendingRemovals_?(n[r]=Mr,++this.pendingRemovals_[t]):(n.splice(r,1),n.length===0&&delete this.listeners_[t]))}}function tt(i,t,e,n,r){if(r){const o=e;e=function(a){return i.removeEventListener(t,e),o.call(n??this,a)}}else n&&n!==i&&(e=e.bind(n));const s={target:i,type:t,listener:e};return i.addEventListener(t,e),s}function Vs(i,t,e,n){return tt(i,t,e,n,!0)}function ct(i){i&&i.target&&(i.target.removeEventListener(i.type,i.listener),ns(i))}class is extends So{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(W.CHANGE)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const n=t.length,r=new Array(n);for(let s=0;s<n;++s)r[s]=tt(this,t[s],e);return r}return tt(this,t,e)}onceInternal(t,e){let n;if(Array.isArray(t)){const r=t.length;n=new Array(r);for(let s=0;s<r;++s)n[s]=Vs(this,t[s],e)}else n=Vs(this,t,e);return e.ol_key=n,n}unInternal(t,e){const n=e.ol_key;if(n)bm(n);else if(Array.isArray(t))for(let r=0,s=t.length;r<s;++r)this.removeEventListener(t[r],e);else this.removeEventListener(t,e)}}is.prototype.on;is.prototype.once;is.prototype.un;function bm(i){if(Array.isArray(i))for(let t=0,e=i.length;t<e;++t)ct(i[t]);else ct(i)}class Sh extends on{constructor(t,e,n){super(t),this.key=e,this.oldValue=n}}class $e extends is{constructor(t){super(),this.on,this.once,this.un,et(this),this.values_=null,t!==void 0&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(t,e){let n;n=`change:${t}`,this.hasListener(n)&&this.dispatchEvent(new Sh(n,t,e)),n=Vi.PROPERTYCHANGE,this.hasListener(n)&&this.dispatchEvent(new Sh(n,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,n){const r=this.values_||(this.values_={});if(n)r[t]=e;else{const s=r[t];r[t]=e,s!==e&&this.notify(t,s)}}setProperties(t,e){for(const n in t)this.set(n,t[n],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const n=this.values_[t];delete this.values_[t],Jn(this.values_)&&(this.values_=null),e||this.notify(t,n)}}}function Hd(...i){console.warn(...i)}function Em(i,t){return i[0]+=+t[0],i[1]+=+t[1],i}function zs(i,t){let e=!0;for(let n=i.length-1;n>=0;--n)if(i[n]!=t[n]){e=!1;break}return e}function Ql(i,t){const e=Math.cos(t),n=Math.sin(t),r=i[0]*e-i[1]*n,s=i[1]*e+i[0]*n;return i[0]=r,i[1]=s,i}function Cm(i,t){return i[0]*=t,i[1]*=t,i}function Yd(i,t){if(t.canWrapX()){const e=ot(t.getExtent()),n=xm(i,t,e);n&&(i[0]-=n*e)}return i}function xm(i,t,e){const n=t.getExtent();let r=0;return t.canWrapX()&&(i[0]<n[0]||i[0]>n[2])&&(e=e||ot(n),r=Math.floor((i[0]-n[0])/e)),r}const tc={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class ec{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=t.extent!==void 0?t.extent:null,this.worldExtent_=t.worldExtent!==void 0?t.worldExtent:null,this.axisOrientation_=t.axisOrientation!==void 0?t.axisOrientation:"enu",this.global_=t.global!==void 0?t.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||tc[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!!(t&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!!(this.global_&&t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const rs=6378137,Li=Math.PI*rs,Sm=[-Li,-Li,Li,Li],Im=[-180,-85,180,85],bs=rs*Math.log(Math.tan(Math.PI/2));class _i extends ec{constructor(t){super({code:t,units:"m",extent:Sm,global:!0,worldExtent:Im,getPointResolution:function(e,n){return e/Math.cosh(n[1]/rs)}})}}const Ih=[new _i("EPSG:3857"),new _i("EPSG:102100"),new _i("EPSG:102113"),new _i("EPSG:900913"),new _i("http://www.opengis.net/def/crs/EPSG/0/3857"),new _i("http://www.opengis.net/gml/srs/epsg.xml#3857")];function Tm(i,t,e,n){const r=i.length;e=e>1?e:2,n=n??e,t===void 0&&(e>2?t=i.slice():t=new Array(r));for(let s=0;s<r;s+=n){t[s]=Li*i[s]/180;let o=rs*Math.log(Math.tan(Math.PI*(+i[s+1]+90)/360));o>bs?o=bs:o<-bs&&(o=-bs),t[s+1]=o}return t}function Rm(i,t,e,n){const r=i.length;e=e>1?e:2,n=n??e,t===void 0&&(e>2?t=i.slice():t=new Array(r));for(let s=0;s<r;s+=n)t[s]=180*i[s]/Li,t[s+1]=360*Math.atan(Math.exp(i[s+1]/rs))/Math.PI-90;return t}const Am=6378137,Th=[-180,-90,180,90],Pm=Math.PI*Am/180;class kn extends ec{constructor(t,e){super({code:t,units:"degrees",extent:Th,axisOrientation:e,global:!0,metersPerUnit:Pm,worldExtent:Th})}}const Rh=[new kn("CRS:84"),new kn("EPSG:4326","neu"),new kn("urn:ogc:def:crs:OGC:1.3:CRS84"),new kn("urn:ogc:def:crs:OGC:2:84"),new kn("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new kn("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new kn("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let rl={};function Lm(i){return rl[i]||rl[i.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function Mm(i,t){rl[i]=t}let Oi={};function Or(i,t,e){const n=i.getCode(),r=t.getCode();n in Oi||(Oi[n]={}),Oi[n][r]=e}function fa(i,t){return i in Oi&&t in Oi[i]?Oi[i][t]:null}const Gs=.9996,ue=.00669438,Io=ue*ue,To=Io*ue,Bn=ue/(1-ue),Ah=Math.sqrt(1-ue),zi=(1-Ah)/(1+Ah),Zd=zi*zi,nc=Zd*zi,ic=nc*zi,Jd=ic*zi,Qd=1-ue/4-3*Io/64-5*To/256,Om=3*ue/8+3*Io/32+45*To/1024,km=15*Io/256+45*To/1024,Dm=35*To/3072,Fm=3/2*zi-27/32*nc+269/512*Jd,Nm=21/16*Zd-55/32*ic,$m=151/96*nc-417/128*Jd,Vm=1097/512*ic,Us=6378137;function zm(i,t,e){const n=i-5e5,o=(e.north?t:t-1e7)/Gs/(Us*Qd),a=o+Fm*Math.sin(2*o)+Nm*Math.sin(4*o)+$m*Math.sin(6*o)+Vm*Math.sin(8*o),l=Math.sin(a),c=l*l,h=Math.cos(a),u=l/h,d=u*u,f=d*d,m=1-ue*c,v=Math.sqrt(1-ue*c),w=Us/v,E=(1-ue)/m,I=Bn*h**2,R=I*I,S=n/(w*Gs),T=S*S,A=T*S,y=A*S,g=y*S,p=g*S,b=a-u/E*(T/2-y/24*(5+3*d+10*I-4*R-9*Bn))+p/720*(61+90*d+298*I+45*f-252*Bn-3*R);let C=(S-A/6*(1+2*d+I)+g/120*(5-2*I+28*d-3*R+8*Bn+24*f))/h;return C=nl(C+bn(tf(e.number)),-Math.PI,Math.PI),[xh(C),xh(b)]}const Ph=-80,Lh=84,Gm=-180,Um=180;function Bm(i,t,e){i=nl(i,Gm,Um),t<Ph?t=Ph:t>Lh&&(t=Lh);const n=bn(t),r=Math.sin(n),s=Math.cos(n),o=r/s,a=o*o,l=a*a,c=bn(i),h=tf(e.number),u=bn(h),d=Us/Math.sqrt(1-ue*r**2),f=Bn*s**2,m=s*nl(c-u,-Math.PI,Math.PI),v=m*m,w=v*m,E=w*m,I=E*m,R=I*m,S=Us*(Qd*n-Om*Math.sin(2*n)+km*Math.sin(4*n)-Dm*Math.sin(6*n)),T=Gs*d*(m+w/6*(1-a+f)+I/120*(5-18*a+l+72*f-58*Bn))+5e5;let A=Gs*(S+d*o*(v/2+E/24*(5-a+9*f+4*f**2)+R/720*(61-58*a+l+600*f-330*Bn)));return e.north||(A+=1e7),[T,A]}function tf(i){return(i-1)*6-180+3}const jm=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function ef(i){let t=0;for(const r of jm){const s=i.match(r);if(s){t=parseInt(s[1]);break}}if(!t)return null;let e=0,n=!1;return t>32700&&t<32761?e=t-32700:t>32600&&t<32661&&(n=!0,e=t-32600),e?{number:e,north:n}:null}function Mh(i,t){return function(e,n,r,s){const o=e.length;r=r>1?r:2,s=s??r,n||(r>2?n=e.slice():n=new Array(o));for(let a=0;a<o;a+=s){const l=e[a],c=e[a+1],h=i(l,c,t);n[a]=h[0],n[a+1]=h[1]}return n}}function Wm(i){return ef(i)?new ec({code:i,units:"m"}):null}function qm(i){const t=ef(i.getCode());return t?{forward:Mh(Bm,t),inverse:Mh(zm,t)}:null}const Xm=[qm],Km=[Wm];let sl=!0;function Hm(i){sl=!1}function rc(i,t){if(t!==void 0){for(let e=0,n=i.length;e<n;++e)t[e]=i[e];t=t}else t=i.slice();return t}function ol(i){Mm(i.getCode(),i),Or(i,i,rc)}function Ym(i){i.forEach(ol)}function ht(i){if(typeof i!="string")return i;const t=Lm(i);if(t)return t;for(const e of Km){const n=e(i);if(n)return n}return null}function Oh(i,t,e,n){i=ht(i);let r;const s=i.getPointResolutionFunc();if(s)r=s(t,e);else{const o=i.getUnits();if(o=="degrees"&&!n||n=="degrees")r=t;else{const a=ss(i,ht("EPSG:4326"));if(!a&&o!=="degrees")r=t*i.getMetersPerUnit();else{let c=[e[0]-t/2,e[1],e[0]+t/2,e[1],e[0],e[1]-t/2,e[0],e[1]+t/2];c=a(c,c,2);const h=il(c.slice(0,2),c.slice(2,4)),u=il(c.slice(4,6),c.slice(6,8));r=(h+u)/2}const l=i.getMetersPerUnit();l!==void 0&&(r/=l)}}return r}function kh(i){Ym(i),i.forEach(function(t){i.forEach(function(e){t!==e&&Or(t,e,rc)})})}function Zm(i,t,e,n){i.forEach(function(r){t.forEach(function(s){Or(r,s,e),Or(s,r,n)})})}function sc(i,t){return i?typeof i=="string"?ht(i):i:ht(t)}function Jm(i){return function(t,e,n,r){const s=t.length;n=n!==void 0?n:2,r=r??n,e=e!==void 0?e:new Array(s);for(let o=0;o<s;o+=r){const a=i(t.slice(o,o+n)),l=a.length;for(let c=0,h=r;c<h;++c)e[o+c]=c>=l?t[o+c]:a[c]}return e}}function Fs(i,t){if(i===t)return!0;const e=i.getUnits()===t.getUnits();return(i.getCode()===t.getCode()||ss(i,t)===rc)&&e}function ss(i,t){const e=i.getCode(),n=t.getCode();let r=fa(e,n);if(r)return r;let s=null,o=null;for(const l of Xm)s||(s=l(i)),o||(o=l(t));if(!s&&!o)return null;const a="EPSG:4326";if(o)if(s)r=ga(s.inverse,o.forward);else{const l=fa(e,a);l&&(r=ga(l,o.forward))}else{const l=fa(a,n);l&&(r=ga(s.inverse,l))}return r&&(ol(i),ol(t),Or(i,t,r)),r}function ga(i,t){return function(e,n,r,s){return n=i(e,n,r,s),t(n,n,r,s)}}function Gi(i,t){const e=ht(i),n=ht(t);return ss(e,n)}function Ro(i,t,e){const n=Gi(t,e);if(!n){const r=ht(t).getCode(),s=ht(e).getCode();throw new Error(`No transform available between ${r} and ${s}`)}return n(i,void 0,i.length)}function nf(i,t,e,n){const r=Gi(t,e);return pm(i,r,void 0)}let ge=null;function Qm(i){ge=ht(i)}function Bs(){return ge}function t_(){Qm("EPSG:4326")}function al(i,t){return ge?Ro(i,t,ge):i}function qe(i,t){return ge?Ro(i,ge,t):(sl&&!zs(i,[0,0])&&i[0]>=-180&&i[0]<=180&&i[1]>=-90&&i[1]<=90&&(sl=!1,Hd("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),i)}function js(i,t){return ge?nf(i,t,ge):i}function yn(i,t){return ge?nf(i,ge,t):i}function e_(i,t){if(!ge)return i;const e=ht(t).getMetersPerUnit(),n=ge.getMetersPerUnit();return e&&n?i*e/n:i}function n_(){kh(Ih),kh(Rh),Zm(Rh,Ih,Tm,Rm)}n_();function it(i,t){if(!i)throw new Error(t)}new Array(6);function ve(){return[1,0,0,1,0,0]}function i_(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i}function Tt(i,t){const e=t[0],n=t[1];return t[0]=i[0]*e+i[2]*n+i[4],t[1]=i[1]*e+i[3]*n+i[5],t}function en(i,t,e,n,r,s,o,a){const l=Math.sin(s),c=Math.cos(s);return i[0]=n*c,i[1]=r*l,i[2]=-n*l,i[3]=r*c,i[4]=o*n*c-a*n*l+t,i[5]=o*r*l+a*r*c+e,i}function rf(i,t){const e=r_(t);it(e!==0,"Transformation matrix cannot be inverted");const n=t[0],r=t[1],s=t[2],o=t[3],a=t[4],l=t[5];return i[0]=o/e,i[1]=-r/e,i[2]=-s/e,i[3]=n/e,i[4]=(s*l-o*a)/e,i[5]=-(n*l-r*a)/e,i}function r_(i){return i[0]*i[3]-i[1]*i[2]}const s_=[1e5,1e5,1e5,1e5,2,2];function o_(i){return"matrix("+i.join(", ")+")"}function Dh(i){return i.substring(7,i.length-1).split(",").map(parseFloat)}function a_(i,t){const e=Dh(i),n=Dh(t);for(let r=0;r<6;++r)if(Math.round((e[r]-n[r])*s_[r])!==0)return!1;return!0}function En(i,t,e,n,r,s,o){s=s||[],o=o||2;let a=0;for(let l=t;l<e;l+=n){const c=i[l],h=i[l+1];s[a++]=r[0]*c+r[2]*h+r[4],s[a++]=r[1]*c+r[3]*h+r[5];for(let u=2;u<o;u++)s[a++]=i[l+u]}return s&&s.length!=a&&(s.length=a),s}function sf(i,t,e,n,r,s,o){o=o||[];const a=Math.cos(r),l=Math.sin(r),c=s[0],h=s[1];let u=0;for(let d=t;d<e;d+=n){const f=i[d]-c,m=i[d+1]-h;o[u++]=c+f*a-m*l,o[u++]=h+f*l+m*a;for(let v=d+2;v<d+n;++v)o[u++]=i[v]}return o&&o.length!=u&&(o.length=u),o}function l_(i,t,e,n,r,s,o,a){a=a||[];const l=o[0],c=o[1];let h=0;for(let u=t;u<e;u+=n){const d=i[u]-l,f=i[u+1]-c;a[h++]=l+r*d,a[h++]=c+s*f;for(let m=u+2;m<u+n;++m)a[h++]=i[m]}return a&&a.length!=h&&(a.length=h),a}function c_(i,t,e,n,r,s,o){o=o||[];let a=0;for(let l=t;l<e;l+=n){o[a++]=i[l]+r,o[a++]=i[l+1]+s;for(let c=l+2;c<l+n;++c)o[a++]=i[c]}return o&&o.length!=a&&(o.length=a),o}const Fh=ve(),h_=[NaN,NaN];class of extends $e{constructor(){super(),this.extent_=fe(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=Kd((t,e,n)=>{if(!n)return this.getSimplifiedGeometry(e);const r=this.clone();return r.applyTransform(n),r.getSimplifiedGeometry(e)})}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return U()}closestPointXY(t,e,n,r){return U()}containsXY(t,e){return this.closestPointXY(t,e,h_,Number.MIN_VALUE)===0}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return U()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&Qi(e),this.extentRevision_=this.getRevision()}return fm(this.extent_,t)}rotate(t,e){U()}scale(t,e,n){U()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return U()}getType(){return U()}applyTransform(t){U()}intersectsExtent(t){return U()}translate(t,e){U()}transform(t,e){const n=ht(t),r=n.getUnits()=="tile-pixels"?function(s,o,a){const l=n.getExtent(),c=n.getWorldExtent(),h=Ut(c)/Ut(l);en(Fh,c[0],c[3],h,-h,0,0,0);const u=En(s,0,s.length,a,Fh,o),d=Gi(n,e);return d?d(u,u,a):u}:Gi(n,e);return this.applyTransform(r),this}}class ai extends of{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(t){return Jl(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return U()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=Nh(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){U()}setLayout(t,e,n){let r;if(t)r=Nh(t);else{for(let s=0;s<n;++s){if(e.length===0){this.layout="XY",this.stride=2;return}e=e[0]}r=e.length,t=li(r)}this.layout=t,this.stride=r}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(t,e){const n=this.getFlatCoordinates();if(n){const r=this.getStride();sf(n,0,n.length,r,t,e,n),this.changed()}}scale(t,e,n){e===void 0&&(e=t),n||(n=tn(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();l_(r,0,r.length,s,t,e,n,r),this.changed()}}translate(t,e){const n=this.getFlatCoordinates();if(n){const r=this.getStride();c_(n,0,n.length,r,t,e,n),this.changed()}}}function li(i){let t;return i==2?t="XY":i==3?t="XYZ":i==4&&(t="XYZM"),t}function Nh(i){let t;return i=="XY"?t=2:i=="XYZ"||i=="XYM"?t=3:i=="XYZM"&&(t=4),t}function u_(i,t,e){const n=i.getFlatCoordinates();if(!n)return null;const r=i.getStride();return En(n,0,n.length,r,t,e)}function af(i,t,e,n){let r=0;const s=i[e-n],o=i[e-n+1];let a=0,l=0;for(;t<e;t+=n){const c=i[t]-s,h=i[t+1]-o;r+=l*c-a*h,a=c,l=h}return r/2}function lf(i,t,e,n){let r=0;for(let s=0,o=e.length;s<o;++s){const a=e[s];r+=af(i,t,a,n),t=a}return r}function d_(i,t,e,n){let r=0;for(let s=0,o=e.length;s<o;++s){const a=e[s];r+=lf(i,t,a,n),t=a[a.length-1]}return r}function $h(i,t,e,n,r,s,o){const a=i[t],l=i[t+1],c=i[e]-a,h=i[e+1]-l;let u;if(c===0&&h===0)u=t;else{const d=((r-a)*c+(s-l)*h)/(c*c+h*h);if(d>1)u=e;else if(d>0){for(let f=0;f<n;++f)o[f]=ee(i[t+f],i[e+f],d);o.length=n;return}else u=t}for(let d=0;d<n;++d)o[d]=i[u+d];o.length=n}function oc(i,t,e,n,r){let s=i[t],o=i[t+1];for(t+=n;t<e;t+=n){const a=i[t],l=i[t+1],c=Hn(s,o,a,l);c>r&&(r=c),s=a,o=l}return r}function ac(i,t,e,n,r){for(let s=0,o=e.length;s<o;++s){const a=e[s];r=oc(i,t,a,n,r),t=a}return r}function f_(i,t,e,n,r){for(let s=0,o=e.length;s<o;++s){const a=e[s];r=ac(i,t,a,n,r),t=a[a.length-1]}return r}function lc(i,t,e,n,r,s,o,a,l,c,h){if(t==e)return c;let u,d;if(r===0){if(d=Hn(o,a,i[t],i[t+1]),d<c){for(u=0;u<n;++u)l[u]=i[t+u];return l.length=n,d}return c}h=h||[NaN,NaN];let f=t+n;for(;f<e;)if($h(i,f-n,f,n,o,a,h),d=Hn(o,a,h[0],h[1]),d<c){for(c=d,u=0;u<n;++u)l[u]=h[u];l.length=n,f+=n}else f+=n*Math.max((Math.sqrt(d)-Math.sqrt(c))/r|0,1);if(s&&($h(i,e-n,t,n,o,a,h),d=Hn(o,a,h[0],h[1]),d<c)){for(c=d,u=0;u<n;++u)l[u]=h[u];l.length=n}return c}function cc(i,t,e,n,r,s,o,a,l,c,h){h=h||[NaN,NaN];for(let u=0,d=e.length;u<d;++u){const f=e[u];c=lc(i,t,f,n,r,s,o,a,l,c,h),t=f}return c}function g_(i,t,e,n,r,s,o,a,l,c,h){h=h||[NaN,NaN];for(let u=0,d=e.length;u<d;++u){const f=e[u];c=cc(i,t,f,n,r,s,o,a,l,c,h),t=f[f.length-1]}return c}function p_(i,t,e,n){for(let r=0,s=e.length;r<s;++r)i[t++]=e[r];return t}function Ao(i,t,e,n){for(let r=0,s=e.length;r<s;++r){const o=e[r];for(let a=0;a<n;++a)i[t++]=o[a]}return t}function os(i,t,e,n,r){r=r||[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=Ao(i,t,e[o],n);r[s++]=l,t=l}return r.length=s,r}function cf(i,t,e,n,r){r=r||[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=os(i,t,e[o],n,r[s]);l.length===0&&(l[0]=t),r[s++]=l,t=l[l.length-1]}return r.length=s,r}function wn(i,t,e,n,r){r=r!==void 0?r:[];let s=0;for(let o=t;o<e;o+=n)r[s++]=i.slice(o,o+n);return r.length=s,r}function kr(i,t,e,n,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=e[o];r[s++]=wn(i,t,l,n,r[s]),t=l}return r.length=s,r}function ll(i,t,e,n,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=e[o];r[s++]=l.length===1&&l[0]===t?[]:kr(i,t,l,n,r[s]),t=l[l.length-1]}return r.length=s,r}function Po(i,t,e,n,r,s,o){const a=(e-t)/n;if(a<3){for(;t<e;t+=n)s[o++]=i[t],s[o++]=i[t+1];return o}const l=new Array(a);l[0]=1,l[a-1]=1;const c=[t,e-n];let h=0;for(;c.length>0;){const u=c.pop(),d=c.pop();let f=0;const m=i[d],v=i[d+1],w=i[u],E=i[u+1];for(let I=d+n;I<u;I+=n){const R=i[I],S=i[I+1],T=mm(R,S,m,v,w,E);T>f&&(h=I,f=T)}f>r&&(l[(h-t)/n]=1,d+n<h&&c.push(d,h),h+n<u&&c.push(h,u))}for(let u=0;u<a;++u)l[u]&&(s[o++]=i[t+u*n],s[o++]=i[t+u*n+1]);return o}function hf(i,t,e,n,r,s,o,a){for(let l=0,c=e.length;l<c;++l){const h=e[l];o=Po(i,t,h,n,r,s,o),a.push(o),t=h}return o}function $n(i,t){return t*Math.round(i/t)}function m_(i,t,e,n,r,s,o){if(t==e)return o;let a=$n(i[t],r),l=$n(i[t+1],r);t+=n,s[o++]=a,s[o++]=l;let c,h;do if(c=$n(i[t],r),h=$n(i[t+1],r),t+=n,t==e)return s[o++]=c,s[o++]=h,o;while(c==a&&h==l);for(;t<e;){const u=$n(i[t],r),d=$n(i[t+1],r);if(t+=n,u==c&&d==h)continue;const f=c-a,m=h-l,v=u-a,w=d-l;if(f*w==m*v&&(f<0&&v<f||f==v||f>0&&v>f)&&(m<0&&w<m||m==w||m>0&&w>m)){c=u,h=d;continue}s[o++]=c,s[o++]=h,a=c,l=h,c=u,h=d}return s[o++]=c,s[o++]=h,o}function hc(i,t,e,n,r,s,o,a){for(let l=0,c=e.length;l<c;++l){const h=e[l];o=m_(i,t,h,n,r,s,o),a.push(o),t=h}return o}function __(i,t,e,n,r,s,o,a){for(let l=0,c=e.length;l<c;++l){const h=e[l],u=[];o=hc(i,t,h,n,r,s,o,u),a.push(u),t=h[h.length-1]}return o}class Dr extends ai{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}clone(){return new Dr(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,n,r){return r<si(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(oc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),lc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,n,r))}getArea(){return af(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return wn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=Po(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new Dr(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Ao(this.flatCoordinates,0,t,this.stride),this.changed()}}class Ye extends ai{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new Ye(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,r){const s=this.flatCoordinates,o=Hn(t,e,s[0],s[1]);if(o<r){const a=this.stride;for(let l=0;l<a;++l)n[l]=s[l];return n.length=a,o}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return Gd(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return Zl(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=p_(this.flatCoordinates,0,t,this.stride),this.changed()}}function y_(i,t,e,n,r){return!jd(r,function(o){return!jn(i,t,e,n,o[0],o[1])})}function jn(i,t,e,n,r,s){let o=0,a=i[e-n],l=i[e-n+1];for(;t<e;t+=n){const c=i[t],h=i[t+1];l<=s?h>s&&(c-a)*(s-l)-(r-a)*(h-l)>0&&o++:h<=s&&(c-a)*(s-l)-(r-a)*(h-l)<0&&o--,a=c,l=h}return o!==0}function uc(i,t,e,n,r,s){if(e.length===0||!jn(i,t,e[0],n,r,s))return!1;for(let o=1,a=e.length;o<a;++o)if(jn(i,e[o-1],e[o],n,r,s))return!1;return!0}function w_(i,t,e,n,r,s){if(e.length===0)return!1;for(let o=0,a=e.length;o<a;++o){const l=e[o];if(uc(i,t,l,n,r,s))return!0;t=l[l.length-1]}return!1}function dc(i,t,e,n,r,s,o){let a,l,c,h,u,d,f;const m=r[s+1],v=[];for(let I=0,R=e.length;I<R;++I){const S=e[I];for(h=i[S-n],d=i[S-n+1],a=t;a<S;a+=n)u=i[a],f=i[a+1],(m<=d&&f<=m||d<=m&&m<=f)&&(c=(m-d)/(f-d)*(u-h)+h,v.push(c)),h=u,d=f}let w=NaN,E=-1/0;for(v.sort(He),h=v[0],a=1,l=v.length;a<l;++a){u=v[a];const I=Math.abs(u-h);I>E&&(c=(h+u)/2,uc(i,t,e,n,c,m)&&(w=c,E=I)),h=u}return isNaN(w)&&(w=r[s]),o?(o.push(w,m,E),o):[w,m,E]}function uf(i,t,e,n,r){let s=[];for(let o=0,a=e.length;o<a;++o){const l=e[o];s=dc(i,t,l,n,r,2*o,s),t=l[l.length-1]}return s}function df(i,t,e,n,r){let s;for(t+=n;t<e;t+=n)if(s=r(i.slice(t-n,t),i.slice(t,t+n)),s)return s;return!1}function Lo(i,t,e,n,r,s){return s=s??Bd(fe(),i,t,e,n),Xt(r,s)?s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]?!0:df(i,t,e,n,function(o,a){return gm(r,o,a)}):!1}function v_(i,t,e,n,r){for(let s=0,o=e.length;s<o;++s){if(Lo(i,t,e[s],n,r))return!0;t=e[s]}return!1}function ff(i,t,e,n,r){return!!(Lo(i,t,e,n,r)||jn(i,t,e,n,r[0],r[1])||jn(i,t,e,n,r[0],r[3])||jn(i,t,e,n,r[2],r[1])||jn(i,t,e,n,r[2],r[3]))}function gf(i,t,e,n,r){if(!ff(i,t,e[0],n,r))return!1;if(e.length===1)return!0;for(let s=1,o=e.length;s<o;++s)if(y_(i,e[s-1],e[s],n,r)&&!Lo(i,e[s-1],e[s],n,r))return!1;return!0}function b_(i,t,e,n,r){for(let s=0,o=e.length;s<o;++s){const a=e[s];if(gf(i,t,a,n,r))return!0;t=a[a.length-1]}return!1}function E_(i,t,e,n){for(;t<e-n;){for(let r=0;r<n;++r){const s=i[t+r];i[t+r]=i[e-n+r],i[e-n+r]=s}t+=n,e-=n}}function fc(i,t,e,n){let r=0,s=i[e-n],o=i[e-n+1];for(;t<e;t+=n){const a=i[t],l=i[t+1];r+=(a-s)*(l+o),s=a,o=l}return r===0?void 0:r>0}function gc(i,t,e,n,r){r=r!==void 0?r:!1;for(let s=0,o=e.length;s<o;++s){const a=e[s],l=fc(i,t,a,n);if(s===0){if(r&&l||!r&&!l)return!1}else if(r&&!l||!r&&l)return!1;t=a}return!0}function pf(i,t,e,n,r){for(let s=0,o=e.length;s<o;++s){const a=e[s];if(!gc(i,t,a,n,r))return!1;a.length&&(t=a[a.length-1])}return!0}function Ws(i,t,e,n,r){r=r!==void 0?r:!1;for(let s=0,o=e.length;s<o;++s){const a=e[s],l=fc(i,t,a,n);(s===0?r&&l||!r&&!l:r&&!l||!r&&l)&&E_(i,t,a,n),t=a}return t}function cl(i,t,e,n,r){for(let s=0,o=e.length;s<o;++s)t=Ws(i,t,e[s],n,r);return t}function C_(i,t){const e=[];let n=0,r=0,s;for(let o=0,a=t.length;o<a;++o){const l=t[o],c=fc(i,n,l,2);if(s===void 0&&(s=c),c===s)e.push(t.slice(r,o+1));else{if(e.length===0)continue;e[e.length-1].push(t[r])}r=o+1,n=l}return e}class In extends ai{constructor(t,e,n){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,e!==void 0&&n?(this.setFlatCoordinates(e,t),this.ends_=n):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?Oe(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new In(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,n,r){return r<si(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ac(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),cc(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,n,r))}containsXY(t,e){return uc(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return lf(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),Ws(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,kr(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=tn(this.getExtent());this.flatInteriorPoint_=dc(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new Ye(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new Dr(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,n=this.ends_,r=[];let s=0;for(let o=0,a=n.length;o<a;++o){const l=n[o],c=new Dr(e.slice(s,l),t);r.push(c),s=l}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;gc(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Ws(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],n=[];return e.length=hc(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,n),new In(e,"XY",n)}getType(){return"Polygon"}intersectsExtent(t){return gf(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const n=os(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=n.length===0?0:n[n.length-1],this.changed()}}function hl(i){if(es(i))throw new Error("Cannot create polygon from empty extent");const t=i[0],e=i[1],n=i[2],r=i[3],s=[t,e,t,r,n,r,n,e,t,e];return new In(s,"XY",[s.length])}const ki={ch:ua(ha.features.find(i=>i.properties.code==="ch").geometry.coordinates),fr:ua(ha.features.find(i=>i.properties.code==="fr").geometry.coordinates),de:ua(ha.features.find(i=>i.properties.code==="de").geometry.coordinates)},x_={ch:Er(ki.ch),fr:Er(ki.fr),de:Er(ki.de)},S_={ch:355620,fr:1079440,de:879452};function I_(i,t){const e=S_[t];return 5e3*Math.exp(-10*i/e)}function Vh(i){const t=ki[i];let e=bh(Er(t));for(;;){if($d(e,t))return e;e=bh(Er(t))}}function T_(i,t){const e=hl(i);return e.scale(t),e.getExtent()}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const pc=globalThis,qs=pc.trustedTypes,zh=qs?qs.createPolicy("lit-html",{createHTML:i=>i}):void 0,mf="$lit$",_n=`lit$${Math.random().toFixed(9).slice(2)}$`,_f="?"+_n,R_=`<${_f}>`,Qn=document,Fr=()=>Qn.createComment(""),Nr=i=>i===null||typeof i!="object"&&typeof i!="function",mc=Array.isArray,A_=i=>mc(i)||typeof i?.[Symbol.iterator]=="function",pa=`[ 	
\f\r]`,hr=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Gh=/-->/g,Uh=/>/g,Dn=RegExp(`>|${pa}(?:([^\\s"'>=/]+)(${pa}*=${pa}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),Bh=/'/g,jh=/"/g,yf=/^(?:script|style|textarea|title)$/i,P_=i=>(t,...e)=>({_$litType$:i,strings:t,values:e}),Y=P_(1),we=Symbol.for("lit-noChange"),wt=Symbol.for("lit-nothing"),Wh=new WeakMap,Wn=Qn.createTreeWalker(Qn,129);function wf(i,t){if(!mc(i)||!i.hasOwnProperty("raw"))throw Error("invalid template strings array");return zh!==void 0?zh.createHTML(t):t}const L_=(i,t)=>{const e=i.length-1,n=[];let r,s=t===2?"<svg>":t===3?"<math>":"",o=hr;for(let a=0;a<e;a++){const l=i[a];let c,h,u=-1,d=0;for(;d<l.length&&(o.lastIndex=d,h=o.exec(l),h!==null);)d=o.lastIndex,o===hr?h[1]==="!--"?o=Gh:h[1]!==void 0?o=Uh:h[2]!==void 0?(yf.test(h[2])&&(r=RegExp("</"+h[2],"g")),o=Dn):h[3]!==void 0&&(o=Dn):o===Dn?h[0]===">"?(o=r??hr,u=-1):h[1]===void 0?u=-2:(u=o.lastIndex-h[2].length,c=h[1],o=h[3]===void 0?Dn:h[3]==='"'?jh:Bh):o===jh||o===Bh?o=Dn:o===Gh||o===Uh?o=hr:(o=Dn,r=void 0);const f=o===Dn&&i[a+1].startsWith("/>")?" ":"";s+=o===hr?l+R_:u>=0?(n.push(c),l.slice(0,u)+mf+l.slice(u)+_n+f):l+_n+(u===-2?a:f)}return[wf(i,s+(i[e]||"<?>")+(t===2?"</svg>":t===3?"</math>":"")),n]};let ul=class vf{constructor({strings:t,_$litType$:e},n){let r;this.parts=[];let s=0,o=0;const a=t.length-1,l=this.parts,[c,h]=L_(t,e);if(this.el=vf.createElement(c,n),Wn.currentNode=this.el.content,e===2||e===3){const u=this.el.content.firstChild;u.replaceWith(...u.childNodes)}for(;(r=Wn.nextNode())!==null&&l.length<a;){if(r.nodeType===1){if(r.hasAttributes())for(const u of r.getAttributeNames())if(u.endsWith(mf)){const d=h[o++],f=r.getAttribute(u).split(_n),m=/([.?@])?(.*)/.exec(d);l.push({type:1,index:s,name:m[2],strings:f,ctor:m[1]==="."?O_:m[1]==="?"?k_:m[1]==="@"?D_:Mo}),r.removeAttribute(u)}else u.startsWith(_n)&&(l.push({type:6,index:s}),r.removeAttribute(u));if(yf.test(r.tagName)){const u=r.textContent.split(_n),d=u.length-1;if(d>0){r.textContent=qs?qs.emptyScript:"";for(let f=0;f<d;f++)r.append(u[f],Fr()),Wn.nextNode(),l.push({type:2,index:++s});r.append(u[d],Fr())}}}else if(r.nodeType===8)if(r.data===_f)l.push({type:2,index:s});else{let u=-1;for(;(u=r.data.indexOf(_n,u+1))!==-1;)l.push({type:7,index:s}),u+=_n.length-1}s++}}static createElement(t,e){const n=Qn.createElement("template");return n.innerHTML=t,n}};function Ui(i,t,e=i,n){if(t===we)return t;let r=n!==void 0?e._$Co?.[n]:e._$Cl;const s=Nr(t)?void 0:t._$litDirective$;return r?.constructor!==s&&(r?._$AO?.(!1),s===void 0?r=void 0:(r=new s(i),r._$AT(i,e,n)),n!==void 0?(e._$Co??=[])[n]=r:e._$Cl=r),r!==void 0&&(t=Ui(i,r._$AS(i,t.values),r,n)),t}let M_=class{constructor(t,e){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=e}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){const{el:{content:e},parts:n}=this._$AD,r=(t?.creationScope??Qn).importNode(e,!0);Wn.currentNode=r;let s=Wn.nextNode(),o=0,a=0,l=n[0];for(;l!==void 0;){if(o===l.index){let c;l.type===2?c=new _c(s,s.nextSibling,this,t):l.type===1?c=new l.ctor(s,l.name,l.strings,this,t):l.type===6&&(c=new F_(s,this,t)),this._$AV.push(c),l=n[++a]}o!==l?.index&&(s=Wn.nextNode(),o++)}return Wn.currentNode=Qn,r}p(t){let e=0;for(const n of this._$AV)n!==void 0&&(n.strings!==void 0?(n._$AI(t,n,e),e+=n.strings.length-2):n._$AI(t[e])),e++}},_c=class bf{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(t,e,n,r){this.type=2,this._$AH=wt,this._$AN=void 0,this._$AA=t,this._$AB=e,this._$AM=n,this.options=r,this._$Cv=r?.isConnected??!0}get parentNode(){let t=this._$AA.parentNode;const e=this._$AM;return e!==void 0&&t?.nodeType===11&&(t=e.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,e=this){t=Ui(this,t,e),Nr(t)?t===wt||t==null||t===""?(this._$AH!==wt&&this._$AR(),this._$AH=wt):t!==this._$AH&&t!==we&&this._(t):t._$litType$!==void 0?this.$(t):t.nodeType!==void 0?this.T(t):A_(t)?this.k(t):this._(t)}O(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}T(t){this._$AH!==t&&(this._$AR(),this._$AH=this.O(t))}_(t){this._$AH!==wt&&Nr(this._$AH)?this._$AA.nextSibling.data=t:this.T(Qn.createTextNode(t)),this._$AH=t}$(t){const{values:e,_$litType$:n}=t,r=typeof n=="number"?this._$AC(t):(n.el===void 0&&(n.el=ul.createElement(wf(n.h,n.h[0]),this.options)),n);if(this._$AH?._$AD===r)this._$AH.p(e);else{const s=new M_(r,this),o=s.u(this.options);s.p(e),this.T(o),this._$AH=s}}_$AC(t){let e=Wh.get(t.strings);return e===void 0&&Wh.set(t.strings,e=new ul(t)),e}k(t){mc(this._$AH)||(this._$AH=[],this._$AR());const e=this._$AH;let n,r=0;for(const s of t)r===e.length?e.push(n=new bf(this.O(Fr()),this.O(Fr()),this,this.options)):n=e[r],n._$AI(s),r++;r<e.length&&(this._$AR(n&&n._$AB.nextSibling,r),e.length=r)}_$AR(t=this._$AA.nextSibling,e){for(this._$AP?.(!1,!0,e);t!==this._$AB;){const n=t.nextSibling;t.remove(),t=n}}setConnected(t){this._$AM===void 0&&(this._$Cv=t,this._$AP?.(t))}},Mo=class{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(t,e,n,r,s){this.type=1,this._$AH=wt,this._$AN=void 0,this.element=t,this.name=e,this._$AM=r,this.options=s,n.length>2||n[0]!==""||n[1]!==""?(this._$AH=Array(n.length-1).fill(new String),this.strings=n):this._$AH=wt}_$AI(t,e=this,n,r){const s=this.strings;let o=!1;if(s===void 0)t=Ui(this,t,e,0),o=!Nr(t)||t!==this._$AH&&t!==we,o&&(this._$AH=t);else{const a=t;let l,c;for(t=s[0],l=0;l<s.length-1;l++)c=Ui(this,a[n+l],e,l),c===we&&(c=this._$AH[l]),o||=!Nr(c)||c!==this._$AH[l],c===wt?t=wt:t!==wt&&(t+=(c??"")+s[l+1]),this._$AH[l]=c}o&&!r&&this.j(t)}j(t){t===wt?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t??"")}},O_=class extends Mo{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===wt?void 0:t}},k_=class extends Mo{constructor(){super(...arguments),this.type=4}j(t){this.element.toggleAttribute(this.name,!!t&&t!==wt)}},D_=class extends Mo{constructor(t,e,n,r,s){super(t,e,n,r,s),this.type=5}_$AI(t,e=this){if((t=Ui(this,t,e,0)??wt)===we)return;const n=this._$AH,r=t===wt&&n!==wt||t.capture!==n.capture||t.once!==n.once||t.passive!==n.passive,s=t!==wt&&(n===wt||r);r&&this.element.removeEventListener(this.name,this,n),s&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,t):this._$AH.handleEvent(t)}},F_=class{constructor(t,e,n){this.element=t,this.type=6,this._$AN=void 0,this._$AM=e,this.options=n}get _$AU(){return this._$AM._$AU}_$AI(t){Ui(this,t)}};const N_=pc.litHtmlPolyfillSupport;N_?.(ul,_c),(pc.litHtmlVersions??=[]).push("3.3.1");const $_=(i,t,e)=>{const n=e?.renderBefore??t;let r=n._$litPart$;if(r===void 0){const s=e?.renderBefore??null;n._$litPart$=r=new _c(t.insertBefore(Fr(),s),s,void 0,e??{})}return r._$AI(i),r};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const yc=globalThis;let Zt=class extends Si{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const t=super.createRenderRoot();return this.renderOptions.renderBefore??=t.firstChild,t}update(t){const e=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=$_(e,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return we}};Zt._$litElement$=!0,Zt.finalized=!0,yc.litElementHydrateSupport?.({LitElement:Zt});const V_=yc.litElementPolyfillSupport;V_?.({LitElement:Zt});(yc.litElementVersions??=[]).push("4.2.1");const yi=new Ad,wi=new Ad,qh=new Rd,Xh=new Rd,z_=new _e,G_=new _e;class U_{constructor(t){this.viewer=t,this.dragging_=!1,this.active_=!1,this.handleDownEvent_=this.handleDownEvent.bind(this),this.handleMoveEvent_=this.handleMoveEvent.bind(this),this.handleUpEvent_=this.handleUpEvent.bind(this)}get active(){return this.active_}set active(t){t!==this.active_&&(this.active_=t,this.viewer.scene.screenSpaceCameraController.enableInputs=!t,t?(this.viewer.screenSpaceEventHandler.setInputAction(this.handleDownEvent_,pi.LEFT_DOWN),this.viewer.screenSpaceEventHandler.setInputAction(this.handleMoveEvent_,pi.MOUSE_MOVE),this.viewer.screenSpaceEventHandler.setInputAction(this.handleUpEvent_,pi.LEFT_UP)):(this.viewer.screenSpaceEventHandler.removeInputAction(pi.LEFT_DOWN),this.viewer.screenSpaceEventHandler.removeInputAction(pi.MOUSE_MOVE),this.viewer.screenSpaceEventHandler.removeInputAction(pi.LEFT_UP)))}handleDownEvent(){this.dragging_=!0}handleMoveEvent(t){if(!this.dragging_)return;const e=this.viewer.camera;let n=0;yi.x=t.startPosition.x,yi.y=0,wi.x=t.endPosition.x,wi.y=0;let r=e.getPickRay(yi,qh).direction,s=e.getPickRay(wi,Xh).direction,o=_e.dot(r,s);o<1&&(n=Math.acos(o)),n=t.startPosition.x>t.endPosition.x?-n:n;const a=this.viewer.scene.globe.ellipsoid.geodeticSurfaceNormal(e.position);e.look(a,-n),yi.x=0,yi.y=t.startPosition.y,wi.x=0,wi.y=t.endPosition.y,r=e.getPickRay(yi,qh).direction,s=e.getPickRay(wi,Xh).direction,n=0,o=_e.dot(r,s),o<1&&(n=Math.acos(o)),n=t.startPosition.y>t.endPosition.y?-n:n;const l=e.direction,c=_e.negate(a,z_),h=_e.equalsEpsilon(l,a,Nn.EPSILON2),u=_e.equalsEpsilon(l,c,Nn.EPSILON2);if(!h&&!u){o=_e.dot(l,a);let d=Nn.acosClamped(o);n>0&&n>d&&(n=d-Nn.EPSILON4),o=_e.dot(l,c),d=Nn.acosClamped(o),n<0&&-n>d&&(n=-d+Nn.EPSILON4);const f=_e.cross(a,l,G_);e.look(f,n)}else(h&&n<0||u&&n>0)&&e.look(e.right,-n)}handleUpEvent(){this.dragging_=!1}}class B_ extends Zt{static get properties(){return{scene:{type:Object},heading:{type:Number}}}static get styles(){return Dd`
      :host {
        --cesium-compass-bar-tick-color: #000;
        --cesium-compass-bar-intercardinal-width: 100px;
      }
      :host * {
        box-sizing: content-box;
      }
      .container {
        display: flex;
        justify-content: center;
        height: 100%;
        overflow: hidden;
      }
      .compass-bar {
        display: flex;
        align-items: flex-end;
      }
      .compass-bar > div {
        width: var(--cesium-compass-bar-intercardinal-width);
        text-align: center;
      }
      .label {
        padding: 4px;
        color: var(--cesium-compass-bar-tick-color);
      }
      .ticks {
        display: flex;
        justify-content: space-around;
      }
      .ticks > div {
        width: 1px;
        height: 6px;
        background-color: var(--cesium-compass-bar-tick-color);
      }
      .ticks > div:nth-child(4) {
        height: 10px;
      }
      .center-tick {
        margin: auto;
        width: 4px;
        height: 4px;
        border-radius: 50%;
        background-color: var(--cesium-compass-bar-tick-color);
      }
    `}constructor(){super(),this.scene,this.intercardinalWidth,this.unlistenFromPostRender=null}updated(){this.scene&&!this.unlistenFromPostRender&&(this.unlistenFromPostRender=this.scene.postRender.addEventListener(()=>{this.heading=this.scene.camera.heading}),this.intercardinalWidth=parseInt(getComputedStyle(this).getPropertyValue("--cesium-compass-bar-intercardinal-width")))}getTransform(t){const e=this.intercardinalWidth;let n=-e/2;const r=-this.heading/(Math.PI/4)+4,s=r-t;return s<-4&&(n+=8*e),s>4&&(n-=8*e),`transform: translate(${r*e+n}px)`}render(){const t=Y`
      <div class="ticks">
        ${Array(7).fill().map(()=>Y`<div part="tick"></div>`)}
      </div>
    `;return Y`
      <div class="container">
        <div class="compass-bar">
          <div style=${this.getTransform(4)}>
            <div class="label" part="label major">N</div>
            ${t}
          </div>
          <div style=${this.getTransform(3)}>
            <div class="label" part="label minor">NE</div>
            ${t}
          </div>
          <div style=${this.getTransform(2)}>
            <div class="label" part="label major">E</div>
            ${t}
          </div>
          <div style=${this.getTransform(1)}>
            <div class="label" part="label minor">SE</div>
            ${t}
          </div>
          <div style=${this.getTransform(0)}>
            <div class="label" part="label major">S</div>
            ${t}
          </div>
          <div style=${this.getTransform(-1)}>
            <div class="label" part="label minor">SW</div>
            ${t}
          </div>
          <div style=${this.getTransform(-2)}>
            <div class="label" part="label major">W</div>
            ${t}
          </div>
          <div style=${this.getTransform(-3)}>
            <div class="label" part="label minor">NW</div>
            ${t}
          </div>
        </div>
      </div>
      <div class="center-tick" part="center-tick"></div>
    `}}customElements.define("cesium-compass-bar",B_);/*! Copyright 2025 Fonticons, Inc. - https://webawesome.com/license */var Oo=class{constructor(i,...t){this.slotNames=[],this.handleSlotChange=e=>{const n=e.target;(this.slotNames.includes("[default]")&&!n.name||n.name&&this.slotNames.includes(n.name))&&this.host.requestUpdate()},(this.host=i).addController(this),this.slotNames=t}hasDefaultSlot(){return[...this.host.childNodes].some(i=>{if(i.nodeType===Node.TEXT_NODE&&i.textContent.trim()!=="")return!0;if(i.nodeType===Node.ELEMENT_NODE){const t=i;if(t.tagName.toLowerCase()==="wa-visually-hidden")return!1;if(!t.hasAttribute("slot"))return!0}return!1})}hasNamedSlot(i){return this.host.querySelector(`:scope > [slot="${i}"]`)!==null}test(i){return i==="[default]"?this.hasDefaultSlot():this.hasNamedSlot(i)}hostConnected(){this.host.shadowRoot.addEventListener("slotchange",this.handleSlotChange)}hostDisconnected(){this.host.shadowRoot.removeEventListener("slotchange",this.handleSlotChange)}};/*! Copyright 2025 Fonticons, Inc. - https://webawesome.com/license */var ko=`@layer wa-utilities {
  :host([size='small']),
  .wa-size-s {
    font-size: var(--wa-font-size-s);
  }

  :host([size='medium']),
  .wa-size-m {
    font-size: var(--wa-font-size-m);
  }

  :host([size='large']),
  .wa-size-l {
    font-size: var(--wa-font-size-l);
  }
}
`;/*! Copyright 2025 Fonticons, Inc. - https://webawesome.com/license */var j_=Object.defineProperty,W_=Object.getOwnPropertyDescriptor,Ef=i=>{throw TypeError(i)},L=(i,t,e,n)=>{for(var r=n>1?void 0:n?W_(t,e):t,s=i.length-1,o;s>=0;s--)(o=i[s])&&(r=(n?o(t,e,r):o(r))||r);return n&&r&&j_(t,e,r),r},Cf=(i,t,e)=>t.has(i)||Ef("Cannot "+e),q_=(i,t,e)=>(Cf(i,t,"read from private field"),t.get(i)),X_=(i,t,e)=>t.has(i)?Ef("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(i):t.set(i,e),K_=(i,t,e,n)=>(Cf(i,t,"write to private field"),t.set(i,e),e);/*! Copyright 2025 Fonticons, Inc. - https://webawesome.com/license */var H_=`:host {
  box-sizing: border-box !important;
}

:host *,
:host *::before,
:host *::after {
  box-sizing: inherit !important;
}

[hidden] {
  display: none !important;
}
`,Ns,Ve=class extends Zt{constructor(){super(),X_(this,Ns,!1),this.initialReflectedProperties=new Map,this.didSSR=!!this.shadowRoot,this.customStates={set:(t,e)=>{if(this.internals?.states)try{e?this.internals.states.add(t):this.internals.states.delete(t)}catch(n){if(String(n).includes("must start with '--'"))console.error("Your browser implements an outdated version of CustomStateSet. Consider using a polyfill");else throw n}},has:t=>{if(!this.internals?.states)return!1;try{return this.internals.states.has(t)}catch{return!1}}};try{this.internals=this.attachInternals()}catch{console.error("Element internals are not supported in your browser. Consider using a polyfill")}this.customStates.set("wa-defined",!0);let i=this.constructor;for(let[t,e]of i.elementProperties)e.default==="inherit"&&e.initial!==void 0&&typeof t=="string"&&this.customStates.set(`initial-${t}-${e.initial}`,!0)}static get styles(){const i=Array.isArray(this.css)?this.css:this.css?[this.css]:[];return[H_,...i].map(t=>typeof t=="string"?kd(t):t)}attributeChangedCallback(i,t,e){q_(this,Ns)||(this.constructor.elementProperties.forEach((n,r)=>{n.reflect&&this[r]!=null&&this.initialReflectedProperties.set(r,this[r])}),K_(this,Ns,!0)),super.attributeChangedCallback(i,t,e)}willUpdate(i){super.willUpdate(i),this.initialReflectedProperties.forEach((t,e)=>{i.has(e)&&this[e]==null&&(this[e]=t)})}firstUpdated(i){super.firstUpdated(i),this.didSSR&&this.shadowRoot?.querySelectorAll("slot").forEach(t=>{t.dispatchEvent(new Event("slotchange",{bubbles:!0,composed:!1,cancelable:!1}))})}update(i){try{super.update(i)}catch(t){if(this.didSSR&&!this.hasUpdated){const e=new Event("lit-hydration-error",{bubbles:!0,composed:!0,cancelable:!1});e.error=t,this.dispatchEvent(e)}throw t}}relayNativeEvent(i,t){i.stopImmediatePropagation(),this.dispatchEvent(new i.constructor(i.type,{...i,...t}))}};Ns=new WeakMap;L([M()],Ve.prototype,"dir",2);L([M()],Ve.prototype,"lang",2);L([M({type:Boolean,reflect:!0,attribute:"did-ssr"})],Ve.prototype,"didSSR",2);/*! Copyright 2025 Fonticons, Inc. - https://webawesome.com/license */var Y_=`:host {
  --spacing: var(--wa-space-l);

  /* Internal calculated properties */
  --inner-border-radius: calc(var(--wa-panel-border-radius) - var(--wa-panel-border-width));

  display: flex;
  flex-direction: column;
  background-color: var(--wa-color-surface-default);
  border-color: var(--wa-color-surface-border);
  border-radius: var(--wa-panel-border-radius);
  border-style: var(--wa-panel-border-style);
  box-shadow: var(--wa-shadow-s);
  border-width: var(--wa-panel-border-width);
  color: var(--wa-color-text-normal);
}

/* Appearance modifiers */
:host([appearance~='plain']) {
  background-color: transparent;
  border-color: transparent;
  box-shadow: none;
}

:host([appearance~='outlined']) {
  background-color: var(--wa-color-surface-default);
  border-color: var(--wa-color-surface-border);
}

:host([appearance~='filled']) {
  background-color: var(--wa-color-neutral-fill-quiet);
  border-color: transparent;
}

:host([appearance~='filled'][appearance~='outlined']) {
  border-color: var(--wa-color-neutral-border-quiet);
}

:host([appearance~='accent']) {
  color: var(--wa-color-neutral-on-loud);
  background-color: var(--wa-color-neutral-fill-loud);
  border-color: transparent;
}

/* Take care of top and bottom radii */
.media,
:host(:not([with-media])) .header,
:host(:not([with-media], [with-header])) .body {
  border-start-start-radius: var(--inner-border-radius);
  border-start-end-radius: var(--inner-border-radius);
}

:host(:not([with-footer])) .body,
.footer {
  border-end-start-radius: var(--inner-border-radius);
  border-end-end-radius: var(--inner-border-radius);
}

.media {
  display: flex;
  overflow: hidden;

  &::slotted(*) {
    display: block;
    width: 100%;
    border-radius: 0 !important;
  }
}

/* Round all corners for plain appearance */
:host([appearance='plain']) .media {
  border-radius: var(--inner-border-radius);

  &::slotted(*) {
    border-radius: inherit !important;
  }
}

.header {
  display: block;
  border-block-end-style: inherit;
  border-block-end-color: var(--wa-color-surface-border);
  border-block-end-width: var(--wa-panel-border-width);
  padding: calc(var(--spacing) / 2) var(--spacing);
}

.body {
  display: block;
  padding: var(--spacing);
}

.footer {
  display: block;
  border-block-start-style: inherit;
  border-block-start-color: var(--wa-color-surface-border);
  border-block-start-width: var(--wa-panel-border-width);
  padding: var(--spacing);
}

/* Push slots to sides when the action slots renders */
.has-actions {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

:host(:not([with-header])) .header,
:host(:not([with-footer])) .footer,
:host(:not([with-media])) .media {
  display: none;
}

/* Orientation Styles */
:host([orientation='horizontal']) {
  flex-direction: row;

  .media {
    border-start-start-radius: var(--inner-border-radius);
    border-end-start-radius: var(--inner-border-radius);
    border-start-end-radius: 0;

    &::slotted(*) {
      block-size: 100%;
      inline-size: 100%;
      object-fit: cover;
    }
  }
}

:host([orientation='horizontal']) ::slotted([slot='body']) {
  display: block;
  height: 100%;
  margin: 0;
}

:host([orientation='horizontal']) ::slotted([slot='actions']) {
  display: flex;
  align-items: center;
  padding: var(--spacing);
}
`,Tn=class extends Ve{constructor(){super(...arguments),this.hasSlotController=new Oo(this,"footer","header","media"),this.appearance="outlined",this.withHeader=!1,this.withMedia=!1,this.withFooter=!1,this.orientation="vertical"}updated(){!this.withHeader&&this.hasSlotController.test("header")&&(this.withHeader=!0),!this.withMedia&&this.hasSlotController.test("media")&&(this.withMedia=!0),!this.withFooter&&this.hasSlotController.test("footer")&&(this.withFooter=!0)}render(){return this.orientation==="horizontal"?Y`
        <slot name="media" part="media" class="media"></slot>
        <slot part="body" class="body"></slot>
        <slot name="actions" part="actions" class="actions"></slot>
      `:Y`
      <slot name="media" part="media" class="media"></slot>

      ${this.hasSlotController.test("header-actions")?Y` <header part="header" class="header has-actions">
            <slot name="header"></slot>
            <slot name="header-actions"></slot>
          </header>`:Y` <header part="header" class="header">
            <slot name="header"></slot>
          </header>`}

      <slot part="body" class="body"></slot>
      ${this.hasSlotController.test("footer-actions")?Y` <footer part="footer" class="footer has-actions">
            <slot name="footer"></slot>
            <slot name="footer-actions"></slot>
          </footer>`:Y` <footer part="footer" class="footer">
            <slot name="footer"></slot>
          </footer>`}
    `}};Tn.css=[ko,Y_];L([M({reflect:!0})],Tn.prototype,"appearance",2);L([M({attribute:"with-header",type:Boolean,reflect:!0})],Tn.prototype,"withHeader",2);L([M({attribute:"with-media",type:Boolean,reflect:!0})],Tn.prototype,"withMedia",2);L([M({attribute:"with-footer",type:Boolean,reflect:!0})],Tn.prototype,"withFooter",2);L([M({reflect:!0})],Tn.prototype,"orientation",2);Tn=L([Nt("wa-card")],Tn);/*! Copyright 2025 Fonticons, Inc. - https://webawesome.com/license */var xf=()=>({checkValidity(i){const t=i.input,e={message:"",isValid:!0,invalidKeys:[]};if(!t)return e;let n=!0;if("checkValidity"in t&&(n=t.checkValidity()),n)return e;if(e.isValid=!1,"validationMessage"in t&&(e.message=t.validationMessage),!("validity"in t))return e.invalidKeys.push("customError"),e;for(const r in t.validity){if(r==="valid")continue;const s=r;t.validity[s]&&e.invalidKeys.push(s)}return e}});/*! Copyright 2025 Fonticons, Inc. - https://webawesome.com/license */var Sf=class extends Event{constructor(){super("wa-invalid",{bubbles:!0,cancelable:!1,composed:!0})}},Z_=()=>({observedAttributes:["custom-error"],checkValidity(i){const t={message:"",isValid:!0,invalidKeys:[]};return i.customError&&(t.message=i.customError,t.isValid=!1,t.invalidKeys=["customError"]),t}}),Ee=class extends Ve{constructor(){super(),this.name=null,this.disabled=!1,this.required=!1,this.assumeInteractionOn=["input"],this.validators=[],this.valueHasChanged=!1,this.hasInteracted=!1,this.customError=null,this.emittedEvents=[],this.emitInvalid=i=>{i.target===this&&(this.hasInteracted=!0,this.dispatchEvent(new Sf))},this.handleInteraction=i=>{const t=this.emittedEvents;t.includes(i.type)||t.push(i.type),t.length===this.assumeInteractionOn?.length&&(this.hasInteracted=!0)},this.addEventListener("invalid",this.emitInvalid)}static get validators(){return[Z_()]}static get observedAttributes(){const i=new Set(super.observedAttributes||[]);for(const t of this.validators)if(t.observedAttributes)for(const e of t.observedAttributes)i.add(e);return[...i]}connectedCallback(){super.connectedCallback(),this.updateValidity(),this.assumeInteractionOn.forEach(i=>{this.addEventListener(i,this.handleInteraction)})}firstUpdated(...i){super.firstUpdated(...i),this.updateValidity()}willUpdate(i){if(i.has("customError")&&(this.customError||(this.customError=null),this.setCustomValidity(this.customError||"")),i.has("value")||i.has("disabled")){const t=this.value;if(Array.isArray(t)){if(this.name){const e=new FormData;for(const n of t)e.append(this.name,n);this.setValue(e,e)}}else this.setValue(t,t)}i.has("disabled")&&(this.customStates.set("disabled",this.disabled),(this.hasAttribute("disabled")||!this.matches(":disabled"))&&this.toggleAttribute("disabled",this.disabled)),this.updateValidity(),super.willUpdate(i)}get labels(){return this.internals.labels}getForm(){return this.internals.form}get validity(){return this.internals.validity}get willValidate(){return this.internals.willValidate}get validationMessage(){return this.internals.validationMessage}checkValidity(){return this.updateValidity(),this.internals.checkValidity()}reportValidity(){return this.updateValidity(),this.hasInteracted=!0,this.internals.reportValidity()}get validationTarget(){return this.input||void 0}setValidity(...i){const t=i[0],e=i[1];let n=i[2];n||(n=this.validationTarget),this.internals.setValidity(t,e,n||void 0),this.requestUpdate("validity"),this.setCustomStates()}setCustomStates(){const i=!!this.required,t=this.internals.validity.valid,e=this.hasInteracted;this.customStates.set("required",i),this.customStates.set("optional",!i),this.customStates.set("invalid",!t),this.customStates.set("valid",t),this.customStates.set("user-invalid",!t&&e),this.customStates.set("user-valid",t&&e)}setCustomValidity(i){if(!i){this.customError=null,this.setValidity({});return}this.customError=i,this.setValidity({customError:!0},i,this.validationTarget)}formResetCallback(){this.resetValidity(),this.hasInteracted=!1,this.valueHasChanged=!1,this.emittedEvents=[],this.updateValidity()}formDisabledCallback(i){this.disabled=i,this.updateValidity()}formStateRestoreCallback(i,t){this.value=i,t==="restore"&&this.resetValidity(),this.updateValidity()}setValue(...i){const[t,e]=i;this.internals.setFormValue(t,e)}get allValidators(){const i=this.constructor.validators||[],t=this.validators||[];return[...i,...t]}resetValidity(){this.setCustomValidity(""),this.setValidity({})}updateValidity(){if(this.disabled||this.hasAttribute("disabled")||!this.willValidate){this.resetValidity();return}const i=this.allValidators;if(!i?.length)return;const t={customError:!!this.customError},e=this.validationTarget||this.input||void 0;let n="";for(const r of i){const{isValid:s,message:o,invalidKeys:a}=r.checkValidity(this);s||(n||(n=o),a?.length>=0&&a.forEach(l=>t[l]=!0))}n||(n=this.validationMessage),this.setValidity(t,n,e)}};Ee.formAssociated=!0;L([M({reflect:!0})],Ee.prototype,"name",2);L([M({type:Boolean})],Ee.prototype,"disabled",2);L([M({state:!0,attribute:!1})],Ee.prototype,"valueHasChanged",2);L([M({state:!0,attribute:!1})],Ee.prototype,"hasInteracted",2);L([M({attribute:"custom-error",reflect:!0})],Ee.prototype,"customError",2);L([M({attribute:!1,state:!0,type:Object})],Ee.prototype,"validity",1);/*! Copyright 2025 Fonticons, Inc. - https://webawesome.com/license */var If=`@layer wa-utilities {
  :where(:root),
  .wa-neutral,
  :host([variant='neutral']) {
    --wa-color-fill-loud: var(--wa-color-neutral-fill-loud);
    --wa-color-fill-normal: var(--wa-color-neutral-fill-normal);
    --wa-color-fill-quiet: var(--wa-color-neutral-fill-quiet);
    --wa-color-border-loud: var(--wa-color-neutral-border-loud);
    --wa-color-border-normal: var(--wa-color-neutral-border-normal);
    --wa-color-border-quiet: var(--wa-color-neutral-border-quiet);
    --wa-color-on-loud: var(--wa-color-neutral-on-loud);
    --wa-color-on-normal: var(--wa-color-neutral-on-normal);
    --wa-color-on-quiet: var(--wa-color-neutral-on-quiet);
  }

  .wa-brand,
  :host([variant='brand']) {
    --wa-color-fill-loud: var(--wa-color-brand-fill-loud);
    --wa-color-fill-normal: var(--wa-color-brand-fill-normal);
    --wa-color-fill-quiet: var(--wa-color-brand-fill-quiet);
    --wa-color-border-loud: var(--wa-color-brand-border-loud);
    --wa-color-border-normal: var(--wa-color-brand-border-normal);
    --wa-color-border-quiet: var(--wa-color-brand-border-quiet);
    --wa-color-on-loud: var(--wa-color-brand-on-loud);
    --wa-color-on-normal: var(--wa-color-brand-on-normal);
    --wa-color-on-quiet: var(--wa-color-brand-on-quiet);
  }

  .wa-success,
  :host([variant='success']) {
    --wa-color-fill-loud: var(--wa-color-success-fill-loud);
    --wa-color-fill-normal: var(--wa-color-success-fill-normal);
    --wa-color-fill-quiet: var(--wa-color-success-fill-quiet);
    --wa-color-border-loud: var(--wa-color-success-border-loud);
    --wa-color-border-normal: var(--wa-color-success-border-normal);
    --wa-color-border-quiet: var(--wa-color-success-border-quiet);
    --wa-color-on-loud: var(--wa-color-success-on-loud);
    --wa-color-on-normal: var(--wa-color-success-on-normal);
    --wa-color-on-quiet: var(--wa-color-success-on-quiet);
  }

  .wa-warning,
  :host([variant='warning']) {
    --wa-color-fill-loud: var(--wa-color-warning-fill-loud);
    --wa-color-fill-normal: var(--wa-color-warning-fill-normal);
    --wa-color-fill-quiet: var(--wa-color-warning-fill-quiet);
    --wa-color-border-loud: var(--wa-color-warning-border-loud);
    --wa-color-border-normal: var(--wa-color-warning-border-normal);
    --wa-color-border-quiet: var(--wa-color-warning-border-quiet);
    --wa-color-on-loud: var(--wa-color-warning-on-loud);
    --wa-color-on-normal: var(--wa-color-warning-on-normal);
    --wa-color-on-quiet: var(--wa-color-warning-on-quiet);
  }

  .wa-danger,
  :host([variant='danger']) {
    --wa-color-fill-loud: var(--wa-color-danger-fill-loud);
    --wa-color-fill-normal: var(--wa-color-danger-fill-normal);
    --wa-color-fill-quiet: var(--wa-color-danger-fill-quiet);
    --wa-color-border-loud: var(--wa-color-danger-border-loud);
    --wa-color-border-normal: var(--wa-color-danger-border-normal);
    --wa-color-border-quiet: var(--wa-color-danger-border-quiet);
    --wa-color-on-loud: var(--wa-color-danger-on-loud);
    --wa-color-on-normal: var(--wa-color-danger-on-normal);
    --wa-color-on-quiet: var(--wa-color-danger-on-quiet);
  }
}
`;/*! Copyright 2025 Fonticons, Inc. - https://webawesome.com/license */var Tf={$code:"en",$name:"English",$dir:"ltr",carousel:"Carousel",clearEntry:"Clear entry",close:"Close",copied:"Copied",copy:"Copy",currentValue:"Current value",error:"Error",goToSlide:(i,t)=>`Go to slide ${i} of ${t}`,hidePassword:"Hide password",loading:"Loading",nextSlide:"Next slide",numOptionsSelected:i=>i===0?"No options selected":i===1?"1 option selected":`${i} options selected`,pauseAnimation:"Pause animation",playAnimation:"Play animation",previousSlide:"Previous slide",progress:"Progress",remove:"Remove",resize:"Resize",scrollableRegion:"Scrollable region",scrollToEnd:"Scroll to end",scrollToStart:"Scroll to start",selectAColorFromTheScreen:"Select a color from the screen",showPassword:"Show password",slideNum:i=>`Slide ${i}`,toggleColorFormat:"Toggle color format",zoomIn:"Zoom in",zoomOut:"Zoom out"};jl(Tf);var J_=Tf;/*! Copyright 2025 Fonticons, Inc. - https://webawesome.com/license */var as=class extends Ji{};jl(J_);/*! Copyright 2025 Fonticons, Inc. - https://webawesome.com/license */function ls(i,t){const e={waitUntilFirstUpdate:!1,...t};return(n,r)=>{const{update:s}=n,o=Array.isArray(i)?i:[i];n.update=function(a){o.forEach(l=>{const c=l;if(a.has(c)){const h=a.get(c),u=this[c];h!==u&&(!e.waitUntilFirstUpdate||this.hasUpdated)&&this[r](h,u)}}),s.call(this,a)}}}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Vn={ATTRIBUTE:1,PROPERTY:3,BOOLEAN_ATTRIBUTE:4},Rf=i=>(...t)=>({_$litDirective$:i,values:t});let Af=class{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,e,n){this._$Ct=t,this._$AM=e,this._$Ci=n}_$AS(t,e){return this.update(t,e)}update(t,e){return this.render(...e)}};/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const wc=Rf(class extends Af{constructor(i){if(super(i),i.type!==Vn.ATTRIBUTE||i.name!=="class"||i.strings?.length>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(i){return" "+Object.keys(i).filter(t=>i[t]).join(" ")+" "}update(i,[t]){if(this.st===void 0){this.st=new Set,i.strings!==void 0&&(this.nt=new Set(i.strings.join(" ").split(/\s/).filter(n=>n!=="")));for(const n in t)t[n]&&!this.nt?.has(n)&&this.st.add(n);return this.render(t)}const e=i.element.classList;for(const n of this.st)n in t||(e.remove(n),this.st.delete(n));for(const n in t){const r=!!t[n];r===this.st.has(n)||this.nt?.has(n)||(r?(e.add(n),this.st.add(n)):(e.remove(n),this.st.delete(n)))}return we}});/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const ut=i=>i??wt;/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Pf=Symbol.for(""),Q_=i=>{if(i?.r===Pf)return i?._$litStatic$},Kh=(i,...t)=>({_$litStatic$:t.reduce((e,n,r)=>e+(s=>{if(s._$litStatic$!==void 0)return s._$litStatic$;throw Error(`Value passed to 'literal' function must be a 'literal' result: ${s}. Use 'unsafeStatic' to pass non-literal values, but
            take care to ensure page security.`)})(n)+i[r+1],i[0]),r:Pf}),Hh=new Map,ty=i=>(t,...e)=>{const n=e.length;let r,s;const o=[],a=[];let l,c=0,h=!1;for(;c<n;){for(l=t[c];c<n&&(s=e[c],(r=Q_(s))!==void 0);)l+=r+t[++c],h=!0;c!==n&&a.push(s),o.push(l),c++}if(c===n&&o.push(t[n]),h){const u=o.join("$$lit$$");(t=Hh.get(u))===void 0&&(o.raw=o,Hh.set(u,t=o)),e=a}return i(t,...e)},ma=ty(Y);/*! Copyright 2025 Fonticons, Inc. - https://webawesome.com/license */var ey=`@layer wa-component {
  :host {
    display: inline-block;

    /* Workaround because Chrome doesn't like :host(:has()) below
     * https://issues.chromium.org/issues/40062355
     * Firefox doesn't like this nested rule, so both are needed */
    &:has(wa-badge) {
      position: relative;
    }
  }

  /* Apply relative positioning only when needed to position wa-badge
   * This avoids creating a new stacking context for every button */
  :host(:has(wa-badge)) {
    position: relative;
  }
}

.button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  text-decoration: none;
  user-select: none;
  -webkit-user-select: none;
  white-space: nowrap;
  vertical-align: middle;
  transition-property: background, border, box-shadow, color;
  transition-duration: var(--wa-transition-fast);
  transition-timing-function: var(--wa-transition-easing);
  cursor: pointer;
  padding: 0 var(--wa-form-control-padding-inline);
  font-family: inherit;
  font-size: inherit;
  font-weight: var(--wa-font-weight-action);
  line-height: calc(var(--wa-form-control-height) - var(--border-width) * 2);
  height: var(--wa-form-control-height);
  width: 100%;

  background-color: var(--wa-color-fill-loud, var(--wa-color-neutral-fill-loud));
  border-color: transparent;
  color: var(--wa-color-on-loud, var(--wa-color-neutral-on-loud));
  border-radius: var(--wa-form-control-border-radius);
  border-style: var(--wa-border-style);
  border-width: var(--wa-border-width-s);
}

/* Appearance modifiers */
:host([appearance='plain']) {
  .button {
    color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
    background-color: transparent;
    border-color: transparent;
  }
  @media (hover: hover) {
    .button:not(.disabled):not(.loading):hover {
      color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
      background-color: var(--wa-color-fill-quiet, var(--wa-color-neutral-fill-quiet));
    }
  }
  .button:not(.disabled):not(.loading):active {
    color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
    background-color: color-mix(
      in oklab,
      var(--wa-color-fill-quiet, var(--wa-color-neutral-fill-quiet)),
      var(--wa-color-mix-active)
    );
  }
}

:host([appearance='outlined']) {
  .button {
    color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
    background-color: transparent;
    border-color: var(--wa-color-border-loud, var(--wa-color-neutral-border-loud));
  }
  @media (hover: hover) {
    .button:not(.disabled):not(.loading):hover {
      color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
      background-color: var(--wa-color-fill-quiet, var(--wa-color-neutral-fill-quiet));
    }
  }
  .button:not(.disabled):not(.loading):active {
    color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
    background-color: color-mix(
      in oklab,
      var(--wa-color-fill-quiet, var(--wa-color-neutral-fill-quiet)),
      var(--wa-color-mix-active)
    );
  }
}

:host([appearance='filled']) {
  .button {
    color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
    background-color: var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal));
    border-color: transparent;
  }
  @media (hover: hover) {
    .button:not(.disabled):not(.loading):hover {
      color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
      background-color: color-mix(
        in oklab,
        var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal)),
        var(--wa-color-mix-hover)
      );
    }
  }
  .button:not(.disabled):not(.loading):active {
    color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
    background-color: color-mix(
      in oklab,
      var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal)),
      var(--wa-color-mix-active)
    );
  }
}

:host([appearance='filled-outlined']) {
  .button {
    color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
    background-color: var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal));
    border-color: var(--wa-color-border-normal, var(--wa-color-neutral-border-normal));
  }
  @media (hover: hover) {
    .button:not(.disabled):not(.loading):hover {
      color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
      background-color: color-mix(
        in oklab,
        var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal)),
        var(--wa-color-mix-hover)
      );
    }
  }
  .button:not(.disabled):not(.loading):active {
    color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
    background-color: color-mix(
      in oklab,
      var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal)),
      var(--wa-color-mix-active)
    );
  }
}

:host([appearance='accent']) {
  .button {
    color: var(--wa-color-on-loud, var(--wa-color-neutral-on-loud));
    background-color: var(--wa-color-fill-loud, var(--wa-color-neutral-fill-loud));
    border-color: transparent;
  }
  @media (hover: hover) {
    .button:not(.disabled):not(.loading):hover {
      background-color: color-mix(
        in oklab,
        var(--wa-color-fill-loud, var(--wa-color-neutral-fill-loud)),
        var(--wa-color-mix-hover)
      );
    }
  }
  .button:not(.disabled):not(.loading):active {
    background-color: color-mix(
      in oklab,
      var(--wa-color-fill-loud, var(--wa-color-neutral-fill-loud)),
      var(--wa-color-mix-active)
    );
  }
}

/* Focus states */
.button:focus {
  outline: none;
}

.button:focus-visible {
  outline: var(--wa-focus-ring);
  outline-offset: var(--wa-focus-ring-offset);
}

/* Disabled state */
.button.disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* When disabled, prevent mouse events from bubbling up from children */
.button.disabled * {
  pointer-events: none;
}

/* Keep it last so Safari doesn't stop parsing this block */
.button::-moz-focus-inner {
  border: 0;
}

/* Icon buttons */
.button.is-icon-button {
  outline-offset: 2px;
  width: var(--wa-form-control-height);
  aspect-ratio: 1;
}

.button.is-icon-button:has(wa-icon) {
  width: auto;
}

/* Pill modifier */
:host([pill]) .button {
  border-radius: var(--wa-border-radius-pill);
}

/*
 * Label
 */

.start,
.end {
  flex: 0 0 auto;
  display: flex;
  align-items: center;
  pointer-events: none;
}

.label {
  display: inline-block;
}

.is-icon-button .label {
  display: flex;
}

.label::slotted(wa-icon) {
  align-self: center;
}

/*
 * Caret modifier
 */

wa-icon[part='caret'] {
  display: flex;
  align-self: center;
  align-items: center;

  &::part(svg) {
    width: 0.875em;
    height: 0.875em;
  }

  .button:has(&) .end {
    display: none;
  }
}

/*
 * Loading modifier
 */

.loading {
  position: relative;
  cursor: wait;

  .start,
  .label,
  .end,
  .caret {
    visibility: hidden;
  }

  wa-spinner {
    --indicator-color: currentColor;
    --track-color: color-mix(in oklab, currentColor, transparent 90%);

    position: absolute;
    font-size: 1em;
    height: 1em;
    width: 1em;
    top: calc(50% - 0.5em);
    left: calc(50% - 0.5em);
  }
}

/*
 * Badges
 */

.button ::slotted(wa-badge) {
  border-color: var(--wa-color-surface-default);
  position: absolute;
  inset-block-start: 0;
  inset-inline-end: 0;
  translate: 50% -50%;
  pointer-events: none;
}

:host(:dir(rtl)) ::slotted(wa-badge) {
  translate: -50% -50%;
}

/*
* Button spacing
*/

slot[name='start']::slotted(*) {
  margin-inline-end: 0.75em;
}

slot[name='end']::slotted(*),
.button:not(.visually-hidden-label) [part='caret'] {
  margin-inline-start: 0.75em;
}

/*
 * Button group border radius modifications
 */

/* Remove border radius from all grouped buttons by default */
:host(.wa-button-group__button) .button {
  border-radius: 0;
}

/* Horizontal orientation */
:host(.wa-button-group__horizontal.wa-button-group__button-first) .button {
  border-start-start-radius: var(--wa-form-control-border-radius);
  border-end-start-radius: var(--wa-form-control-border-radius);
}

:host(.wa-button-group__horizontal.wa-button-group__button-last) .button {
  border-start-end-radius: var(--wa-form-control-border-radius);
  border-end-end-radius: var(--wa-form-control-border-radius);
}

/* Vertical orientation */
:host(.wa-button-group__vertical) {
  flex: 1 1 auto;
}

:host(.wa-button-group__vertical) .button {
  width: 100%;
  justify-content: start;
}

:host(.wa-button-group__vertical.wa-button-group__button-first) .button {
  border-start-start-radius: var(--wa-form-control-border-radius);
  border-start-end-radius: var(--wa-form-control-border-radius);
}

:host(.wa-button-group__vertical.wa-button-group__button-last) .button {
  border-end-start-radius: var(--wa-form-control-border-radius);
  border-end-end-radius: var(--wa-form-control-border-radius);
}

/* Handle pill modifier for button groups */
:host([pill].wa-button-group__horizontal.wa-button-group__button-first) .button {
  border-start-start-radius: var(--wa-border-radius-pill);
  border-end-start-radius: var(--wa-border-radius-pill);
}

:host([pill].wa-button-group__horizontal.wa-button-group__button-last) .button {
  border-start-end-radius: var(--wa-border-radius-pill);
  border-end-end-radius: var(--wa-border-radius-pill);
}

:host([pill].wa-button-group__vertical.wa-button-group__button-first) .button {
  border-start-start-radius: var(--wa-border-radius-pill);
  border-start-end-radius: var(--wa-border-radius-pill);
}

:host([pill].wa-button-group__vertical.wa-button-group__button-last) .button {
  border-end-start-radius: var(--wa-border-radius-pill);
  border-end-end-radius: var(--wa-border-radius-pill);
}
`,rt=class extends Ee{constructor(){super(...arguments),this.assumeInteractionOn=["click"],this.hasSlotController=new Oo(this,"[default]","start","end"),this.localize=new as(this),this.invalid=!1,this.isIconButton=!1,this.title="",this.variant="neutral",this.appearance="accent",this.size="medium",this.withCaret=!1,this.disabled=!1,this.loading=!1,this.pill=!1,this.type="button",this.form=null}static get validators(){return[...super.validators,xf()]}constructLightDOMButton(){const i=document.createElement("button");return i.type=this.type,i.style.position="absolute",i.style.width="0",i.style.height="0",i.style.clipPath="inset(50%)",i.style.overflow="hidden",i.style.whiteSpace="nowrap",this.name&&(i.name=this.name),i.value=this.value||"",["form","formaction","formenctype","formmethod","formnovalidate","formtarget"].forEach(t=>{this.hasAttribute(t)&&i.setAttribute(t,this.getAttribute(t))}),i}handleClick(){if(!this.getForm())return;const t=this.constructLightDOMButton();this.parentElement?.append(t),t.click(),t.remove()}handleInvalid(){this.dispatchEvent(new Sf)}handleLabelSlotChange(){const i=this.labelSlot.assignedNodes({flatten:!0});let t=!1,e=!1,n=!1,r=!1;[...i].forEach(s=>{if(s.nodeType===Node.ELEMENT_NODE){const o=s;o.localName==="wa-icon"?(e=!0,t||(t=o.label!==void 0)):r=!0}else s.nodeType===Node.TEXT_NODE&&(s.textContent?.trim()||"").length>0&&(n=!0)}),this.isIconButton=e&&!n&&!r,this.isIconButton&&!t&&console.warn('Icon buttons must have a label for screen readers. Add <wa-icon label="..."> to remove this warning.',this)}isButton(){return!this.href}isLink(){return!!this.href}handleDisabledChange(){this.updateValidity()}setValue(...i){}click(){this.button.click()}focus(i){this.button.focus(i)}blur(){this.button.blur()}render(){const i=this.isLink(),t=i?Kh`a`:Kh`button`;return ma`
      <${t}
        part="base"
        class=${wc({button:!0,caret:this.withCaret,disabled:this.disabled,loading:this.loading,rtl:this.localize.dir()==="rtl","has-label":this.hasSlotController.test("[default]"),"has-start":this.hasSlotController.test("start"),"has-end":this.hasSlotController.test("end"),"is-icon-button":this.isIconButton})}
        ?disabled=${ut(i?void 0:this.disabled)}
        type=${ut(i?void 0:this.type)}
        title=${this.title}
        name=${ut(i?void 0:this.name)}
        value=${ut(i?void 0:this.value)}
        href=${ut(i?this.href:void 0)}
        target=${ut(i?this.target:void 0)}
        download=${ut(i?this.download:void 0)}
        rel=${ut(i&&this.rel?this.rel:void 0)}
        role=${ut(i?void 0:"button")}
        aria-disabled=${this.disabled?"true":"false"}
        tabindex=${this.disabled?"-1":"0"}
        @invalid=${this.isButton()?this.handleInvalid:null}
        @click=${this.handleClick}
      >
        <slot name="start" part="start" class="start"></slot>
        <slot part="label" class="label" @slotchange=${this.handleLabelSlotChange}></slot>
        <slot name="end" part="end" class="end"></slot>
        ${this.withCaret?ma`
                <wa-icon part="caret" class="caret" library="system" name="chevron-down" variant="solid"></wa-icon>
              `:""}
        ${this.loading?ma`<wa-spinner part="spinner"></wa-spinner>`:""}
      </${t}>
    `}};rt.shadowRootOptions={...Ee.shadowRootOptions,delegatesFocus:!0};rt.css=[ey,If,ko];L([Ne(".button")],rt.prototype,"button",2);L([Ne("slot:not([name])")],rt.prototype,"labelSlot",2);L([Fe()],rt.prototype,"invalid",2);L([Fe()],rt.prototype,"isIconButton",2);L([M()],rt.prototype,"title",2);L([M({reflect:!0})],rt.prototype,"variant",2);L([M({reflect:!0})],rt.prototype,"appearance",2);L([M({reflect:!0})],rt.prototype,"size",2);L([M({attribute:"with-caret",type:Boolean,reflect:!0})],rt.prototype,"withCaret",2);L([M({type:Boolean})],rt.prototype,"disabled",2);L([M({type:Boolean,reflect:!0})],rt.prototype,"loading",2);L([M({type:Boolean,reflect:!0})],rt.prototype,"pill",2);L([M()],rt.prototype,"type",2);L([M({reflect:!0})],rt.prototype,"name",2);L([M({reflect:!0})],rt.prototype,"value",2);L([M({reflect:!0})],rt.prototype,"href",2);L([M()],rt.prototype,"target",2);L([M()],rt.prototype,"rel",2);L([M()],rt.prototype,"download",2);L([M({reflect:!0})],rt.prototype,"form",2);L([M({attribute:"formaction"})],rt.prototype,"formAction",2);L([M({attribute:"formenctype"})],rt.prototype,"formEnctype",2);L([M({attribute:"formmethod"})],rt.prototype,"formMethod",2);L([M({attribute:"formnovalidate",type:Boolean})],rt.prototype,"formNoValidate",2);L([M({attribute:"formtarget"})],rt.prototype,"formTarget",2);L([ls("disabled",{waitUntilFirstUpdate:!0})],rt.prototype,"handleDisabledChange",1);rt=L([Nt("wa-button")],rt);/*! Copyright 2025 Fonticons, Inc. - https://webawesome.com/license */var ny=`:host {
  --track-width: 2px;
  --track-color: var(--wa-color-neutral-fill-normal);
  --indicator-color: var(--wa-color-brand-fill-loud);
  --speed: 2s;

  /* Resizing a spinner element using anything but font-size will break the animation because the animation uses em units.
   Therefore, if a spinner is used in a flex container without \`flex: none\` applied, the spinner can grow/shrink and
   break the animation. The use of \`flex: none\` on the host element prevents this by always having the spinner sized
   according to its actual dimensions.
  */
  flex: none;
  display: inline-flex;
  width: 1em;
  height: 1em;
}

svg {
  width: 100%;
  height: 100%;
  aspect-ratio: 1;
  animation: spin var(--speed) linear infinite;
}

.track {
  stroke: var(--track-color);
}

.indicator {
  stroke: var(--indicator-color);
  stroke-dasharray: 75, 100;
  stroke-dashoffset: -5;
  animation: dash 1.5s ease-in-out infinite;
  stroke-linecap: round;
}

@keyframes spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}

@keyframes dash {
  0% {
    stroke-dasharray: 1, 150;
    stroke-dashoffset: 0;
  }
  50% {
    stroke-dasharray: 90, 150;
    stroke-dashoffset: -35;
  }
  100% {
    stroke-dasharray: 90, 150;
    stroke-dashoffset: -124;
  }
}
`,dl=class extends Ve{constructor(){super(...arguments),this.localize=new as(this)}render(){return Y`
      <svg
        part="base"
        role="progressbar"
        aria-label=${this.localize.term("loading")}
        fill="none"
        viewBox="0 0 50 50"
        xmlns="http://www.w3.org/2000/svg"
      >
        <circle class="track" cx="25" cy="25" r="20" fill="none" stroke-width="5" />
        <circle class="indicator" cx="25" cy="25" r="20" fill="none" stroke-width="5" />
      </svg>
    `}};dl.css=ny;dl=L([Nt("wa-spinner")],dl);/*! Copyright 2025 Fonticons, Inc. - https://webawesome.com/license */var iy=class extends Event{constructor(){super("wa-load",{bubbles:!0,cancelable:!1,composed:!0})}};/*! Copyright 2025 Fonticons, Inc. - https://webawesome.com/license */var fl="";function ry(i){fl=i}function sy(){if(!fl){const i=document.querySelector("[data-fa-kit-code]");i&&ry(i.getAttribute("data-fa-kit-code")||"")}return fl}var Be="7.0.1";function oy(i,t,e){const n=sy(),r=n.length>0;let s="solid";return t==="notdog"?(e==="solid"&&(s="solid"),e==="duo-solid"&&(s="duo-solid"),`https://ka-p.fontawesome.com/releases/v${Be}/svgs/notdog-${s}/${i}.svg?token=${encodeURIComponent(n)}`):t==="chisel"?`https://ka-p.fontawesome.com/releases/v${Be}/svgs/chisel-regular/${i}.svg?token=${encodeURIComponent(n)}`:t==="etch"?`https://ka-p.fontawesome.com/releases/v${Be}/svgs/etch-solid/${i}.svg?token=${encodeURIComponent(n)}`:t==="jelly"?(e==="regular"&&(s="regular"),e==="duo-regular"&&(s="duo-regular"),e==="fill-regular"&&(s="fill-regular"),`https://ka-p.fontawesome.com/releases/v${Be}/svgs/jelly-${s}/${i}.svg?token=${encodeURIComponent(n)}`):t==="slab"?((e==="solid"||e==="regular")&&(s="regular"),e==="press-regular"&&(s="press-regular"),`https://ka-p.fontawesome.com/releases/v${Be}/svgs/slab-${s}/${i}.svg?token=${encodeURIComponent(n)}`):t==="thumbprint"?`https://ka-p.fontawesome.com/releases/v${Be}/svgs/thumbprint-light/${i}.svg?token=${encodeURIComponent(n)}`:t==="whiteboard"?`https://ka-p.fontawesome.com/releases/v${Be}/svgs/whiteboard-semibold/${i}.svg?token=${encodeURIComponent(n)}`:(t==="classic"&&(e==="thin"&&(s="thin"),e==="light"&&(s="light"),e==="regular"&&(s="regular"),e==="solid"&&(s="solid")),t==="sharp"&&(e==="thin"&&(s="sharp-thin"),e==="light"&&(s="sharp-light"),e==="regular"&&(s="sharp-regular"),e==="solid"&&(s="sharp-solid")),t==="duotone"&&(e==="thin"&&(s="duotone-thin"),e==="light"&&(s="duotone-light"),e==="regular"&&(s="duotone-regular"),e==="solid"&&(s="duotone")),t==="sharp-duotone"&&(e==="thin"&&(s="sharp-duotone-thin"),e==="light"&&(s="sharp-duotone-light"),e==="regular"&&(s="sharp-duotone-regular"),e==="solid"&&(s="sharp-duotone-solid")),t==="brands"&&(s="brands"),r?`https://ka-p.fontawesome.com/releases/v${Be}/svgs/${s}/${i}.svg?token=${encodeURIComponent(n)}`:`https://ka-f.fontawesome.com/releases/v${Be}/svgs/${s}/${i}.svg`)}var ay={name:"default",resolver:(i,t="classic",e="solid")=>oy(i,t,e),mutator:(i,t)=>{if(t?.family&&!i.hasAttribute("data-duotone-initialized")){const{family:e,variant:n}=t;if(e==="duotone"||e==="sharp-duotone"||e==="notdog"&&n==="duo-solid"||e==="jelly"&&n==="duo-regular"||e==="thumbprint"){const r=[...i.querySelectorAll("path")],s=r.find(a=>!a.hasAttribute("opacity")),o=r.find(a=>a.hasAttribute("opacity"));if(!s||!o)return;if(s.setAttribute("data-duotone-primary",""),o.setAttribute("data-duotone-secondary",""),t.swapOpacity&&s&&o){const a=o.getAttribute("opacity")||"0.4";s.style.setProperty("--path-opacity",a),o.style.setProperty("--path-opacity","1")}i.setAttribute("data-duotone-initialized","")}}}},ly=ay;/*! Copyright 2025 Fonticons, Inc. - https://webawesome.com/license */function cy(i){return`data:image/svg+xml,${encodeURIComponent(i)}`}var _a={solid:{check:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M434.8 70.1c14.3 10.4 17.5 30.4 7.1 44.7l-256 352c-5.5 7.6-14 12.3-23.4 13.1s-18.5-2.7-25.1-9.3l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l101.5 101.5 234-321.7c10.4-14.3 30.4-17.5 44.7-7.1z"/></svg>',"chevron-down":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M201.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 338.7 54.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"/></svg>',"chevron-left":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l192 192c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256 246.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192z"/></svg>',"chevron-right":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M311.1 233.4c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L243.2 256 73.9 86.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l192 192z"/></svg>',circle:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M0 256a256 256 0 1 1 512 0 256 256 0 1 1 -512 0z"/></svg>',eyedropper:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M341.6 29.2l-101.6 101.6-9.4-9.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-9.4-9.4 101.6-101.6c39-39 39-102.2 0-141.1s-102.2-39-141.1 0zM55.4 323.3c-15 15-23.4 35.4-23.4 56.6l0 42.4-26.6 39.9c-8.5 12.7-6.8 29.6 4 40.4s27.7 12.5 40.4 4l39.9-26.6 42.4 0c21.2 0 41.6-8.4 56.6-23.4l109.4-109.4-45.3-45.3-109.4 109.4c-3 3-7.1 4.7-11.3 4.7l-36.1 0 0-36.1c0-4.2 1.7-8.3 4.7-11.3l109.4-109.4-45.3-45.3-109.4 109.4z"/></svg>',"grip-vertical":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M128 40c0-22.1-17.9-40-40-40L40 0C17.9 0 0 17.9 0 40L0 88c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48zm0 192c0-22.1-17.9-40-40-40l-48 0c-22.1 0-40 17.9-40 40l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48zM0 424l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48c0-22.1-17.9-40-40-40l-48 0c-22.1 0-40 17.9-40 40zM320 40c0-22.1-17.9-40-40-40L232 0c-22.1 0-40 17.9-40 40l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48zM192 232l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48c0-22.1-17.9-40-40-40l-48 0c-22.1 0-40 17.9-40 40zM320 424c0-22.1-17.9-40-40-40l-48 0c-22.1 0-40 17.9-40 40l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48z"/></svg>',indeterminate:'<svg part="indeterminate-icon" class="icon" viewBox="0 0 16 16"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round"><g stroke="currentColor" stroke-width="2"><g transform="translate(2.285714 6.857143)"><path d="M10.2857143,1.14285714 L1.14285714,1.14285714"/></g></g></g></svg>',minus:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M0 256c0-17.7 14.3-32 32-32l384 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 288c-17.7 0-32-14.3-32-32z"/></svg>',pause:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M48 32C21.5 32 0 53.5 0 80L0 432c0 26.5 21.5 48 48 48l64 0c26.5 0 48-21.5 48-48l0-352c0-26.5-21.5-48-48-48L48 32zm224 0c-26.5 0-48 21.5-48 48l0 352c0 26.5 21.5 48 48 48l64 0c26.5 0 48-21.5 48-48l0-352c0-26.5-21.5-48-48-48l-64 0z"/></svg>',play:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M91.2 36.9c-12.4-6.8-27.4-6.5-39.6 .7S32 57.9 32 72l0 368c0 14.1 7.5 27.2 19.6 34.4s27.2 7.5 39.6 .7l336-184c12.8-7 20.8-20.5 20.8-35.1s-8-28.1-20.8-35.1l-336-184z"/></svg>',star:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M309.5-18.9c-4.1-8-12.4-13.1-21.4-13.1s-17.3 5.1-21.4 13.1L193.1 125.3 33.2 150.7c-8.9 1.4-16.3 7.7-19.1 16.3s-.5 18 5.8 24.4l114.4 114.5-25.2 159.9c-1.4 8.9 2.3 17.9 9.6 23.2s16.9 6.1 25 2L288.1 417.6 432.4 491c8 4.1 17.7 3.3 25-2s11-14.2 9.6-23.2L441.7 305.9 556.1 191.4c6.4-6.4 8.6-15.8 5.8-24.4s-10.1-14.9-19.1-16.3L383 125.3 309.5-18.9z"/></svg>',user:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M224 248a120 120 0 1 0 0-240 120 120 0 1 0 0 240zm-29.7 56C95.8 304 16 383.8 16 482.3 16 498.7 29.3 512 45.7 512l356.6 0c16.4 0 29.7-13.3 29.7-29.7 0-98.5-79.8-178.3-178.3-178.3l-59.4 0z"/></svg>',xmark:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M55.1 73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L147.2 256 9.9 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192.5 301.3 329.9 438.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.8 256 375.1 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192.5 210.7 55.1 73.4z"/></svg>'},regular:{"circle-question":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M464 256a208 208 0 1 0 -416 0 208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0 256 256 0 1 1 -512 0zm256-80c-17.7 0-32 14.3-32 32 0 13.3-10.7 24-24 24s-24-10.7-24-24c0-44.2 35.8-80 80-80s80 35.8 80 80c0 47.2-36 67.2-56 74.5l0 3.8c0 13.3-10.7 24-24 24s-24-10.7-24-24l0-8.1c0-20.5 14.8-35.2 30.1-40.2 6.4-2.1 13.2-5.5 18.2-10.3 4.3-4.2 7.7-10 7.7-19.6 0-17.7-14.3-32-32-32zM224 368a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"/></svg>',"circle-xmark":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M256 48a208 208 0 1 1 0 416 208 208 0 1 1 0-416zm0 464a256 256 0 1 0 0-512 256 256 0 1 0 0 512zM167 167c-9.4 9.4-9.4 24.6 0 33.9l55 55-55 55c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l55-55 55 55c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-55-55 55-55c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-55 55-55-55c-9.4-9.4-24.6-9.4-33.9 0z"/></svg>',copy:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M384 336l-192 0c-8.8 0-16-7.2-16-16l0-256c0-8.8 7.2-16 16-16l133.5 0c4.2 0 8.3 1.7 11.3 4.7l58.5 58.5c3 3 4.7 7.1 4.7 11.3L400 320c0 8.8-7.2 16-16 16zM192 384l192 0c35.3 0 64-28.7 64-64l0-197.5c0-17-6.7-33.3-18.7-45.3L370.7 18.7C358.7 6.7 342.5 0 325.5 0L192 0c-35.3 0-64 28.7-64 64l0 256c0 35.3 28.7 64 64 64zM64 128c-35.3 0-64 28.7-64 64L0 448c0 35.3 28.7 64 64 64l192 0c35.3 0 64-28.7 64-64l0-16-48 0 0 16c0 8.8-7.2 16-16 16L64 464c-8.8 0-16-7.2-16-16l0-256c0-8.8 7.2-16 16-16l16 0 0-48-16 0z"/></svg>',eye:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M288 80C222.8 80 169.2 109.6 128.1 147.7 89.6 183.5 63 226 49.4 256 63 286 89.6 328.5 128.1 364.3 169.2 402.4 222.8 432 288 432s118.8-29.6 159.9-67.7C486.4 328.5 513 286 526.6 256 513 226 486.4 183.5 447.9 147.7 406.8 109.6 353.2 80 288 80zM95.4 112.6C142.5 68.8 207.2 32 288 32s145.5 36.8 192.6 80.6c46.8 43.5 78.1 95.4 93 131.1 3.3 7.9 3.3 16.7 0 24.6-14.9 35.7-46.2 87.7-93 131.1-47.1 43.7-111.8 80.6-192.6 80.6S142.5 443.2 95.4 399.4c-46.8-43.5-78.1-95.4-93-131.1-3.3-7.9-3.3-16.7 0-24.6 14.9-35.7 46.2-87.7 93-131.1zM288 336c44.2 0 80-35.8 80-80 0-29.6-16.1-55.5-40-69.3-1.4 59.7-49.6 107.9-109.3 109.3 13.8 23.9 39.7 40 69.3 40zm-79.6-88.4c2.5 .3 5 .4 7.6 .4 35.3 0 64-28.7 64-64 0-2.6-.2-5.1-.4-7.6-37.4 3.9-67.2 33.7-71.1 71.1zm45.6-115c10.8-3 22.2-4.5 33.9-4.5 8.8 0 17.5 .9 25.8 2.6 .3 .1 .5 .1 .8 .2 57.9 12.2 101.4 63.7 101.4 125.2 0 70.7-57.3 128-128 128-61.6 0-113-43.5-125.2-101.4-1.8-8.6-2.8-17.5-2.8-26.6 0-11 1.4-21.8 4-32 .2-.7 .3-1.3 .5-1.9 11.9-43.4 46.1-77.6 89.5-89.5z"/></svg>',"eye-slash":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M41-24.9c-9.4-9.4-24.6-9.4-33.9 0S-2.3-.3 7 9.1l528 528c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-96.4-96.4c2.7-2.4 5.4-4.8 8-7.2 46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7 0-24.6-14.9-35.7-46.2-87.7-93-131.1-47.1-43.7-111.8-80.6-192.6-80.6-56.8 0-105.6 18.2-146 44.2L41-24.9zM176.9 111.1c32.1-18.9 69.2-31.1 111.1-31.1 65.2 0 118.8 29.6 159.9 67.7 38.5 35.7 65.1 78.3 78.6 108.3-13.6 30-40.2 72.5-78.6 108.3-3.1 2.8-6.2 5.6-9.4 8.4L393.8 328c14-20.5 22.2-45.3 22.2-72 0-70.7-57.3-128-128-128-26.7 0-51.5 8.2-72 22.2l-39.1-39.1zm182 182l-108-108c11.1-5.8 23.7-9.1 37.1-9.1 44.2 0 80 35.8 80 80 0 13.4-3.3 26-9.1 37.1zM103.4 173.2l-34-34c-32.6 36.8-55 75.8-66.9 104.5-3.3 7.9-3.3 16.7 0 24.6 14.9 35.7 46.2 87.7 93 131.1 47.1 43.7 111.8 80.6 192.6 80.6 37.3 0 71.2-7.9 101.5-20.6L352.2 422c-20 6.4-41.4 10-64.2 10-65.2 0-118.8-29.6-159.9-67.7-38.5-35.7-65.1-78.3-78.6-108.3 10.4-23.1 28.6-53.6 54-82.8z"/></svg>',star:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M288.1-32c9 0 17.3 5.1 21.4 13.1L383 125.3 542.9 150.7c8.9 1.4 16.3 7.7 19.1 16.3s.5 18-5.8 24.4L441.7 305.9 467 465.8c1.4 8.9-2.3 17.9-9.6 23.2s-17 6.1-25 2L288.1 417.6 143.8 491c-8 4.1-17.7 3.3-25-2s-11-14.2-9.6-23.2L134.4 305.9 20 191.4c-6.4-6.4-8.6-15.8-5.8-24.4s10.1-14.9 19.1-16.3l159.9-25.4 73.6-144.2c4.1-8 12.4-13.1 21.4-13.1zm0 76.8L230.3 158c-3.5 6.8-10 11.6-17.6 12.8l-125.5 20 89.8 89.9c5.4 5.4 7.9 13.1 6.7 20.7l-19.8 125.5 113.3-57.6c6.8-3.5 14.9-3.5 21.8 0l113.3 57.6-19.8-125.5c-1.2-7.6 1.3-15.3 6.7-20.7l89.8-89.9-125.5-20c-7.6-1.2-14.1-6-17.6-12.8L288.1 44.8z"/></svg>'}},hy={name:"system",resolver:(i,t="classic",e="solid")=>{let r=_a[e][i]??_a.regular[i]??_a.regular["circle-question"];return r?cy(r):""}},uy=hy;/*! Copyright 2025 Fonticons, Inc. - https://webawesome.com/license */var dy="classic",fy=[ly,uy],gl=[];function gy(i){gl.push(i)}function py(i){gl=gl.filter(t=>t!==i)}function ya(i){return fy.find(t=>t.name===i)}function my(){return dy}/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const _y=(i,t)=>i?._$litType$!==void 0,yy=i=>i.strings===void 0,wy={},vy=(i,t=wy)=>i._$AH=t;/*! Copyright 2025 Fonticons, Inc. - https://webawesome.com/license */var by=class extends Event{constructor(){super("wa-error",{bubbles:!0,cancelable:!1,composed:!0})}},Ey=`:host {
  --primary-color: currentColor;
  --primary-opacity: 1;
  --secondary-color: currentColor;
  --secondary-opacity: 0.4;

  box-sizing: content-box;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  vertical-align: -0.125em;
}

/* Standard */
:host(:not([auto-width])) {
  width: 1.25em;
  height: 1em;
}

/* Auto-width */
:host([auto-width]) {
  width: auto;
  height: 1em;
}

svg {
  height: 1em;
  fill: currentColor;
  overflow: visible;

  /* Duotone colors with path-specific opacity fallback */
  path[data-duotone-primary] {
    color: var(--primary-color);
    opacity: var(--path-opacity, var(--primary-opacity));
  }

  path[data-duotone-secondary] {
    color: var(--secondary-color);
    opacity: var(--path-opacity, var(--secondary-opacity));
  }
}
`,ur=Symbol(),Es=Symbol(),wa,va=new Map,Jt=class extends Ve{constructor(){super(...arguments),this.svg=null,this.autoWidth=!1,this.swapOpacity=!1,this.label="",this.library="default",this.resolveIcon=async(i,t)=>{let e;if(t?.spriteSheet){this.hasUpdated||await this.updateComplete,this.svg=Y`<svg part="svg">
        <use part="use" href="${i}"></use>
      </svg>`,await this.updateComplete;const n=this.shadowRoot.querySelector("[part='svg']");return typeof t.mutator=="function"&&t.mutator(n,this),this.svg}try{if(e=await fetch(i,{mode:"cors"}),!e.ok)return e.status===410?ur:Es}catch{return Es}try{const n=document.createElement("div");n.innerHTML=await e.text();const r=n.firstElementChild;if(r?.tagName?.toLowerCase()!=="svg")return ur;wa||(wa=new DOMParser);const o=wa.parseFromString(r.outerHTML,"text/html").body.querySelector("svg");return o?(o.part.add("svg"),document.adoptNode(o)):ur}catch{return ur}}}connectedCallback(){super.connectedCallback(),gy(this)}firstUpdated(i){super.firstUpdated(i),this.setIcon()}disconnectedCallback(){super.disconnectedCallback(),py(this)}getIconSource(){const i=ya(this.library),t=this.family||my();return this.name&&i?{url:i.resolver(this.name,t,this.variant,this.autoWidth),fromLibrary:!0}:{url:this.src,fromLibrary:!1}}handleLabelChange(){typeof this.label=="string"&&this.label.length>0?(this.setAttribute("role","img"),this.setAttribute("aria-label",this.label),this.removeAttribute("aria-hidden")):(this.removeAttribute("role"),this.removeAttribute("aria-label"),this.setAttribute("aria-hidden","true"))}async setIcon(){const{url:i,fromLibrary:t}=this.getIconSource(),e=t?ya(this.library):void 0;if(!i){this.svg=null;return}let n=va.get(i);n||(n=this.resolveIcon(i,e),va.set(i,n));const r=await n;if(r===Es&&va.delete(i),i===this.getIconSource().url){if(_y(r)){this.svg=r;return}switch(r){case Es:case ur:this.svg=null,this.dispatchEvent(new by);break;default:this.svg=r.cloneNode(!0),e?.mutator?.(this.svg,this),this.dispatchEvent(new iy)}}}updated(i){super.updated(i);const t=ya(this.library),e=this.shadowRoot?.querySelector("svg");e&&t?.mutator?.(e,this)}render(){return this.hasUpdated?this.svg:Y`<svg part="svg" fill="currentColor" width="16" height="16"></svg>`}};Jt.css=Ey;L([Fe()],Jt.prototype,"svg",2);L([M({reflect:!0})],Jt.prototype,"name",2);L([M({reflect:!0})],Jt.prototype,"family",2);L([M({reflect:!0})],Jt.prototype,"variant",2);L([M({attribute:"auto-width",type:Boolean,reflect:!0})],Jt.prototype,"autoWidth",2);L([M({attribute:"swap-opacity",type:Boolean,reflect:!0})],Jt.prototype,"swapOpacity",2);L([M()],Jt.prototype,"src",2);L([M()],Jt.prototype,"label",2);L([M({reflect:!0})],Jt.prototype,"library",2);L([ls("label")],Jt.prototype,"handleLabelChange",1);L([ls(["family","name","library","variant","src","autoWidth","swapOpacity"])],Jt.prototype,"setIcon",1);Jt=L([Nt("wa-icon")],Jt);const jt={ADD:"add",REMOVE:"remove"},Yh={LENGTH:"length"};class Cs extends on{constructor(t,e,n){super(t),this.element=e,this.index=n}}class Le extends $e{constructor(t,e){if(super(),this.on,this.once,this.un,e=e||{},this.unique_=!!e.unique,this.array_=t||[],this.unique_)for(let n=0,r=this.array_.length;n<r;++n)this.assertUnique_(this.array_[n],n);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,n=t.length;e<n;++e)this.push(t[e]);return this}forEach(t){const e=this.array_;for(let n=0,r=e.length;n<r;++n)t(e[n],n,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(Yh.LENGTH)}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new Cs(jt.ADD,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){this.unique_&&this.assertUnique_(t);const e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){const e=this.array_;for(let n=0,r=e.length;n<r;++n)if(e[n]===t)return this.removeAt(n)}removeAt(t){if(t<0||t>=this.getLength())return;const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Cs(jt.REMOVE,e,t)),e}setAt(t,e){const n=this.getLength();if(t>=n){this.insertAt(t,e);return}if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);const r=this.array_[t];this.array_[t]=e,this.dispatchEvent(new Cs(jt.REMOVE,r,t)),this.dispatchEvent(new Cs(jt.ADD,e,t))}updateLength_(){this.set(Yh.LENGTH,this.array_.length)}assertUnique_(t,e){for(let n=0,r=this.array_.length;n<r;++n)if(this.array_[n]===t&&n!==e)throw new Error("Duplicate item added to a unique collection")}}class Ii extends on{constructor(t,e,n){super(t),this.map=e,this.frameState=n!==void 0?n:null}}class fn extends Ii{constructor(t,e,n,r,s,o){super(t,e,s),this.originalEvent=n,this.pixel_=null,this.coordinate_=null,this.dragging=r!==void 0?r:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const gt={SINGLECLICK:"singleclick",CLICK:W.CLICK,DBLCLICK:W.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},ti=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",Cy=ti.includes("safari")&&!ti.includes("chrom");Cy&&(ti.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(ti));const xy=ti.includes("webkit")&&!ti.includes("edge"),Lf=ti.includes("macintosh"),Sy=typeof devicePixelRatio<"u"?devicePixelRatio:1,vc=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,Mf=typeof Image<"u"&&Image.prototype.decode,Of=function(){let i=!1;try{const t=Object.defineProperty({},"passive",{get:function(){i=!0}});window.addEventListener("_",null,t),window.removeEventListener("_",null,t)}catch{}return i}(),pl={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class Iy extends So{constructor(t,e){super(t),this.map_=t,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=e===void 0?1:e,this.down_=null;const n=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=n,this.pointerdownListenerKey_=tt(n,pl.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=tt(n,pl.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(W.TOUCHMOVE,this.boundHandleTouchMove_,Of?{passive:!1}:!1)}emulateClick_(t){let e=new fn(gt.CLICK,this.map_,t);this.dispatchEvent(e),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new fn(gt.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const n=new fn(gt.SINGLECLICK,this.map_,t);this.dispatchEvent(n)},250)}updateActivePointers_(t){const e=t,n=e.pointerId;if(e.type==gt.POINTERUP||e.type==gt.POINTERCANCEL){delete this.trackedTouches_[n];for(const r in this.trackedTouches_)if(this.trackedTouches_[r].target!==e.target){delete this.trackedTouches_[r];break}}else(e.type==gt.POINTERDOWN||e.type==gt.POINTERMOVE)&&(this.trackedTouches_[n]=e);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(t){this.updateActivePointers_(t);const e=new fn(gt.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(ct),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return t.button===0}handlePointerDown_(t){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(t);const e=new fn(gt.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);if(this.dispatchEvent(e),this.down_=new PointerEvent(t.type,t),Object.defineProperty(this.down_,"target",{writable:!1,value:t.target}),this.dragListenerKeys_.length===0){const n=this.map_.getOwnerDocument();this.dragListenerKeys_.push(tt(n,gt.POINTERMOVE,this.handlePointerMove_,this),tt(n,gt.POINTERUP,this.handlePointerUp_,this),tt(this.element_,gt.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==n&&this.dragListenerKeys_.push(tt(this.element_.getRootNode(),gt.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;const e=new fn(gt.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}relayMoveEvent_(t){this.originalPointerMoveEvent_=t;const e=!!(this.down_&&this.isMoving_(t));this.dispatchEvent(new fn(gt.POINTERMOVE,this.map_,t,e))}handleTouchMove_(t){const e=this.originalPointerMoveEvent_;(!e||e.defaultPrevented)&&(typeof t.cancelable!="boolean"||t.cancelable===!0)&&t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(ct(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(W.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(ct(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(ct),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const gn={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},kt={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},z={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4},Xs=1/0;class Ty{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,ns(this.queuedElements_)}dequeue(){const t=this.elements_,e=this.priorities_,n=t[0];t.length==1?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));const r=this.keyFunction_(n);return delete this.queuedElements_[r],n}enqueue(t){it(!(this.keyFunction_(t)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const e=this.priorityFunction_(t);return e!=Xs?(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(t){return t*2+1}getRightChildIndex_(t){return t*2+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}isEmpty(){return this.elements_.length===0}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){const e=this.elements_,n=this.priorities_,r=e.length,s=e[t],o=n[t],a=t;for(;t<r>>1;){const l=this.getLeftChildIndex_(t),c=this.getRightChildIndex_(t),h=c<r&&n[c]<n[l]?c:l;e[t]=e[h],n[t]=n[h],t=h}e[t]=s,n[t]=o,this.siftDown_(a,t)}siftDown_(t,e){const n=this.elements_,r=this.priorities_,s=n[e],o=r[e];for(;e>t;){const a=this.getParentIndex_(e);if(r[a]>o)n[e]=n[a],r[e]=r[a],e=a;else break}n[e]=s,r[e]=o}reprioritize(){const t=this.priorityFunction_,e=this.elements_,n=this.priorities_;let r=0;const s=e.length;let o,a,l;for(a=0;a<s;++a)o=e[a],l=t(o),l==Xs?delete this.queuedElements_[this.keyFunction_(o)]:(n[r]=l,e[r++]=o);e.length=r,n.length=r,this.heapify_()}}class Ry extends Ty{constructor(t,e){super(n=>t.apply(null,n),n=>n[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){const e=super.enqueue(t);return e&&t[0].addEventListener(W.CHANGE,this.boundHandleTileChange_),e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){const e=t.target,n=e.getState();if(n===z.LOADED||n===z.ERROR||n===z.EMPTY){n!==z.ERROR&&e.removeEventListener(W.CHANGE,this.boundHandleTileChange_);const r=e.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let n=0;for(;this.tilesLoading_<t&&n<e&&this.getCount()>0;){const r=this.dequeue()[0],s=r.getKey();r.getState()===z.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++n,r.load())}}}function Ay(i,t,e,n,r){if(!i||!(e in i.wantedTiles)||!i.wantedTiles[e][t.getKey()])return Xs;const s=i.viewState.center,o=n[0]-s[0],a=n[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+a*a)/r}const Ft={ANIMATING:0,INTERACTING:1},me={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function Zh(i,t,e){return function(n,r,s,o,a){if(!n)return;if(!r&&!t)return n;const l=t?0:s[0]*r,c=t?0:s[1]*r,h=a?a[0]:0,u=a?a[1]:0;let d=i[0]+l/2+h,f=i[2]-l/2+h,m=i[1]+c/2+u,v=i[3]-c/2+u;d>f&&(d=(f+d)/2,f=d),m>v&&(m=(v+m)/2,v=m);let w=dt(n[0],d,f),E=dt(n[1],m,v);if(o&&e&&r){const I=30*r;w+=-I*Math.log(1+Math.max(0,d-n[0])/I)+I*Math.log(1+Math.max(0,n[0]-f)/I),E+=-I*Math.log(1+Math.max(0,m-n[1])/I)+I*Math.log(1+Math.max(0,n[1]-v)/I)}return[w,E]}}function Py(i){return i}function kf(i){return Math.pow(i,3)}function tr(i){return 1-kf(1-i)}function Ly(i){return 3*i*i-2*i*i*i}function My(i){return i}function bc(i,t,e,n){const r=ot(t)/e[0],s=Ut(t)/e[1];return n?Math.min(i,Math.max(r,s)):Math.min(i,Math.min(r,s))}function Ec(i,t,e){let n=Math.min(i,t);const r=50;return n*=Math.log(1+r*Math.max(0,i/t-1))/r+1,e&&(n=Math.max(n,e),n/=Math.log(1+r*Math.max(0,e/i-1))/r+1),dt(n,e/2,t*2)}function Oy(i,t,e,n){return t=t!==void 0?t:!0,function(r,s,o,a){if(r!==void 0){const l=i[0],c=i[i.length-1],h=e?bc(l,e,o,n):l;if(a)return t?Ec(r,h,c):dt(r,c,h);const u=Math.min(h,r),d=Math.floor(Hl(i,u,s));return i[d]>h&&d<i.length-1?i[d+1]:i[d]}}}function ky(i,t,e,n,r,s){return n=n!==void 0?n:!0,e=e!==void 0?e:0,function(o,a,l,c){if(o!==void 0){const h=r?bc(t,r,l,s):t;if(c)return n?Ec(o,h,e):dt(o,e,h);const u=1e-9,d=Math.ceil(Math.log(t/h)/Math.log(i)-u),f=-a*(.5-u)+.5,m=Math.min(h,o),v=Math.floor(Math.log(t/m)/Math.log(i)+f),w=Math.max(d,v),E=t/Math.pow(i,w);return dt(E,e,h)}}}function Jh(i,t,e,n,r){return e=e!==void 0?e:!0,function(s,o,a,l){if(s!==void 0){const c=n?bc(i,n,a,r):i;return!e||!l?dt(s,t,c):Ec(s,c,t)}}}function Cc(i){if(i!==void 0)return 0}function Qh(i){if(i!==void 0)return i}function Dy(i){const t=2*Math.PI/i;return function(e,n){if(n)return e;if(e!==void 0)return e=Math.floor(e/t+.5)*t,e}}function Fy(i){const t=bn(5);return function(e,n){return n||e===void 0?e:Math.abs(e)<=t?0:e}}const Ny=42,xc=256,ba=0;class Re extends $e{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=sc(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&Hm(),t.center&&(t.center=qe(t.center,this.projection_)),t.extent&&(t.extent=yn(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){const e=Object.assign({},t);for(const a in me)delete e[a];this.setProperties(e,!0);const n=Vy(t);this.maxResolution_=n.maxResolution,this.minResolution_=n.minResolution,this.zoomFactor_=n.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=n.minZoom;const r=$y(t),s=n.constraint,o=zy(t);this.constraints_={center:r,resolution:s,rotation:o},this.setRotation(t.rotation!==void 0?t.rotation:0),this.setCenterInternal(t.center!==void 0?t.center:null),t.resolution!==void 0?this.setResolution(t.resolution):t.zoom!==void 0&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;const n=this.getCenterInternal();if(n){const r=t||[0,0,0,0];e=e||[0,0,0,0];const s=this.getResolution(),o=s/2*(r[3]-e[3]+e[1]-r[1]),a=s/2*(r[0]-e[0]+e[2]-r[2]);this.setCenterInternal([n[0]+o,n[1]-a])}}getUpdatedOptions_(t){const e=this.getProperties();return e.resolution!==void 0?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const e=new Array(arguments.length);for(let n=0;n<e.length;++n){let r=arguments[n];r.center&&(r=Object.assign({},r),r.center=qe(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=qe(r.anchor,this.getProjection())),e[n]=r}this.animateInternal.apply(this,e)}animateInternal(t){let e=arguments.length,n;e>1&&typeof arguments[e-1]=="function"&&(n=arguments[e-1],--e);let r=0;for(;r<e&&!this.isDef();++r){const h=arguments[r];h.center&&this.setCenterInternal(h.center),h.zoom!==void 0?this.setZoom(h.zoom):h.resolution&&this.setResolution(h.resolution),h.rotation!==void 0&&this.setRotation(h.rotation)}if(r===e){n&&xs(n,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,l=this.targetRotation_;const c=[];for(;r<e;++r){const h=arguments[r],u={start:s,complete:!1,anchor:h.anchor,duration:h.duration!==void 0?h.duration:1e3,easing:h.easing||Ly,callback:n};if(h.center&&(u.sourceCenter=o,u.targetCenter=h.center.slice(),o=u.targetCenter),h.zoom!==void 0?(u.sourceResolution=a,u.targetResolution=this.getResolutionForZoom(h.zoom),a=u.targetResolution):h.resolution&&(u.sourceResolution=a,u.targetResolution=h.resolution,a=u.targetResolution),h.rotation!==void 0){u.sourceRotation=l;const d=Mi(h.rotation-l+Math.PI,2*Math.PI)-Math.PI;u.targetRotation=l+d,l=u.targetRotation}Gy(u)?u.complete=!0:s+=u.duration,c.push(u)}this.animations_.push(c),this.setHint(Ft.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Ft.ANIMATING]>0}getInteracting(){return this.hints_[Ft.INTERACTING]>0}cancelAnimations(){this.setHint(Ft.ANIMATING,-this.hints_[Ft.ANIMATING]);let t;for(let e=0,n=this.animations_.length;e<n;++e){const r=this.animations_[e];if(r[0].callback&&xs(r[0].callback,!1),!t)for(let s=0,o=r.length;s<o;++s){const a=r[s];if(!a.complete){t=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let e=!1;for(let n=this.animations_.length-1;n>=0;--n){const r=this.animations_[n];let s=!0;for(let o=0,a=r.length;o<a;++o){const l=r[o];if(l.complete)continue;const c=t-l.start;let h=l.duration>0?c/l.duration:1;h>=1?(l.complete=!0,h=1):s=!1;const u=l.easing(h);if(l.sourceCenter){const d=l.sourceCenter[0],f=l.sourceCenter[1],m=l.targetCenter[0],v=l.targetCenter[1];this.nextCenter_=l.targetCenter;const w=d+u*(m-d),E=f+u*(v-f);this.targetCenter_=[w,E]}if(l.sourceResolution&&l.targetResolution){const d=u===1?l.targetResolution:l.sourceResolution+u*(l.targetResolution-l.sourceResolution);if(l.anchor){const f=this.getViewportSize_(this.getRotation()),m=this.constraints_.resolution(d,0,f,!0);this.targetCenter_=this.calculateCenterZoom(m,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=d,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){const d=u===1?Mi(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+u*(l.targetRotation-l.sourceRotation);if(l.anchor){const f=this.constraints_.rotation(d,!0);this.targetCenter_=this.calculateCenterRotate(f,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=d}if(this.applyTargetState_(!0),e=!0,!l.complete)break}if(s){this.animations_[n]=null,this.setHint(Ft.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=r[0].callback;o&&xs(o,!0)}}this.animations_=this.animations_.filter(Boolean),e&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let n;const r=this.getCenterInternal();return r!==void 0&&(n=[r[0]-e[0],r[1]-e[1]],Ql(n,t-this.getRotation()),Em(n,e)),n}calculateCenterZoom(t,e){let n;const r=this.getCenterInternal(),s=this.getResolution();if(r!==void 0&&s!==void 0){const o=e[0]-t*(e[0]-r[0])/s,a=e[1]-t*(e[1]-r[1])/s;n=[o,a]}return n}getViewportSize_(t){const e=this.viewportSize_;if(t){const n=e[0],r=e[1];return[Math.abs(n*Math.cos(t))+Math.abs(r*Math.sin(t)),Math.abs(n*Math.sin(t))+Math.abs(r*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t&&al(t,this.getProjection())}getCenterInternal(){return this.get(me.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return t!==void 0?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){const e=this.calculateExtentInternal(t);return js(e,this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();const e=this.getCenterInternal();it(e,"The view center is not defined");const n=this.getResolution();it(n!==void 0,"The view resolution is not defined");const r=this.getRotation();return it(r!==void 0,"The view rotation is not defined"),el(e,n,r,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(me.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(yn(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();const n=ot(t)/e[0],r=Ut(t)/e[1];return Math.max(n,r)}getResolutionForValueFunction(t){t=t||2;const e=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,r=Math.log(e/n)/Math.log(t);return function(s){return e/Math.pow(t,s*r)}}getRotation(){return this.get(me.ROTATION)}getValueForResolutionFunction(t){const e=Math.log(t||2),n=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,s=Math.log(n/r)/e;return function(o){return Math.log(n/o)/e/s}}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);const n=this.padding_;return n&&(e=[e[0]-n[1]-n[3],e[1]-n[0]-n[2]]),e}getState(){const t=this.getProjection(),e=this.getResolution(),n=this.getRotation();let r=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();r=Ea(r,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],e,n)}return{center:r.slice(0),projection:t!==void 0?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:n,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t;const e=this.getResolution();return e!==void 0&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e=this.minZoom_||0,n,r;if(this.resolutions_){const s=Hl(this.resolutions_,t,1);e=s,n=this.resolutions_[s],s==this.resolutions_.length-1?r=2:r=n/this.resolutions_[s+1]}else n=this.maxResolution_,r=this.zoomFactor_;return e+Math.log(n/t)/Math.log(r)}getResolutionForZoom(t){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const e=dt(Math.floor(t),0,this.resolutions_.length-2),n=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(n,dt(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let n;if(it(Array.isArray(t)||typeof t.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(t)){it(!es(t),"Cannot fit empty extent provided as `geometry`");const r=yn(t,this.getProjection());n=hl(r)}else if(t.getType()==="Circle"){const r=yn(t.getExtent(),this.getProjection());n=hl(r),n.rotate(this.getRotation(),tn(r))}else{const r=Bs();r?n=t.clone().transform(r,this.getProjection()):n=t}this.fitInternal(n,e)}rotatedExtentForGeometry(t){const e=this.getRotation(),n=Math.cos(e),r=Math.sin(-e),s=t.getFlatCoordinates(),o=t.getStride();let a=1/0,l=1/0,c=-1/0,h=-1/0;for(let u=0,d=s.length;u<d;u+=o){const f=s[u]*n-s[u+1]*r,m=s[u]*r+s[u+1]*n;a=Math.min(a,f),l=Math.min(l,m),c=Math.max(c,f),h=Math.max(h,m)}return[a,l,c,h]}fitInternal(t,e){e=e||{};let n=e.size;n||(n=this.getViewportSizeMinusPadding_());const r=e.padding!==void 0?e.padding:[0,0,0,0],s=e.nearest!==void 0?e.nearest:!1;let o;e.minResolution!==void 0?o=e.minResolution:e.maxZoom!==void 0?o=this.getResolutionForZoom(e.maxZoom):o=0;const a=this.rotatedExtentForGeometry(t);let l=this.getResolutionForExtentInternal(a,[n[0]-r[1]-r[3],n[1]-r[0]-r[2]]);l=isNaN(l)?o:Math.max(l,o),l=this.getConstrainedResolution(l,s?0:1);const c=this.getRotation(),h=Math.sin(c),u=Math.cos(c),d=tn(a);d[0]+=(r[1]-r[3])/2*l,d[1]+=(r[0]-r[2])/2*l;const f=d[0]*u-d[1]*h,m=d[1]*u+d[0]*h,v=this.getConstrainedCenter([f,m],l),w=e.callback?e.callback:Mr;e.duration!==void 0?this.animateInternal({resolution:l,center:v,duration:e.duration,easing:e.easing},w):(this.targetResolution_=l,this.targetCenter_=v,this.applyTargetState_(!1,!0),xs(w,!0))}centerOn(t,e,n){this.centerOnInternal(qe(t,this.getProjection()),e,n)}centerOnInternal(t,e,n){this.setCenterInternal(Ea(t,e,n,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,n,r){let s;const o=this.padding_;if(o&&t){const a=this.getViewportSizeMinusPadding_(-n),l=Ea(t,r,[a[0]/2+o[3],a[1]/2+o[0]],e,n);s=[t[0]-l[0],t[1]-l[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(t){const e=al(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){const e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&qe(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){const n=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*t,0,r,n);e&&(this.targetCenter_=this.calculateCenterZoom(s,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=qe(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){const n=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+t,n);e&&(this.targetCenter_=this.calculateCenterRotate(r,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t&&qe(t,this.getProjection()))}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){const n=this.getAnimating()||this.getInteracting()||e,r=this.constraints_.rotation(this.targetRotation_,n),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,s,n),a=this.constraints_.center(this.targetCenter_,o,s,n,this.calculateCenterShift(this.targetCenter_,o,r,s));this.get(me.ROTATION)!==r&&this.set(me.ROTATION,r),this.get(me.RESOLUTION)!==o&&(this.set(me.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(me.CENTER)||!zs(this.get(me.CENTER),a))&&this.set(me.CENTER,a),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,n){t=t!==void 0?t:200;const r=e||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),a=this.constraints_.resolution(this.targetResolution_,r,o),l=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,s,o));if(t===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=s,this.targetCenter_=l,this.applyTargetState_();return}n=n||(t===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==s||!this.getCenterInternal()||!zs(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:l,resolution:a,duration:t,easing:tr,anchor:n}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Ft.INTERACTING,1)}endInteraction(t,e,n){n=n&&qe(n,this.getProjection()),this.endInteractionInternal(t,e,n)}endInteractionInternal(t,e,n){this.getInteracting()&&(this.setHint(Ft.INTERACTING,-1),this.resolveConstraints(t,e,n))}getConstrainedCenter(t,e){const n=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),n)}getConstrainedZoom(t,e){const n=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(n,e))}getConstrainedResolution(t,e){e=e||0;const n=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,n)}}function xs(i,t){setTimeout(function(){i(t)},0)}function $y(i){if(i.extent!==void 0){const e=i.smoothExtentConstraint!==void 0?i.smoothExtentConstraint:!0;return Zh(i.extent,i.constrainOnlyCenter,e)}const t=sc(i.projection,"EPSG:3857");if(i.multiWorld!==!0&&t.isGlobal()){const e=t.getExtent().slice();return e[0]=-1/0,e[2]=1/0,Zh(e,!1,!1)}return Py}function Vy(i){let t,e,n,o=i.minZoom!==void 0?i.minZoom:ba,a=i.maxZoom!==void 0?i.maxZoom:28;const l=i.zoomFactor!==void 0?i.zoomFactor:2,c=i.multiWorld!==void 0?i.multiWorld:!1,h=i.smoothResolutionConstraint!==void 0?i.smoothResolutionConstraint:!0,u=i.showFullExtent!==void 0?i.showFullExtent:!1,d=sc(i.projection,"EPSG:3857"),f=d.getExtent();let m=i.constrainOnlyCenter,v=i.extent;if(!c&&!v&&d.isGlobal()&&(m=!1,v=f),i.resolutions!==void 0){const w=i.resolutions;e=w[o],n=w[a]!==void 0?w[a]:w[w.length-1],i.constrainResolution?t=Oy(w,h,!m&&v,u):t=Jh(e,n,h,!m&&v,u)}else{const E=(f?Math.max(ot(f),Ut(f)):360*tc.degrees/d.getMetersPerUnit())/xc/Math.pow(2,ba),I=E/Math.pow(2,28-ba);e=i.maxResolution,e!==void 0?o=0:e=E/Math.pow(l,o),n=i.minResolution,n===void 0&&(i.maxZoom!==void 0?i.maxResolution!==void 0?n=e/Math.pow(l,a):n=E/Math.pow(l,a):n=I),a=o+Math.floor(Math.log(e/n)/Math.log(l)),n=e/Math.pow(l,a-o),i.constrainResolution?t=ky(l,e,n,h,!m&&v,u):t=Jh(e,n,h,!m&&v,u)}return{constraint:t,maxResolution:e,minResolution:n,minZoom:o,zoomFactor:l}}function zy(i){if(i.enableRotation!==void 0?i.enableRotation:!0){const e=i.constrainRotation;return e===void 0||e===!0?Fy():e===!1?Qh:typeof e=="number"?Dy(e):Qh}return Cc}function Gy(i){return!(i.sourceCenter&&i.targetCenter&&!zs(i.sourceCenter,i.targetCenter)||i.sourceResolution!==i.targetResolution||i.sourceRotation!==i.targetRotation)}function Ea(i,t,e,n,r){const s=Math.cos(-r);let o=Math.sin(-r),a=i[0]*s-i[1]*o,l=i[1]*s+i[0]*o;a+=(t[0]/2-e[0])*n,l+=(e[1]-t[1]/2)*n,o=-o;const c=a*s-l*o,h=l*s+a*o;return[c,h]}const Ss="ol-hidden",Do="ol-unselectable",Sc="ol-control",tu="ol-collapsed",Uy=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),eu=["style","variant","weight","size","lineHeight","family"],ml={normal:400,bold:700},_l=function(i){const t=i.match(Uy);if(!t)return null;const e={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let n=0,r=eu.length;n<r;++n){const s=t[n+1];s!==void 0&&(e[eu[n]]=typeof s=="string"?s.trim():s)}return isNaN(Number(e.weight))&&e.weight in ml&&(e.weight=ml[e.weight]),e.families=e.family.split(/,\s?/).map(n=>n.trim().replace(/^['"]|['"]$/g,"")),e};function xt(i,t,e,n){let r;return e&&e.length?r=e.shift():vc?r=new OffscreenCanvas(i||300,t||300):r=document.createElement("canvas"),i&&(r.width=i),t&&(r.height=t),r.getContext("2d",n)}let Ca;function Ks(){return Ca||(Ca=xt(1,1)),Ca}function Fo(i){const t=i.canvas;t.width=1,t.height=1,i.clearRect(0,0,1,1)}function nu(i,t){const e=t.parentNode;e&&e.replaceChild(i,t)}function By(i){for(;i.lastChild;)i.lastChild.remove()}function jy(i,t){const e=i.childNodes;for(let n=0;;++n){const r=e[n],s=t[n];if(!r&&!s)break;if(r!==s){if(!r){i.appendChild(s);continue}if(!s){i.removeChild(r),--n;continue}i.insertBefore(s,r)}}}class Ic extends $e{constructor(t){super();const e=t.element;e&&!t.target&&!e.style.pointerEvents&&(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(t){this.map_&&this.element?.remove();for(let e=0,n=this.listenerKeys.length;e<n;++e)ct(this.listenerKeys[e]);if(this.listenerKeys.length=0,this.map_=t,t){const e=this.target_??t.getOverlayContainerStopEvent();this.element&&e.appendChild(this.element),this.render!==Mr&&this.listenerKeys.push(tt(t,gn.POSTRENDER,this.render,this)),t.render()}}render(t){}setTarget(t){this.target_=typeof t=="string"?document.getElementById(t):t}}class Wy extends Ic{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=t.collapsed!==void 0?t.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=t.collapsible!==void 0,this.collapsible_=t.collapsible!==void 0?t.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=t.attributions;const e=t.className!==void 0?t.className:"ol-attribution",n=t.tipLabel!==void 0?t.tipLabel:"Attributions",r=t.expandClassName!==void 0?t.expandClassName:e+"-expand",s=t.collapseLabel!==void 0?t.collapseLabel:"›",o=t.collapseClassName!==void 0?t.collapseClassName:e+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const a=t.label!==void 0?t.label:"i";typeof a=="string"?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=r):this.label_=a;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=n,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(W.CLICK,this.handleClick_.bind(this),!1);const c=e+" "+Do+" "+Sc+(this.collapsed_&&this.collapsible_?" "+tu:"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=c,h.appendChild(this.toggleButton_),h.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(t){const e=this.getMap().getAllLayers(),n=new Set(e.flatMap(r=>r.getAttributions(t)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(r=>n.add(r)):n.add(this.attributions_)),!this.overrideCollapsible_){const r=!e.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(r)}return Array.from(n)}async updateElement_(t){if(!t){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const e=await Promise.all(this.collectSourceAttributions_(t).map(r=>vm(()=>r))),n=e.length>0;if(this.renderedVisible_!=n&&(this.element.style.display=n?"":"none",this.renderedVisible_=n),!Pn(e,this.renderedAttributions_)){By(this.ulElement_);for(let r=0,s=e.length;r<s;++r){const o=document.createElement("li");o.innerHTML=e[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=e}}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(tu),this.collapsed_?nu(this.collapseLabel_,this.label_):nu(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(t){this.userCollapsed_=t,!(!this.collapsible_||this.collapsed_===t)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}}class qy extends Ic{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target});const e=t.className!==void 0?t.className:"ol-rotate",n=t.label!==void 0?t.label:"⇧",r=t.compassClassName!==void 0?t.compassClassName:"ol-compass";this.label_=null,typeof n=="string"?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=n):(this.label_=n,this.label_.classList.add(r));const s=t.tipLabel?t.tipLabel:"Reset rotation",o=document.createElement("button");o.className=e+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(W.CLICK,this.handleClick_.bind(this),!1);const a=e+" "+Do+" "+Sc,l=this.element;l.className=a,l.appendChild(o),this.callResetNorth_=t.resetNorth?t.resetNorth:void 0,this.duration_=t.duration!==void 0?t.duration:250,this.autoHide_=t.autoHide!==void 0?t.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Ss)}handleClick_(t){t.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const e=this.getMap().getView();if(!e)return;const n=e.getRotation();n!==void 0&&(this.duration_>0&&n%(2*Math.PI)!==0?e.animate({rotation:0,duration:this.duration_,easing:tr}):e.setRotation(0))}render(t){const e=t.frameState;if(!e)return;const n=e.viewState.rotation;if(n!=this.rotation_){const r="rotate("+n+"rad)";if(this.autoHide_){const s=this.element.classList.contains(Ss);!s&&n===0?this.element.classList.add(Ss):s&&n!==0&&this.element.classList.remove(Ss)}this.label_.style.transform=r}this.rotation_=n}}class Xy extends Ic{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target});const e=t.className!==void 0?t.className:"ol-zoom",n=t.delta!==void 0?t.delta:1,r=t.zoomInClassName!==void 0?t.zoomInClassName:e+"-in",s=t.zoomOutClassName!==void 0?t.zoomOutClassName:e+"-out",o=t.zoomInLabel!==void 0?t.zoomInLabel:"+",a=t.zoomOutLabel!==void 0?t.zoomOutLabel:"–",l=t.zoomInTipLabel!==void 0?t.zoomInTipLabel:"Zoom in",c=t.zoomOutTipLabel!==void 0?t.zoomOutTipLabel:"Zoom out",h=document.createElement("button");h.className=r,h.setAttribute("type","button"),h.title=l,h.appendChild(typeof o=="string"?document.createTextNode(o):o),h.addEventListener(W.CLICK,this.handleClick_.bind(this,n),!1);const u=document.createElement("button");u.className=s,u.setAttribute("type","button"),u.title=c,u.appendChild(typeof a=="string"?document.createTextNode(a):a),u.addEventListener(W.CLICK,this.handleClick_.bind(this,-n),!1);const d=e+" "+Do+" "+Sc,f=this.element;f.className=d,f.appendChild(h),f.appendChild(u),this.duration_=t.duration!==void 0?t.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){const n=this.getMap().getView();if(!n)return;const r=n.getZoom();if(r!==void 0){const s=n.getConstrainedZoom(r+t);this.duration_>0?(n.getAnimating()&&n.cancelAnimations(),n.animate({zoom:s,duration:this.duration_,easing:tr})):n.setZoom(s)}}}function Ky(i){i=i||{};const t=new Le;return(i.zoom!==void 0?i.zoom:!0)&&t.push(new Xy(i.zoomOptions)),(i.rotate!==void 0?i.rotate:!0)&&t.push(new qy(i.rotateOptions)),(i.attribution!==void 0?i.attribution:!0)&&t.push(new Wy(i.attributionOptions)),t}class Hy{constructor(t,e,n){this.decay_=t,this.minVelocity_=e,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;const t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;let n=e-3;for(;n>0&&this.points_[n+2]>t;)n-=3;const r=this.points_[e+2]-this.points_[n+2];if(r<1e3/60)return!1;const s=this.points_[e]-this.points_[n],o=this.points_[e+1]-this.points_[n+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const iu={ACTIVE:"active"};class cs extends $e{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(iu.ACTIVE)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(iu.ACTIVE,t)}setMap(t){this.map_=t}}function Yy(i,t,e){const n=i.getCenterInternal();if(n){const r=[n[0]+t[0],n[1]+t[1]];i.animateInternal({duration:e!==void 0?e:250,easing:My,center:i.getConstrainedCenter(r)})}}function Tc(i,t,e,n){const r=i.getZoom();if(r===void 0)return;const s=i.getConstrainedZoom(r+t),o=i.getResolutionForZoom(s);i.getAnimating()&&i.cancelAnimations(),i.animate({resolution:o,anchor:e,duration:n!==void 0?n:250,easing:tr})}class Zy extends cs{constructor(t){super(),t=t||{},this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:250}handleEvent(t){let e=!1;if(t.type==gt.DBLCLICK){const n=t.originalEvent,r=t.map,s=t.coordinate,o=n.shiftKey?-this.delta_:this.delta_,a=r.getView();Tc(a,o,s,this.duration_),n.preventDefault(),e=!0}return!e}}function yl(i){const t=arguments;return function(e){let n=!0;for(let r=0,s=t.length;r<s&&(n=n&&t[r](e),!!n);++r);return n}}const Jy=function(i){const t=i.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},Qy=function(i){const t=i.map.getTargetElement(),e=t.getRootNode(),n=i.map.getOwnerDocument().activeElement;return e instanceof ShadowRoot?e.host.contains(n):t.contains(n)},Df=function(i){const t=i.map.getTargetElement(),e=t.getRootNode();return(e instanceof ShadowRoot?e.host:t).hasAttribute("tabindex")?Qy(i):!0},t0=Lr,Ff=function(i){const t=i.originalEvent;return"pointerId"in t&&t.button==0&&!(xy&&Lf&&t.ctrlKey)},Nf=function(i){const t=i.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},e0=function(i){const t=i.originalEvent;return Lf?t.metaKey:t.ctrlKey},n0=function(i){const t=i.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},$f=function(i){const t=i.originalEvent,e=t.target.tagName;return e!=="INPUT"&&e!=="SELECT"&&e!=="TEXTAREA"&&!t.target.isContentEditable},xa=function(i){const t=i.originalEvent;return"pointerId"in t&&t.pointerType=="mouse"},i0=function(i){const t=i.originalEvent;return"pointerId"in t&&t.isPrimary&&t.button===0};class hs extends cs{constructor(t){t=t||{},super(t),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==gt.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==gt.POINTERUP){const n=this.handleUpEvent(t);this.handlingDownUpSequence=n&&this.targetPointers.length>0}}else if(t.type==gt.POINTERDOWN){const n=this.handleDownEvent(t);this.handlingDownUpSequence=n,e=this.stopDown(n)}else t.type==gt.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}}function Rc(i){const t=i.length;let e=0,n=0;for(let r=0;r<t;r++)e+=i[r].clientX,n+=i[r].clientY;return{clientX:e/t,clientY:n/t}}class r0 extends hs{constructor(t){super({stopDown:xo}),t=t||{},this.kinetic_=t.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const e=t.condition?t.condition:yl(Nf,i0);this.condition_=t.onFocusOnly?yl(Df,e):e,this.noKinetic_=!1}handleDragEvent(t){const e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());const n=this.targetPointers,r=e.getEventPixel(Rc(n));if(n.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const s=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],a=t.map.getView();Cm(s,a.getResolution()),Ql(s,a.getRotation()),a.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=n.length,t.originalEvent.preventDefault()}handleUpEvent(t){const e=t.map,n=e.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=n.getCenterInternal(),a=e.getPixelFromCoordinateInternal(o),l=e.getCoordinateFromPixelInternal([a[0]-r*Math.cos(s),a[1]-r*Math.sin(s)]);n.animateInternal({center:n.getConstrainedCenter(l),duration:500,easing:tr})}return this.panning_&&(this.panning_=!1,n.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(t){if(this.targetPointers.length>0&&this.condition_(t)){const n=t.map.getView();return this.lastCentroid=null,n.getAnimating()&&n.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class s0 extends hs{constructor(t){t=t||{},super({stopDown:xo}),this.condition_=t.condition?t.condition:Jy,this.lastAngle_=void 0,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){if(!xa(t))return;const e=t.map,n=e.getView();if(n.getConstraints().rotation===Cc)return;const r=e.getSize(),s=t.pixel,o=Math.atan2(r[1]/2-s[1],s[0]-r[0]/2);if(this.lastAngle_!==void 0){const a=o-this.lastAngle_;n.adjustRotationInternal(-a)}this.lastAngle_=o}handleUpEvent(t){return xa(t)?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){return xa(t)&&Ff(t)&&this.condition_(t)?(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class o0 extends Co{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const t=this.startPixel_,e=this.endPixel_,n="px",r=this.element_.style;r.left=Math.min(t[0],e[0])+n,r.top=Math.min(t[1],e[1])+n,r.width=Math.abs(e[0]-t[0])+n,r.height=Math.abs(e[1]-t[1])+n}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const e=this.element_.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const t=this.startPixel_,e=this.endPixel_,r=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new In([r])}getGeometry(){return this.geometry_}}const vi={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class dr extends on{constructor(t,e,n){super(t),this.coordinate=e,this.mapBrowserEvent=n}}class a0 extends hs{constructor(t){super(),this.on,this.once,this.un,t=t??{},this.box_=new o0(t.className||"ol-dragbox"),this.minArea_=t.minArea??64,t.onBoxEnd&&(this.onBoxEnd=t.onBoxEnd),this.startPixel_=null,this.condition_=t.condition??Ff,this.boxEndCondition_=t.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,n){const r=n[0]-e[0],s=n[1]-e[1];return r*r+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.startPixel_&&(this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new dr(vi.BOXDRAG,t.coordinate,t)))}handleUpEvent(t){if(!this.startPixel_)return!1;const e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new dr(e?vi.BOXEND:vi.BOXCANCEL,t.coordinate,t)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(t){return this.condition_(t)?(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new dr(vi.BOXSTART,t.coordinate,t)),!0):!1}onBoxEnd(t){}setActive(t){t||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new dr(vi.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(t)}setMap(t){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new dr(vi.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(t)}}class l0 extends a0{constructor(t){t=t||{};const e=t.condition?t.condition:n0;super({condition:e,className:t.className||"ol-dragzoom",minArea:t.minArea}),this.duration_=t.duration!==void 0?t.duration:200,this.out_=t.out!==void 0?t.out:!1}onBoxEnd(t){const n=this.getMap().getView();let r=this.getGeometry();if(this.out_){const s=n.rotatedExtentForGeometry(r),o=n.getResolutionForExtentInternal(s),a=n.getResolution()/o;r=r.clone(),r.scale(a*a)}n.fitInternal(r,{duration:this.duration_,easing:tr})}}const Fn={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class c0 extends cs{constructor(t){super(),t=t||{},this.defaultCondition_=function(e){return Nf(e)&&$f(e)},this.condition_=t.condition!==void 0?t.condition:this.defaultCondition_,this.duration_=t.duration!==void 0?t.duration:100,this.pixelDelta_=t.pixelDelta!==void 0?t.pixelDelta:128}handleEvent(t){let e=!1;if(t.type==W.KEYDOWN){const n=t.originalEvent,r=n.key;if(this.condition_(t)&&(r==Fn.DOWN||r==Fn.LEFT||r==Fn.RIGHT||r==Fn.UP)){const o=t.map.getView(),a=o.getResolution()*this.pixelDelta_;let l=0,c=0;r==Fn.DOWN?c=-a:r==Fn.LEFT?l=-a:r==Fn.RIGHT?l=a:c=a;const h=[l,c];Ql(h,o.getRotation()),Yy(o,h,this.duration_),n.preventDefault(),e=!0}}return!e}}class h0 extends cs{constructor(t){super(),t=t||{},this.condition_=t.condition?t.condition:function(e){return!e0(e)&&$f(e)},this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:100}handleEvent(t){let e=!1;if(t.type==W.KEYDOWN||t.type==W.KEYPRESS){const n=t.originalEvent,r=n.key;if(this.condition_(t)&&(r==="+"||r==="-")){const s=t.map,o=r==="+"?this.delta_:-this.delta_,a=s.getView();Tc(a,o,void 0,this.duration_),n.preventDefault(),e=!0}}return!e}}const u0=40,d0=300;class f0 extends cs{constructor(t){t=t||{},super(t),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=t.maxDelta!==void 0?t.maxDelta:1,this.duration_=t.duration!==void 0?t.duration:250,this.timeout_=t.timeout!==void 0?t.timeout:80,this.useAnchor_=t.useAnchor!==void 0?t.useAnchor:!0,this.constrainResolution_=t.constrainResolution!==void 0?t.constrainResolution:!1;const e=t.condition?t.condition:t0;this.condition_=t.onFocusOnly?yl(Df,e):e,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const t=this.getMap();if(!t)return;t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?t.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(t){if(!this.condition_(t)||t.type!==W.WHEEL)return!0;const n=t.map,r=t.originalEvent;r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.pixel);let s=r.deltaY;switch(r.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=u0;break;case WheelEvent.DOM_DELTA_PAGE:s*=d0;break}if(s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const a=n.getView();if(this.mode_==="trackpad"&&!(a.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(a.getAnimating()&&a.cancelAnimations(),a.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),a.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?n.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=s;const l=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,n),l),!1}handleWheelZoom_(t){const e=t.getView();e.getAnimating()&&e.cancelAnimations();let n=-dt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(n=n?n>0?1:-1:0),Tc(e,n,this.lastAnchor_?t.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}}class g0 extends hs{constructor(t){t=t||{};const e=t;e.stopDown||(e.stopDown=xo),super(e),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=t.threshold!==void 0?t.threshold:.3,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){let e=0;const n=this.targetPointers[0],r=this.targetPointers[1],s=Math.atan2(r.clientY-n.clientY,r.clientX-n.clientX);if(this.lastAngle_!==void 0){const l=s-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=l}this.lastAngle_=s;const o=t.map,a=o.getView();a.getConstraints().rotation!==Cc&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(Rc(this.targetPointers))),this.rotating_&&(o.render(),a.adjustRotationInternal(e,this.anchor_)))}handleUpEvent(t){return this.targetPointers.length<2?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}class p0 extends hs{constructor(t){t=t||{};const e=t;e.stopDown||(e.stopDown=xo),super(e),this.anchor_=null,this.duration_=t.duration!==void 0?t.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1;const n=this.targetPointers[0],r=this.targetPointers[1],s=n.clientX-r.clientX,o=n.clientY-r.clientY,a=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(e=this.lastDistance_/a),this.lastDistance_=a;const l=t.map,c=l.getView();e!=1&&(this.lastScaleDelta_=e),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(Rc(this.targetPointers))),l.render(),c.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){if(this.targetPointers.length<2){const n=t.map.getView(),r=this.lastScaleDelta_>1?1:-1;return n.endInteraction(this.duration_,r),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}function m0(i){i=i||{};const t=new Le,e=new Hy(-.005,.05,100);return(i.altShiftDragRotate!==void 0?i.altShiftDragRotate:!0)&&t.push(new s0),(i.doubleClickZoom!==void 0?i.doubleClickZoom:!0)&&t.push(new Zy({delta:i.zoomDelta,duration:i.zoomDuration})),(i.dragPan!==void 0?i.dragPan:!0)&&t.push(new r0({onFocusOnly:i.onFocusOnly,kinetic:e})),(i.pinchRotate!==void 0?i.pinchRotate:!0)&&t.push(new g0),(i.pinchZoom!==void 0?i.pinchZoom:!0)&&t.push(new p0({duration:i.zoomDuration})),(i.keyboard!==void 0?i.keyboard:!0)&&(t.push(new c0),t.push(new h0({delta:i.zoomDelta,duration:i.zoomDuration}))),(i.mouseWheelZoom!==void 0?i.mouseWheelZoom:!0)&&t.push(new f0({onFocusOnly:i.onFocusOnly,duration:i.zoomDuration})),(i.shiftDragZoom!==void 0?i.shiftDragZoom:!0)&&t.push(new l0({duration:i.zoomDuration})),t}const st={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class Vf extends $e{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;const e=Object.assign({},t);typeof t.properties=="object"&&(delete e.properties,Object.assign(e,t.properties)),e[st.OPACITY]=t.opacity!==void 0?t.opacity:1,it(typeof e[st.OPACITY]=="number","Layer opacity must be a number"),e[st.VISIBLE]=t.visible!==void 0?t.visible:!0,e[st.Z_INDEX]=t.zIndex,e[st.MAX_RESOLUTION]=t.maxResolution!==void 0?t.maxResolution:1/0,e[st.MIN_RESOLUTION]=t.minResolution!==void 0?t.minResolution:0,e[st.MIN_ZOOM]=t.minZoom!==void 0?t.minZoom:-1/0,e[st.MAX_ZOOM]=t.maxZoom!==void 0?t.maxZoom:1/0,this.className_=e.className!==void 0?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){const e=this.state_||{layer:this,managed:t===void 0?!0:t},n=this.getZIndex();return e.opacity=dt(Math.round(this.getOpacity()*100)/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=n===void 0&&!e.managed?1/0:n,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return U()}getLayerStatesArray(t){return U()}getExtent(){return this.get(st.EXTENT)}getMaxResolution(){return this.get(st.MAX_RESOLUTION)}getMinResolution(){return this.get(st.MIN_RESOLUTION)}getMinZoom(){return this.get(st.MIN_ZOOM)}getMaxZoom(){return this.get(st.MAX_ZOOM)}getOpacity(){return this.get(st.OPACITY)}getSourceState(){return U()}getVisible(){return this.get(st.VISIBLE)}getZIndex(){return this.get(st.Z_INDEX)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(st.EXTENT,t)}setMaxResolution(t){this.set(st.MAX_RESOLUTION,t)}setMinResolution(t){this.set(st.MIN_RESOLUTION,t)}setMaxZoom(t){this.set(st.MAX_ZOOM,t)}setMinZoom(t){this.set(st.MIN_ZOOM,t)}setOpacity(t){it(typeof t=="number","Layer opacity must be a number"),this.set(st.OPACITY,t)}setVisible(t){this.set(st.VISIBLE,t)}setZIndex(t){this.set(st.Z_INDEX,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class pn extends on{constructor(t,e){super(t),this.layer=e}}const Sa={LAYERS:"layers"};class er extends Vf{constructor(t){t=t||{};const e=Object.assign({},t);delete e.layers;let n=t.layers;super(e),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(Sa.LAYERS,this.handleLayersChanged_),n?Array.isArray(n)?n=new Le(n.slice(),{unique:!0}):it(typeof n.getArray=="function","Expected `layers` to be an array or a `Collection`"):n=new Le(void 0,{unique:!0}),this.setLayers(n)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(ct),this.layersListenerKeys_.length=0;const t=this.getLayers();this.layersListenerKeys_.push(tt(t,jt.ADD,this.handleLayersAdd_,this),tt(t,jt.REMOVE,this.handleLayersRemove_,this));for(const n in this.listenerKeys_)this.listenerKeys_[n].forEach(ct);ns(this.listenerKeys_);const e=t.getArray();for(let n=0,r=e.length;n<r;n++){const s=e[n];this.registerLayerListeners_(s),this.dispatchEvent(new pn("addlayer",s))}this.changed()}registerLayerListeners_(t){const e=[tt(t,Vi.PROPERTYCHANGE,this.handleLayerChange_,this),tt(t,W.CHANGE,this.handleLayerChange_,this)];t instanceof er&&e.push(tt(t,"addlayer",this.handleLayerGroupAdd_,this),tt(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[et(t)]=e}handleLayerGroupAdd_(t){this.dispatchEvent(new pn("addlayer",t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new pn("removelayer",t.layer))}handleLayersAdd_(t){const e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new pn("addlayer",e)),this.changed()}handleLayersRemove_(t){const e=t.element,n=et(e);this.listenerKeys_[n].forEach(ct),delete this.listenerKeys_[n],this.dispatchEvent(new pn("removelayer",e)),this.changed()}getLayers(){return this.get(Sa.LAYERS)}setLayers(t){const e=this.getLayers();if(e){const n=e.getArray();for(let r=0,s=n.length;r<s;++r)this.dispatchEvent(new pn("removelayer",n[r]))}this.set(Sa.LAYERS,t)}getLayersArray(t){return t=t!==void 0?t:[],this.getLayers().forEach(function(e){e.getLayersArray(t)}),t}getLayerStatesArray(t){const e=t!==void 0?t:[],n=e.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(e)});const r=this.getLayerState();let s=r.zIndex;!t&&r.zIndex===void 0&&(s=0);for(let o=n,a=e.length;o<a;o++){const l=e[o];l.opacity*=r.opacity,l.visible=l.visible&&r.visible,l.maxResolution=Math.min(l.maxResolution,r.maxResolution),l.minResolution=Math.max(l.minResolution,r.minResolution),l.minZoom=Math.max(l.minZoom,r.minZoom),l.maxZoom=Math.min(l.maxZoom,r.maxZoom),r.extent!==void 0&&(l.extent!==void 0?l.extent=Kn(l.extent,r.extent):l.extent=r.extent),l.zIndex===void 0&&(l.zIndex=s)}return e}getSourceState(){return"ready"}}const ce={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"};class No extends Vf{constructor(t){const e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(st.SOURCE,this.handleSourcePropertyChange_);const n=t.source?t.source:null;this.setSource(n)}getLayersArray(t){return t=t||[],t.push(this),t}getLayerStatesArray(t){return t=t||[],t.push(this.getLayerState()),t}getSource(){return this.get(st.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(ct(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const t=this.getSource();t&&(this.sourceChangeKey_=tt(t,W.CHANGE,this.handleSourceChange_,this),t.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return!this.renderer_||!this.rendered?null:this.renderer_.getData(t)}isVisible(t){let e;const n=this.getMapInternal();!t&&n&&(t=n.getView()),t instanceof Re?e={viewState:t.getState(),extent:t.calculateExtent()}:e=t,!e.layerStatesArray&&n&&(e.layerStatesArray=n.getLayerGroup().getLayerStatesArray());let r;if(e.layerStatesArray){if(r=e.layerStatesArray.find(o=>o.layer===this),!r)return!1}else r=this.getLayerState();const s=this.getExtent();return Ac(r,e.viewState)&&(!s||Xt(s,e.extent))}getAttributions(t){if(!this.isVisible(t))return[];const e=this.getSource()?.getAttributions();if(!e)return[];const n=t instanceof Re?t.getViewStateAndExtent():t;let r=e(n);return Array.isArray(r)||(r=[r]),r}render(t,e){const n=this.getRenderer();return n.prepareFrame(t)?(this.rendered=!0,n.renderFrame(t,e)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(t,e){}renderDeferred(t){const e=this.getRenderer();e&&e.renderDeferred(t)}setMapInternal(t){t||this.unrender(),this.set(st.MAP,t)}getMapInternal(){return this.get(st.MAP)}setMap(t){this.mapPrecomposeKey_&&(ct(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(ct(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=tt(t,ce.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=tt(this,W.CHANGE,t.render,t),this.changed())}handlePrecompose_(t){const e=t.frameState.layerStatesArray,n=this.getLayerState(!1);it(!e.some(r=>r.layer===n.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),e.push(n)}setSource(t){this.set(st.SOURCE,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function Ac(i,t){if(!i.visible)return!1;const e=t.resolution;if(e<i.minResolution||e>=i.maxResolution)return!1;const n=t.zoom;return n>i.minZoom&&n<=i.maxZoom}const Pc=[NaN,NaN,NaN,0];let Ia;function _0(){return Ia||(Ia=xt(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),Ia}const y0=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,w0=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,v0=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,b0=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function Is(i,t){return i.endsWith("%")?Number(i.substring(0,i.length-1))/t:Number(i)}function xr(i){throw new Error('failed to parse "'+i+'" as color')}function zf(i){if(i.toLowerCase().startsWith("rgb")){const s=i.match(w0)||i.match(y0)||i.match(v0);if(s){const o=s[4],a=100/255;return[dt(Is(s[1],a)+.5|0,0,255),dt(Is(s[2],a)+.5|0,0,255),dt(Is(s[3],a)+.5|0,0,255),o!==void 0?dt(Is(o,100),0,1):1]}xr(i)}if(i.startsWith("#")){if(b0.test(i)){const s=i.substring(1),o=s.length<=4?1:2,a=[0,0,0,255];for(let l=0,c=s.length;l<c;l+=o){let h=parseInt(s.substring(l,l+o),16);o===1&&(h+=h<<4),a[l/o]=h}return a[3]=a[3]/255,a}xr(i)}const t=_0();t.fillStyle="#abcdef";let e=t.fillStyle;t.fillStyle=i,t.fillStyle===e&&(t.fillStyle="#fedcba",e=t.fillStyle,t.fillStyle=i,t.fillStyle===e&&xr(i));const n=t.fillStyle;if(n.startsWith("#")||n.startsWith("rgba"))return zf(n);t.clearRect(0,0,1,1),t.fillRect(0,0,1,1);const r=Array.from(t.getImageData(0,0,1,1).data);return r[3]=Eo(r[3]/255,3),r}function E0(i){return typeof i=="string"?i:Mc(i)}const C0=1024,fr={};let Ta=0;function x0(i){if(i.length===4)return i;const t=i.slice();return t[3]=1,t}function Ra(i){return i>.0031308?Math.pow(i,1/2.4)*269.025-14.025:i*3294.6}function Aa(i){return i>.2068965?Math.pow(i,3):(i-4/29)*(108/841)}function Pa(i){return i>10.314724?Math.pow((i+14.025)/269.025,2.4):i/3294.6}function La(i){return i>.0088564?Math.pow(i,1/3):i/(108/841)+4/29}function ru(i){const t=Pa(i[0]),e=Pa(i[1]),n=Pa(i[2]),r=La(t*.222488403+e*.716873169+n*.06060791),s=500*(La(t*.452247074+e*.399439023+n*.148375274)-r),o=200*(r-La(t*.016863605+e*.117638439+n*.865350722)),a=Math.atan2(o,s)*(180/Math.PI);return[116*r-16,Math.sqrt(s*s+o*o),a<0?a+360:a,i[3]]}function S0(i){const t=(i[0]+16)/116,e=i[1],n=i[2]*Math.PI/180,r=Aa(t),s=Aa(t+e/500*Math.cos(n)),o=Aa(t-e/200*Math.sin(n)),a=Ra(s*3.021973625-r*1.617392459-o*.404875592),l=Ra(s*-.943766287+r*1.916279586+o*.027607165),c=Ra(s*.069407491-r*.22898585+o*1.159737864);return[dt(a+.5|0,0,255),dt(l+.5|0,0,255),dt(c+.5|0,0,255),i[3]]}function Lc(i){if(i==="none")return Pc;if(fr.hasOwnProperty(i))return fr[i];if(Ta>=C0){let e=0;for(const n in fr)(e++&3)===0&&(delete fr[n],--Ta)}const t=zf(i);t.length!==4&&xr(i);for(const e of t)isNaN(e)&&xr(i);return fr[i]=t,++Ta,t}function Bi(i){return Array.isArray(i)?i:Lc(i)}function Mc(i){let t=i[0];t!=(t|0)&&(t=t+.5|0);let e=i[1];e!=(e|0)&&(e=e+.5|0);let n=i[2];n!=(n|0)&&(n=n+.5|0);const r=i[3]===void 0?1:Math.round(i[3]*1e3)/1e3;return"rgba("+t+","+e+","+n+","+r+")"}function su(i){return i[0]>0&&i[1]>0}function I0(i,t,e){return e===void 0&&(e=[0,0]),e[0]=i[0]*t+.5|0,e[1]=i[1]*t+.5|0,e}function Yt(i,t){return Array.isArray(i)?i:(t===void 0?t=[i,i]:(t[0]=i,t[1]=i),t)}let ci=0;const Gt=1<<ci++,J=1<<ci++,Wt=1<<ci++,ye=1<<ci++,ei=1<<ci++,_r=1<<ci++,Ts=Math.pow(2,ci)-1,Oc={[Gt]:"boolean",[J]:"number",[Wt]:"string",[ye]:"color",[ei]:"number[]",[_r]:"size"},T0=Object.keys(Oc).map(Number).sort(He);function R0(i){return i in Oc}function yr(i){const t=[];for(const e of T0)wr(i,e)&&t.push(Oc[e]);return t.length===0?"untyped":t.length<3?t.join(" or "):t.slice(0,-1).join(", ")+", or "+t[t.length-1]}function wr(i,t){return(i&t)===t}function ln(i,t){return i===t}class bt{constructor(t,e){if(!R0(t))throw new Error(`literal expressions must have a specific type, got ${yr(t)}`);this.type=t,this.value=e}}class A0{constructor(t,e,...n){this.type=t,this.operator=e,this.args=n}}function Gf(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function Pt(i,t,e){switch(typeof i){case"boolean":{if(ln(t,Wt))return new bt(Wt,i?"true":"false");if(!wr(t,Gt))throw new Error(`got a boolean, but expected ${yr(t)}`);return new bt(Gt,i)}case"number":{if(ln(t,_r))return new bt(_r,Yt(i));if(ln(t,Gt))return new bt(Gt,!!i);if(ln(t,Wt))return new bt(Wt,i.toString());if(!wr(t,J))throw new Error(`got a number, but expected ${yr(t)}`);return new bt(J,i)}case"string":{if(ln(t,ye))return new bt(ye,Lc(i));if(ln(t,Gt))return new bt(Gt,!!i);if(!wr(t,Wt))throw new Error(`got a string, but expected ${yr(t)}`);return new bt(Wt,i)}}if(!Array.isArray(i))throw new Error("expression must be an array or a primitive value");if(i.length===0)throw new Error("empty expression");if(typeof i[0]=="string")return z0(i,t,e);for(const n of i)if(typeof n!="number")throw new Error("expected an array of numbers");if(ln(t,_r)){if(i.length!==2)throw new Error(`expected an array of two values for a size, got ${i.length}`);return new bt(_r,i)}if(ln(t,ye)){if(i.length===3)return new bt(ye,[...i,1]);if(i.length===4)return new bt(ye,i);throw new Error(`expected an array of 3 or 4 values for a color, got ${i.length}`)}if(!wr(t,ei))throw new Error(`got an array of numbers, but expected ${yr(t)}`);return new bt(ei,i)}const P={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},P0={[P.Get]:G(X(1,1/0),ou),[P.Var]:G(X(1,1),L0),[P.Has]:G(X(1,1/0),ou),[P.Id]:G(M0,bi),[P.Concat]:G(X(2,1/0),nt(Wt)),[P.GeometryType]:G(O0,bi),[P.LineMetric]:G(bi),[P.Resolution]:G(Ma,bi),[P.Zoom]:G(Ma,bi),[P.Time]:G(Ma,bi),[P.Any]:G(X(2,1/0),nt(Gt)),[P.All]:G(X(2,1/0),nt(Gt)),[P.Not]:G(X(1,1),nt(Gt)),[P.Equal]:G(X(2,2),nt(Ts)),[P.NotEqual]:G(X(2,2),nt(Ts)),[P.GreaterThan]:G(X(2,2),nt(J)),[P.GreaterThanOrEqualTo]:G(X(2,2),nt(J)),[P.LessThan]:G(X(2,2),nt(J)),[P.LessThanOrEqualTo]:G(X(2,2),nt(J)),[P.Multiply]:G(X(2,1/0),au),[P.Coalesce]:G(X(2,1/0),au),[P.Divide]:G(X(2,2),nt(J)),[P.Add]:G(X(2,1/0),nt(J)),[P.Subtract]:G(X(2,2),nt(J)),[P.Clamp]:G(X(3,3),nt(J)),[P.Mod]:G(X(2,2),nt(J)),[P.Pow]:G(X(2,2),nt(J)),[P.Abs]:G(X(1,1),nt(J)),[P.Floor]:G(X(1,1),nt(J)),[P.Ceil]:G(X(1,1),nt(J)),[P.Round]:G(X(1,1),nt(J)),[P.Sin]:G(X(1,1),nt(J)),[P.Cos]:G(X(1,1),nt(J)),[P.Atan]:G(X(1,2),nt(J)),[P.Sqrt]:G(X(1,1),nt(J)),[P.Match]:G(X(4,1/0),lu,D0),[P.Between]:G(X(3,3),nt(J)),[P.Interpolate]:G(X(6,1/0),lu,F0),[P.Case]:G(X(3,1/0),k0,N0),[P.In]:G(X(2,2),$0),[P.Number]:G(X(1,1/0),nt(Ts)),[P.String]:G(X(1,1/0),nt(Ts)),[P.Array]:G(X(1,1/0),nt(J)),[P.Color]:G(X(1,4),nt(J)),[P.Band]:G(X(1,3),nt(J)),[P.Palette]:G(X(2,2),V0),[P.ToString]:G(X(1,1),nt(Gt|J|Wt|ye))};function ou(i,t,e){const n=i.length-1,r=new Array(n);for(let s=0;s<n;++s){const o=i[s+1];switch(typeof o){case"number":{r[s]=new bt(J,o);break}case"string":{r[s]=new bt(Wt,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}s===0&&e.properties.add(String(o))}return r}function L0(i,t,e){const n=i[1];if(typeof n!="string")throw new Error("expected a string argument for var operation");return e.variables.add(n),[new bt(Wt,n)]}function M0(i,t,e){e.featureId=!0}function O0(i,t,e){e.geometryType=!0}function Ma(i,t,e){e.mapState=!0}function bi(i,t,e){const n=i[0];if(i.length!==1)throw new Error(`expected no arguments for ${n} operation`);return[]}function X(i,t){return function(e,n,r){const s=e[0],o=e.length-1;if(i===t){if(o!==i){const a=i===1?"":"s";throw new Error(`expected ${i} argument${a} for ${s}, got ${o}`)}}else if(o<i||o>t){const a=t===1/0?`${i} or more`:`${i} to ${t}`;throw new Error(`expected ${a} arguments for ${s}, got ${o}`)}}}function au(i,t,e){const n=i.length-1,r=new Array(n);for(let s=0;s<n;++s){const o=Pt(i[s+1],t,e);r[s]=o}return r}function nt(i){return function(t,e,n){const r=t.length-1,s=new Array(r);for(let o=0;o<r;++o){const a=Pt(t[o+1],i,n);s[o]=a}return s}}function k0(i,t,e){const n=i[0],r=i.length-1;if(r%2===0)throw new Error(`expected an odd number of arguments for ${n}, got ${r} instead`)}function lu(i,t,e){const n=i[0],r=i.length-1;if(r%2===1)throw new Error(`expected an even number of arguments for operation ${n}, got ${r} instead`)}function D0(i,t,e){const n=i.length-1,r=Wt|J|Gt,s=Pt(i[1],r,e),o=Pt(i[i.length-1],t,e),a=new Array(n-2);for(let l=0;l<n-2;l+=2){try{const c=Pt(i[l+2],s.type,e);a[l]=c}catch(c){throw new Error(`failed to parse argument ${l+1} of match expression: ${c.message}`)}try{const c=Pt(i[l+3],o.type,e);a[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+2} of match expression: ${c.message}`)}}return[s,...a,o]}function F0(i,t,e){const n=i[1];let r;switch(n[0]){case"linear":r=1;break;case"exponential":const l=n[1];if(typeof l!="number"||l<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(l)} instead`);r=l;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(n)}`)}const s=new bt(J,r);let o;try{o=Pt(i[2],J,e)}catch(l){throw new Error(`failed to parse argument 1 in interpolate expression: ${l.message}`)}const a=new Array(i.length-3);for(let l=0;l<a.length;l+=2){try{const c=Pt(i[l+3],J,e);a[l]=c}catch(c){throw new Error(`failed to parse argument ${l+2} for interpolate expression: ${c.message}`)}try{const c=Pt(i[l+4],t,e);a[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+3} for interpolate expression: ${c.message}`)}}return[s,o,...a]}function N0(i,t,e){const n=Pt(i[i.length-1],t,e),r=new Array(i.length-1);for(let s=0;s<r.length-1;s+=2){try{const o=Pt(i[s+1],Gt,e);r[s]=o}catch(o){throw new Error(`failed to parse argument ${s} of case expression: ${o.message}`)}try{const o=Pt(i[s+2],n.type,e);r[s+1]=o}catch(o){throw new Error(`failed to parse argument ${s+1} of case expression: ${o.message}`)}}return r[r.length-1]=n,r}function $0(i,t,e){let n=i[2];if(!Array.isArray(n))throw new Error('the second argument for the "in" operator must be an array');let r;if(typeof n[0]=="string"){if(n[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(n[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');n=n[1],r=Wt}else r=J;const s=new Array(n.length);for(let a=0;a<s.length;a++)try{const l=Pt(n[a],r,e);s[a]=l}catch(l){throw new Error(`failed to parse haystack item ${a} for "in" expression: ${l.message}`)}return[Pt(i[1],r,e),...s]}function V0(i,t,e){let n;try{n=Pt(i[1],J,e)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const r=i[2];if(!Array.isArray(r))throw new Error("the second argument of palette must be an array");const s=new Array(r.length);for(let o=0;o<s.length;o++){let a;try{a=Pt(r[o],ye,e)}catch(l){throw new Error(`failed to parse color at index ${o} in palette expression: ${l.message}`)}if(!(a instanceof bt))throw new Error(`the palette color at index ${o} must be a literal value`);s[o]=a}return[n,...s]}function G(...i){return function(t,e,n){const r=t[0];let s;for(let o=0;o<i.length;o++){const a=i[o](t,e,n);if(o==i.length-1){if(!a)throw new Error("expected last argument validator to return the parsed args");s=a}}return new A0(e,r,...s)}}function z0(i,t,e){const n=i[0],r=P0[n];if(!r)throw new Error(`unknown operator: ${n}`);return r(i,t,e)}function Uf(i){if(!i)return"";const t=i.getType();switch(t){case"Point":case"LineString":case"Polygon":return t;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return t.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return Uf(i.getGeometries()[0]);default:return""}}function Bf(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function an(i,t,e){const n=Pt(i,t,e);return be(n)}function be(i,t){if(i instanceof bt){if(i.type===ye&&typeof i.value=="string"){const n=Lc(i.value);return function(){return n}}return function(){return i.value}}const e=i.operator;switch(e){case P.Number:case P.String:case P.Coalesce:return G0(i);case P.Get:case P.Var:case P.Has:return U0(i);case P.Id:return n=>n.featureId;case P.GeometryType:return n=>n.geometryType;case P.Concat:{const n=i.args.map(r=>be(r));return r=>"".concat(...n.map(s=>s(r).toString()))}case P.Resolution:return n=>n.resolution;case P.Any:case P.All:case P.Between:case P.In:case P.Not:return j0(i);case P.Equal:case P.NotEqual:case P.LessThan:case P.LessThanOrEqualTo:case P.GreaterThan:case P.GreaterThanOrEqualTo:return B0(i);case P.Multiply:case P.Divide:case P.Add:case P.Subtract:case P.Clamp:case P.Mod:case P.Pow:case P.Abs:case P.Floor:case P.Ceil:case P.Round:case P.Sin:case P.Cos:case P.Atan:case P.Sqrt:return W0(i);case P.Case:return q0(i);case P.Match:return X0(i);case P.Interpolate:return K0(i);case P.ToString:return H0(i);default:throw new Error(`Unsupported operator ${e}`)}}function G0(i,t){const e=i.operator,n=i.args.length,r=new Array(n);for(let s=0;s<n;++s)r[s]=be(i.args[s]);switch(e){case P.Coalesce:return s=>{for(let o=0;o<n;++o){const a=r[o](s);if(typeof a<"u"&&a!==null)return a}throw new Error("Expected one of the values to be non-null")};case P.Number:case P.String:return s=>{for(let o=0;o<n;++o){const a=r[o](s);if(typeof a===e)return a}throw new Error(`Expected one of the values to be a ${e}`)};default:throw new Error(`Unsupported assertion operator ${e}`)}}function U0(i,t){const n=i.args[0].value;switch(i.operator){case P.Get:return r=>{const s=i.args;let o=r.properties[n];for(let a=1,l=s.length;a<l;++a){const h=s[a].value;o=o[h]}return o};case P.Var:return r=>r.variables[n];case P.Has:return r=>{const s=i.args;if(!(n in r.properties))return!1;let o=r.properties[n];for(let a=1,l=s.length;a<l;++a){const h=s[a].value;if(!o||!Object.hasOwn(o,h))return!1;o=o[h]}return!0};default:throw new Error(`Unsupported accessor operator ${i.operator}`)}}function B0(i,t){const e=i.operator,n=be(i.args[0]),r=be(i.args[1]);switch(e){case P.Equal:return s=>n(s)===r(s);case P.NotEqual:return s=>n(s)!==r(s);case P.LessThan:return s=>n(s)<r(s);case P.LessThanOrEqualTo:return s=>n(s)<=r(s);case P.GreaterThan:return s=>n(s)>r(s);case P.GreaterThanOrEqualTo:return s=>n(s)>=r(s);default:throw new Error(`Unsupported comparison operator ${e}`)}}function j0(i,t){const e=i.operator,n=i.args.length,r=new Array(n);for(let s=0;s<n;++s)r[s]=be(i.args[s]);switch(e){case P.Any:return s=>{for(let o=0;o<n;++o)if(r[o](s))return!0;return!1};case P.All:return s=>{for(let o=0;o<n;++o)if(!r[o](s))return!1;return!0};case P.Between:return s=>{const o=r[0](s),a=r[1](s),l=r[2](s);return o>=a&&o<=l};case P.In:return s=>{const o=r[0](s);for(let a=1;a<n;++a)if(o===r[a](s))return!0;return!1};case P.Not:return s=>!r[0](s);default:throw new Error(`Unsupported logical operator ${e}`)}}function W0(i,t){const e=i.operator,n=i.args.length,r=new Array(n);for(let s=0;s<n;++s)r[s]=be(i.args[s]);switch(e){case P.Multiply:return s=>{let o=1;for(let a=0;a<n;++a)o*=r[a](s);return o};case P.Divide:return s=>r[0](s)/r[1](s);case P.Add:return s=>{let o=0;for(let a=0;a<n;++a)o+=r[a](s);return o};case P.Subtract:return s=>r[0](s)-r[1](s);case P.Clamp:return s=>{const o=r[0](s),a=r[1](s);if(o<a)return a;const l=r[2](s);return o>l?l:o};case P.Mod:return s=>r[0](s)%r[1](s);case P.Pow:return s=>Math.pow(r[0](s),r[1](s));case P.Abs:return s=>Math.abs(r[0](s));case P.Floor:return s=>Math.floor(r[0](s));case P.Ceil:return s=>Math.ceil(r[0](s));case P.Round:return s=>Math.round(r[0](s));case P.Sin:return s=>Math.sin(r[0](s));case P.Cos:return s=>Math.cos(r[0](s));case P.Atan:return n===2?s=>Math.atan2(r[0](s),r[1](s)):s=>Math.atan(r[0](s));case P.Sqrt:return s=>Math.sqrt(r[0](s));default:throw new Error(`Unsupported numeric operator ${e}`)}}function q0(i,t){const e=i.args.length,n=new Array(e);for(let r=0;r<e;++r)n[r]=be(i.args[r]);return r=>{for(let s=0;s<e-1;s+=2)if(n[s](r))return n[s+1](r);return n[e-1](r)}}function X0(i,t){const e=i.args.length,n=new Array(e);for(let r=0;r<e;++r)n[r]=be(i.args[r]);return r=>{const s=n[0](r);for(let o=1;o<e-1;o+=2)if(s===n[o](r))return n[o+1](r);return n[e-1](r)}}function K0(i,t){const e=i.args.length,n=new Array(e);for(let r=0;r<e;++r)n[r]=be(i.args[r]);return r=>{const s=n[0](r),o=n[1](r);let a,l;for(let c=2;c<e;c+=2){const h=n[c](r);let u=n[c+1](r);const d=Array.isArray(u);if(d&&(u=x0(u)),h>=o)return c===2?u:d?Y0(s,o,a,l,h,u):vr(s,o,a,l,h,u);a=h,l=u}return l}}function H0(i,t){const e=i.operator,n=i.args.length,r=new Array(n);for(let s=0;s<n;++s)r[s]=be(i.args[s]);switch(e){case P.ToString:return s=>{const o=r[0](s);return i.args[0].type===ye?Mc(o):o.toString()};default:throw new Error(`Unsupported convert operator ${e}`)}}function vr(i,t,e,n,r,s){const o=r-e;if(o===0)return n;const a=t-e,l=i===1?a/o:(Math.pow(i,a)-1)/(Math.pow(i,o)-1);return n+l*(s-n)}function Y0(i,t,e,n,r,s){if(r-e===0)return n;const a=ru(n),l=ru(s);let c=l[2]-a[2];c>180?c-=360:c<-180&&(c+=360);const h=[vr(i,t,e,a[0],r,l[0]),vr(i,t,e,a[1],r,l[1]),a[2]+vr(i,t,e,0,r,c),vr(i,t,e,n[3],r,s[3])];return S0(h)}const K={IDLE:0,LOADING:1,LOADED:2,ERROR:3};function Z0(i,t,e){const n=i;let r=!0,s=!1,o=!1;const a=[Vs(n,W.LOAD,function(){o=!0,s||t()})];return n.src&&Mf?(s=!0,n.decode().then(function(){r&&t()}).catch(function(l){r&&(o?t():e())})):a.push(Vs(n,W.ERROR,e)),function(){r=!1,a.forEach(ct)}}function J0(i,t){return new Promise((e,n)=>{function r(){o(),e(i)}function s(){o(),n(new Error("Image load error"))}function o(){i.removeEventListener("load",r),i.removeEventListener("error",s)}i.addEventListener("load",r),i.addEventListener("error",s)})}function Q0(i,t){return t&&(i.src=t),i.src&&Mf?new Promise((e,n)=>i.decode().then(()=>e(i)).catch(r=>i.complete&&i.width?e(i):n(r))):J0(i)}class tw{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const e in this.cache_){const n=this.cache_[e];(t++&3)===0&&!n.hasListener()&&(delete this.cache_[e],delete this.patternCache_[e],--this.cacheSize_)}}}get(t,e,n){const r=Oa(t,e,n);return r in this.cache_?this.cache_[r]:null}getPattern(t,e,n){const r=Oa(t,e,n);return r in this.patternCache_?this.patternCache_[r]:null}set(t,e,n,r,s){const o=Oa(t,e,n),a=o in this.cache_;this.cache_[o]=r,s&&(r.getImageState()===K.IDLE&&r.load(),r.getImageState()===K.LOADING?r.ready().then(()=>{this.patternCache_[o]=Ks().createPattern(r.getImage(1),"repeat")}):this.patternCache_[o]=Ks().createPattern(r.getImage(1),"repeat")),a||++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}}function Oa(i,t,e){const n=e?Bi(e):"null";return t+":"+i+":"+n}const he=new tw;let gr=null;class jf extends So{constructor(t,e,n,r,s){super(),this.hitDetectionImage_=null,this.image_=t,this.crossOrigin_=n,this.canvas_={},this.color_=s,this.imageState_=r===void 0?K.IDLE:r,this.size_=t&&t.width&&t.height?[t.width,t.height]:null,this.src_=e,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===K.LOADED){gr||(gr=xt(1,1,void 0,{willReadFrequently:!0})),gr.drawImage(this.image_,0,0);try{gr.getImageData(0,0,1,1),this.tainted_=!1}catch{gr=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(W.CHANGE)}handleImageError_(){this.imageState_=K.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=K.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}getPixelRatio(t){return this.replaceColor_(t),this.canvas_[t]?t:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const t=this.size_[0],e=this.size_[1],n=xt(t,e);n.fillRect(0,0,t,e),this.hitDetectionImage_=n.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===K.IDLE){this.image_||this.initializeImage_(),this.imageState_=K.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&Q0(this.image_,this.src_).then(t=>{this.image_=t,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(t){if(!this.color_||this.canvas_[t]||this.imageState_!==K.LOADED)return;const e=this.image_,n=xt(Math.ceil(e.width*t),Math.ceil(e.height*t)),r=n.canvas;n.scale(t,t),n.drawImage(e,0,0),n.globalCompositeOperation="multiply",n.fillStyle=E0(this.color_),n.fillRect(0,0,r.width/t,r.height/t),n.globalCompositeOperation="destination-in",n.drawImage(e,0,0),this.canvas_[t]=r}ready(){return this.ready_||(this.ready_=new Promise(t=>{if(this.imageState_===K.LOADED||this.imageState_===K.ERROR)t();else{const e=()=>{(this.imageState_===K.LOADED||this.imageState_===K.ERROR)&&(this.removeEventListener(W.CHANGE,e),t())};this.addEventListener(W.CHANGE,e)}})),this.ready_}}function kc(i,t,e,n,r,s){let o=t===void 0?void 0:he.get(t,e,r);return o||(o=new jf(i,i&&"src"in i?i.src||void 0:t,e,n,r),he.set(t,e,r,o,s)),s&&o&&!he.getPattern(t,e,r)&&he.set(t,e,r,o,s),o}function Me(i){return i?Array.isArray(i)?Mc(i):typeof i=="object"&&"src"in i?ew(i):i:null}function ew(i){if(!i.offset||!i.size)return he.getPattern(i.src,"anonymous",i.color);const t=i.src+":"+i.offset,e=he.getPattern(t,void 0,i.color);if(e)return e;const n=he.get(i.src,"anonymous",null);if(n.getImageState()!==K.LOADED)return null;const r=xt(i.size[0],i.size[1]);return r.drawImage(n.getImage(1),i.offset[0],i.offset[1],i.size[0],i.size[1],0,0,i.size[0],i.size[1]),kc(r.canvas,t,void 0,K.LOADED,i.color,!0),he.getPattern(t,void 0,i.color)}const Wf="10px sans-serif",qt="#000",ji="round",Ze=[],Je=0,Wi="round",$r=10,Vr="#000",zr="center",Hs="middle",qn=[0,0,0,0],Gr=1,Ti=new $e;let pr=null,cu;const wl={},nw=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function iw(i,t,e){return`${i} ${t} 16px "${e}"`}const rw=function(){let t,e;async function n(s){await e.ready;const o=await e.load(s);if(o.length===0)return!1;const a=_l(s),l=a.families[0].toLowerCase(),c=a.weight;return o.some(h=>{const u=h.family.replace(/^['"]|['"]$/g,"").toLowerCase(),d=ml[h.weight]||h.weight;return u===l&&h.style===a.style&&d==c})}async function r(){await e.ready;let s=!0;const o=Ti.getProperties(),a=Object.keys(o).filter(l=>o[l]<100);for(let l=a.length-1;l>=0;--l){const c=a[l];let h=o[c];h<100&&(await n(c)?(ns(wl),Ti.set(c,100)):(h+=10,Ti.set(c,h,!0),h<100&&(s=!1)))}t=void 0,s||(t=setTimeout(r,100))}return async function(s){e||(e=vc?self.fonts:document.fonts);const o=_l(s);if(!o)return;const a=o.families;let l=!1;for(const c of a){if(nw.has(c))continue;const h=iw(o.style,o.weight,c);Ti.get(h)===void 0&&(Ti.set(h,0,!0),l=!0)}l&&(clearTimeout(t),t=setTimeout(r,100))}}(),sw=function(){let i;return function(t){let e=wl[t];if(e==null){if(vc){const n=_l(t),r=qf(t,"Žg");e=(isNaN(Number(n.lineHeight))?1.2:Number(n.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else i||(i=document.createElement("div"),i.innerHTML="M",i.style.minHeight="0",i.style.maxHeight="none",i.style.height="auto",i.style.padding="0",i.style.border="none",i.style.position="absolute",i.style.display="block",i.style.left="-99999px"),i.style.font=t,document.body.appendChild(i),e=i.offsetHeight,document.body.removeChild(i);wl[t]=e}return e}}();function qf(i,t){return pr||(pr=xt(1,1)),i!=cu&&(pr.font=i,cu=pr.font),pr.measureText(t)}function Xf(i,t){return qf(i,t).width}function hu(i,t,e){if(t in e)return e[t];const n=t.split(`
`).reduce((r,s)=>Math.max(r,Xf(i,s)),0);return e[t]=n,n}function ow(i,t){const e=[],n=[],r=[];let s=0,o=0,a=0,l=0;for(let c=0,h=t.length;c<=h;c+=2){const u=t[c];if(u===`
`||c===h){s=Math.max(s,o),r.push(o),o=0,a+=l,l=0;continue}const d=t[c+1]||i.font,f=Xf(d,u);e.push(f),o+=f;const m=sw(d);n.push(m),l=Math.max(l,m)}return{width:s,height:a,widths:e,heights:n,lineWidths:r}}function aw(i,t,e,n,r,s,o,a,l,c,h){i.save(),e!==1&&(i.globalAlpha===void 0?i.globalAlpha=u=>u.globalAlpha*=e:i.globalAlpha*=e),t&&i.transform.apply(i,t),n.contextInstructions?(i.translate(l,c),i.scale(h[0],h[1]),lw(n,i)):h[0]<0||h[1]<0?(i.translate(l,c),i.scale(h[0],h[1]),i.drawImage(n,r,s,o,a,0,0,o,a)):i.drawImage(n,r,s,o,a,l,c,o*h[0],a*h[1]),i.restore()}function lw(i,t){const e=i.contextInstructions;for(let n=0,r=e.length;n<r;n+=2)Array.isArray(e[n+1])?t[e[n]].apply(t,e[n+1]):t[e[n]]=e[n+1]}class $o{constructor(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=Yt(t.scale),this.displacement_=t.displacement,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new $o({opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return U()}getImage(t){return U()}getHitDetectionImage(){return U()}getPixelRatio(t){return 1}getImageState(){return U()}getImageSize(){return U()}getOrigin(){return U()}getSize(){return U()}setDisplacement(t){this.displacement_=t}setOpacity(t){this.opacity_=t}setRotateWithView(t){this.rotateWithView_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=Yt(t)}listenImageChange(t){U()}load(){U()}unlistenImageChange(t){U()}ready(){return Promise.resolve()}}class Vo extends $o{constructor(t){super({opacity:1,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,rotation:t.rotation!==void 0?t.rotation:0,scale:t.scale!==void 0?t.scale:1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=t.fill!==void 0?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius=t.radius,this.radius2_=t.radius2,this.angle_=t.angle!==void 0?t.angle:0,this.stroke_=t.stroke!==void 0?t.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?K.LOADING:K.LOADED,this.imageState_===K.LOADING&&this.ready().then(()=>this.imageState_=K.LOADED),this.render()}clone(){const t=this.getScale(),e=new Vo({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}getAnchor(){const t=this.size_,e=this.getDisplacement(),n=this.getScaleArray();return[t[0]/2-e[0]/n[0],t[1]/2+e[1]/n[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(t){this.fill_=t,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(t){const e=this.fill_?.getKey(),n=`${t},${this.angle_},${this.radius},${this.radius2_},${this.points_},${e}`+Object.values(this.renderOptions_).join(",");let r=he.get(n,null,null)?.getImage(1);if(!r){const s=this.renderOptions_,o=Math.ceil(s.size*t),a=xt(o,o);this.draw_(s,a,t),r=a.canvas,he.set(n,null,null,new jf(r,void 0,null,K.LOADED,null))}return r}getPixelRatio(t){return t}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t,this.render()}listenImageChange(t){}load(){}unlistenImageChange(t){}calculateLineJoinSize_(t,e,n){if(e===0||this.points_===1/0||t!=="bevel"&&t!=="miter")return e;let r=this.radius,s=this.radius2_===void 0?r:this.radius2_;if(r<s){const A=r;r=s,s=A}const o=this.radius2_===void 0?this.points_:this.points_*2,a=2*Math.PI/o,l=s*Math.sin(a),c=Math.sqrt(s*s-l*l),h=r-c,u=Math.sqrt(l*l+h*h),d=u/l;if(t==="miter"&&d<=n)return d*e;const f=e/2/d,m=e/2*(h/u),w=Math.sqrt((r+f)*(r+f)+m*m)-r;if(this.radius2_===void 0||t==="bevel")return w*2;const E=r*Math.sin(a),I=Math.sqrt(r*r-E*E),R=s-I,T=Math.sqrt(E*E+R*R)/E;if(T<=n){const A=T*e/2-s-r;return 2*Math.max(w,A)}return w*2}createRenderOptions(){let t=ji,e=Wi,n=0,r=null,s=0,o,a=0;this.stroke_&&(o=Me(this.stroke_.getColor()??Vr),a=this.stroke_.getWidth()??Gr,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,e=this.stroke_.getLineJoin()??Wi,t=this.stroke_.getLineCap()??ji,n=this.stroke_.getMiterLimit()??$r);const l=this.calculateLineJoinSize_(e,a,n),c=Math.max(this.radius,this.radius2_||0),h=Math.ceil(2*c+l);return{strokeStyle:o,strokeWidth:a,size:h,lineCap:t,lineDash:r,lineDashOffset:s,lineJoin:e,miterLimit:n}}render(){this.renderOptions_=this.createRenderOptions();const t=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[t,t]}draw_(t,e,n){if(e.scale(n,n),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){let r=this.fill_.getColor();r===null&&(r=qt),e.fillStyle=Me(r),e.fill()}t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}createHitDetectionCanvas_(t){let e;if(this.fill_){let n=this.fill_.getColor(),r=0;typeof n=="string"&&(n=Bi(n)),n===null?r=1:Array.isArray(n)&&(r=n.length===4?n[3]:1),r===0&&(e=xt(t.size,t.size),this.drawHitDetectionCanvas_(t,e))}return e?e.canvas:this.getImage(1)}createPath_(t){let e=this.points_;const n=this.radius;if(e===1/0)t.arc(0,0,n,0,2*Math.PI);else{const r=this.radius2_===void 0?n:this.radius2_;this.radius2_!==void 0&&(e*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/e;for(let a=0;a<e;a++){const l=s+a*o,c=a%2===0?n:r;t.lineTo(c*Math.cos(l),c*Math.sin(l))}t.closePath()}}drawHitDetectionCanvas_(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=qt,e.fill(),t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class zo extends Vo{constructor(t){t=t||{radius:5},super({points:1/0,fill:t.fill,radius:t.radius,stroke:t.stroke,scale:t.scale!==void 0?t.scale:1,rotation:t.rotation!==void 0?t.rotation:0,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode})}clone(){const t=this.getScale(),e=new zo({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}setRadius(t){this.radius=t,this.render()}}class us{constructor(t){t=t||{},this.patternImage_=null,this.color_=null,t.color!==void 0&&this.setColor(t.color)}clone(){const t=this.getColor();return new us({color:Array.isArray(t)?t.slice():t||void 0})}getColor(){return this.color_}setColor(t){if(t!==null&&typeof t=="object"&&"src"in t){const e=kc(null,t.src,"anonymous",void 0,t.offset?null:t.color?t.color:null,!(t.offset&&t.size));e.ready().then(()=>{this.patternImage_=null}),e.getImageState()===K.IDLE&&e.load(),e.getImageState()===K.LOADING&&(this.patternImage_=e)}this.color_=t}getKey(){const t=this.getColor();return t?t instanceof CanvasPattern||t instanceof CanvasGradient?et(t):typeof t=="object"&&"src"in t?t.src+":"+t.offset:Bi(t).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}function uu(i,t,e,n){return e!==void 0&&n!==void 0?[e/i,n/t]:e!==void 0?e/i:n!==void 0?n/t:1}class Go extends $o{constructor(t){t=t||{};const e=t.opacity!==void 0?t.opacity:1,n=t.rotation!==void 0?t.rotation:0,r=t.scale!==void 0?t.scale:1,s=t.rotateWithView!==void 0?t.rotateWithView:!1;super({opacity:e,rotation:n,scale:r,displacement:t.displacement!==void 0?t.displacement:[0,0],rotateWithView:s,declutterMode:t.declutterMode}),this.anchor_=t.anchor!==void 0?t.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=t.anchorOrigin!==void 0?t.anchorOrigin:"top-left",this.anchorXUnits_=t.anchorXUnits!==void 0?t.anchorXUnits:"fraction",this.anchorYUnits_=t.anchorYUnits!==void 0?t.anchorYUnits:"fraction",this.crossOrigin_=t.crossOrigin!==void 0?t.crossOrigin:null;const o=t.img!==void 0?t.img:null;let a=t.src;it(!(a!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(a===void 0||a.length===0)&&o&&(a=o.src||et(o)),it(a!==void 0&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),it(!((t.width!==void 0||t.height!==void 0)&&t.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(t.src!==void 0?l=K.IDLE:o!==void 0&&("complete"in o?o.complete?l=o.src?K.LOADED:K.IDLE:l=K.LOADING:l=K.LOADED),this.color_=t.color!==void 0?Bi(t.color):null,this.iconImage_=kc(o,a,this.crossOrigin_,l,this.color_),this.offset_=t.offset!==void 0?t.offset:[0,0],this.offsetOrigin_=t.offsetOrigin!==void 0?t.offsetOrigin:"top-left",this.origin_=null,this.size_=t.size!==void 0?t.size:null,this.initialOptions_,t.width!==void 0||t.height!==void 0){let c,h;if(t.size)[c,h]=t.size;else{const u=this.getImage(1);if(u.width&&u.height)c=u.width,h=u.height;else if(u instanceof HTMLImageElement){this.initialOptions_=t;const d=()=>{if(this.unlistenImageChange(d),!this.initialOptions_)return;const f=this.iconImage_.getSize();this.setScale(uu(f[0],f[1],t.width,t.height))};this.listenImageChange(d);return}}c!==void 0&&this.setScale(uu(c,h,t.width,t.height))}}clone(){let t,e,n;return this.initialOptions_?(e=this.initialOptions_.width,n=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t),new Go({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:e,height:n,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let t=this.normalizedAnchor_;if(!t){t=this.anchor_;const r=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!r)return null;t=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(t[0]*=r[0]),this.anchorYUnits_=="fraction"&&(t[1]*=r[1])}if(this.anchorOrigin_!="top-left"){if(!r)return null;t===this.anchor_&&(t=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(t[0]=-t[0]+r[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(t[1]=-t[1]+r[1])}this.normalizedAnchor_=t}const e=this.getDisplacement(),n=this.getScaleArray();return[t[0]-e[0]/n[0],t[1]+e[1]/n[1]]}setAnchor(t){this.anchor_=t,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(t){return this.iconImage_.getImage(t)}getPixelRatio(t){return this.iconImage_.getPixelRatio(t)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let t=this.offset_;if(this.offsetOrigin_!="top-left"){const e=this.getSize(),n=this.iconImage_.getSize();if(!e||!n)return null;t=t.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(t[0]=n[0]-e[0]-t[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(t[1]=n[1]-e[1]-t[1])}return this.origin_=t,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const t=this.getScaleArray();if(this.size_)return this.size_[0]*t[0];if(this.iconImage_.getImageState()==K.LOADED)return this.iconImage_.getSize()[0]*t[0]}getHeight(){const t=this.getScaleArray();if(this.size_)return this.size_[1]*t[1];if(this.iconImage_.getImageState()==K.LOADED)return this.iconImage_.getSize()[1]*t[1]}setScale(t){delete this.initialOptions_,super.setScale(t)}listenImageChange(t){this.iconImage_.addEventListener(W.CHANGE,t)}load(){this.iconImage_.load()}unlistenImageChange(t){this.iconImage_.removeEventListener(W.CHANGE,t)}ready(){return this.iconImage_.ready()}}class Uo{constructor(t){t=t||{},this.color_=t.color!==void 0?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=t.lineDash!==void 0?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}clone(){const t=this.getColor();return new Uo({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(t){this.color_=t}setLineCap(t){this.lineCap_=t}setLineDash(t){this.lineDash_=t}setLineDashOffset(t){this.lineDashOffset_=t}setLineJoin(t){this.lineJoin_=t}setMiterLimit(t){this.miterLimit_=t}setWidth(t){this.width_=t}}class Yn{constructor(t){t=t||{},this.geometry_=null,this.geometryFunction_=du,t.geometry!==void 0&&this.setGeometry(t.geometry),this.fill_=t.fill!==void 0?t.fill:null,this.image_=t.image!==void 0?t.image:null,this.renderer_=t.renderer!==void 0?t.renderer:null,this.hitDetectionRenderer_=t.hitDetectionRenderer!==void 0?t.hitDetectionRenderer:null,this.stroke_=t.stroke!==void 0?t.stroke:null,this.text_=t.text!==void 0?t.text:null,this.zIndex_=t.zIndex}clone(){let t=this.getGeometry();return t&&typeof t=="object"&&(t=t.clone()),new Yn({geometry:t??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(t){this.renderer_=t}setHitDetectionRenderer(t){this.hitDetectionRenderer_=t}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(t){this.fill_=t}getImage(){return this.image_}setImage(t){this.image_=t}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t}getText(){return this.text_}setText(t){this.text_=t}getZIndex(){return this.zIndex_}setGeometry(t){typeof t=="function"?this.geometryFunction_=t:typeof t=="string"?this.geometryFunction_=function(e){return e.get(t)}:t?t!==void 0&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=du,this.geometry_=t}setZIndex(t){this.zIndex_=t}}function cw(i){let t;if(typeof i=="function")t=i;else{let e;Array.isArray(i)?e=i:(it(typeof i.getZIndex=="function","Expected an `Style` or an array of `Style`"),e=[i]),t=function(){return e}}return t}let ka=null;function Kf(i,t){if(!ka){const e=new us({color:"rgba(255,255,255,0.4)"}),n=new Uo({color:"#3399CC",width:1.25});ka=[new Yn({image:new zo({fill:e,stroke:n,radius:5}),fill:e,stroke:n})]}return ka}function du(i){return i.getGeometry()}const hw="#333";class Dc{constructor(t){t=t||{},this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.keepUpright_=t.keepUpright,this.scale_=t.scale,this.scaleArray_=Yt(t.scale!==void 0?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.repeat_=t.repeat,this.textBaseline_=t.textBaseline,this.fill_=t.fill!==void 0?t.fill:new us({color:hw}),this.maxAngle_=t.maxAngle!==void 0?t.maxAngle:Math.PI/4,this.placement_=t.placement!==void 0?t.placement:"point",this.overflow_=!!t.overflow,this.stroke_=t.stroke!==void 0?t.stroke:null,this.offsetX_=t.offsetX!==void 0?t.offsetX:0,this.offsetY_=t.offsetY!==void 0?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=t.padding===void 0?null:t.padding,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new Dc({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(t){this.overflow_=t}setFont(t){this.font_=t}setMaxAngle(t){this.maxAngle_=t}setOffsetX(t){this.offsetX_=t}setOffsetY(t){this.offsetY_=t}setPlacement(t){this.placement_=t}setRepeat(t){this.repeat_=t}setRotateWithView(t){this.rotateWithView_=t}setKeepUpright(t){this.keepUpright_=t}setFill(t){this.fill_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=Yt(t!==void 0?t:1)}setStroke(t){this.stroke_=t}setText(t){this.text_=t}setTextAlign(t){this.textAlign_=t}setJustify(t){this.justify_=t}setTextBaseline(t){this.textBaseline_=t}setBackgroundFill(t){this.backgroundFill_=t}setBackgroundStroke(t){this.backgroundStroke_=t}setPadding(t){this.padding_=t}}function uw(i){return!0}function dw(i){const t=Gf(),e=fw(i,t),n=Bf();return function(r,s){if(n.properties=r.getPropertiesInternal(),n.resolution=s,t.featureId){const o=r.getId();o!==void 0?n.featureId=o:n.featureId=null}return t.geometryType&&(n.geometryType=Uf(r.getGeometry())),e(n)}}function fu(i){const t=Gf(),e=i.length,n=new Array(e);for(let o=0;o<e;++o)n[o]=vl(i[o],t);const r=Bf(),s=new Array(e);return function(o,a){if(r.properties=o.getPropertiesInternal(),r.resolution=a,t.featureId){const c=o.getId();c!==void 0?r.featureId=c:r.featureId=null}let l=0;for(let c=0;c<e;++c){const h=n[c](r);h&&(s[l]=h,l+=1)}return s.length=l,s}}function fw(i,t){const e=i.length,n=new Array(e);for(let r=0;r<e;++r){const s=i[r],o="filter"in s?an(s.filter,Gt,t):uw;let a;if(Array.isArray(s.style)){const l=s.style.length;a=new Array(l);for(let c=0;c<l;++c)a[c]=vl(s.style[c],t)}else a=[vl(s.style,t)];n[r]={filter:o,styles:a}}return function(r){const s=[];let o=!1;for(let a=0;a<e;++a){const l=n[a].filter;if(l(r)&&!(i[a].else&&o)){o=!0;for(const c of n[a].styles){const h=c(r);h&&s.push(h)}}}return s}}function vl(i,t){const e=Ur(i,"",t),n=Br(i,"",t),r=gw(i,t),s=pw(i,t),o=Kt(i,"z-index",t);if(!e&&!n&&!r&&!s&&!Jn(i))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(i));const a=new Yn;return function(l){let c=!0;if(e){const h=e(l);h&&(c=!1),a.setFill(h)}if(n){const h=n(l);h&&(c=!1),a.setStroke(h)}if(r){const h=r(l);h&&(c=!1),a.setText(h)}if(s){const h=s(l);h&&(c=!1),a.setImage(h)}return o&&a.setZIndex(o(l)),c?null:a}}function Ur(i,t,e){let n;if(t+"fill-pattern-src"in i)n=ww(i,t+"fill-",e);else{if(i[t+"fill-color"]==="none")return s=>null;n=Fc(i,t+"fill-color",e)}if(!n)return null;const r=new us;return function(s){const o=n(s);return o===Pc?null:(r.setColor(o),r)}}function Br(i,t,e){const n=Kt(i,t+"stroke-width",e),r=Fc(i,t+"stroke-color",e);if(!n&&!r)return null;const s=Xe(i,t+"stroke-line-cap",e),o=Xe(i,t+"stroke-line-join",e),a=Hf(i,t+"stroke-line-dash",e),l=Kt(i,t+"stroke-line-dash-offset",e),c=Kt(i,t+"stroke-miter-limit",e),h=new Uo;return function(u){if(r){const d=r(u);if(d===Pc)return null;h.setColor(d)}if(n&&h.setWidth(n(u)),s){const d=s(u);if(d!=="butt"&&d!=="round"&&d!=="square")throw new Error("Expected butt, round, or square line cap");h.setLineCap(d)}if(o){const d=o(u);if(d!=="bevel"&&d!=="round"&&d!=="miter")throw new Error("Expected bevel, round, or miter line join");h.setLineJoin(d)}return a&&h.setLineDash(a(u)),l&&h.setLineDashOffset(l(u)),c&&h.setMiterLimit(c(u)),h}}function gw(i,t){const e="text-",n=Xe(i,e+"value",t);if(!n)return null;const r=Ur(i,e,t),s=Ur(i,e+"background-",t),o=Br(i,e,t),a=Br(i,e+"background-",t),l=Xe(i,e+"font",t),c=Kt(i,e+"max-angle",t),h=Kt(i,e+"offset-x",t),u=Kt(i,e+"offset-y",t),d=Di(i,e+"overflow",t),f=Xe(i,e+"placement",t),m=Kt(i,e+"repeat",t),v=Bo(i,e+"scale",t),w=Di(i,e+"rotate-with-view",t),E=Kt(i,e+"rotation",t),I=Xe(i,e+"align",t),R=Xe(i,e+"justify",t),S=Xe(i,e+"baseline",t),T=Di(i,e+"keep-upright",t),A=Hf(i,e+"padding",t),y=jo(i,e+"declutter-mode"),g=new Dc({declutterMode:y});return function(p){if(g.setText(n(p)),r&&g.setFill(r(p)),s&&g.setBackgroundFill(s(p)),o&&g.setStroke(o(p)),a&&g.setBackgroundStroke(a(p)),l&&g.setFont(l(p)),c&&g.setMaxAngle(c(p)),h&&g.setOffsetX(h(p)),u&&g.setOffsetY(u(p)),d&&g.setOverflow(d(p)),f){const b=f(p);if(b!=="point"&&b!=="line")throw new Error("Expected point or line for text-placement");g.setPlacement(b)}if(m&&g.setRepeat(m(p)),v&&g.setScale(v(p)),w&&g.setRotateWithView(w(p)),E&&g.setRotation(E(p)),I){const b=I(p);if(b!=="left"&&b!=="center"&&b!=="right"&&b!=="end"&&b!=="start")throw new Error("Expected left, right, center, start, or end for text-align");g.setTextAlign(b)}if(R){const b=R(p);if(b!=="left"&&b!=="right"&&b!=="center")throw new Error("Expected left, right, or center for text-justify");g.setJustify(b)}if(S){const b=S(p);if(b!=="bottom"&&b!=="top"&&b!=="middle"&&b!=="alphabetic"&&b!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");g.setTextBaseline(b)}return A&&g.setPadding(A(p)),T&&g.setKeepUpright(T(p)),g}}function pw(i,t){return"icon-src"in i?mw(i,t):"shape-points"in i?_w(i,t):"circle-radius"in i?yw(i,t):null}function mw(i,t){const e="icon-",n=e+"src",r=Yf(i[n],n),s=Ys(i,e+"anchor",t),o=Bo(i,e+"scale",t),a=Kt(i,e+"opacity",t),l=Ys(i,e+"displacement",t),c=Kt(i,e+"rotation",t),h=Di(i,e+"rotate-with-view",t),u=pu(i,e+"anchor-origin"),d=mu(i,e+"anchor-x-units"),f=mu(i,e+"anchor-y-units"),m=Cw(i,e+"color"),v=bw(i,e+"cross-origin"),w=Ew(i,e+"offset"),E=pu(i,e+"offset-origin"),I=Zs(i,e+"width"),R=Zs(i,e+"height"),S=vw(i,e+"size"),T=jo(i,e+"declutter-mode"),A=new Go({src:r,anchorOrigin:u,anchorXUnits:d,anchorYUnits:f,color:m,crossOrigin:v,offset:w,offsetOrigin:E,height:R,width:I,size:S,declutterMode:T});return function(y){return a&&A.setOpacity(a(y)),l&&A.setDisplacement(l(y)),c&&A.setRotation(c(y)),h&&A.setRotateWithView(h(y)),o&&A.setScale(o(y)),s&&A.setAnchor(s(y)),A}}function _w(i,t){const e="shape-",n=e+"points",r=e+"radius",s=bl(i[n],n),o=bl(i[r],r),a=Ur(i,e,t),l=Br(i,e,t),c=Bo(i,e+"scale",t),h=Ys(i,e+"displacement",t),u=Kt(i,e+"rotation",t),d=Di(i,e+"rotate-with-view",t),f=Zs(i,e+"radius2"),m=Zs(i,e+"angle"),v=jo(i,e+"declutter-mode"),w=new Vo({points:s,radius:o,radius2:f,angle:m,declutterMode:v});return function(E){return a&&w.setFill(a(E)),l&&w.setStroke(l(E)),h&&w.setDisplacement(h(E)),u&&w.setRotation(u(E)),d&&w.setRotateWithView(d(E)),c&&w.setScale(c(E)),w}}function yw(i,t){const e="circle-",n=Ur(i,e,t),r=Br(i,e,t),s=Kt(i,e+"radius",t),o=Bo(i,e+"scale",t),a=Ys(i,e+"displacement",t),l=Kt(i,e+"rotation",t),c=Di(i,e+"rotate-with-view",t),h=jo(i,e+"declutter-mode"),u=new zo({radius:5,declutterMode:h});return function(d){return s&&u.setRadius(s(d)),n&&u.setFill(n(d)),r&&u.setStroke(r(d)),a&&u.setDisplacement(a(d)),l&&u.setRotation(l(d)),c&&u.setRotateWithView(c(d)),o&&u.setScale(o(d)),u}}function Kt(i,t,e){if(!(t in i))return;const n=an(i[t],J,e);return function(r){return bl(n(r),t)}}function Xe(i,t,e){if(!(t in i))return null;const n=an(i[t],Wt,e);return function(r){return Yf(n(r),t)}}function ww(i,t,e){const n=Xe(i,t+"pattern-src",e),r=gu(i,t+"pattern-offset",e),s=gu(i,t+"pattern-size",e),o=Fc(i,t+"color",e);return function(a){return{src:n(a),offset:r&&r(a),size:s&&s(a),color:o&&o(a)}}}function Di(i,t,e){if(!(t in i))return null;const n=an(i[t],Gt,e);return function(r){const s=n(r);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${t}`);return s}}function Fc(i,t,e){if(!(t in i))return null;const n=an(i[t],ye,e);return function(r){return Zf(n(r),t)}}function Hf(i,t,e){if(!(t in i))return null;const n=an(i[t],ei,e);return function(r){return ds(n(r),t)}}function Ys(i,t,e){if(!(t in i))return null;const n=an(i[t],ei,e);return function(r){const s=ds(n(r),t);if(s.length!==2)throw new Error(`Expected two numbers for ${t}`);return s}}function gu(i,t,e){if(!(t in i))return null;const n=an(i[t],ei,e);return function(r){return Jf(n(r),t)}}function Bo(i,t,e){if(!(t in i))return null;const n=an(i[t],ei|J,e);return function(r){return xw(n(r),t)}}function Zs(i,t){const e=i[t];if(e!==void 0){if(typeof e!="number")throw new Error(`Expected a number for ${t}`);return e}}function vw(i,t){const e=i[t];if(e!==void 0){if(typeof e=="number")return Yt(e);if(!Array.isArray(e))throw new Error(`Expected a number or size array for ${t}`);if(e.length!==2||typeof e[0]!="number"||typeof e[1]!="number")throw new Error(`Expected a number or size array for ${t}`);return e}}function bw(i,t){const e=i[t];if(e!==void 0){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);return e}}function pu(i,t){const e=i[t];if(e!==void 0){if(e!=="bottom-left"&&e!=="bottom-right"&&e!=="top-left"&&e!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${t}`);return e}}function mu(i,t){const e=i[t];if(e!==void 0){if(e!=="pixels"&&e!=="fraction")throw new Error(`Expected pixels or fraction for ${t}`);return e}}function Ew(i,t){const e=i[t];if(e!==void 0)return ds(e,t)}function jo(i,t){const e=i[t];if(e!==void 0){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);if(e!=="declutter"&&e!=="obstacle"&&e!=="none")throw new Error(`Expected declutter, obstacle, or none for ${t}`);return e}}function Cw(i,t){const e=i[t];if(e!==void 0)return Zf(e,t)}function ds(i,t){if(!Array.isArray(i))throw new Error(`Expected an array for ${t}`);const e=i.length;for(let n=0;n<e;++n)if(typeof i[n]!="number")throw new Error(`Expected an array of numbers for ${t}`);return i}function Yf(i,t){if(typeof i!="string")throw new Error(`Expected a string for ${t}`);return i}function bl(i,t){if(typeof i!="number")throw new Error(`Expected a number for ${t}`);return i}function Zf(i,t){if(typeof i=="string")return i;const e=ds(i,t),n=e.length;if(n<3||n>4)throw new Error(`Expected a color with 3 or 4 values for ${t}`);return e}function Jf(i,t){const e=ds(i,t);if(e.length!==2)throw new Error(`Expected an array of two numbers for ${t}`);return e}function xw(i,t){return typeof i=="number"?i:Jf(i,t)}const _u={RENDER_ORDER:"renderOrder"};class Qf extends No{constructor(t){t=t||{};const e=Object.assign({},t);delete e.style,delete e.renderBuffer,delete e.updateWhileAnimating,delete e.updateWhileInteracting,super(e),this.declutter_=t.declutter?String(t.declutter):void 0,this.renderBuffer_=t.renderBuffer!==void 0?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=t.updateWhileAnimating!==void 0?t.updateWhileAnimating:!1,this.updateWhileInteracting_=t.updateWhileInteracting!==void 0?t.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(t){return super.getFeatures(t)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(_u.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(t,e){const n=this.getDeclutter();n in t.declutter||(t.declutter[n]=new Pd(9)),this.getRenderer().renderDeclutter(t,e)}setRenderOrder(t){this.set(_u.RENDER_ORDER,t)}setStyle(t){this.style_=t===void 0?Kf:t;const e=Sw(t);this.styleFunction_=t===null?void 0:cw(e),this.changed()}setDeclutter(t){this.declutter_=t?String(t):void 0,this.changed()}}function Sw(i){if(i===void 0)return Kf;if(!i)return null;if(typeof i=="function"||i instanceof Yn)return i;if(!Array.isArray(i))return fu([i]);if(i.length===0)return[];const t=i.length,e=i[0];if(e instanceof Yn){const r=new Array(t);for(let s=0;s<t;++s){const o=i[s];if(!(o instanceof Yn))throw new Error("Expected a list of style instances");r[s]=o}return r}if("style"in e){const r=new Array(t);for(let s=0;s<t;++s){const o=i[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");r[s]=o}return dw(r)}return fu(i)}class tg extends on{constructor(t,e,n,r){super(t),this.inversePixelTransform=e,this.frameState=n,this.context=r}}class Iw extends Co{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){U()}calculateMatrices2D(t){const e=t.viewState,n=t.coordinateToPixelTransform,r=t.pixelToCoordinateTransform;en(n,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),rf(r,n)}forEachFeatureAtCoordinate(t,e,n,r,s,o,a,l){let c;const h=e.viewState;function u(S,T,A,y){return s.call(o,T,S?A:null,y)}const d=h.projection,f=Yd(t.slice(),d),m=[[0,0]];if(d.canWrapX()&&r){const S=d.getExtent(),T=ot(S);m.push([-T,0],[T,0])}const v=e.layerStatesArray,w=v.length,E=[],I=[];for(let S=0;S<m.length;S++)for(let T=w-1;T>=0;--T){const A=v[T],y=A.layer;if(y.hasRenderer()&&Ac(A,h)&&a.call(l,y)){const g=y.getRenderer(),p=y.getSource();if(g&&p){const b=p.getWrapX()?f:t,C=u.bind(null,A.managed);I[0]=b[0]+m[S][0],I[1]=b[1]+m[S][1],c=g.forEachFeatureAtCoordinate(I,e,n,C,E)}if(c)return c}}if(E.length===0)return;const R=1/E.length;return E.forEach((S,T)=>S.distanceSq+=T*R),E.sort((S,T)=>S.distanceSq-T.distanceSq),E.some(S=>c=S.callback(S.feature,S.layer,S.geometry)),c}hasFeatureAtCoordinate(t,e,n,r,s,o){return this.forEachFeatureAtCoordinate(t,e,n,r,Lr,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(t){U()}scheduleExpireIconCache(t){he.canExpireCache()&&t.postRenderFunctions.push(Tw)}}function Tw(i,t){he.expire()}class Rw extends Iw{constructor(t){super(t),this.fontChangeListenerKey_=tt(Ti,Vi.PROPERTYCHANGE,t.redrawText,t),this.element_=document.createElement("div");const e=this.element_.style;e.position="absolute",e.width="100%",e.height="100%",e.zIndex="0",this.element_.className=Do+" ol-layers";const n=t.getViewport();n.insertBefore(this.element_,n.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(t,e){const n=this.getMap();if(n.hasListener(t)){const r=new tg(t,void 0,e);n.dispatchEvent(r)}}disposeInternal(){ct(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(t){if(!t){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(t),this.dispatchRenderEvent(ce.PRECOMPOSE,t);const e=t.layerStatesArray.sort((a,l)=>a.zIndex-l.zIndex);e.some(a=>a.layer instanceof Qf&&a.layer.getDeclutter())&&(t.declutter={});const r=t.viewState;this.children_.length=0;const s=[];let o=null;for(let a=0,l=e.length;a<l;++a){const c=e[a];t.layerIndex=a;const h=c.layer,u=h.getSourceState();if(!Ac(c,r)||u!="ready"&&u!="undefined"){h.unrender();continue}const d=h.render(t,o);d&&(d!==o&&(this.children_.push(d),o=d),s.push(c))}this.declutter(t,s),jy(this.element_,this.children_),this.dispatchRenderEvent(ce.POSTCOMPOSE,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}declutter(t,e){if(t.declutter){for(let n=e.length-1;n>=0;--n){const r=e[n],s=r.layer;s.getDeclutter()&&s.renderDeclutter(t,r)}e.forEach(n=>n.layer.renderDeferred(t))}}}function eg(i){if(i instanceof No){i.setMapInternal(null);return}i instanceof er&&i.getLayers().forEach(eg)}function ng(i,t){if(i instanceof No){i.setMapInternal(t);return}if(i instanceof er){const e=i.getLayers().getArray();for(let n=0,r=e.length;n<r;++n)ng(e[n],t)}}let Aw=class extends $e{constructor(t){super(),t=t||{},this.on,this.once,this.un;const e=Pw(t);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=t.maxTilesLoading!==void 0?t.maxTilesLoading:16,this.pixelRatio_=t.pixelRatio!==void 0?t.pixelRatio:Sy,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=ve(),this.pixelToCoordinateTransform_=ve(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=t.moveTolerance,this.keyboardEventTarget_=e.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver(()=>this.updateSize()),this.controls=e.controls||Ky(),this.interactions=e.interactions||m0({onFocusOnly:!0}),this.overlays_=e.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new Ry(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(kt.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(kt.VIEW,this.handleViewChanged_),this.addChangeListener(kt.SIZE,this.handleSizeChanged_),this.addChangeListener(kt.TARGET,this.handleTargetChanged_),this.setProperties(e.values);const n=this;t.view&&!(t.view instanceof Re)&&t.view.then(function(r){n.setView(new Re(r))}),this.controls.addEventListener(jt.ADD,r=>{r.element.setMap(this)}),this.controls.addEventListener(jt.REMOVE,r=>{r.element.setMap(null)}),this.interactions.addEventListener(jt.ADD,r=>{r.element.setMap(this)}),this.interactions.addEventListener(jt.REMOVE,r=>{r.element.setMap(null)}),this.overlays_.addEventListener(jt.ADD,r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener(jt.REMOVE,r=>{const s=r.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(t){this.getControls().push(t)}addInteraction(t){this.getInteractions().push(t)}addLayer(t){this.getLayerGroup().getLayers().push(t)}handleLayerAdd_(t){ng(t.layer,this)}addOverlay(t){this.getOverlays().push(t)}addOverlayInternal_(t){const e=t.getId();e!==void 0&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(t,e,n){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(t);n=n!==void 0?n:{};const s=n.hitTolerance!==void 0?n.hitTolerance:0,o=n.layerFilter!==void 0?n.layerFilter:Lr,a=n.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,s,a,e,null,o,null)}getFeaturesAtPixel(t,e){const n=[];return this.forEachFeatureAtPixel(t,function(r){n.push(r)},e),n}getAllLayers(){const t=[];function e(n){n.forEach(function(r){r instanceof er?e(r.getLayers()):t.push(r)})}return e(this.getLayers()),t}hasFeatureAtPixel(t,e){if(!this.frameState_||!this.renderer_)return!1;const n=this.getCoordinateFromPixelInternal(t);e=e!==void 0?e:{};const r=e.layerFilter!==void 0?e.layerFilter:Lr,s=e.hitTolerance!==void 0?e.hitTolerance:0,o=e.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(n,this.frameState_,s,o,r,null)}getEventCoordinate(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}getEventCoordinateInternal(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}getEventPixel(t){const n=this.viewport_.getBoundingClientRect(),r=this.getSize(),s=n.width/r[0],o=n.height/r[1],a="changedTouches"in t?t.changedTouches[0]:t;return[(a.clientX-n.left)/s,(a.clientY-n.top)/o]}getTarget(){return this.get(kt.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(t){return al(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}getCoordinateFromPixelInternal(t){const e=this.frameState_;return e?Tt(e.pixelToCoordinateTransform,t.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(t){const e=this.overlayIdIndex_[t.toString()];return e!==void 0?e:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(kt.LAYERGROUP)}setLayers(t){const e=this.getLayerGroup();if(t instanceof Le){e.setLayers(t);return}const n=e.getLayers();n.clear(),n.extend(t)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,n=t.length;e<n;++e){const r=t[e];if(!r.visible)continue;const s=r.layer.getRenderer();if(s&&!s.ready)return!0;const o=r.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(t){const e=qe(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}getPixelFromCoordinateInternal(t){const e=this.frameState_;return e?Tt(e.coordinateToPixelTransform,t.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(kt.SIZE)}getView(){return this.get(kt.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const t=this.getTargetElement();return t?t.ownerDocument:document}getTilePriority(t,e,n,r){return Ay(this.frameState_,t,e,n,r)}handleBrowserEvent(t,e){e=e||t.type;const n=new fn(e,this,t);this.handleMapBrowserEvent(n)}handleMapBrowserEvent(t){if(!this.frameState_)return;const e=t.originalEvent,n=e.type;if(n===pl.POINTERDOWN||n===W.WHEEL||n===W.KEYDOWN){const r=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o=e.target,a=s instanceof ShadowRoot?s.host===o?s.host.ownerDocument:s:s===r?r.documentElement:s;if(this.overlayContainerStopEvent_.contains(o)||!a.contains(o))return}if(t.frameState=this.frameState_,this.dispatchEvent(t)!==!1){const r=this.getInteractions().getArray().slice();for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(t)||t.propagationStopped)break}}}handlePostRender(){const t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){let r=this.maxTilesLoading_,s=r;if(t){const o=t.viewHints;if(o[Ft.ANIMATING]||o[Ft.INTERACTING]){const a=Date.now()-t.time>8;r=a?0:8,s=a?0:2}}e.getTilesLoading()<r&&(e.reprioritize(),e.loadMoreTiles(r,s))}t&&this.renderer_&&!t.animate&&(this.renderComplete_?(this.hasListener(ce.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(ce.RENDERCOMPLETE,t),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Ii(gn.LOADEND,this,t)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Ii(gn.LOADSTART,this,t))));const n=this.postRenderFunctions_;if(t)for(let r=0,s=n.length;r<s;++r)n[r](this,t);n.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let n=0,r=this.targetChangeHandlerKeys_.length;n<r;++n)ct(this.targetChangeHandlerKeys_[n]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(W.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(W.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const n=this.targetElement_.getRootNode();n instanceof ShadowRoot&&this.resizeObserver_.unobserve(n.host),this.setSize(void 0)}const t=this.getTarget(),e=typeof t=="string"?document.getElementById(t):t;if(this.targetElement_=e,!e)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{e.appendChild(this.viewport_),this.renderer_||(this.renderer_=new Rw(this)),this.mapBrowserEventHandler_=new Iy(this,this.moveTolerance_);for(const s in gt)this.mapBrowserEventHandler_.addEventListener(gt[s],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(W.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(W.WHEEL,this.boundHandleBrowserEvent_,Of?{passive:!1}:!1);let n;if(this.keyboardEventTarget_)n=this.keyboardEventTarget_;else{const s=e.getRootNode();n=s instanceof ShadowRoot?s.host:e}this.targetChangeHandlerKeys_=[tt(n,W.KEYDOWN,this.handleBrowserEvent,this),tt(n,W.KEYPRESS,this.handleBrowserEvent,this)];const r=e.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.observe(r.host),this.resizeObserver_.observe(e)}this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(ct(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(ct(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const t=this.getView();t&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=tt(t,Vi.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=tt(t,W.CHANGE,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(ct),this.layerGroupPropertyListenerKeys_=null);const t=this.getLayerGroup();t&&(this.handleLayerAdd_(new pn("addlayer",t)),this.layerGroupPropertyListenerKeys_=[tt(t,Vi.PROPERTYCHANGE,this.render,this),tt(t,W.CHANGE,this.render,this),tt(t,"addlayer",this.handleLayerAdd_,this),tt(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const t=this.frameState_.layerStatesArray;for(let e=0,n=t.length;e<n;++e){const r=t[e].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(t){return this.getControls().remove(t)}removeInteraction(t){return this.getInteractions().remove(t)}removeLayer(t){return this.getLayerGroup().getLayers().remove(t)}handleLayerRemove_(t){eg(t.layer)}removeOverlay(t){return this.getOverlays().remove(t)}renderFrame_(t){const e=this.getSize(),n=this.getView(),r=this.frameState_;let s=null;if(e!==void 0&&su(e)&&n&&n.isDef()){const o=n.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=n.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:el(a.center,a.resolution,a.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{},mapId:et(this),renderTargets:{}},a.nextCenter&&a.nextResolution){const l=isNaN(a.nextRotation)?a.rotation:a.nextRotation;s.nextExtent=el(a.nextCenter,a.nextResolution,l,e)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),r&&(!this.previousExtent_||!es(this.previousExtent_)&&!Pr(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Ii(gn.MOVESTART,this,r)),this.previousExtent_=Qi(this.previousExtent_)),this.previousExtent_&&!s.viewHints[Ft.ANIMATING]&&!s.viewHints[Ft.INTERACTING]&&!Pr(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Ii(gn.MOVEEND,this,s)),zd(s.extent,this.previousExtent_))),this.dispatchEvent(new Ii(gn.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(gn.LOADSTART)||this.hasListener(gn.LOADEND)||this.hasListener(ce.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(t){const e=this.getLayerGroup();e&&this.handleLayerRemove_(new pn("removelayer",e)),this.set(kt.LAYERGROUP,t)}setSize(t){this.set(kt.SIZE,t)}setTarget(t){this.set(kt.TARGET,t)}setView(t){if(!t||t instanceof Re){this.set(kt.VIEW,t);return}this.set(kt.VIEW,new Re);const e=this;t.then(function(n){e.setView(new Re(n))})}updateSize(){const t=this.getTargetElement();let e;if(t){const r=getComputedStyle(t),s=t.offsetWidth-parseFloat(r.borderLeftWidth)-parseFloat(r.paddingLeft)-parseFloat(r.paddingRight)-parseFloat(r.borderRightWidth),o=t.offsetHeight-parseFloat(r.borderTopWidth)-parseFloat(r.paddingTop)-parseFloat(r.paddingBottom)-parseFloat(r.borderBottomWidth);!isNaN(s)&&!isNaN(o)&&(e=[Math.max(0,s),Math.max(0,o)],!su(e)&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&Hd("No map visible because the map container's width or height are 0."))}const n=this.getSize();e&&(!n||!Pn(e,n))&&(this.setSize(e),this.updateViewportSize_(e))}updateViewportSize_(t){const e=this.getView();e&&e.setViewportSize(t)}};function Pw(i){let t=null;i.keyboardEventTarget!==void 0&&(t=typeof i.keyboardEventTarget=="string"?document.getElementById(i.keyboardEventTarget):i.keyboardEventTarget);const e={},n=i.layers&&typeof i.layers.getLayers=="function"?i.layers:new er({layers:i.layers});e[kt.LAYERGROUP]=n,e[kt.TARGET]=i.target,e[kt.VIEW]=i.view instanceof Re?i.view:new Re;let r;i.controls!==void 0&&(Array.isArray(i.controls)?r=new Le(i.controls.slice()):(it(typeof i.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),r=i.controls));let s;i.interactions!==void 0&&(Array.isArray(i.interactions)?s=new Le(i.interactions.slice()):(it(typeof i.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=i.interactions));let o;return i.overlays!==void 0?Array.isArray(i.overlays)?o=new Le(i.overlays.slice()):(it(typeof i.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=i.overlays):o=new Le,{controls:r,interactions:s,keyboardEventTarget:t,overlays:o,values:e}}class Nc extends So{constructor(t,e,n){super(),n=n||{},this.tileCoord=t,this.state=e,this.key="",this.transition_=n.transition===void 0?250:n.transition,this.transitionStarts_={},this.interpolate=!!n.interpolate}changed(){this.dispatchEvent(W.CHANGE)}release(){this.setState(z.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(this.state!==z.EMPTY){if(this.state!==z.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}}load(){U()}getAlpha(t,e){if(!this.transition_)return 1;let n=this.transitionStarts_[t];if(!n)n=e,this.transitionStarts_[t]=n;else if(n===-1)return 1;const r=e-n+1e3/60;return r>=this.transition_?1:kf(r/this.transition_)}inTransition(t){return this.transition_?this.transitionStarts_[t]!==-1:!1}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function El(i){return i instanceof Image||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageBitmap?i:null}const Lw=new Error("disposed"),Mw=[256,256];class yu extends Nc{constructor(t){const e=z.IDLE;super(t.tileCoord,e,{transition:t.transition,interpolate:t.interpolate}),this.loader_=t.loader,this.data_=null,this.error_=null,this.size_=t.size||null,this.controller_=t.controller||null}getSize(){if(this.size_)return this.size_;const t=El(this.data_);return t?[t.width,t.height]:Mw}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==z.IDLE&&this.state!==z.ERROR)return;this.state=z.LOADING,this.changed();const t=this;this.loader_().then(function(e){t.data_=e,t.state=z.LOADED,t.changed()}).catch(function(e){t.error_=e,t.state=z.ERROR,t.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(Lw),this.controller_=null),super.disposeInternal()}}class ig extends Nc{constructor(t,e,n,r,s,o){super(t,e,o),this.crossOrigin_=r,this.src_=n,this.key=n,this.image_=new Image,r!==null&&(this.image_.crossOrigin=r),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(t){this.image_=t,this.state=z.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=z.ERROR,this.unlistenImage_(),this.image_=Ow(),this.changed()}handleImageLoad_(){const t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=z.LOADED:this.state=z.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==z.ERROR&&(this.state=z.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==z.IDLE&&(this.state=z.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=Z0(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function Ow(){const i=xt(1,1);return i.fillStyle="rgba(0,0,0,0)",i.fillRect(0,0,1,1),i.canvas}class $c{constructor(t,e,n,r){this.minX=t,this.maxX=e,this.minY=n,this.maxY=r}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}function Ei(i,t,e,n,r){return r!==void 0?(r.minX=i,r.maxX=t,r.minY=e,r.maxY=n,r):new $c(i,t,e,n)}let Da;const Fi=[];function wu(i,t,e,n,r){i.beginPath(),i.moveTo(0,0),i.lineTo(t,e),i.lineTo(n,r),i.closePath(),i.save(),i.clip(),i.fillRect(0,0,Math.max(t,n)+1,Math.max(e,r)),i.restore()}function Fa(i,t){return Math.abs(i[t*4]-210)>2||Math.abs(i[t*4+3]-.75*255)>2}function kw(){if(Da===void 0){const i=xt(6,6,Fi);i.globalCompositeOperation="lighter",i.fillStyle="rgba(210, 0, 0, 0.75)",wu(i,4,5,4,0),wu(i,4,5,0,5);const t=i.getImageData(0,0,3,3).data;Da=Fa(t,0)||Fa(t,4)||Fa(t,8),Fo(i),Fi.push(i.canvas)}return Da}function vu(i,t,e,n){const r=Ro(e,t,i);let s=Oh(t,n,e);const o=t.getMetersPerUnit();o!==void 0&&(s*=o);const a=i.getMetersPerUnit();a!==void 0&&(s/=a);const l=i.getExtent();if(!l||$i(l,r)){const c=Oh(i,s,r)/s;isFinite(c)&&c>0&&(s/=c)}return s}function Dw(i,t,e,n){const r=tn(e);let s=vu(i,t,r,n);return(!isFinite(s)||s<=0)&&jd(e,function(o){return s=vu(i,t,o,n),isFinite(s)&&s>0}),s}function Fw(i,t,e,n,r,s,o,a,l,c,h,u,d,f){const m=xt(Math.round(e*i),Math.round(e*t),Fi);if(u||(m.imageSmoothingEnabled=!1),l.length===0)return m.canvas;m.scale(e,e);function v(T){return Math.round(T*e)/e}m.globalCompositeOperation="lighter";const w=fe();l.forEach(function(T,A,y){Ud(w,T.extent)});let E;const I=e/n,R=(u?1:1+Math.pow(2,-24))/I;E=xt(Math.round(ot(w)*I),Math.round(Ut(w)*I),Fi),u||(E.imageSmoothingEnabled=!1),l.forEach(function(T,A,y){if(T.image.width>0&&T.image.height>0){if(T.clipExtent){E.save();const x=(T.clipExtent[0]-w[0])*I,_=-(T.clipExtent[3]-w[3])*I,V=ot(T.clipExtent)*I,D=Ut(T.clipExtent)*I;E.rect(u?x:Math.round(x),u?_:Math.round(_),u?V:Math.round(x+V)-Math.round(x),u?D:Math.round(_+D)-Math.round(_)),E.clip()}const g=(T.extent[0]-w[0])*I,p=-(T.extent[3]-w[3])*I,b=ot(T.extent)*I,C=Ut(T.extent)*I;E.drawImage(T.image,c,c,T.image.width-2*c,T.image.height-2*c,u?g:Math.round(g),u?p:Math.round(p),u?b:Math.round(g+b)-Math.round(g),u?C:Math.round(p+C)-Math.round(p)),T.clipExtent&&E.restore()}});const S=oi(o);return a.getTriangles().forEach(function(T,A,y){const g=T.source,p=T.target;let b=g[0][0],C=g[0][1],x=g[1][0],_=g[1][1],V=g[2][0],D=g[2][1];const B=v((p[0][0]-S[0])/s),k=v(-(p[0][1]-S[1])/s),F=v((p[1][0]-S[0])/s),q=v(-(p[1][1]-S[1])/s),Z=v((p[2][0]-S[0])/s),at=v(-(p[2][1]-S[1])/s),O=b,Lt=C;b=0,C=0,x-=O,_-=Lt,V-=O,D-=Lt;const $t=[[x,_,0,0,F-B],[V,D,0,0,Z-B],[0,0,x,_,q-k],[0,0,V,D,at-k]],pt=_m($t);if(!pt)return;if(m.save(),m.beginPath(),kw()||!u){m.moveTo(F,q);const Mt=4,xe=B-F,pe=k-q;for(let te=0;te<Mt;te++)m.lineTo(F+v((te+1)*xe/Mt),q+v(te*pe/(Mt-1))),te!=Mt-1&&m.lineTo(F+v((te+1)*xe/Mt),q+v((te+1)*pe/(Mt-1)));m.lineTo(Z,at)}else m.moveTo(F,q),m.lineTo(B,k),m.lineTo(Z,at);m.clip(),m.transform(pt[0],pt[2],pt[1],pt[3],B,k),m.translate(w[0]-O,w[3]-Lt);let Qt;if(E)Qt=E.canvas,m.scale(R,-R);else{const Mt=l[0],xe=Mt.extent;Qt=Mt.image,m.scale(ot(xe)/Qt.width,-Ut(xe)/Qt.height)}m.drawImage(Qt,0,0),m.restore()}),E&&(Fo(E),Fi.push(E.canvas)),h&&(m.save(),m.globalCompositeOperation="source-over",m.strokeStyle="black",m.lineWidth=1,a.getTriangles().forEach(function(T,A,y){const g=T.target,p=(g[0][0]-S[0])/s,b=-(g[0][1]-S[1])/s,C=(g[1][0]-S[0])/s,x=-(g[1][1]-S[1])/s,_=(g[2][0]-S[0])/s,V=-(g[2][1]-S[1])/s;m.beginPath(),m.moveTo(C,x),m.lineTo(p,b),m.lineTo(_,V),m.closePath(),m.stroke()}),m.restore()),m.canvas}const Nw=10,bu=.25;class $w{constructor(t,e,n,r,s,o,a){this.sourceProj_=t,this.targetProj_=e;let l={};const c=a?Jm(R=>Tt(a,Ro(R,this.targetProj_,this.sourceProj_))):Gi(this.targetProj_,this.sourceProj_);this.transformInv_=function(R){const S=R[0]+"/"+R[1];return l[S]||(l[S]=c(R)),l[S]},this.maxSourceExtent_=r,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&ot(r)>=ot(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?ot(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?ot(this.targetProj_.getExtent()):null;const h=oi(n),u=bo(n),d=vo(n),f=wo(n),m=this.transformInv_(h),v=this.transformInv_(u),w=this.transformInv_(d),E=this.transformInv_(f),I=Nw+(o?Math.max(0,Math.ceil(Math.log2(tl(n)/(o*o*256*256)))):0);if(this.addQuad_(h,u,d,f,m,v,w,E,I),this.wrapsXInSource_){let R=1/0;this.triangles_.forEach(function(S,T,A){R=Math.min(R,S.source[0][0],S.source[1][0],S.source[2][0])}),this.triangles_.forEach(S=>{if(Math.max(S.source[0][0],S.source[1][0],S.source[2][0])-R>this.sourceWorldWidth_/2){const T=[[S.source[0][0],S.source[0][1]],[S.source[1][0],S.source[1][1]],[S.source[2][0],S.source[2][1]]];T[0][0]-R>this.sourceWorldWidth_/2&&(T[0][0]-=this.sourceWorldWidth_),T[1][0]-R>this.sourceWorldWidth_/2&&(T[1][0]-=this.sourceWorldWidth_),T[2][0]-R>this.sourceWorldWidth_/2&&(T[2][0]-=this.sourceWorldWidth_);const A=Math.min(T[0][0],T[1][0],T[2][0]);Math.max(T[0][0],T[1][0],T[2][0])-A<this.sourceWorldWidth_/2&&(S.source=T)}})}l={}}addTriangle_(t,e,n,r,s,o){this.triangles_.push({source:[r,s,o],target:[t,e,n]})}addQuad_(t,e,n,r,s,o,a,l,c){const h=Ch([s,o,a,l]),u=this.sourceWorldWidth_?ot(h)/this.sourceWorldWidth_:null,d=this.sourceWorldWidth_,f=this.sourceProj_.canWrapX()&&u>.5&&u<1;let m=!1;if(c>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const w=Ch([t,e,n,r]);m=ot(w)/this.targetWorldWidth_>bu||m}!f&&this.sourceProj_.isGlobal()&&u&&(m=u>bu||m)}if(!m&&this.maxSourceExtent_&&isFinite(h[0])&&isFinite(h[1])&&isFinite(h[2])&&isFinite(h[3])&&!Xt(h,this.maxSourceExtent_))return;let v=0;if(!m&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(l[0])||!isFinite(l[1]))){if(c>0)m=!0;else if(v=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),v!=1&&v!=2&&v!=4&&v!=8)return}if(c>0){if(!m){const w=[(t[0]+n[0])/2,(t[1]+n[1])/2],E=this.transformInv_(w);let I;f?I=(Mi(s[0],d)+Mi(a[0],d))/2-Mi(E[0],d):I=(s[0]+a[0])/2-E[0];const R=(s[1]+a[1])/2-E[1];m=I*I+R*R>this.errorThresholdSquared_}if(m){if(Math.abs(t[0]-n[0])<=Math.abs(t[1]-n[1])){const w=[(e[0]+n[0])/2,(e[1]+n[1])/2],E=this.transformInv_(w),I=[(r[0]+t[0])/2,(r[1]+t[1])/2],R=this.transformInv_(I);this.addQuad_(t,e,w,I,s,o,E,R,c-1),this.addQuad_(I,w,n,r,R,E,a,l,c-1)}else{const w=[(t[0]+e[0])/2,(t[1]+e[1])/2],E=this.transformInv_(w),I=[(n[0]+r[0])/2,(n[1]+r[1])/2],R=this.transformInv_(I);this.addQuad_(t,w,I,r,s,E,R,l,c-1),this.addQuad_(w,e,n,I,E,o,a,R,c-1)}return}}if(f){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(v&11)==0&&this.addTriangle_(t,n,r,s,a,l),(v&14)==0&&this.addTriangle_(t,n,e,s,a,o),v&&((v&13)==0&&this.addTriangle_(e,r,t,o,l,s),(v&7)==0&&this.addTriangle_(e,r,n,o,l,a))}calculateSourceExtent(){const t=fe();return this.triangles_.forEach(function(e,n,r){const s=e.source;Cr(t,s[0]),Cr(t,s[1]),Cr(t,s[2])}),t}getTriangles(){return this.triangles_}}const Vw=.5;class rg extends Nc{constructor(t,e,n,r,s,o,a,l,c,h,u,d){super(s,z.IDLE,d),this.renderEdges_=u!==void 0?u:!1,this.pixelRatio_=a,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=r,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=t.canWrapX()?t.getExtent():void 0;const f=r.getTileCoordExtent(this.wrappedTileCoord_),m=this.targetTileGrid_.getExtent();let v=this.sourceTileGrid_.getExtent();const w=m?Kn(f,m):f;if(tl(w)===0){this.state=z.EMPTY;return}const E=t.getExtent();E&&(v?v=Kn(v,E):v=E);const I=r.getResolution(this.wrappedTileCoord_[0]),R=Dw(t,n,w,I);if(!isFinite(R)||R<=0){this.state=z.EMPTY;return}const S=h!==void 0?h:Vw;if(this.triangulation_=new $w(t,n,w,v,R*S,I),this.triangulation_.getTriangles().length===0){this.state=z.EMPTY;return}this.sourceZ_=e.getZForResolution(R);let T=this.triangulation_.calculateSourceExtent();if(v&&(t.canWrapX()?(T[1]=dt(T[1],v[1],v[3]),T[3]=dt(T[3],v[1],v[3])):T=Kn(T,v)),!tl(T))this.state=z.EMPTY;else{let A=0,y=0;t.canWrapX()&&(A=ot(E),y=Math.floor((T[0]-E[0])/A)),Xd(T.slice(),t,!0).forEach(p=>{const b=e.getTileRangeForExtentAndZ(p,this.sourceZ_);for(let C=b.minX;C<=b.maxX;C++)for(let x=b.minY;x<=b.maxY;x++){const _=c(this.sourceZ_,C,x,a);if(_){const V=y*A;this.sourceTiles_.push({tile:_,offset:V})}}++y}),this.sourceTiles_.length===0&&(this.state=z.EMPTY)}}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach(e=>{const n=e.tile;if(n&&n.getState()==z.LOADED){const r=this.sourceTileGrid_.getTileCoordExtent(n.tileCoord);r[0]+=e.offset,r[2]+=e.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=e.offset,s[2]+=e.offset),t.push({extent:r,clipExtent:s,image:n.getImage()})}}),this.sourceTiles_.length=0,t.length===0)this.state=z.ERROR;else{const e=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(e),r=typeof n=="number"?n:n[0],s=typeof n=="number"?n:n[1],o=this.targetTileGrid_.getResolution(e),a=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=Fw(r,s,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,l,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=z.LOADED}this.changed()}load(){if(this.state==z.IDLE){this.state=z.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:e})=>{const n=e.getState();if(n==z.IDLE||n==z.LOADING){t++;const r=tt(e,W.CHANGE,s=>{const o=e.getState();(o==z.LOADED||o==z.ERROR||o==z.EMPTY)&&(ct(r),t--,t===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(r)}}),t===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:e},n,r){e.getState()==z.IDLE&&e.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(ct),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Fo(this.canvas_.getContext("2d")),Fi.push(this.canvas_),this.canvas_=null),super.release()}}class zw{constructor(t){this.highWaterMark=t!==void 0?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const t=this.pop();t instanceof Co&&t.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){const n=this.entries_[t];return it(n!==void 0,"Tried to get a value for a key that does not exist in the cache"),n===this.newest_||(n===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(n.newer.older=n.older,n.older.newer=n.newer),n.newer=null,n.older=this.newest_,this.newest_.newer=n,this.newest_=n),n.value_}remove(t){const e=this.entries_[t];return it(e!==void 0,"Tried to get a value for a key that does not exist in the cache"),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){const t=new Array(this.count_);let e=0,n;for(n=this.newest_;n;n=n.older)t[e++]=n.key_;return t}getValues(){const t=new Array(this.count_);let e=0,n;for(n=this.newest_;n;n=n.older)t[e++]=n.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){return this.entries_[t]?.value_}pop(){const t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){it(!(t in this.entries_),"Tried to set a value for a key that is used already");const n={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[t]=n,++this.count_}setSize(t){this.highWaterMark=t}}function Js(i,t,e,n){return n!==void 0?(n[0]=i,n[1]=t,n[2]=e,n):[i,t,e]}function Gw(i,t,e){return i+"/"+t+"/"+e}function Uw(i){return Bw(i[0],i[1],i[2])}function Bw(i,t,e){return(t<<i)+e}function jw(i,t){const e=i[0],n=i[1],r=i[2];if(t.getMinZoom()>e||e>t.getMaxZoom())return!1;const s=t.getFullTileRange(e);return s?s.containsXY(n,r):!0}class sg{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(Ks(),{get:(t,e)=>{if(typeof Ks()[e]=="function")return this.push_(e),this.pushMethodArgs_},set:(t,e,n)=>(this.push_(e,n),!0)})}push_(...t){const e=this.instructions_,n=this.zIndex+this.offset_;e[n]||(e[n]=[]),e[n].push(...t)}pushMethodArgs_=(...t)=>(this.push_(t),this);pushFunction(t){this.push_(t)}getContext(){return this.context_}draw(t){this.instructions_.forEach(e=>{for(let n=0,r=e.length;n<r;++n){const s=e[n];if(typeof s=="function"){s(t);continue}const o=e[++n];if(typeof t[s]=="function")t[s](...o);else{if(typeof o=="function"){t[s]=o(t);continue}t[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const Ww=5;class qw extends is{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.staleKeys_=new Array,this.maxStaleKeys=Ww}getStaleKeys(){return this.staleKeys_}prependStaleKey(t){this.staleKeys_.unshift(t),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(t){return U()}getData(t){return null}prepareFrame(t){return U()}renderFrame(t,e){return U()}forEachFeatureAtCoordinate(t,e,n,r,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){const e=t.target;(e.getState()===K.LOADED||e.getState()===K.ERROR)&&this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return e!=K.LOADED&&e!=K.ERROR&&t.addEventListener(W.CHANGE,this.boundHandleImageChange_),e==K.IDLE&&(t.load(),e=t.getState()),e==K.LOADED}renderIfReadyAndVisible(){const t=this.getLayer();t&&t.getVisible()&&t.getSourceState()==="ready"&&t.changed()}renderDeferred(t){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const Eu=[];let Ri=null;function Xw(){Ri=xt(1,1,void 0,{willReadFrequently:!0})}class og extends qw{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=ve(),this.pixelTransform=ve(),this.inversePixelTransform=ve(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(t,e,n){Ri||Xw(),Ri.clearRect(0,0,1,1);let r;try{Ri.drawImage(t,e,n,1,1,0,0,1,1),r=Ri.getImageData(0,0,1,1).data}catch{return Ri=null,null}return r}getBackground(t){let n=this.getLayer().getBackground();return typeof n=="function"&&(n=n(t.viewState.resolution)),n||void 0}useContainer(t,e,n){const r=this.getLayer().getClassName();let s,o;if(t&&t.className===r&&(!n||t&&t.style.backgroundColor&&Pn(Bi(t.style.backgroundColor),Bi(n)))){const a=t.firstElementChild;a instanceof HTMLCanvasElement&&(o=a.getContext("2d"))}if(o&&a_(o.canvas.style.transform,e)?(this.container=t,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=document.createElement("div"),s.className=r;let a=s.style;a.position="absolute",a.width="100%",a.height="100%",o=xt();const l=o.canvas;s.appendChild(l),a=l.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&n&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=n)}clipUnrotated(t,e,n){const r=oi(n),s=bo(n),o=vo(n),a=wo(n);Tt(e.coordinateToPixelTransform,r),Tt(e.coordinateToPixelTransform,s),Tt(e.coordinateToPixelTransform,o),Tt(e.coordinateToPixelTransform,a);const l=this.inversePixelTransform;Tt(l,r),Tt(l,s),Tt(l,o),Tt(l,a),t.save(),t.beginPath(),t.moveTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.clip()}prepareContainer(t,e){const n=t.extent,r=t.viewState.resolution,s=t.viewState.rotation,o=t.pixelRatio,a=Math.round(ot(n)/r*o),l=Math.round(Ut(n)/r*o);en(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/o,1/o,s,-a/2,-l/2),rf(this.inversePixelTransform,this.pixelTransform);const c=o_(this.pixelTransform);if(this.useContainer(e,c,this.getBackground(t)),!this.containerReused){const h=this.context.canvas;h.width!=a||h.height!=l?(h.width=a,h.height=l):this.context.clearRect(0,0,a,l),c!==h.style.transform&&(h.style.transform=c)}}dispatchRenderEvent_(t,e,n){const r=this.getLayer();if(r.hasListener(t)){const s=new tg(t,this.inversePixelTransform,n,e);r.dispatchEvent(s)}}preRender(t,e){this.frameState=e,!e.declutter&&this.dispatchRenderEvent_(ce.PRERENDER,t,e)}postRender(t,e){e.declutter||this.dispatchRenderEvent_(ce.POSTRENDER,t,e)}renderDeferredInternal(t){}getRenderContext(t){return t.declutter&&!this.deferredContext_&&(this.deferredContext_=new sg),t.declutter?this.deferredContext_.getContext():this.context}renderDeferred(t){t.declutter&&(this.dispatchRenderEvent_(ce.PRERENDER,this.context,t),t.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(t),this.dispatchRenderEvent_(ce.POSTRENDER,this.context,t))}getRenderTransform(t,e,n,r,s,o,a){const l=s/2,c=o/2,h=r/e,u=-h,d=-t[0]+a,f=-t[1];return en(this.tempTransform,l,c,h,u,-n,d,f)}disposeInternal(){delete this.frameState,super.disposeInternal()}}function Na(i,t,e,n,r){return`${et(i)},${t},${Gw(e,n,r)}`}function $a(i,t,e){if(!(e in i))return i[e]=new Set([t]),!0;const n=i[e],r=n.has(t);return r||n.add(t),!r}function Kw(i,t,e){const n=i[e];return n?n.delete(t):!1}function Cu(i,t){const e=i.layerStatesArray[i.layerIndex];e.extent&&(t=Kn(t,yn(e.extent,i.viewState.projection)));const n=e.layer.getRenderSource();if(!n.getWrapX()){const r=n.getTileGridForProjection(i.viewState.projection).getExtent();r&&(t=Kn(t,r))}return t}class Hw extends og{constructor(t,e){super(t),e=e||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=fe(),this.tempTileRange_=new $c(0,0,0,0),this.tempTileCoord_=Js(0,0,0);const n=e.cacheSize!==void 0?e.cacheSize:512;this.tileCache_=new zw(n),this.maxStaleKeys=n*.5}getTileCache(){return this.tileCache_}getOrCreateTile(t,e,n,r){const s=this.tileCache_,a=this.getLayer().getSource(),l=Na(a,a.getKey(),t,e,n);let c;if(s.containsKey(l))c=s.get(l);else{if(c=a.getTile(t,e,n,r.pixelRatio,r.viewState.projection),!c)return null;s.set(l,c)}return c}getTile(t,e,n,r){const s=this.getOrCreateTile(t,e,n,r);return s||null}getData(t){const e=this.frameState;if(!e)return null;const n=this.getLayer(),r=Tt(e.pixelToCoordinateTransform,t.slice()),s=n.getExtent();if(s&&!$i(s,r))return null;const o=e.viewState,a=n.getRenderSource(),l=a.getTileGridForProjection(o.projection),c=a.getTilePixelRatio(e.pixelRatio);for(let h=l.getZForResolution(o.resolution);h>=l.getMinZoom();--h){const u=l.getTileCoordForCoordAndZ(r,h),d=this.getTile(h,u[1],u[2],e);if(!d||d.getState()!==z.LOADED)continue;const f=l.getOrigin(h),m=Yt(l.getTileSize(h)),v=l.getResolution(h);let w;if(d instanceof ig||d instanceof rg)w=d.getImage();else if(d instanceof yu){if(w=El(d.getData()),!w)continue}else continue;const E=Math.floor(c*((r[0]-f[0])/v-u[1]*m[0])),I=Math.floor(c*((f[1]-r[1])/v-u[2]*m[1])),R=Math.round(c*a.getGutterForProjection(o.projection));return this.getImageData(w,E+R,I+R)}return null}prepareFrame(t){this.renderedProjection?t.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=t.viewState.projection):this.renderedProjection=t.viewState.projection;const e=this.getLayer().getSource();if(!e)return!1;const n=e.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==n&&(this.renderedSourceRevision_=n,this.renderedSourceKey_===e.getKey()&&this.tileCache_.clear()):this.renderedSourceRevision_=n,!0}enqueueTiles(t,e,n,r,s){const o=t.viewState,a=this.getLayer(),l=a.getRenderSource(),c=l.getTileGridForProjection(o.projection),h=et(l);h in t.wantedTiles||(t.wantedTiles[h]={});const u=t.wantedTiles[h],d=a.getMapInternal(),f=Math.max(n-s,c.getMinZoom(),c.getZForResolution(Math.min(a.getMaxResolution(),d?d.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):c.getResolution(0)),l.zDirection)),m=o.rotation,v=m?Wd(o.center,o.resolution,m,t.size):void 0;for(let w=n;w>=f;--w){const E=c.getTileRangeForExtentAndZ(e,w,this.tempTileRange_),I=c.getResolution(w);for(let R=E.minX;R<=E.maxX;++R)for(let S=E.minY;S<=E.maxY;++S){if(m&&!c.tileCoordIntersectsViewport([w,R,S],v))continue;const T=this.getTile(w,R,S,t);if(!T||!$a(r,T,w))continue;const y=T.getKey();if(u[y]=!0,T.getState()===z.IDLE&&!t.tileQueue.isKeyQueued(y)){const g=Js(w,R,S,this.tempTileCoord_);t.tileQueue.enqueue([T,h,c.getTileCoordCenter(g),I])}}}}findStaleTile_(t,e){const n=this.tileCache_,r=t[0],s=t[1],o=t[2],a=this.getStaleKeys();for(let l=0;l<a.length;++l){const c=Na(this.getLayer().getSource(),a[l],r,s,o);if(n.containsKey(c)){const h=n.peek(c);if(h.getState()===z.LOADED)return h.endTransition(et(this)),$a(e,h,r),!0}}return!1}findAltTiles_(t,e,n,r){const s=t.getTileRangeForTileCoordAndZ(e,n,this.tempTileRange_);if(!s)return!1;let o=!0;const a=this.tileCache_,l=this.getLayer().getRenderSource(),c=l.getKey();for(let h=s.minX;h<=s.maxX;++h)for(let u=s.minY;u<=s.maxY;++u){const d=Na(l,c,n,h,u);let f=!1;if(a.containsKey(d)){const m=a.peek(d);m.getState()===z.LOADED&&($a(r,m,n),f=!0)}f||(o=!1)}return o}renderFrame(t,e){this.renderComplete=!0;const n=t.layerStatesArray[t.layerIndex],r=t.viewState,s=r.projection,o=r.resolution,a=r.center,l=t.pixelRatio,c=this.getLayer(),h=c.getSource(),u=h.getTileGridForProjection(s),d=u.getZForResolution(o,h.zDirection),f=u.getResolution(d),m=h.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==m&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=m):this.renderedSourceKey_=m;let v=t.extent;const w=h.getTilePixelRatio(l);this.prepareContainer(t,e);const E=this.context.canvas.width,I=this.context.canvas.height,R=n.extent&&yn(n.extent,s);R&&(v=Kn(v,yn(n.extent,s)));const S=f*E/2/w,T=f*I/2/w,A=[a[0]-S,a[1]-T,a[0]+S,a[1]+T],y={};this.renderedTiles.length=0;const g=c.getPreload();if(t.nextExtent){const F=u.getZForResolution(r.nextResolution,h.zDirection),q=Cu(t,t.nextExtent);this.enqueueTiles(t,q,F,y,g)}const p=Cu(t,v);if(this.enqueueTiles(t,p,d,y,0),g>0&&setTimeout(()=>{this.enqueueTiles(t,p,d-1,y,g-1)},0),!(d in y))return this.container;const b=et(this),C=t.time;for(const F of y[d]){const q=F.getState();if(q===z.EMPTY)continue;const Z=F.tileCoord;if(q===z.LOADED&&F.getAlpha(b,C)===1){F.endTransition(b);continue}if(q!==z.ERROR&&(this.renderComplete=!1),this.findStaleTile_(Z,y)){Kw(y,F,d),t.animate=!0;continue}if(this.findAltTiles_(u,Z,d+1,y))continue;const Lt=u.getMinZoom();for(let $t=d-1;$t>=Lt&&!this.findAltTiles_(u,Z,$t,y);--$t);}const x=f/o*l/w,_=this.getRenderContext(t);en(this.tempTransform,E/2,I/2,x,x,0,-E/2,-I/2),n.extent&&this.clipUnrotated(_,t,R),h.getInterpolate()||(_.imageSmoothingEnabled=!1),this.preRender(_,t);const V=Object.keys(y).map(Number);V.sort(He);let D;const B=[],k=[];for(let F=V.length-1;F>=0;--F){const q=V[F],Z=h.getTilePixelSize(q,l,s),O=u.getResolution(q)/f,Lt=Z[0]*O*x,$t=Z[1]*O*x,pt=u.getTileCoordForCoordAndZ(oi(A),q),Qt=u.getTileCoordExtent(pt),Mt=Tt(this.tempTransform,[w*(Qt[0]-A[0])/f,w*(A[3]-Qt[3])/f]),xe=w*h.getGutterForProjection(s);for(const pe of y[q]){if(pe.getState()!==z.LOADED)continue;const te=pe.tileCoord,ms=pt[1]-te[1],ra=Math.round(Mt[0]-(ms-1)*Lt),sr=pt[2]-te[2],Ln=Math.round(Mt[1]-(sr-1)*$t),ie=Math.round(Mt[0]-ms*Lt),Se=Math.round(Mt[1]-sr*$t),ui=ra-ie,di=Ln-Se,or=V.length===1;let Mn=!1;D=[ie,Se,ie+ui,Se,ie+ui,Se+di,ie,Se+di];for(let fi=0,gi=B.length;fi<gi;++fi)if(!or&&q<k[fi]){const St=B[fi];Xt([ie,Se,ie+ui,Se+di],[St[0],St[3],St[4],St[7]])&&(Mn||(_.save(),Mn=!0),_.beginPath(),_.moveTo(D[0],D[1]),_.lineTo(D[2],D[3]),_.lineTo(D[4],D[5]),_.lineTo(D[6],D[7]),_.moveTo(St[6],St[7]),_.lineTo(St[4],St[5]),_.lineTo(St[2],St[3]),_.lineTo(St[0],St[1]),_.clip())}B.push(D),k.push(q),this.drawTile(pe,t,ie,Se,ui,di,xe,or),Mn&&_.restore(),this.renderedTiles.unshift(pe),this.updateUsedTiles(t.usedTiles,h,pe)}}if(this.renderedResolution=f,this.extentChanged=!this.renderedExtent_||!Pr(this.renderedExtent_,A),this.renderedExtent_=A,this.renderedPixelRatio=l,this.postRender(this.context,t),n.extent&&_.restore(),_.imageSmoothingEnabled=!0,this.renderComplete){const F=(q,Z)=>{const at=et(h),O=Z.wantedTiles[at],Lt=O?Object.keys(O).length:0;this.updateCacheSize(Lt),this.tileCache_.expireCache()};t.postRenderFunctions.push(F)}return this.container}updateCacheSize(t){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,t*2)}drawTile(t,e,n,r,s,o,a,l){let c;if(t instanceof yu){if(c=El(t.getData()),!c)throw new Error("Rendering array data is not yet supported")}else c=this.getTileImage(t);if(!c)return;const h=this.getRenderContext(e),u=et(this),d=e.layerStatesArray[e.layerIndex],f=d.opacity*(l?t.getAlpha(u,e.time):1),m=f!==h.globalAlpha;m&&(h.save(),h.globalAlpha=f),h.drawImage(c,a,a,c.width-2*a,c.height-2*a,n,r,s,o),m&&h.restore(),f!==d.opacity?e.animate=!0:l&&t.endTransition(u)}getImage(){const t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}updateUsedTiles(t,e,n){const r=et(e);r in t||(t[r]={}),t[r][n.getKey()]=!0}}const Rs={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class Yw extends No{constructor(t){t=t||{};const e=Object.assign({},t),n=t.cacheSize;delete t.cacheSize,delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.cacheSize_=n,this.setPreload(t.preload!==void 0?t.preload:0),this.setUseInterimTilesOnError(t.useInterimTilesOnError!==void 0?t.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(Rs.PRELOAD)}setPreload(t){this.set(Rs.PRELOAD,t)}getUseInterimTilesOnError(){return this.get(Rs.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(t){this.set(Rs.USE_INTERIM_TILES_ON_ERROR,t)}getData(t){return super.getData(t)}}class Zw extends Yw{constructor(t){super(t)}createRenderer(){return new Hw(this,{cacheSize:this.getCacheSize()})}}class ag{drawCustom(t,e,n,r,s){}drawGeometry(t){}setStyle(t){}drawCircle(t,e,n){}drawFeature(t,e,n){}drawGeometryCollection(t,e,n){}drawLineString(t,e,n){}drawMultiLineString(t,e,n){}drawMultiPoint(t,e,n){}drawMultiPolygon(t,e,n){}drawPoint(t,e,n){}drawPolygon(t,e,n){}drawText(t,e,n){}setFillStrokeStyle(t,e){}setImageStyle(t,e){}setTextStyle(t,e){}}const $={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},As=[$.FILL],vn=[$.STROKE],Xn=[$.BEGIN_PATH],xu=[$.CLOSE_PATH];class fs extends ag{constructor(t,e,n,r){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=n,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const e=this.pixelRatio;return e==1?t:t.map(function(n){return n*e})}appendFlatPointCoordinates(t,e){const n=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let a=0,l=t.length;a<l;a+=e)r[0]=t[a],r[1]=t[a+1],$i(n,r)&&(s[o++]=r[0],s[o++]=r[1]);return o}appendFlatLineCoordinates(t,e,n,r,s,o){const a=this.coordinates;let l=a.length;const c=this.getBufferedMaxExtent();o&&(e+=r);let h=t[e],u=t[e+1];const d=this.tmpCoordinate_;let f=!0,m,v,w;for(m=e+r;m<n;m+=r)d[0]=t[m],d[1]=t[m+1],w=Qa(c,d),w!==v?(f&&(a[l++]=h,a[l++]=u,f=!1),a[l++]=d[0],a[l++]=d[1]):w===It.INTERSECTING?(a[l++]=d[0],a[l++]=d[1],f=!1):f=!0,h=d[0],u=d[1],v=w;return(s&&f||m===e+r)&&(a[l++]=h,a[l++]=u),l}drawCustomCoordinates_(t,e,n,r,s){for(let o=0,a=n.length;o<a;++o){const l=n[o],c=this.appendFlatLineCoordinates(t,e,l,r,!1,!1);s.push(c),e=l}return e}drawCustom(t,e,n,r,s){this.beginGeometry(t,e,s);const o=t.getType(),a=t.getStride(),l=this.coordinates.length;let c,h,u,d,f;switch(o){case"MultiPolygon":c=t.getOrientedFlatCoordinates(),d=[];const m=t.getEndss();f=0;for(let v=0,w=m.length;v<w;++v){const E=[];f=this.drawCustomCoordinates_(c,f,m[v],a,E),d.push(E)}this.instructions.push([$.CUSTOM,l,d,t,n,ll,s]),this.hitDetectionInstructions.push([$.CUSTOM,l,d,t,r||n,ll,s]);break;case"Polygon":case"MultiLineString":u=[],c=o=="Polygon"?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),f=this.drawCustomCoordinates_(c,0,t.getEnds(),a,u),this.instructions.push([$.CUSTOM,l,u,t,n,kr,s]),this.hitDetectionInstructions.push([$.CUSTOM,l,u,t,r||n,kr,s]);break;case"LineString":case"Circle":c=t.getFlatCoordinates(),h=this.appendFlatLineCoordinates(c,0,c.length,a,!1,!1),this.instructions.push([$.CUSTOM,l,h,t,n,wn,s]),this.hitDetectionInstructions.push([$.CUSTOM,l,h,t,r||n,wn,s]);break;case"MultiPoint":c=t.getFlatCoordinates(),h=this.appendFlatPointCoordinates(c,a),h>l&&(this.instructions.push([$.CUSTOM,l,h,t,n,wn,s]),this.hitDetectionInstructions.push([$.CUSTOM,l,h,t,r||n,wn,s]));break;case"Point":c=t.getFlatCoordinates(),this.coordinates.push(c[0],c[1]),h=this.coordinates.length,this.instructions.push([$.CUSTOM,l,h,t,n,void 0,s]),this.hitDetectionInstructions.push([$.CUSTOM,l,h,t,r||n,void 0,s]);break}this.endGeometry(e)}beginGeometry(t,e,n){this.beginGeometryInstruction1_=[$.BEGIN_GEOMETRY,e,0,t,n],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[$.BEGIN_GEOMETRY,e,0,t,n],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;t.reverse();let e;const n=t.length;let r,s,o=-1;for(e=0;e<n;++e)r=t[e],s=r[0],s==$.END_GEOMETRY?o=e:s==$.BEGIN_GEOMETRY&&(r[2]=e,lm(this.hitDetectionInstructions,o,e),o=-1)}fillStyleToState(t,e={}){if(t){const n=t.getColor();e.fillPatternScale=n&&typeof n=="object"&&"src"in n?this.pixelRatio:1,e.fillStyle=Me(n||qt)}else e.fillStyle=void 0;return e}strokeStyleToState(t,e={}){if(t){const n=t.getColor();e.strokeStyle=Me(n||Vr);const r=t.getLineCap();e.lineCap=r!==void 0?r:ji;const s=t.getLineDash();e.lineDash=s?s.slice():Ze;const o=t.getLineDashOffset();e.lineDashOffset=o||Je;const a=t.getLineJoin();e.lineJoin=a!==void 0?a:Wi;const l=t.getWidth();e.lineWidth=l!==void 0?l:Gr;const c=t.getMiterLimit();e.miterLimit=c!==void 0?c:$r,e.lineWidth>this.maxLineWidth&&(this.maxLineWidth=e.lineWidth,this.bufferedMaxExtent_=null)}else e.strokeStyle=void 0,e.lineCap=void 0,e.lineDash=null,e.lineDashOffset=void 0,e.lineJoin=void 0,e.lineWidth=void 0,e.miterLimit=void 0;return e}setFillStrokeStyle(t,e){const n=this.state;this.fillStyleToState(t,n),this.strokeStyleToState(e,n)}createFill(t){const e=t.fillStyle,n=[$.SET_FILL_STYLE,e];return typeof e!="string"&&n.push(t.fillPatternScale),n}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[$.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,t.lineDash?this.applyPixelRatio(t.lineDash):null,t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){const n=t.fillStyle;(typeof n!="string"||t.currentFillStyle!=n)&&(this.instructions.push(e.call(this,t)),t.currentFillStyle=n)}updateStrokeStyle(t,e){const n=t.strokeStyle,r=t.lineCap,s=t.lineDash,o=t.lineDashOffset,a=t.lineJoin,l=t.lineWidth,c=t.miterLimit;(t.currentStrokeStyle!=n||t.currentLineCap!=r||s!=t.currentLineDash&&!Pn(t.currentLineDash,s)||t.currentLineDashOffset!=o||t.currentLineJoin!=a||t.currentLineWidth!=l||t.currentMiterLimit!=c)&&(e.call(this,t),t.currentStrokeStyle=n,t.currentLineCap=r,t.currentLineDash=s,t.currentLineDashOffset=o,t.currentLineJoin=a,t.currentLineWidth=l,t.currentMiterLimit=c)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const e=[$.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=zd(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;Yl(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class Jw extends fs{constructor(t,e,n,r){super(t,e,n,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e,n){if(!this.image_||this.maxExtent&&!$i(this.maxExtent,t.getFlatCoordinates()))return;this.beginGeometry(t,e,n);const r=t.getFlatCoordinates(),s=t.getStride(),o=this.coordinates.length,a=this.appendFlatPointCoordinates(r,s);this.instructions.push([$.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([$.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e,n){if(!this.image_)return;this.beginGeometry(t,e,n);const r=t.getFlatCoordinates(),s=[];for(let l=0,c=r.length;l<c;l+=t.getStride())(!this.maxExtent||$i(this.maxExtent,r.slice(l,l+2)))&&s.push(r[l],r[l+1]);const o=this.coordinates.length,a=this.appendFlatPointCoordinates(s,2);this.instructions.push([$.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([$.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){const n=t.getAnchor(),r=t.getSize(),s=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=n[0],this.anchorY_=n[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=t.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=r[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}class Qw extends fs{constructor(t,e,n,r){super(t,e,n,r)}drawFlatCoordinates_(t,e,n,r){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(t,e,n,r,!1,!1),a=[$.MOVE_TO_LINE_TO,s,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),n}drawLineString(t,e,n){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(t,e,n),this.hitDetectionInstructions.push([$.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Ze,Je],Xn);const a=t.getFlatCoordinates(),l=t.getStride();this.drawFlatCoordinates_(a,0,a.length,l),this.hitDetectionInstructions.push(vn),this.endGeometry(e)}drawMultiLineString(t,e,n){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(t,e,n),this.hitDetectionInstructions.push([$.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Ze,Je],Xn);const a=t.getEnds(),l=t.getFlatCoordinates(),c=t.getStride();let h=0;for(let u=0,d=a.length;u<d;++u)h=this.drawFlatCoordinates_(l,h,a[u],c);this.hitDetectionInstructions.push(vn),this.endGeometry(e)}finish(){const t=this.state;return t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&this.instructions.push(vn),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(vn),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(Xn)}}class Su extends fs{constructor(t,e,n,r){super(t,e,n,r)}drawFlatCoordinatess_(t,e,n,r){const s=this.state,o=s.fillStyle!==void 0,a=s.strokeStyle!==void 0,l=n.length;this.instructions.push(Xn),this.hitDetectionInstructions.push(Xn);for(let c=0;c<l;++c){const h=n[c],u=this.coordinates.length,d=this.appendFlatLineCoordinates(t,e,h,r,!0,!a),f=[$.MOVE_TO_LINE_TO,u,d];this.instructions.push(f),this.hitDetectionInstructions.push(f),a&&(this.instructions.push(xu),this.hitDetectionInstructions.push(xu)),e=h}return o&&(this.instructions.push(As),this.hitDetectionInstructions.push(As)),a&&(this.instructions.push(vn),this.hitDetectionInstructions.push(vn)),e}drawCircle(t,e,n){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,n),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([$.SET_FILL_STYLE,qt]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([$.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Ze,Je]);const a=t.getFlatCoordinates(),l=t.getStride(),c=this.coordinates.length;this.appendFlatLineCoordinates(a,0,a.length,l,!1,!1);const h=[$.CIRCLE,c];this.instructions.push(Xn,h),this.hitDetectionInstructions.push(Xn,h),r.fillStyle!==void 0&&(this.instructions.push(As),this.hitDetectionInstructions.push(As)),r.strokeStyle!==void 0&&(this.instructions.push(vn),this.hitDetectionInstructions.push(vn)),this.endGeometry(e)}drawPolygon(t,e,n){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,n),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([$.SET_FILL_STYLE,qt]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([$.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Ze,Je]);const a=t.getEnds(),l=t.getOrientedFlatCoordinates(),c=t.getStride();this.drawFlatCoordinatess_(l,0,a,c),this.endGeometry(e)}drawMultiPolygon(t,e,n){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,n),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([$.SET_FILL_STYLE,qt]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([$.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,Ze,Je]);const a=t.getEndss(),l=t.getOrientedFlatCoordinates(),c=t.getStride();let h=0;for(let u=0,d=a.length;u<d;++u)h=this.drawFlatCoordinatess_(l,h,a[u],c);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(t!==0){const e=this.coordinates;for(let n=0,r=e.length;n<r;++n)e[n]=$n(e[n],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;this.updateFillStyle(t,this.createFill),this.updateStrokeStyle(t,this.applyStroke)}}function tv(i,t,e,n,r){const s=[];let o=e,a=0,l=t.slice(e,2);for(;a<i&&o+r<n;){const[c,h]=l.slice(-2),u=t[o+r],d=t[o+r+1],f=Math.sqrt((u-c)*(u-c)+(d-h)*(d-h));if(a+=f,a>=i){const m=(i-a+f)/f,v=ee(c,u,m),w=ee(h,d,m);l.push(v,w),s.push(l),l=[v,w],a==i&&(o+=r),a=0}else if(a<i)l.push(t[o+r],t[o+r+1]),o+=r;else{const m=f-a,v=ee(c,u,m/f),w=ee(h,d,m/f);l.push(v,w),s.push(l),l=[v,w],a=0,o+=r}}return a>0&&s.push(l),s}function ev(i,t,e,n,r){let s=e,o=e,a=0,l=0,c=e,h,u,d,f,m,v,w,E,I,R;for(u=e;u<n;u+=r){const S=t[u],T=t[u+1];m!==void 0&&(I=S-m,R=T-v,f=Math.sqrt(I*I+R*R),w!==void 0&&(l+=d,h=Math.acos((w*I+E*R)/(d*f)),h>i&&(l>a&&(a=l,s=c,o=u),l=0,c=u-r)),d=f,w=I,E=R),m=S,v=T}return l+=f,l>a?[c,u]:[s,o]}const Qs={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class nv extends fs{constructor(t,e,n,r){super(t,e,n,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[qt]={fillStyle:qt},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e,n){const r=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!r&&!s)return;const a=this.coordinates;let l=a.length;const c=t.getType();let h=null,u=t.getStride();if(o.placement==="line"&&(c=="LineString"||c=="MultiLineString"||c=="Polygon"||c=="MultiPolygon")){if(!Xt(this.maxExtent,t.getExtent()))return;let d;if(h=t.getFlatCoordinates(),c=="LineString")d=[h.length];else if(c=="MultiLineString")d=t.getEnds();else if(c=="Polygon")d=t.getEnds().slice(0,1);else if(c=="MultiPolygon"){const w=t.getEndss();d=[];for(let E=0,I=w.length;E<I;++E)d.push(w[E][0])}this.beginGeometry(t,e,n);const f=o.repeat,m=f?void 0:o.textAlign;let v=0;for(let w=0,E=d.length;w<E;++w){let I;f?I=tv(f*this.resolution,h,v,d[w],u):I=[h.slice(v,d[w])];for(let R=0,S=I.length;R<S;++R){const T=I[R];let A=0,y=T.length;if(m==null){const p=ev(o.maxAngle,T,0,T.length,2);A=p[0],y=p[1]}for(let p=A;p<y;p+=u)a.push(T[p],T[p+1]);const g=a.length;v=d[w],this.drawChars_(l,g),l=g}}this.endGeometry(e)}else{let d=o.overflow?null:[];switch(c){case"Point":case"MultiPoint":h=t.getFlatCoordinates();break;case"LineString":h=t.getFlatMidpoint();break;case"Circle":h=t.getCenter();break;case"MultiLineString":h=t.getFlatMidpoints(),u=2;break;case"Polygon":h=t.getFlatInteriorPoint(),o.overflow||d.push(h[2]/this.resolution),u=3;break;case"MultiPolygon":const S=t.getFlatInteriorPoints();h=[];for(let T=0,A=S.length;T<A;T+=3)o.overflow||d.push(S[T+2]/this.resolution),h.push(S[T],S[T+1]);if(h.length===0)return;u=2;break}const f=this.appendFlatPointCoordinates(h,u);if(f===l)return;if(d&&(f-l)/2!==h.length/u){let S=l/2;d=d.filter((T,A)=>{const y=a[(S+A)*2]===h[A*u]&&a[(S+A)*2+1]===h[A*u+1];return y||--S,y})}this.saveTextStates_();const m=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,v=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(t,e,n);let w=o.padding;if(w!=qn&&(o.scale[0]<0||o.scale[1]<0)){let S=o.padding[0],T=o.padding[1],A=o.padding[2],y=o.padding[3];o.scale[0]<0&&(T=-T,y=-y),o.scale[1]<0&&(S=-S,A=-A),w=[S,T,A,y]}const E=this.pixelRatio;this.instructions.push([$.DRAW_IMAGE,l,f,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,w==qn?qn:w.map(function(S){return S*E}),m,v,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,d]);const I=1/E,R=m?m.slice(0):null;R&&(R[1]=qt),this.hitDetectionInstructions.push([$.DRAW_IMAGE,l,f,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[I,I],NaN,this.declutterMode_,this.declutterImageWithText_,w,R,v,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?qt:this.fillKey_,this.textOffsetX_,this.textOffsetY_,d]),this.endGeometry(e)}}saveTextStates_(){const t=this.textStrokeState_,e=this.textState_,n=this.textFillState_,r=this.strokeKey_;t&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:e.font,textAlign:e.textAlign||zr,justify:e.justify,textBaseline:e.textBaseline||Hs,scale:e.scale});const o=this.fillKey_;n&&(o in this.fillStates||(this.fillStates[o]={fillStyle:n.fillStyle}))}drawChars_(t,e){const n=this.textStrokeState_,r=this.textState_,s=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,c=Qs[r.textBaseline],h=this.textOffsetY_*l,u=this.text_,d=n?n.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([$.DRAW_CHARS,t,e,c,r.overflow,a,r.maxAngle,l,h,s,d*l,u,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([$.DRAW_CHARS,t,e,c,r.overflow,a&&qt,r.maxAngle,l,h,s,d*l,u,o,1/l,this.declutterMode_,this.textKeepUpright_])}setTextStyle(t,e){let n,r,s;if(!t)this.text_="";else{const o=t.getFill();o?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=Me(o.getColor()||qt)):(r=null,this.textFillState_=r);const a=t.getStroke();if(!a)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const v=a.getLineDash(),w=a.getLineDashOffset(),E=a.getWidth(),I=a.getMiterLimit();s.lineCap=a.getLineCap()||ji,s.lineDash=v?v.slice():Ze,s.lineDashOffset=w===void 0?Je:w,s.lineJoin=a.getLineJoin()||Wi,s.lineWidth=E===void 0?Gr:E,s.miterLimit=I===void 0?$r:I,s.strokeStyle=Me(a.getColor()||Vr)}n=this.textState_;const l=t.getFont()||Wf;rw(l);const c=t.getScaleArray();n.overflow=t.getOverflow(),n.font=l,n.maxAngle=t.getMaxAngle(),n.placement=t.getPlacement(),n.textAlign=t.getTextAlign(),n.repeat=t.getRepeat(),n.justify=t.getJustify(),n.textBaseline=t.getTextBaseline()||Hs,n.backgroundFill=t.getBackgroundFill(),n.backgroundStroke=t.getBackgroundStroke(),n.padding=t.getPadding()||qn,n.scale=c===void 0?[1,1]:c;const h=t.getOffsetX(),u=t.getOffsetY(),d=t.getRotateWithView(),f=t.getKeepUpright(),m=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=h===void 0?0:h,this.textOffsetY_=u===void 0?0:u,this.textRotateWithView_=d===void 0?!1:d,this.textKeepUpright_=f===void 0?!0:f,this.textRotation_=m===void 0?0:m,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:et(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=n.font+n.scale+(n.textAlign||"?")+(n.repeat||"?")+(n.justify||"?")+(n.textBaseline||"?"),this.fillKey_=r&&r.fillStyle?typeof r.fillStyle=="string"?r.fillStyle:"|"+et(r.fillStyle):""}this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}const iv={Circle:Su,Default:fs,Image:Jw,LineString:Qw,Polygon:Su,Text:nv};class rv{constructor(t,e,n,r){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=r,this.resolution_=n,this.buildersByZIndex_={}}finish(){const t={};for(const e in this.buildersByZIndex_){t[e]=t[e]||{};const n=this.buildersByZIndex_[e];for(const r in n){const s=n[r].finish();t[e][r]=s}}return t}getBuilder(t,e){const n=t!==void 0?t.toString():"0";let r=this.buildersByZIndex_[n];r===void 0&&(r={},this.buildersByZIndex_[n]=r);let s=r[e];if(s===void 0){const o=iv[e];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[e]=s}return s}}function Vc(i,t,e,n){let r=i[t],s=i[t+1],o=0;for(let a=t+n;a<e;a+=n){const l=i[a],c=i[a+1];o+=Math.sqrt((l-r)*(l-r)+(c-s)*(c-s)),r=l,s=c}return o}function sv(i,t,e,n,r,s,o,a,l,c,h,u,d=!0){let f=i[t],m=i[t+1],v=0,w=0,E=0,I=0;function R(){v=f,w=m,t+=n,f=i[t],m=i[t+1],I+=E,E=Math.sqrt((f-v)*(f-v)+(m-w)*(m-w))}do R();while(t<e-n&&I+E<s);let S=E===0?0:(s-I)/E;const T=ee(v,f,S),A=ee(w,m,S),y=t-n,g=I,p=s+a*l(c,r,h);for(;t<e-n&&I+E<p;)R();S=E===0?0:(p-I)/E;const b=ee(v,f,S),C=ee(w,m,S);let x=!1;if(d)if(u){const k=[T,A,b,C];sf(k,0,4,2,u,k,k),x=k[0]>k[2]}else x=T>b;const _=Math.PI,V=[],D=y+n===t;t=y,E=0,I=g,f=i[t],m=i[t+1];let B;if(D){R(),B=Math.atan2(m-w,f-v),x&&(B+=B>0?-_:_);const k=(b+T)/2,F=(C+A)/2;return V[0]=[k,F,(p-s)/2,B,r],V}r=r.replace(/\n/g," ");for(let k=0,F=r.length;k<F;){R();let q=Math.atan2(m-w,f-v);if(x&&(q+=q>0?-_:_),B!==void 0){let pt=q-B;if(pt+=pt>_?-2*_:pt<-_?2*_:0,Math.abs(pt)>o)return null}B=q;const Z=k;let at=0;for(;k<F;++k){const pt=x?F-k-1:k,Qt=a*l(c,r[pt],h);if(t+n<e&&I+E<s+at+Qt/2)break;at+=Qt}if(k===Z)continue;const O=x?r.substring(F-Z,F-k):r.substring(Z,k);S=E===0?0:(s+at/2-I)/E;const Lt=ee(v,f,S),$t=ee(w,m,S);V.push([Lt,$t,at/2,q,O]),s+=at}return V}const Ci=fe(),cn=[],je=[],We=[],hn=[];function Iu(i){return i[3].declutterBox}const Tu=new RegExp("[֑-ࣿיִ-﷿ﹰ-ﻼࠀ-࿿-]");function Va(i,t){return t==="start"?t=Tu.test(i)?"right":"left":t==="end"&&(t=Tu.test(i)?"left":"right"),Qs[t]}function ov(i,t,e){return e>0&&i.push(`
`,""),i.push(t,""),i}function av(i,t,e){return e%2===0&&(i+=t),i}class lv{constructor(t,e,n,r,s){this.overlaps=n,this.pixelRatio=e,this.resolution=t,this.alignAndScaleFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=ve(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new sg:null}getZIndexContext(){return this.zIndexContext_}createLabel(t,e,n,r){const s=t+e+n+r;if(this.labels_[s])return this.labels_[s];const o=r?this.strokeStates[r]:null,a=n?this.fillStates[n]:null,l=this.textStates[e],c=this.pixelRatio,h=[l.scale[0]*c,l.scale[1]*c],u=l.justify?Qs[l.justify]:Va(Array.isArray(t)?t[0]:t,l.textAlign||zr),d=r&&o.lineWidth?o.lineWidth:0,f=Array.isArray(t)?t:String(t).split(`
`).reduce(ov,[]),{width:m,height:v,widths:w,heights:E,lineWidths:I}=ow(l,f),R=m+d,S=[],T=(R+2)*h[0],A=(v+d)*h[1],y={width:T<0?Math.floor(T):Math.ceil(T),height:A<0?Math.floor(A):Math.ceil(A),contextInstructions:S};(h[0]!=1||h[1]!=1)&&S.push("scale",h),r&&(S.push("strokeStyle",o.strokeStyle),S.push("lineWidth",d),S.push("lineCap",o.lineCap),S.push("lineJoin",o.lineJoin),S.push("miterLimit",o.miterLimit),S.push("setLineDash",[o.lineDash]),S.push("lineDashOffset",o.lineDashOffset)),n&&S.push("fillStyle",a.fillStyle),S.push("textBaseline","middle"),S.push("textAlign","center");const g=.5-u;let p=u*R+g*d;const b=[],C=[];let x=0,_=0,V=0,D=0,B;for(let k=0,F=f.length;k<F;k+=2){const q=f[k];if(q===`
`){_+=x,x=0,p=u*R+g*d,++D;continue}const Z=f[k+1]||l.font;Z!==B&&(r&&b.push("font",Z),n&&C.push("font",Z),B=Z),x=Math.max(x,E[V]);const at=[q,p+g*w[V]+u*(w[V]-I[D]),.5*(d+x)+_];p+=w[V],r&&b.push("strokeText",at),n&&C.push("fillText",at),++V}return Array.prototype.push.apply(S,b),Array.prototype.push.apply(S,C),this.labels_[s]=y,y}replayTextBackground_(t,e,n,r,s,o,a){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,n),t.lineTo.apply(t,r),t.lineTo.apply(t,s),t.lineTo.apply(t,e),o&&(this.alignAndScaleFill_=o[2],t.fillStyle=o[1],this.fill_(t)),a&&(this.setStrokeStyle_(t,a),t.stroke())}calculateImageOrLabelDimensions_(t,e,n,r,s,o,a,l,c,h,u,d,f,m,v,w){a*=d[0],l*=d[1];let E=n-a,I=r-l;const R=s+c>t?t-c:s,S=o+h>e?e-h:o,T=m[3]+R*d[0]+m[1],A=m[0]+S*d[1]+m[2],y=E-m[3],g=I-m[0];(v||u!==0)&&(cn[0]=y,hn[0]=y,cn[1]=g,je[1]=g,je[0]=y+T,We[0]=je[0],We[1]=g+A,hn[1]=We[1]);let p;return u!==0?(p=en(ve(),n,r,1,1,u,-n,-r),Tt(p,cn),Tt(p,je),Tt(p,We),Tt(p,hn),Qe(Math.min(cn[0],je[0],We[0],hn[0]),Math.min(cn[1],je[1],We[1],hn[1]),Math.max(cn[0],je[0],We[0],hn[0]),Math.max(cn[1],je[1],We[1],hn[1]),Ci)):Qe(Math.min(y,y+T),Math.min(g,g+A),Math.max(y,y+T),Math.max(g,g+A),Ci),f&&(E=Math.round(E),I=Math.round(I)),{drawImageX:E,drawImageY:I,drawImageW:R,drawImageH:S,originX:c,originY:h,declutterBox:{minX:Ci[0],minY:Ci[1],maxX:Ci[2],maxY:Ci[3],value:w},canvasTransform:p,scale:d}}replayImageOrLabel_(t,e,n,r,s,o,a){const l=!!(o||a),c=r.declutterBox,h=a?a[2]*r.scale[0]/2:0;return c.minX-h<=e[0]&&c.maxX+h>=0&&c.minY-h<=e[1]&&c.maxY+h>=0&&(l&&this.replayTextBackground_(t,cn,je,We,hn,o,a),aw(t,r.canvasTransform,s,n,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}fill_(t){const e=this.alignAndScaleFill_;if(e){const n=Tt(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;t.save(),t.translate(n[0]%r,n[1]%r),e!==1&&t.scale(e,e),t.rotate(this.viewRotation_)}t.fill(),e&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],e[1]&&(t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6]))}drawLabelWithPointPlacement_(t,e,n,r){const s=this.textStates[e],o=this.createLabel(t,e,r,n),a=this.strokeStates[n],l=this.pixelRatio,c=Va(Array.isArray(t)?t[0]:t,s.textAlign||zr),h=Qs[s.textBaseline||Hs],u=a&&a.lineWidth?a.lineWidth:0,d=o.width/l-2*s.scale[0],f=c*d+2*(.5-c)*u,m=h*o.height/l+2*(.5-h)*u;return{label:o,anchorX:f,anchorY:m}}execute_(t,e,n,r,s,o,a,l){const c=this.zIndexContext_;let h;this.pixelCoordinates_&&Pn(n,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=En(this.coordinates,0,this.coordinates.length,2,n,this.pixelCoordinates_),i_(this.renderedTransform_,n));let u=0;const d=r.length;let f=0,m,v,w,E,I,R,S,T,A,y,g,p,b,C=0,x=0;const _=this.coordinateCache_,V=this.viewRotation_,D=Math.round(Math.atan2(-n[1],n[0])*1e12)/1e12,B={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:V},k=this.instructions!=r||this.overlaps?0:200;let F,q,Z,at;for(;u<d;){const O=r[u];switch(O[0]){case $.BEGIN_GEOMETRY:F=O[1],at=O[3],F.getGeometry()?a!==void 0&&!Xt(a,at.getExtent())?u=O[2]+1:++u:u=O[2],c&&(c.zIndex=O[4]);break;case $.BEGIN_PATH:C>k&&(this.fill_(t),C=0),x>k&&(t.stroke(),x=0),!C&&!x&&(t.beginPath(),I=NaN,R=NaN),++u;break;case $.CIRCLE:f=O[1];const $t=h[f],pt=h[f+1],Qt=h[f+2],Mt=h[f+3],xe=Qt-$t,pe=Mt-pt,te=Math.sqrt(xe*xe+pe*pe);t.moveTo($t+te,pt),t.arc($t,pt,te,0,2*Math.PI,!0),++u;break;case $.CLOSE_PATH:t.closePath(),++u;break;case $.CUSTOM:f=O[1],m=O[2];const ms=O[3],ra=O[4],sr=O[5];B.geometry=ms,B.feature=F,u in _||(_[u]=[]);const Ln=_[u];sr?sr(h,f,m,2,Ln):(Ln[0]=h[f],Ln[1]=h[f+1],Ln.length=2),c&&(c.zIndex=O[6]),ra(Ln,B),++u;break;case $.DRAW_IMAGE:f=O[1],m=O[2],A=O[3],v=O[4],w=O[5];let ie=O[6];const Se=O[7],ui=O[8],di=O[9],or=O[10];let Mn=O[11];const fi=O[12];let gi=O[13];E=O[14]||"declutter";const St=O[15];if(!A&&O.length>=20){y=O[19],g=O[20],p=O[21],b=O[22];const re=this.drawLabelWithPointPlacement_(y,g,p,b);A=re.label,O[3]=A;const On=O[23];v=(re.anchorX-On)*this.pixelRatio,O[4]=v;const se=O[24];w=(re.anchorY-se)*this.pixelRatio,O[5]=w,ie=A.height,O[6]=ie,gi=A.width,O[13]=gi}let sa;O.length>25&&(sa=O[25]);let oa,_s,ys;O.length>17?(oa=O[16],_s=O[17],ys=O[18]):(oa=qn,_s=null,ys=null),or&&D?Mn+=V:!or&&!D&&(Mn-=V);let dp=0;for(;f<m;f+=2){if(sa&&sa[dp++]<gi/this.pixelRatio)continue;const re=this.calculateImageOrLabelDimensions_(A.width,A.height,h[f],h[f+1],gi,ie,v,w,ui,di,Mn,fi,s,oa,!!_s||!!ys,F),On=[t,e,A,re,Se,_s,ys];if(l){let se,Ie,oe;if(St){const ft=m-f;if(!St[ft]){St[ft]={args:On,declutterMode:E};continue}const Vt=St[ft];se=Vt.args,Ie=Vt.declutterMode,delete St[ft],oe=Iu(se)}let ze,Ge;if(se&&(Ie!=="declutter"||!l.collides(oe))&&(ze=!0),(E!=="declutter"||!l.collides(re.declutterBox))&&(Ge=!0),Ie==="declutter"&&E==="declutter"){const ft=ze&&Ge;ze=ft,Ge=ft}ze&&(Ie!=="none"&&l.insert(oe),this.replayImageOrLabel_.apply(this,se)),Ge&&(E!=="none"&&l.insert(re.declutterBox),this.replayImageOrLabel_.apply(this,On))}else this.replayImageOrLabel_.apply(this,On)}++u;break;case $.DRAW_CHARS:const rh=O[1],sh=O[2],aa=O[3],fp=O[4];b=O[5];const gp=O[6],oh=O[7],ah=O[8];p=O[9];const la=O[10];y=O[11],Array.isArray(y)&&(y=y.reduce(av,"")),g=O[12];const lh=[O[13],O[13]];E=O[14]||"declutter";const pp=O[15],ca=this.textStates[g],ar=ca.font,lr=[ca.scale[0]*oh,ca.scale[1]*oh];let cr;ar in this.widths_?cr=this.widths_[ar]:(cr={},this.widths_[ar]=cr);const ch=Vc(h,rh,sh,2),hh=Math.abs(lr[0])*hu(ar,y,cr);if(fp||hh<=ch){const re=this.textStates[g].textAlign,On=(ch-hh)*Va(y,re),se=sv(h,rh,sh,2,y,On,gp,Math.abs(lr[0]),hu,ar,cr,D?0:this.viewRotation_,pp);t:if(se){const Ie=[];let oe,ze,Ge,ft,Vt;if(p)for(oe=0,ze=se.length;oe<ze;++oe){Vt=se[oe],Ge=Vt[4],ft=this.createLabel(Ge,g,"",p),v=Vt[2]+(lr[0]<0?-la:la),w=aa*ft.height+(.5-aa)*2*la*lr[1]/lr[0]-ah;const Ue=this.calculateImageOrLabelDimensions_(ft.width,ft.height,Vt[0],Vt[1],ft.width,ft.height,v,w,0,0,Vt[3],lh,!1,qn,!1,F);if(l&&E==="declutter"&&l.collides(Ue.declutterBox))break t;Ie.push([t,e,ft,Ue,1,null,null])}if(b)for(oe=0,ze=se.length;oe<ze;++oe){Vt=se[oe],Ge=Vt[4],ft=this.createLabel(Ge,g,b,""),v=Vt[2],w=aa*ft.height-ah;const Ue=this.calculateImageOrLabelDimensions_(ft.width,ft.height,Vt[0],Vt[1],ft.width,ft.height,v,w,0,0,Vt[3],lh,!1,qn,!1,F);if(l&&E==="declutter"&&l.collides(Ue.declutterBox))break t;Ie.push([t,e,ft,Ue,1,null,null])}l&&E!=="none"&&l.load(Ie.map(Iu));for(let Ue=0,mp=Ie.length;Ue<mp;++Ue)this.replayImageOrLabel_.apply(this,Ie[Ue])}}++u;break;case $.END_GEOMETRY:if(o!==void 0){F=O[1];const re=o(F,at,E);if(re)return re}++u;break;case $.FILL:k?C++:this.fill_(t),++u;break;case $.MOVE_TO_LINE_TO:for(f=O[1],m=O[2],q=h[f],Z=h[f+1],t.moveTo(q,Z),I=q+.5|0,R=Z+.5|0,f+=2;f<m;f+=2)q=h[f],Z=h[f+1],S=q+.5|0,T=Z+.5|0,(f==m-2||S!==I||T!==R)&&(t.lineTo(q,Z),I=S,R=T);++u;break;case $.SET_FILL_STYLE:this.alignAndScaleFill_=O[2],C&&(this.fill_(t),C=0,x&&(t.stroke(),x=0)),t.fillStyle=O[1],++u;break;case $.SET_STROKE_STYLE:x&&(t.stroke(),x=0),this.setStrokeStyle_(t,O),++u;break;case $.STROKE:k?x++:t.stroke(),++u;break;default:++u;break}}C&&this.fill_(t),x&&t.stroke()}execute(t,e,n,r,s,o){this.viewRotation_=r,this.execute_(t,e,n,this.instructions,s,void 0,void 0,o)}executeHitDetection(t,e,n,r,s){return this.viewRotation_=n,this.execute_(t,[t.canvas.width,t.canvas.height],e,this.hitDetectionInstructions,!0,r,s)}}const Un=["Polygon","Circle","LineString","Image","Text","Default"],lg=["Image","Text"],cv=Un.filter(i=>!lg.includes(i));class hv{constructor(t,e,n,r,s,o,a){this.maxExtent_=t,this.overlaps_=r,this.pixelRatio_=n,this.resolution_=e,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=ve(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,a)}clip(t,e){const n=this.getClipCoords(e);t.beginPath(),t.moveTo(n[0],n[1]),t.lineTo(n[2],n[3]),t.lineTo(n[4],n[5]),t.lineTo(n[6],n[7]),t.clip()}createExecutors_(t,e){for(const n in t){let r=this.executorsByZIndex_[n];r===void 0&&(r={},this.executorsByZIndex_[n]=r);const s=t[n];for(const o in s){const a=s[o];r[o]=new lv(this.resolution_,this.pixelRatio_,this.overlaps_,a,e)}}}hasExecutors(t){for(const e in this.executorsByZIndex_){const n=this.executorsByZIndex_[e];for(let r=0,s=t.length;r<s;++r)if(t[r]in n)return!0}return!1}forEachFeatureAtCoordinate(t,e,n,r,s,o){r=Math.round(r);const a=r*2+1,l=en(this.hitDetectionTransform_,r+.5,r+.5,1/e,-1/e,-n,-t[0],-t[1]),c=!this.hitDetectionContext_;c&&(this.hitDetectionContext_=xt(a,a));const h=this.hitDetectionContext_;h.canvas.width!==a||h.canvas.height!==a?(h.canvas.width=a,h.canvas.height=a):c||h.clearRect(0,0,a,a);let u;this.renderBuffer_!==void 0&&(u=fe(),Cr(u,t),Yl(u,e*(this.renderBuffer_+r),u));const d=uv(r);let f;function m(T,A,y){const g=h.getImageData(0,0,a,a).data;for(let p=0,b=d.length;p<b;p++)if(g[d[p]]>0){if(!o||y==="none"||f!=="Image"&&f!=="Text"||o.includes(T)){const C=(d[p]-3)/4,x=r-C%a,_=r-(C/a|0),V=s(T,A,x*x+_*_);if(V)return V}h.clearRect(0,0,a,a);break}}const v=Object.keys(this.executorsByZIndex_).map(Number);v.sort(He);let w,E,I,R,S;for(w=v.length-1;w>=0;--w){const T=v[w].toString();for(I=this.executorsByZIndex_[T],E=Un.length-1;E>=0;--E)if(f=Un[E],R=I[f],R!==void 0&&(S=R.executeHitDetection(h,l,n,m,u),S))return S}}getClipCoords(t){const e=this.maxExtent_;if(!e)return null;const n=e[0],r=e[1],s=e[2],o=e[3],a=[n,r,n,o,s,o,s,r];return En(a,0,8,2,t,a),a}isEmpty(){return Jn(this.executorsByZIndex_)}execute(t,e,n,r,s,o,a){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(a?am:He),o=o||Un;const c=Un.length;for(let h=0,u=l.length;h<u;++h){const d=l[h].toString(),f=this.executorsByZIndex_[d];for(let m=0,v=o.length;m<v;++m){const w=o[m],E=f[w];if(E!==void 0){const I=a===null?void 0:E.getZIndexContext(),R=I?I.getContext():t,S=this.maxExtent_&&w!=="Image"&&w!=="Text";if(S&&(R.save(),this.clip(R,n)),!I||w==="Text"||w==="Image"?E.execute(R,e,n,r,s,a):I.pushFunction(T=>E.execute(T,e,n,r,s,a)),S&&R.restore(),I){I.offset();const T=l[h]*c+Un.indexOf(w);this.deferredZIndexContexts_[T]||(this.deferredZIndexContexts_[T]=[]),this.deferredZIndexContexts_[T].push(I)}}}}this.renderedContext_=t}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const t=this.deferredZIndexContexts_,e=Object.keys(t).map(Number).sort(He);for(let n=0,r=e.length;n<r;++n)t[e[n]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),t[e[n]].length=0}}const za={};function uv(i){if(za[i]!==void 0)return za[i];const t=i*2+1,e=i*i,n=new Array(e+1);for(let s=0;s<=i;++s)for(let o=0;o<=i;++o){const a=s*s+o*o;if(a>e)break;let l=n[a];l||(l=[],n[a]=l),l.push(((i+s)*t+(i+o))*4+3),s>0&&l.push(((i-s)*t+(i+o))*4+3),o>0&&(l.push(((i+s)*t+(i-o))*4+3),s>0&&l.push(((i-s)*t+(i-o))*4+3))}const r=[];for(let s=0,o=n.length;s<o;++s)n[s]&&r.push(...n[s]);return za[i]=r,r}class dv extends ag{constructor(t,e,n,r,s,o,a){super(),this.context_=t,this.pixelRatio_=e,this.extent_=n,this.transform_=r,this.transformRotation_=r?Eo(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=ve()}drawImages_(t,e,n,r){if(!this.image_)return;const s=En(t,e,n,r,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,l=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=l*this.imageOpacity_);let c=this.imageRotation_;this.transformRotation_===0&&(c-=this.viewRotation_),this.imageRotateWithView_&&(c+=this.viewRotation_);for(let h=0,u=s.length;h<u;h+=2){const d=s[h]-this.imageAnchorX_,f=s[h+1]-this.imageAnchorY_;if(c!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const m=d+this.imageAnchorX_,v=f+this.imageAnchorY_;en(a,m,v,1,1,c,-m,-v),o.save(),o.transform.apply(o,a),o.translate(m,v),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,d,f,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=l)}drawText_(t,e,n,r){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=En(t,e,n,r,this.transform_,this.pixelCoordinates_),o=this.context_;let a=this.textRotation_;for(this.transformRotation_===0&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);e<n;e+=r){const l=s[e]+this.textOffsetX_,c=s[e+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(l-this.textOffsetX_,c-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,l,c),this.textFillState_&&o.fillText(this.text_,l,c))}}moveToLineTo_(t,e,n,r,s){const o=this.context_,a=En(t,e,n,r,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);let l=a.length;s&&(l-=2);for(let c=2;c<l;c+=2)o.lineTo(a[c],a[c+1]);return s&&o.closePath(),n}drawRings_(t,e,n,r){for(let s=0,o=n.length;s<o;++s)e=this.moveToLineTo_(t,e,n[s],r,!0);return e}drawCircle(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Xt(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=u_(t,this.transform_,this.pixelCoordinates_),n=e[2]-e[0],r=e[3]-e[1],s=Math.sqrt(n*n+r*r),o=this.context_;o.beginPath(),o.arc(e[0],e[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t);break}}drawFeature(t,e){const n=e.getGeometryFunction()(t);n&&(this.setStyle(e),this.drawGeometry(n))}drawGeometryCollection(t){const e=t.getGeometriesArray();for(let n=0,r=e.length;n<r;++n)this.drawGeometry(e[n])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(e,0,e.length,n),this.text_!==""&&this.drawText_(e,0,e.length,n)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(e,0,e.length,n),this.text_!==""&&this.drawText_(e,0,e.length,n)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Xt(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,n=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(n,0,n.length,t.getStride(),!1),e.stroke()}if(this.text_!==""){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getExtent();if(Xt(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const n=this.context_,r=t.getFlatCoordinates();let s=0;const o=t.getEnds(),a=t.getStride();n.beginPath();for(let l=0,c=o.length;l<c;++l)s=this.moveToLineTo_(r,s,o[l],a,!1);n.stroke()}if(this.text_!==""){const n=t.getFlatMidpoints();this.drawText_(n,0,n.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Xt(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Xt(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,n=t.getOrientedFlatCoordinates();let r=0;const s=t.getEndss(),o=t.getStride();e.beginPath();for(let a=0,l=s.length;a<l;++a){const c=s[a];r=this.drawRings_(n,r,c,o)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}}setContextFillState_(t){const e=this.context_,n=this.contextFillState_;n?n.fillStyle!=t.fillStyle&&(n.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const e=this.context_,n=this.contextStrokeState_;n?(n.lineCap!=t.lineCap&&(n.lineCap=t.lineCap,e.lineCap=t.lineCap),Pn(n.lineDash,t.lineDash)||e.setLineDash(n.lineDash=t.lineDash),n.lineDashOffset!=t.lineDashOffset&&(n.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),n.lineJoin!=t.lineJoin&&(n.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),n.lineWidth!=t.lineWidth&&(n.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),n.miterLimit!=t.miterLimit&&(n.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),n.strokeStyle!=t.strokeStyle&&(n.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const e=this.context_,n=this.contextTextState_,r=t.textAlign?t.textAlign:zr;n?(n.font!=t.font&&(n.font=t.font,e.font=t.font),n.textAlign!=r&&(n.textAlign=r,e.textAlign=r),n.textBaseline!=t.textBaseline&&(n.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=r,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:r,textBaseline:t.textBaseline})}setFillStrokeStyle(t,e){if(!t)this.fillState_=null;else{const n=t.getColor();this.fillState_={fillStyle:Me(n||qt)}}if(!e)this.strokeState_=null;else{const n=e.getColor(),r=e.getLineCap(),s=e.getLineDash(),o=e.getLineDashOffset(),a=e.getLineJoin(),l=e.getWidth(),c=e.getMiterLimit(),h=s||Ze;this.strokeState_={lineCap:r!==void 0?r:ji,lineDash:this.pixelRatio_===1?h:h.map(u=>u*this.pixelRatio_),lineDashOffset:(o||Je)*this.pixelRatio_,lineJoin:a!==void 0?a:Wi,lineWidth:(l!==void 0?l:Gr)*this.pixelRatio_,miterLimit:c!==void 0?c:$r,strokeStyle:Me(n||Vr)}}}setImageStyle(t){let e;if(!t||!(e=t.getSize())){this.image_=null;return}const n=t.getPixelRatio(this.pixelRatio_),r=t.getAnchor(),s=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*n,this.imageAnchorY_=r[1]*n,this.imageHeight_=e[1]*n,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const o=t.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/n,o[1]*this.pixelRatio_/n],this.imageWidth_=e[0]*n}setTextStyle(t){if(!t)this.text_="";else{const e=t.getFill();if(!e)this.textFillState_=null;else{const f=e.getColor();this.textFillState_={fillStyle:Me(f||qt)}}const n=t.getStroke();if(!n)this.textStrokeState_=null;else{const f=n.getColor(),m=n.getLineCap(),v=n.getLineDash(),w=n.getLineDashOffset(),E=n.getLineJoin(),I=n.getWidth(),R=n.getMiterLimit();this.textStrokeState_={lineCap:m!==void 0?m:ji,lineDash:v||Ze,lineDashOffset:w||Je,lineJoin:E!==void 0?E:Wi,lineWidth:I!==void 0?I:Gr,miterLimit:R!==void 0?R:$r,strokeStyle:Me(f||Vr)}}const r=t.getFont(),s=t.getOffsetX(),o=t.getOffsetY(),a=t.getRotateWithView(),l=t.getRotation(),c=t.getScaleArray(),h=t.getText(),u=t.getTextAlign(),d=t.getTextBaseline();this.textState_={font:r!==void 0?r:Wf,textAlign:u!==void 0?u:zr,textBaseline:d!==void 0?d:Hs},this.text_=h!==void 0?Array.isArray(h)?h.reduce((f,m,v)=>f+=v%2?" ":m,""):h:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=a!==void 0?a:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*c[0],this.pixelRatio_*c[1]]}}}const Ae=.5;function fv(i,t,e,n,r,s,o,a,l){const c=l?js(r,l):r,h=i[0]*Ae,u=i[1]*Ae,d=xt(h,u);d.imageSmoothingEnabled=!1;const f=d.canvas,m=new dv(d,Ae,r,null,o,a,l?ss(Bs(),l):null),v=e.length,w=Math.floor((256*256*256-1)/v),E={};for(let R=1;R<=v;++R){const S=e[R-1],T=S.getStyleFunction()||n;if(!T)continue;let A=T(S,s);if(!A)continue;Array.isArray(A)||(A=[A]);const g=(R*w).toString(16).padStart(7,"#00000");for(let p=0,b=A.length;p<b;++p){const C=A[p],x=C.getGeometryFunction()(S);if(!x||!Xt(c,x.getExtent()))continue;const _=C.clone(),V=_.getFill();V&&V.setColor(g);const D=_.getStroke();D&&(D.setColor(g),D.setLineDash(null)),_.setText(void 0);const B=C.getImage();if(B){const Z=B.getImageSize();if(!Z)continue;const at=xt(Z[0],Z[1],void 0,{alpha:!1}),O=at.canvas;at.fillStyle=g,at.fillRect(0,0,O.width,O.height),_.setImage(new Go({img:O,anchor:B.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:B.getOrigin(),opacity:1,size:B.getSize(),scale:B.getScale(),rotation:B.getRotation(),rotateWithView:B.getRotateWithView()}))}const k=_.getZIndex()||0;let F=E[k];F||(F={},E[k]=F,F.Polygon=[],F.Circle=[],F.LineString=[],F.Point=[]);const q=x.getType();if(q==="GeometryCollection"){const Z=x.getGeometriesArrayRecursive();for(let at=0,O=Z.length;at<O;++at){const Lt=Z[at];F[Lt.getType().replace("Multi","")].push(Lt,_)}}else F[q.replace("Multi","")].push(x,_)}}const I=Object.keys(E).map(Number).sort(He);for(let R=0,S=I.length;R<S;++R){const T=E[I[R]];for(const A in T){const y=T[A];for(let g=0,p=y.length;g<p;g+=2){m.setStyle(y[g+1]);for(let b=0,C=t.length;b<C;++b)m.setTransform(t[b]),m.drawGeometry(y[g])}}}return d.getImageData(0,0,f.width,f.height)}function gv(i,t,e){const n=[];if(e){const r=Math.floor(Math.round(i[0])*Ae),s=Math.floor(Math.round(i[1])*Ae),o=(dt(r,0,e.width-1)+dt(s,0,e.height-1)*e.width)*4,a=e.data[o],l=e.data[o+1],h=e.data[o+2]+256*(l+256*a),u=Math.floor((256*256*256-1)/t.length);h&&h%u===0&&n.push(t[h/u-1])}return n}const pv=.5,cg={Point:Cv,LineString:vv,Polygon:Sv,MultiPoint:xv,MultiLineString:bv,MultiPolygon:Ev,GeometryCollection:wv,Circle:_v};function mv(i,t){return parseInt(et(i),10)-parseInt(et(t),10)}function Ru(i,t){const e=hg(i,t);return e*e}function hg(i,t){return pv*i/t}function _v(i,t,e,n,r){const s=e.getFill(),o=e.getStroke();if(s||o){const l=i.getBuilder(e.getZIndex(),"Circle");l.setFillStrokeStyle(s,o),l.drawCircle(t,n,r)}const a=e.getText();if(a&&a.getText()){const l=i.getBuilder(e.getZIndex(),"Text");l.setTextStyle(a),l.drawText(t,n)}}function Au(i,t,e,n,r,s,o,a){const l=[],c=e.getImage();if(c){let d=!0;const f=c.getImageState();f==K.LOADED||f==K.ERROR?d=!1:f==K.IDLE&&c.load(),d&&l.push(c.ready())}const h=e.getFill();h&&h.loading()&&l.push(h.ready());const u=l.length>0;return u&&Promise.all(l).then(()=>r(null)),yv(i,t,e,n,s,o,a),u}function yv(i,t,e,n,r,s,o){const a=e.getGeometryFunction()(t);if(!a)return;const l=a.simplifyTransformed(n,r);if(e.getRenderer())ug(i,l,e,t,o);else{const h=cg[l.getType()];h(i,l,e,t,o,s)}}function ug(i,t,e,n,r){if(t.getType()=="GeometryCollection"){const o=t.getGeometries();for(let a=0,l=o.length;a<l;++a)ug(i,o[a],e,n,r);return}i.getBuilder(e.getZIndex(),"Default").drawCustom(t,n,e.getRenderer(),e.getHitDetectionRenderer(),r)}function wv(i,t,e,n,r,s){const o=t.getGeometriesArray();let a,l;for(a=0,l=o.length;a<l;++a){const c=cg[o[a].getType()];c(i,o[a],e,n,r,s)}}function vv(i,t,e,n,r){const s=e.getStroke();if(s){const a=i.getBuilder(e.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawLineString(t,n,r)}const o=e.getText();if(o&&o.getText()){const a=i.getBuilder(e.getZIndex(),"Text");a.setTextStyle(o),a.drawText(t,n,r)}}function bv(i,t,e,n,r){const s=e.getStroke();if(s){const a=i.getBuilder(e.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawMultiLineString(t,n,r)}const o=e.getText();if(o&&o.getText()){const a=i.getBuilder(e.getZIndex(),"Text");a.setTextStyle(o),a.drawText(t,n,r)}}function Ev(i,t,e,n,r){const s=e.getFill(),o=e.getStroke();if(o||s){const l=i.getBuilder(e.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawMultiPolygon(t,n,r)}const a=e.getText();if(a&&a.getText()){const l=i.getBuilder(e.getZIndex(),"Text");l.setTextStyle(a),l.drawText(t,n,r)}}function Cv(i,t,e,n,r,s){const o=e.getImage(),a=e.getText(),l=a&&a.getText(),c=s&&o&&l?{}:void 0;if(o){if(o.getImageState()!=K.LOADED)return;const h=i.getBuilder(e.getZIndex(),"Image");h.setImageStyle(o,c),h.drawPoint(t,n,r)}if(l){const h=i.getBuilder(e.getZIndex(),"Text");h.setTextStyle(a,c),h.drawText(t,n,r)}}function xv(i,t,e,n,r,s){const o=e.getImage(),a=o&&o.getOpacity()!==0,l=e.getText(),c=l&&l.getText(),h=s&&a&&c?{}:void 0;if(a){if(o.getImageState()!=K.LOADED)return;const u=i.getBuilder(e.getZIndex(),"Image");u.setImageStyle(o,h),u.drawMultiPoint(t,n,r)}if(c){const u=i.getBuilder(e.getZIndex(),"Text");u.setTextStyle(l,h),u.drawText(t,n,r)}}function Sv(i,t,e,n,r){const s=e.getFill(),o=e.getStroke();if(s||o){const l=i.getBuilder(e.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawPolygon(t,n,r)}const a=e.getText();if(a&&a.getText()){const l=i.getBuilder(e.getZIndex(),"Text");l.setTextStyle(a),l.drawText(t,n,r)}}class Iv extends og{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=fe(),this.wrappedRenderedExtent_=fe(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(t,e,n){const r=e.extent,s=e.viewState,o=s.center,a=s.resolution,l=s.projection,c=s.rotation,h=l.getExtent(),u=this.getLayer().getSource(),d=this.getLayer().getDeclutter(),f=e.pixelRatio,m=e.viewHints,v=!(m[Ft.ANIMATING]||m[Ft.INTERACTING]),w=this.context,E=Math.round(ot(r)/a*f),I=Math.round(Ut(r)/a*f),R=u.getWrapX()&&l.canWrapX(),S=R?ot(h):null,T=R?Math.ceil((r[2]-h[2])/S)+1:1;let A=R?Math.floor((r[0]-h[0])/S):0;do{let y=this.getRenderTransform(o,a,0,f,E,I,A*S);e.declutter&&(y=y.slice(0)),t.execute(w,[w.canvas.width,w.canvas.height],y,c,v,n===void 0?Un:n?lg:cv,n?d&&e.declutter[d]:void 0)}while(++A<T)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=xt(this.context.canvas.width,this.context.canvas.height,Eu))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const t=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=t,Fo(this.context),Eu.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(t){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,t,!0)}renderDeferredInternal(t){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(t,e){const n=t.layerStatesArray[t.layerIndex];this.opacity_=n.opacity;const r=t.viewState;this.prepareContainer(t,e);const s=this.context,o=this.replayGroup_;let a=o&&!o.isEmpty();if(!a&&!(this.getLayer().hasListener(ce.PRERENDER)||this.getLayer().hasListener(ce.POSTRENDER)))return this.container;this.setDrawContext_(),this.preRender(s,t);const l=r.projection;if(this.clipped_=!1,a&&n.extent&&this.clipping){const c=yn(n.extent,l);a=Xt(c,t.extent),this.clipped_=a&&!mr(c,t.extent),this.clipped_&&this.clipUnrotated(s,t,c)}return a&&this.renderWorlds(o,t,this.getLayer().getDeclutter()?!1:void 0),!t.declutter&&this.clipped_&&s.restore(),this.postRender(s,t),this.renderedRotation_!==r.rotation&&(this.renderedRotation_=r.rotation,this.hitDetectionImageData_=null),t.declutter||this.resetDrawContext_(),this.container}getFeatures(t){return new Promise(e=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const n=this.frameState.size.slice(),r=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,l=this.wrappedRenderedExtent_,c=this.getLayer(),h=[],u=n[0]*Ae,d=n[1]*Ae;h.push(this.getRenderTransform(r,s,o,Ae,u,d,0).slice());const f=c.getSource(),m=a.getExtent();if(f.getWrapX()&&a.canWrapX()&&!mr(m,l)){let w=l[0];const E=ot(m);let I=0,R;for(;w<m[0];)--I,R=E*I,h.push(this.getRenderTransform(r,s,o,Ae,u,d,R).slice()),w+=E;for(I=0,w=l[2];w>m[2];)++I,R=E*I,h.push(this.getRenderTransform(r,s,o,Ae,u,d,R).slice()),w-=E}const v=Bs();this.hitDetectionImageData_=fv(n,h,this.renderedFeatures_,c.getStyleFunction(),l,s,o,Ru(s,this.renderedPixelRatio_),v?a:null)}e(gv(t,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(t,e,n,r,s){if(!this.replayGroup_)return;const o=e.viewState.resolution,a=e.viewState.rotation,l=this.getLayer(),c={},h=function(d,f,m){const v=et(d),w=c[v];if(w){if(w!==!0&&m<w.distanceSq){if(m===0)return c[v]=!0,s.splice(s.lastIndexOf(w),1),r(d,l,f);w.geometry=f,w.distanceSq=m}}else{if(m===0)return c[v]=!0,r(d,l,f);s.push(c[v]={feature:d,layer:l,geometry:f,distanceSq:m,callback:r})}},u=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(t,o,a,n,h,u?e.declutter?.[u]?.all().map(d=>d.value):null)}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}prepareFrame(t){const e=this.getLayer(),n=e.getSource();if(!n)return!1;const r=t.viewHints[Ft.ANIMATING],s=t.viewHints[Ft.INTERACTING],o=e.getUpdateWhileAnimating(),a=e.getUpdateWhileInteracting();if(this.ready&&!o&&r||!a&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=t.extent,c=t.viewState,h=c.projection,u=c.resolution,d=t.pixelRatio,f=e.getRevision(),m=e.getRenderBuffer();let v=e.getRenderOrder();v===void 0&&(v=mv);const w=c.center.slice(),E=Yl(l,m*u),I=E.slice(),R=[E.slice()],S=h.getExtent();if(n.getWrapX()&&h.canWrapX()&&!mr(S,t.extent)){const D=ot(S),B=Math.max(ot(E)/2,D);E[0]=S[0]-B,E[2]=S[2]+B,Yd(w,h);const k=qd(R[0],h);k[0]<S[0]&&k[2]<S[2]?R.push([k[0]+D,k[1],k[2]+D,k[3]]):k[0]>S[0]&&k[2]>S[2]&&R.push([k[0]-D,k[1],k[2]-D,k[3]])}if(this.ready&&this.renderedResolution_==u&&this.renderedRevision_==f&&this.renderedRenderOrder_==v&&this.renderedFrameDeclutter_===!!t.declutter&&mr(this.wrappedRenderedExtent_,E))return Pn(this.renderedExtent_,I)||(this.hitDetectionImageData_=null,this.renderedExtent_=I),this.renderedCenter_=w,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const T=new rv(hg(u,d),E,u,d),A=Bs();let y;if(A){for(let D=0,B=R.length;D<B;++D){const k=R[D],F=js(k,h);n.loadFeatures(F,e_(u,h),A)}y=ss(A,h)}else for(let D=0,B=R.length;D<B;++D)n.loadFeatures(R[D],u,h);const g=Ru(u,d);let p=!0;const b=(D,B)=>{let k;const F=D.getStyleFunction()||e.getStyleFunction();if(F&&(k=F(D,u)),k){const q=this.renderFeature(D,g,k,T,y,this.getLayer().getDeclutter(),B);p=p&&!q}},C=js(E,h),x=n.getFeaturesInExtent(C);v&&x.sort(v);for(let D=0,B=x.length;D<B;++D)b(x[D],D);this.renderedFeatures_=x,this.ready=p;const _=T.finish(),V=new hv(E,u,d,n.getOverlaps(),_,e.getRenderBuffer(),!!t.declutter);return this.renderedResolution_=u,this.renderedRevision_=f,this.renderedRenderOrder_=v,this.renderedFrameDeclutter_=!!t.declutter,this.renderedExtent_=I,this.wrappedRenderedExtent_=E,this.renderedCenter_=w,this.renderedProjection_=h,this.renderedPixelRatio_=d,this.replayGroup_=V,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(t,e,n,r,s,o,a){if(!n)return!1;let l=!1;if(Array.isArray(n))for(let c=0,h=n.length;c<h;++c)l=Au(r,t,n[c],e,this.boundHandleStyleImageChange_,s,o,a)||l;else l=Au(r,t,n,e,this.boundHandleStyleImageChange_,s,o,a);return l}}class Pu extends Qf{constructor(t){super(t)}createRenderer(){return new Iv(this)}}let Tv=!1;function Rv(i,t,e,n,r,s,o){const a=new XMLHttpRequest;a.open("GET",typeof i=="function"?i(e,n,r):i,!0),t.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=Tv,a.onload=function(l){if(!a.status||a.status>=200&&a.status<300){const c=t.getType();try{let h;c=="text"||c=="json"?h=a.responseText:c=="xml"?h=a.responseXML||a.responseText:c=="arraybuffer"&&(h=a.response),h?s(t.readFeatures(h,{extent:e,featureProjection:r}),t.readProjection(h)):o()}catch{o()}}else o()},a.onerror=o,a.send()}function Lu(i,t){return function(e,n,r,s,o){Rv(i,t,e,n,r,(a,l)=>{this.addFeatures(a),s!==void 0&&s(a)},()=>{this.changed(),o!==void 0&&o()})}}function Av(i,t){return[[-1/0,-1/0,1/0,1/0]]}class Zn extends $e{constructor(t){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t)if(typeof t.getSimplifiedGeometry=="function"){const e=t;this.setGeometry(e)}else{const e=t;this.setProperties(e)}}clone(){const t=new Zn(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());const e=this.getGeometry();e&&t.setGeometry(e.clone());const n=this.getStyle();return n&&t.setStyle(n),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(ct(this.geometryChangeKey_),this.geometryChangeKey_=null);const t=this.getGeometry();t&&(this.geometryChangeKey_=tt(t,W.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?Pv(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function Pv(i){if(typeof i=="function")return i;let t;return Array.isArray(i)?t=i:(it(typeof i.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),t=[i]),function(){return t}}function dg(i,t,e,n){const r=[];let s=fe();for(let o=0,a=e.length;o<a;++o){const l=e[o];s=Jl(i,t,l[0],n),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),t=l[l.length-1]}return r}function to(i,t,e,n,r,s,o){let a,l;const c=(e-t)/n;if(c===1)a=t;else if(c===2)a=t,l=r;else if(c!==0){let h=i[t],u=i[t+1],d=0;const f=[0];for(let w=t+n;w<e;w+=n){const E=i[w],I=i[w+1];d+=Math.sqrt((E-h)*(E-h)+(I-u)*(I-u)),f.push(d),h=E,u=I}const m=r*d,v=om(f,m);v<0?(l=(m-f[-v-2])/(f[-v-1]-f[-v-2]),a=t+(-v-2)*n):a=t+v*n}o=o>1?o:2,s=s||new Array(o);for(let h=0;h<o;++h)s[h]=a===void 0?NaN:l===void 0?i[a+h]:ee(i[a+h],i[a+n+h],l);return s}function Cl(i,t,e,n,r,s){if(e==t)return null;let o;if(r<i[t+n-1])return s?(o=i.slice(t,t+n),o[n-1]=r,o):null;if(i[e-1]<r)return s?(o=i.slice(e-n,e),o[n-1]=r,o):null;if(r==i[t+n-1])return i.slice(t,t+n);let a=t/n,l=e/n;for(;a<l;){const d=a+l>>1;r<i[(d+1)*n-1]?l=d:a=d+1}const c=i[a*n-1];if(r==c)return i.slice((a-1)*n,(a-1)*n+n);const h=i[(a+1)*n-1],u=(r-c)/(h-c);o=[];for(let d=0;d<n-1;++d)o.push(ee(i[(a-1)*n+d],i[a*n+d],u));return o.push(r),o}function Lv(i,t,e,n,r,s,o){if(o)return Cl(i,t,e[e.length-1],n,r,s);let a;if(r<i[n-1])return s?(a=i.slice(0,n),a[n-1]=r,a):null;if(i[i.length-1]<r)return s?(a=i.slice(i.length-n),a[n-1]=r,a):null;for(let l=0,c=e.length;l<c;++l){const h=e[l];if(t!=h){if(r<i[t+n-1])return null;if(r<=i[h-1])return Cl(i,t,h,n,r,!1);t=h}}return null}class eo extends of{constructor(t){super(),this.geometries_=t,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(ct),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const t=this.geometries_;for(let e=0,n=t.length;e<n;++e)this.changeEventsKeys_.push(tt(t[e],W.CHANGE,this.changed,this))}clone(){const t=new eo(Ga(this.geometries_));return t.applyProperties(this),t}closestPointXY(t,e,n,r){if(r<si(this.getExtent(),t,e))return r;const s=this.geometries_;for(let o=0,a=s.length;o<a;++o)r=s[o].closestPointXY(t,e,n,r);return r}containsXY(t,e){const n=this.geometries_;for(let r=0,s=n.length;r<s;++r)if(n[r].containsXY(t,e))return!0;return!1}computeExtent(t){Qi(t);const e=this.geometries_;for(let n=0,r=e.length;n<r;++n)Ud(t,e[n].getExtent());return t}getGeometries(){return Ga(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let t=[];const e=this.geometries_;for(let n=0,r=e.length;n<r;++n)e[n].getType()===this.getType()?t=t.concat(e[n].getGeometriesArrayRecursive()):t.push(e[n]);return t}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=[],n=this.geometries_;let r=!1;for(let s=0,o=n.length;s<o;++s){const a=n[s],l=a.getSimplifiedGeometry(t);e.push(l),l!==a&&(r=!0)}return r?new eo(e):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getType(){return"GeometryCollection"}intersectsExtent(t){const e=this.geometries_;for(let n=0,r=e.length;n<r;++n)if(e[n].intersectsExtent(t))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(t,e){const n=this.geometries_;for(let r=0,s=n.length;r<s;++r)n[r].rotate(t,e);this.changed()}scale(t,e,n){n||(n=tn(this.getExtent()));const r=this.geometries_;for(let s=0,o=r.length;s<o;++s)r[s].scale(t,e,n);this.changed()}setGeometries(t){this.setGeometriesArray(Ga(t))}setGeometriesArray(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()}applyTransform(t){const e=this.geometries_;for(let n=0,r=e.length;n<r;++n)e[n].applyTransform(t);this.changed()}translate(t,e){const n=this.geometries_;for(let r=0,s=n.length;r<s;++r)n[r].translate(t,e);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function Ga(i){return i.map(t=>t.clone())}class ni extends ai{constructor(t,e){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendCoordinate(t){Oe(this.flatCoordinates,t),this.changed()}clone(){const t=new ni(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,r){return r<si(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(oc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),lc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,n,r))}forEachSegment(t){return df(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinateAtM(t,e){return this.layout!="XYM"&&this.layout!="XYZM"?null:(e=e!==void 0?e:!1,Cl(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e))}getCoordinates(){return wn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(t,e){return to(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}getLength(){return Vc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(t){const e=[];return e.length=Po(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new ni(e,"XY")}getType(){return"LineString"}intersectsExtent(t){return Lo(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,this.getExtent())}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Ao(this.flatCoordinates,0,t,this.stride),this.changed()}}class no extends ai{constructor(t,e,n){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(t[0]))this.setCoordinates(t,e);else if(e!==void 0&&n)this.setFlatCoordinates(e,t),this.ends_=n;else{const r=t,s=[],o=[];for(let l=0,c=r.length;l<c;++l){const h=r[l];Oe(s,h.getFlatCoordinates()),o.push(s.length)}const a=r.length===0?this.getLayout():r[0].getLayout();this.setFlatCoordinates(a,s),this.ends_=o}}appendLineString(t){Oe(this.flatCoordinates,t.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new no(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,n,r){return r<si(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ac(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),cc(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,n,r))}getCoordinateAtM(t,e,n){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(e=e!==void 0?e:!1,n=n!==void 0?n:!1,Lv(this.flatCoordinates,0,this.ends_,this.stride,t,e,n))}getCoordinates(){return kr(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(t){return t<0||this.ends_.length<=t?null:new ni(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLineStrings(){const t=this.flatCoordinates,e=this.ends_,n=this.layout,r=[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=e[o],c=new ni(t.slice(s,l),n);r.push(c),s=l}return r}getLength(){const t=this.ends_;let e=0,n=0;for(let r=0,s=t.length;r<s;++r)n+=Vc(this.flatCoordinates,e,t[r],this.stride),e=t[r];return n}getFlatMidpoints(){const t=[],e=this.flatCoordinates;let n=0;const r=this.ends_,s=this.stride;for(let o=0,a=r.length;o<a;++o){const l=r[o],c=to(e,n,l,s,.5);Oe(t,c),n=l}return t}getSimplifiedGeometryInternal(t){const e=[],n=[];return e.length=hf(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,n),new no(e,"XY",n)}getType(){return"MultiLineString"}intersectsExtent(t){return v_(this.flatCoordinates,0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const n=os(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=n.length===0?0:n[n.length-1],this.changed()}}class Wo extends ai{constructor(t,e){super(),e&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendPoint(t){Oe(this.flatCoordinates,t.getFlatCoordinates()),this.changed()}clone(){const t=new Wo(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,r){if(r<si(this.getExtent(),t,e))return r;const s=this.flatCoordinates,o=this.stride;for(let a=0,l=s.length;a<l;a+=o){const c=Hn(t,e,s[a],s[a+1]);if(c<r){r=c;for(let h=0;h<o;++h)n[h]=s[a+h];n.length=o}}return r}getCoordinates(){return wn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(t){const e=this.flatCoordinates.length/this.stride;return t<0||e<=t?null:new Ye(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}getPoints(){const t=this.flatCoordinates,e=this.layout,n=this.stride,r=[];for(let s=0,o=t.length;s<o;s+=n){const a=new Ye(t.slice(s,s+n),e);r.push(a)}return r}getType(){return"MultiPoint"}intersectsExtent(t){const e=this.flatCoordinates,n=this.stride;for(let r=0,s=e.length;r<s;r+=n){const o=e[r],a=e[r+1];if(Zl(t,o,a))return!0}return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Ao(this.flatCoordinates,0,t,this.stride),this.changed()}}class io extends ai{constructor(t,e,n){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!n&&!Array.isArray(t[0])){const r=t,s=[],o=[];for(let a=0,l=r.length;a<l;++a){const c=r[a],h=s.length,u=c.getEnds();for(let d=0,f=u.length;d<f;++d)u[d]+=h;Oe(s,c.getFlatCoordinates()),o.push(u)}e=r.length===0?this.getLayout():r[0].getLayout(),t=s,n=o}e!==void 0&&n?(this.setFlatCoordinates(e,t),this.endss_=n):this.setCoordinates(t,e)}appendPolygon(t){let e;if(!this.flatCoordinates)this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();else{const n=this.flatCoordinates.length;Oe(this.flatCoordinates,t.getFlatCoordinates()),e=t.getEnds().slice();for(let r=0,s=e.length;r<s;++r)e[r]+=n}this.endss_.push(e),this.changed()}clone(){const t=this.endss_.length,e=new Array(t);for(let r=0;r<t;++r)e[r]=this.endss_[r].slice();const n=new io(this.flatCoordinates.slice(),this.layout,e);return n.applyProperties(this),n}closestPointXY(t,e,n,r){return r<si(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(f_(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),g_(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,n,r))}containsXY(t,e){return w_(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)}getArea(){return d_(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),cl(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,ll(e,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const t=dg(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=uf(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new Wo(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;pf(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=cl(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],n=[];return e.length=__(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,n),new io(e,"XY",n)}getPolygon(t){if(t<0||this.endss_.length<=t)return null;let e;if(t===0)e=0;else{const s=this.endss_[t-1];e=s[s.length-1]}const n=this.endss_[t].slice(),r=n[n.length-1];if(e!==0)for(let s=0,o=n.length;s<o;++s)n[s]-=e;return new In(this.flatCoordinates.slice(e,r),this.layout,n)}getPolygons(){const t=this.layout,e=this.flatCoordinates,n=this.endss_,r=[];let s=0;for(let o=0,a=n.length;o<a;++o){const l=n[o].slice(),c=l[l.length-1];if(s!==0)for(let u=0,d=l.length;u<d;++u)l[u]-=s;const h=new In(e.slice(s,c),t,l);r.push(h),s=c}return r}getType(){return"MultiPolygon"}intersectsExtent(t){return b_(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);const n=cf(this.flatCoordinates,0,t,this.stride,this.endss_);if(n.length===0)this.flatCoordinates.length=0;else{const r=n[n.length-1];this.flatCoordinates.length=r.length===0?0:r[r.length-1]}this.changed()}}const Mu=ve();class ne{constructor(t,e,n,r,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=t,this.flatCoordinates_=e,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=n||null,this.properties_=s,this.squaredTolerance_,this.stride_=r,this.simplifiedGeometry_}get(t){return this.properties_[t]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?Gd(this.flatCoordinates_):Jl(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const t=tn(this.getExtent());this.flatInteriorPoints_=dc(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const t=C_(this.flatCoordinates_,this.ends_),e=dg(this.flatCoordinates_,0,t,2);this.flatInteriorPoints_=uf(this.flatCoordinates_,0,t,2,e)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=to(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const t=this.flatCoordinates_;let e=0;const n=this.ends_;for(let r=0,s=n.length;r<s;++r){const o=n[r],a=to(t,e,o,2,.5);Oe(this.flatMidpoints_,a),e=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(t){return this}simplifyTransformed(t,e){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(t){t=ht(t);const e=t.getExtent(),n=t.getWorldExtent();if(e&&n){const r=Ut(n)/Ut(e);en(Mu,n[0],n[3],r,-r,0,0,0),En(this.flatCoordinates_,0,this.flatCoordinates_.length,2,Mu,this.flatCoordinates_)}}applyTransform(t){t(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new ne(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=Kd((t,e)=>{if(t===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),e&&this.simplifiedGeometry_.applyTransform(e);const n=this.simplifiedGeometry_.getFlatCoordinates();let r;switch(this.type_){case"LineString":n.length=Po(n,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,t,n,0),r=[n.length];break;case"MultiLineString":r=[],n.length=hf(n,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,t,n,0,r);break;case"Polygon":r=[],n.length=hc(n,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(t),n,0,r);break}return r&&(this.simplifiedGeometry_=new ne(this.type_,n,r,2,this.properties_,this.id_)),this.squaredTolerance_=t,this.simplifiedGeometry_}),this}}ne.prototype.getFlatCoordinates=ne.prototype.getOrientedFlatCoordinates;class Ou{constructor(t){this.rbush_=new Pd(t),this.items_={}}insert(t,e){const n={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(n),this.items_[et(e)]=n}load(t,e){const n=new Array(e.length);for(let r=0,s=e.length;r<s;r++){const o=t[r],a=e[r],l={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};n[r]=l,this.items_[et(a)]=l}this.rbush_.load(n)}remove(t){const e=et(t),n=this.items_[e];return delete this.items_[e],this.rbush_.remove(n)!==null}update(t,e){const n=this.items_[et(e)],r=[n.minX,n.minY,n.maxX,n.maxY];Pr(r,t)||(this.remove(e),this.insert(t,e))}getAll(){return this.rbush_.all().map(function(e){return e.value})}getInExtent(t){const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map(function(r){return r.value})}forEach(t){return this.forEach_(this.getAll(),t)}forEachInExtent(t,e){return this.forEach_(this.getInExtent(t),e)}forEach_(t,e){let n;for(let r=0,s=t.length;r<s;r++)if(n=e(t[r]),n)return n;return n}isEmpty(){return Jn(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(t){const e=this.rbush_.toJSON();return Qe(e.minX,e.minY,e.maxX,e.maxY,t)}concat(t){this.rbush_.load(t.rbush_.all());for(const e in t.items_)this.items_[e]=t.items_[e]}}class fg extends $e{constructor(t){super(),this.projection=ht(t.projection),this.attributions_=ku(t.attributions),this.attributionsCollapsible_=t.attributionsCollapsible??!0,this.loading=!1,this.state_=t.state!==void 0?t.state:"ready",this.wrapX_=t.wrapX!==void 0?t.wrapX:!1,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;const e=this;this.viewPromise_=new Promise(function(n,r){e.viewResolver=n,e.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(t){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=ku(t),this.changed()}setState(t){this.state_=t,this.changed()}}function ku(i){return i?typeof i=="function"?i:(Array.isArray(i)||(i=[i]),t=>i):null}const ae={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class un extends on{constructor(t,e,n){super(t),this.feature=e,this.features=n}}class Du extends fg{constructor(t){t=t||{},super({attributions:t.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:t.wrapX!==void 0?t.wrapX:!0}),this.on,this.once,this.un,this.loader_=Mr,this.format_=t.format||null,this.overlaps_=t.overlaps===void 0?!0:t.overlaps,this.url_=t.url,t.loader!==void 0?this.loader_=t.loader:this.url_!==void 0&&(it(this.format_,"`format` must be set when `url` is set"),this.loader_=Lu(this.url_,this.format_)),this.strategy_=t.strategy!==void 0?t.strategy:Av;const e=t.useSpatialIndex!==void 0?t.useSpatialIndex:!0;this.featuresRtree_=e?new Ou:null,this.loadedExtentsRtree_=new Ou,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let n,r;Array.isArray(t.features)?r=t.features:t.features&&(n=t.features,r=n.getArray()),!e&&n===void 0&&(n=new Le(r)),r!==void 0&&this.addFeaturesInternal(r),n!==void 0&&this.bindFeaturesCollection_(n)}addFeature(t){this.addFeatureInternal(t),this.changed()}addFeatureInternal(t){const e=et(t);if(!this.addToIndex_(e,t)){this.featuresCollection_&&this.featuresCollection_.remove(t);return}this.setupChangeEvents_(e,t);const n=t.getGeometry();if(n){const r=n.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new un(ae.ADDFEATURE,t))}setupChangeEvents_(t,e){e instanceof ne||(this.featureChangeKeys_[t]=[tt(e,W.CHANGE,this.handleFeatureChange_,this),tt(e,Vi.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(t,e){let n=!0;if(e.getId()!==void 0){const r=String(e.getId());if(!(r in this.idIndex_))this.idIndex_[r]=e;else if(e instanceof ne){const s=this.idIndex_[r];s instanceof ne?Array.isArray(s)?s.push(e):this.idIndex_[r]=[s,e]:n=!1}else n=!1}return n&&(it(!(t in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[t]=e),n}addFeatures(t){this.addFeaturesInternal(t),this.changed()}addFeaturesInternal(t){const e=[],n=[],r=[];for(let s=0,o=t.length;s<o;s++){const a=t[s],l=et(a);this.addToIndex_(l,a)&&n.push(a)}for(let s=0,o=n.length;s<o;s++){const a=n[s],l=et(a);this.setupChangeEvents_(l,a);const c=a.getGeometry();if(c){const h=c.getExtent();e.push(h),r.push(a)}else this.nullGeometryFeatures_[l]=a}if(this.featuresRtree_&&this.featuresRtree_.load(e,r),this.hasListener(ae.ADDFEATURE))for(let s=0,o=n.length;s<o;s++)this.dispatchEvent(new un(ae.ADDFEATURE,n[s]))}bindFeaturesCollection_(t){let e=!1;this.addEventListener(ae.ADDFEATURE,function(n){e||(e=!0,t.push(n.feature),e=!1)}),this.addEventListener(ae.REMOVEFEATURE,function(n){e||(e=!0,t.remove(n.feature),e=!1)}),t.addEventListener(jt.ADD,n=>{e||(e=!0,this.addFeature(n.element),e=!1)}),t.addEventListener(jt.REMOVE,n=>{e||(e=!0,this.removeFeature(n.element),e=!1)}),this.featuresCollection_=t}clear(t){if(t){for(const n in this.featureChangeKeys_)this.featureChangeKeys_[n].forEach(ct);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(n=>{this.removeFeatureInternal(n)});for(const n in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[n])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const e=new un(ae.CLEAR);this.dispatchEvent(e),this.changed()}forEachFeature(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureAtCoordinateDirect(t,e){const n=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(n,function(r){const s=r.getGeometry();if(s instanceof ne||s.intersectsCoordinate(t))return e(r)})}forEachFeatureInExtent(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureIntersectingExtent(t,e){return this.forEachFeatureInExtent(t,function(n){const r=n.getGeometry();if(r instanceof ne||r.intersectsExtent(t)){const s=e(n);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),Jn(this.nullGeometryFeatures_)||Oe(t,Object.values(this.nullGeometryFeatures_))),t}getFeaturesAtCoordinate(t){const e=[];return this.forEachFeatureAtCoordinateDirect(t,function(n){e.push(n)}),e}getFeaturesInExtent(t,e){if(this.featuresRtree_){if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);const r=Xd(t,e);return[].concat(...r.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(t,e){const n=t[0],r=t[1];let s=null;const o=[NaN,NaN];let a=1/0;const l=[-1/0,-1/0,1/0,1/0];return e=e||Lr,this.featuresRtree_.forEachInExtent(l,function(c){if(e(c)){const h=c.getGeometry(),u=a;if(a=h instanceof ne?0:h.closestPointXY(n,r,o,a),a<u){s=c;const d=Math.sqrt(a);l[0]=n-d,l[1]=r-d,l[2]=n+d,l[3]=r+d}}}),s}getExtent(t){return this.featuresRtree_.getExtent(t)}getFeatureById(t){const e=this.idIndex_[t.toString()];return e!==void 0?e:null}getFeatureByUid(t){const e=this.uidIndex_[t];return e!==void 0?e:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(t){const e=t.target,n=et(e),r=e.getGeometry();if(!r)n in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[n]=e);else{const o=r.getExtent();n in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[n],this.featuresRtree_&&this.featuresRtree_.insert(o,e)):this.featuresRtree_&&this.featuresRtree_.update(o,e)}const s=e.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[o]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[n]=e;this.changed(),this.dispatchEvent(new un(ae.CHANGEFEATURE,e))}hasFeature(t){const e=t.getId();return e!==void 0?e in this.idIndex_:et(t)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&Jn(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(t,e,n){const r=this.loadedExtentsRtree_,s=this.strategy_(t,e,n);for(let o=0,a=s.length;o<a;++o){const l=s[o];r.forEachInExtent(l,function(h){return mr(h.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new un(ae.FEATURESLOADSTART)),this.loader_.call(this,l,e,n,h=>{--this.loadingExtentsCount_,this.dispatchEvent(new un(ae.FEATURESLOADEND,void 0,h))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new un(ae.FEATURESLOADERROR))}),r.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(t){const e=this.loadedExtentsRtree_,n=e.forEachInExtent(t,function(r){if(Pr(r.extent,t))return r});n&&e.remove(n)}removeFeatures(t){let e=!1;for(let n=0,r=t.length;n<r;++n)e=this.removeFeatureInternal(t[n])||e;e&&this.changed()}removeFeature(t){if(!t)return;this.removeFeatureInternal(t)&&this.changed()}removeFeatureInternal(t){const e=et(t);if(!(e in this.uidIndex_))return!1;e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.featureChangeKeys_[e]?.forEach(ct),delete this.featureChangeKeys_[e];const r=t.getId();if(r!==void 0){const s=r.toString(),o=this.idIndex_[s];o===t?delete this.idIndex_[s]:Array.isArray(o)&&(o.splice(o.indexOf(t),1),o.length===1&&(this.idIndex_[s]=o[0]))}return delete this.uidIndex_[e],this.hasListener(ae.REMOVEFEATURE)&&this.dispatchEvent(new un(ae.REMOVEFEATURE,t)),!0}removeFromIdIndex_(t){for(const e in this.idIndex_)if(this.idIndex_[e]===t){delete this.idIndex_[e];break}}setLoader(t){this.loader_=t}setUrl(t){it(this.format_,"`format` must be set when `url` is set"),this.url_=t,this.setLoader(Lu(t,this.format_))}setOverlaps(t){this.overlaps_=t,this.changed()}}class Mv{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=Zn,this.supportedMediaTypes=null}getReadOptions(t,e){if(e){let n=e.dataProjection?ht(e.dataProjection):this.readProjection(t);e.extent&&n&&n.getUnits()==="tile-pixels"&&(n=ht(n),n.setWorldExtent(e.extent)),e={dataProjection:n,featureProjection:e.featureProjection}}return this.adaptOptions(e)}adaptOptions(t){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},t)}getType(){return U()}readFeature(t,e){return U()}readFeatures(t,e){return U()}readGeometry(t,e){return U()}readProjection(t){return U()}writeFeature(t,e){return U()}writeFeatures(t,e){return U()}writeGeometry(t,e){return U()}}function zc(i,t,e){const n=e?ht(e.featureProjection):null,r=e?ht(e.dataProjection):null;let s=i;if(n&&r&&!Fs(n,r)){t&&(s=i.clone());const o=t?n:r,a=t?r:n;o.getUnits()==="tile-pixels"?s.transform(o,a):s.applyTransform(Gi(o,a))}if(t&&e&&e.decimals!==void 0){const o=Math.pow(10,e.decimals),a=function(l){for(let c=0,h=l.length;c<h;++c)l[c]=Math.round(l[c]*o)/o;return l};s===i&&(s=i.clone()),s.applyTransform(a)}return s}const Ov={Point:Ye,LineString:ni,Polygon:In,MultiPoint:Wo,MultiLineString:no,MultiPolygon:io};function kv(i,t,e){return Array.isArray(t[0])?(pf(i,0,t,e)||(i=i.slice(),cl(i,0,t,e)),i):(gc(i,0,t,e)||(i=i.slice(),Ws(i,0,t,e)),i)}function gg(i,t){const e=i.geometry;if(!e)return[];if(Array.isArray(e))return e.map(s=>gg({...i,geometry:s})).flat();const n=e.type==="MultiPolygon"?"Polygon":e.type;if(n==="GeometryCollection"||n==="Circle")throw new Error("Unsupported geometry type: "+n);const r=e.layout.length;return zc(new ne(n,n==="Polygon"?kv(e.flatCoordinates,e.ends,r):e.flatCoordinates,e.ends?.flat(),r,i.properties||{},i.id).enableSimplifyTransformed(),!1,t)}function Gc(i,t){if(!i)return null;if(Array.isArray(i)){const n=i.map(r=>Gc(r,t));return new eo(n)}const e=Ov[i.type];return zc(new e(i.flatCoordinates,i.layout||"XY",i.ends),!1,t)}class Dv extends Mv{constructor(){super()}getType(){return"json"}readFeature(t,e){return this.readFeatureFromObject(Ps(t),this.getReadOptions(t,e))}readFeatures(t,e){return this.readFeaturesFromObject(Ps(t),this.getReadOptions(t,e))}readFeatureFromObject(t,e){return U()}readFeaturesFromObject(t,e){return U()}readGeometry(t,e){return this.readGeometryFromObject(Ps(t),this.getReadOptions(t,e))}readGeometryFromObject(t,e){return U()}readProjection(t){return this.readProjectionFromObject(Ps(t))}readProjectionFromObject(t){return U()}writeFeature(t,e){return JSON.stringify(this.writeFeatureObject(t,e))}writeFeatureObject(t,e){return U()}writeFeatures(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))}writeFeaturesObject(t,e){return U()}writeGeometry(t,e){return JSON.stringify(this.writeGeometryObject(t,e))}writeGeometryObject(t,e){return U()}}function Ps(i){if(typeof i=="string"){const t=JSON.parse(i);return t||null}return i!==null?i:null}class Fv extends Dv{constructor(t){t=t||{},super(),this.dataProjection=ht(t.dataProjection?t.dataProjection:"EPSG:4326"),t.featureProjection&&(this.defaultFeatureProjection=ht(t.featureProjection)),t.featureClass&&(this.featureClass=t.featureClass),this.geometryName_=t.geometryName,this.extractGeometryName_=t.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(t,e){let n=null;t.type==="Feature"?n=t:n={type:"Feature",geometry:t,properties:null};const r=Uc(n.geometry);if(this.featureClass===ne)return gg({geometry:r,id:n.id,properties:n.properties},e);const s=new Zn;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&n.geometry_name&&s.setGeometryName(n.geometry_name),s.setGeometry(Gc(r,e)),"id"in n&&s.setId(n.id),n.properties&&s.setProperties(n.properties,!0),s}readFeaturesFromObject(t,e){const n=t;let r=null;if(n.type==="FeatureCollection"){const s=t;r=[];const o=s.features;for(let a=0,l=o.length;a<l;++a){const c=this.readFeatureFromObject(o[a],e);c&&r.push(c)}}else r=[this.readFeatureFromObject(t,e)];return r.flat()}readGeometryFromObject(t,e){return Nv(t,e)}readProjectionFromObject(t){const e=t.crs;let n;if(e)if(e.type=="name")n=ht(e.properties.name);else if(e.type==="EPSG")n=ht("EPSG:"+e.properties.code);else throw new Error("Unknown SRS type");else n=this.dataProjection;return n}writeFeatureObject(t,e){e=this.adaptOptions(e);const n={type:"Feature",geometry:null,properties:null},r=t.getId();if(r!==void 0&&(n.id=r),!t.hasProperties())return n;const s=t.getProperties(),o=t.getGeometry();return o&&(n.geometry=xl(o,e),delete s[t.getGeometryName()]),Jn(s)||(n.properties=s),n}writeFeaturesObject(t,e){e=this.adaptOptions(e);const n=[];for(let r=0,s=t.length;r<s;++r)n.push(this.writeFeatureObject(t[r],e));return{type:"FeatureCollection",features:n}}writeGeometryObject(t,e){return xl(t,this.adaptOptions(e))}}function Uc(i,t){if(!i)return null;let e;switch(i.type){case"Point":{e=Vv(i);break}case"LineString":{e=zv(i);break}case"Polygon":{e=jv(i);break}case"MultiPoint":{e=Uv(i);break}case"MultiLineString":{e=Gv(i);break}case"MultiPolygon":{e=Bv(i);break}case"GeometryCollection":{e=$v(i);break}default:throw new Error("Unsupported GeoJSON type: "+i.type)}return e}function Nv(i,t){const e=Uc(i);return Gc(e,t)}function $v(i,t){return i.geometries.map(function(n){return Uc(n)})}function Vv(i){const t=i.coordinates;return{type:"Point",flatCoordinates:t,layout:li(t.length)}}function zv(i){const t=i.coordinates,e=t.flat();return{type:"LineString",flatCoordinates:e,ends:[e.length],layout:li(t[0]?.length||2)}}function Gv(i){const t=i.coordinates,e=t[0]?.[0]?.length||2,n=[],r=os(n,0,t,e);return{type:"MultiLineString",flatCoordinates:n,ends:r,layout:li(e)}}function Uv(i){const t=i.coordinates;return{type:"MultiPoint",flatCoordinates:t.flat(),layout:li(t[0]?.length||2)}}function Bv(i){const t=i.coordinates,e=[],n=t[0]?.[0]?.[0].length||2,r=cf(e,0,t,n);return{type:"MultiPolygon",flatCoordinates:e,ends:r,layout:li(n)}}function jv(i){const t=i.coordinates,e=[],n=t[0]?.[0]?.length,r=os(e,0,t,n);return{type:"Polygon",flatCoordinates:e,ends:r,layout:li(n)}}function xl(i,t){i=zc(i,!0,t);const e=i.getType();let n;switch(e){case"Point":{n=Yv(i);break}case"LineString":{n=qv(i);break}case"Polygon":{n=Zv(i,t);break}case"MultiPoint":{n=Kv(i);break}case"MultiLineString":{n=Xv(i);break}case"MultiPolygon":{n=Hv(i,t);break}case"GeometryCollection":{n=Wv(i,t);break}case"Circle":{n={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+e)}return n}function Wv(i,t){return t=Object.assign({},t),delete t.featureProjection,{type:"GeometryCollection",geometries:i.getGeometriesArray().map(function(n){return xl(n,t)})}}function qv(i,t){return{type:"LineString",coordinates:i.getCoordinates()}}function Xv(i,t){return{type:"MultiLineString",coordinates:i.getCoordinates()}}function Kv(i,t){return{type:"MultiPoint",coordinates:i.getCoordinates()}}function Hv(i,t){let e;return t&&(e=t.rightHanded),{type:"MultiPolygon",coordinates:i.getCoordinates(e)}}function Yv(i,t){return{type:"Point",coordinates:i.getCoordinates()}}function Zv(i,t){let e;return t&&(e=t.rightHanded),{type:"Polygon",coordinates:i.getCoordinates(e)}}const xi=[0,0,0],dn=5;class pg{constructor(t){this.minZoom=t.minZoom!==void 0?t.minZoom:0,this.resolutions_=t.resolutions,it(cm(this.resolutions_,(r,s)=>s-r),"`resolutions` must be sorted in descending order");let e;if(!t.origins){for(let r=0,s=this.resolutions_.length-1;r<s;++r)if(!e)e=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==e){e=void 0;break}}this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=t.origin!==void 0?t.origin:null,this.origins_=null,t.origins!==void 0&&(this.origins_=t.origins,it(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const n=t.extent;n!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=oi(n)),it(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,t.tileSizes!==void 0&&(this.tileSizes_=t.tileSizes,it(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=t.tileSize!==void 0?t.tileSize:this.tileSizes_?null:xc,it(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=n!==void 0?n:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],t.sizes!==void 0?this.fullTileRanges_=t.sizes.map((r,s)=>{const o=new $c(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(n){const a=this.getTileRangeForExtentAndZ(n,s);o.minX=Math.max(a.minX,o.minX),o.maxX=Math.min(a.maxX,o.maxX),o.minY=Math.max(a.minY,o.minY),o.maxY=Math.min(a.maxY,o.maxY)}return o}):n&&this.calculateTileRanges_(n)}forEachTileCoord(t,e,n){const r=this.getTileRangeForExtentAndZ(t,e);for(let s=r.minX,o=r.maxX;s<=o;++s)for(let a=r.minY,l=r.maxY;a<=l;++a)n([e,s,a])}forEachTileCoordParentTileRange(t,e,n,r){let s,o,a,l=null,c=t[0]-1;for(this.zoomFactor_===2?(o=t[1],a=t[2]):l=this.getTileCoordExtent(t,r);c>=this.minZoom;){if(o!==void 0&&a!==void 0?(o=Math.floor(o/2),a=Math.floor(a/2),s=Ei(o,o,a,a,n)):s=this.getTileRangeForExtentAndZ(l,c,n),e(c,s))return!0;--c}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(t){return this.origin_?this.origin_:this.origins_[t]}getResolution(t){return this.resolutions_[t]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(t,e,n){if(t[0]<this.maxZoom){if(this.zoomFactor_===2){const s=t[1]*2,o=t[2]*2;return Ei(s,s+1,o,o+1,e)}const r=this.getTileCoordExtent(t,n||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,t[0]+1,e)}return null}getTileRangeForTileCoordAndZ(t,e,n){if(e>this.maxZoom||e<this.minZoom)return null;const r=t[0],s=t[1],o=t[2];if(e===r)return Ei(s,o,s,o,n);if(this.zoomFactor_){const l=Math.pow(this.zoomFactor_,e-r),c=Math.floor(s*l),h=Math.floor(o*l);if(e<r)return Ei(c,c,h,h,n);const u=Math.floor(l*(s+1))-1,d=Math.floor(l*(o+1))-1;return Ei(c,u,h,d,n)}const a=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,e,n)}getTileRangeForExtentAndZ(t,e,n){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,xi);const r=xi[1],s=xi[2];this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,xi);const o=xi[1],a=xi[2];return Ei(r,o,s,a,n)}getTileCoordCenter(t){const e=this.getOrigin(t[0]),n=this.getResolution(t[0]),r=Yt(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*r[0]*n,e[1]-(t[2]+.5)*r[1]*n]}getTileCoordExtent(t,e){const n=this.getOrigin(t[0]),r=this.getResolution(t[0]),s=Yt(this.getTileSize(t[0]),this.tmpSize_),o=n[0]+t[1]*s[0]*r,a=n[1]-(t[2]+1)*s[1]*r,l=o+s[0]*r,c=a+s[1]*r;return Qe(o,a,l,c,e)}getTileCoordForCoordAndResolution(t,e,n){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,n)}getTileCoordForXYAndResolution_(t,e,n,r,s){const o=this.getZForResolution(n),a=n/this.getResolution(o),l=this.getOrigin(o),c=Yt(this.getTileSize(o),this.tmpSize_);let h=a*(t-l[0])/n/c[0],u=a*(l[1]-e)/n/c[1];return r?(h=vs(h,dn)-1,u=vs(u,dn)-1):(h=ws(h,dn),u=ws(u,dn)),Js(o,h,u,s)}getTileCoordForXYAndZ_(t,e,n,r,s){const o=this.getOrigin(n),a=this.getResolution(n),l=Yt(this.getTileSize(n),this.tmpSize_);let c=(t-o[0])/a/l[0],h=(o[1]-e)/a/l[1];return r?(c=vs(c,dn)-1,h=vs(h,dn)-1):(c=ws(c,dn),h=ws(h,dn)),Js(n,c,h,s)}getTileCoordForCoordAndZ(t,e,n){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,n)}getTileCoordResolution(t){return this.resolutions_[t[0]]}getTileSize(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}getFullTileRange(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}getZForResolution(t,e){const n=Hl(this.resolutions_,t,e||0);return dt(n,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(t,e){return ff(e,0,e.length,2,this.getTileCoordExtent(t))}calculateTileRanges_(t){const e=this.resolutions_.length,n=new Array(e);for(let r=this.minZoom;r<e;++r)n[r]=this.getTileRangeForExtentAndZ(t,r);this.fullTileRanges_=n}}function mg(i){let t=i.getDefaultTileGrid();return t||(t=e1(i),i.setDefaultTileGrid(t)),t}function Jv(i,t,e){const n=t[0],r=i.getTileCoordCenter(t),s=Bc(e);if(!$i(s,r)){const o=ot(s),a=Math.ceil((s[0]-r[0])/o);return r[0]+=o*a,i.getTileCoordForCoordAndZ(r,n)}return t}function Qv(i,t,e,n){n=n!==void 0?n:"top-left";const r=_g(i,t,e);return new pg({extent:i,origin:dm(i,n),resolutions:r,tileSize:e})}function t1(i){const t=i||{},e=t.extent||ht("EPSG:3857").getExtent(),n={extent:e,minZoom:t.minZoom,tileSize:t.tileSize,resolutions:_g(e,t.maxZoom,t.tileSize,t.maxResolution)};return new pg(n)}function _g(i,t,e,n){t=t!==void 0?t:Ny,e=Yt(e!==void 0?e:xc);const r=Ut(i),s=ot(i);n=n>0?n:Math.max(s/e[0],r/e[1]);const o=t+1,a=new Array(o);for(let l=0;l<o;++l)a[l]=n/Math.pow(2,l);return a}function e1(i,t,e,n){const r=Bc(i);return Qv(r,t,e,n)}function Bc(i){i=ht(i);let t=i.getExtent();if(!t){const e=180*tc.degrees/i.getMetersPerUnit();t=Qe(-e,-e,e,e)}return t}const n1=/\{z\}/g,i1=/\{x\}/g,r1=/\{y\}/g,s1=/\{-y\}/g;function o1(i,t,e,n,r){return i.replace(n1,t.toString()).replace(i1,e.toString()).replace(r1,n.toString()).replace(s1,function(){if(r===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(r-n).toString()})}function a1(i){const t=[];let e=/\{([a-z])-([a-z])\}/.exec(i);if(e){const n=e[1].charCodeAt(0),r=e[2].charCodeAt(0);let s;for(s=n;s<=r;++s)t.push(i.replace(e[0],String.fromCharCode(s)));return t}if(e=/\{(\d+)-(\d+)\}/.exec(i),e){const n=parseInt(e[2],10);for(let r=parseInt(e[1],10);r<=n;r++)t.push(i.replace(e[0],r.toString()));return t}return t.push(i),t}function l1(i,t){return function(e,n,r){if(!e)return;let s;const o=e[0];if(t){const a=t.getFullTileRange(o);a&&(s=a.getHeight()-1)}return o1(i,o,e[1],e[2],s)}}function c1(i,t){const e=i.length,n=new Array(e);for(let r=0;r<e;++r)n[r]=l1(i[r],t);return h1(n)}function h1(i){return i.length===1?i[0]:function(t,e,n){if(!t)return;const r=Uw(t),s=Mi(r,i.length);return i[s](t,e,n)}}class u1 extends fg{constructor(t){super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=t.tilePixelRatio!==void 0?t.tilePixelRatio:1,this.tileGrid=t.tileGrid!==void 0?t.tileGrid:null;const e=[256,256];this.tileGrid&&Yt(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),e),this.tmpSize=[0,0],this.key_=t.key||et(this),this.tileOptions={transition:t.transition,interpolate:t.interpolate},this.zDirection=t.zDirection?t.zDirection:0}getGutterForProjection(t){return 0}getKey(){return this.key_}setKey(t){this.key_!==t&&(this.key_=t,this.changed())}getResolutions(t){const e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}getTile(t,e,n,r,s){return U()}getTileGrid(){return this.tileGrid}getTileGridForProjection(t){return this.tileGrid?this.tileGrid:mg(t)}getTilePixelRatio(t){return this.tilePixelRatio_}getTilePixelSize(t,e,n){const r=this.getTileGridForProjection(n),s=this.getTilePixelRatio(e),o=Yt(r.getTileSize(t),this.tmpSize);return s==1?o:I0(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(t,e){const n=e!==void 0?e:this.getProjection(),r=e!==void 0?this.getTileGridForProjection(n):this.tileGrid||this.getTileGridForProjection(n);return this.getWrapX()&&n.isGlobal()&&(t=Jv(r,t,n)),jw(t,r)?t:null}clear(){}refresh(){this.clear(),super.refresh()}}class d1 extends on{constructor(t,e){super(t),this.tile=e}}const Ua={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class jc extends u1{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===jc.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(t){const e=t.target,n=et(e),r=e.getState();let s;r==z.LOADING?(this.tileLoadingKeys_[n]=!0,s=Ua.TILELOADSTART):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],s=r==z.ERROR?Ua.TILELOADERROR:r==z.LOADED?Ua.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new d1(s,e))}setTileLoadFunction(t){this.tileLoadFunction=t,this.changed()}setTileUrlFunction(t,e){this.tileUrlFunction=t,typeof e<"u"?this.setKey(e):this.changed()}setUrl(t){const e=a1(t);this.urls=e,this.setUrls(e)}setUrls(t){this.urls=t;const e=t.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(c1(t,this.tileGrid),e):this.setKey(e)}tileUrlFunction(t,e,n){}}class f1 extends jc{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:g1,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate!==void 0?t.interpolate:!0,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=t.crossOrigin!==void 0?t.crossOrigin:null,this.tileClass=t.tileClass!==void 0?t.tileClass:ig,this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(t){return this.getProjection()&&t&&!Fs(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getTileGridForProjection(t){const e=this.getProjection();if(this.tileGrid&&(!e||Fs(e,t)))return this.tileGrid;const n=et(t);return n in this.tileGridForProjection||(this.tileGridForProjection[n]=mg(t)),this.tileGridForProjection[n]}createTile_(t,e,n,r,s,o){const a=[t,e,n],l=this.getTileCoordForTileUrlFunction(a,s),c=l?this.tileUrlFunction(l,r,s):void 0,h=new this.tileClass(a,c!==void 0?z.IDLE:z.EMPTY,c!==void 0?c:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return h.key=o,h.addEventListener(W.CHANGE,this.handleTileChange.bind(this)),h}getTile(t,e,n,r,s){const o=this.getProjection();if(!o||!s||Fs(o,s))return this.getTileInternal(t,e,n,r,o||s);const a=[t,e,n],l=this.getKey(),c=this.getTileGridForProjection(o),h=this.getTileGridForProjection(s),u=this.getTileCoordForTileUrlFunction(a,s),d=new rg(o,c,s,h,a,u,this.getTilePixelRatio(r),this.getGutter(),(f,m,v,w)=>this.getTileInternal(f,m,v,w,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return d.key=l,d}getTileInternal(t,e,n,r,s){const o=this.getKey();return this.createTile_(t,e,n,r,s,o)}setRenderReprojectionEdges(t){this.renderReprojectionEdges_!=t&&(this.renderReprojectionEdges_=t,this.changed())}setTileGridForProjection(t,e){const n=ht(t);if(n){const r=et(n);r in this.tileGridForProjection||(this.tileGridForProjection[r]=e)}}}function g1(i,t){i.getImage().src=t}class p1 extends f1{constructor(t){t=t||{};const e=t.projection!==void 0?t.projection:"EPSG:3857",n=t.tileGrid!==void 0?t.tileGrid:t1({extent:Bc(e),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:e,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:n,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX!==void 0?t.wrapX:!0,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.gutter_=t.gutter!==void 0?t.gutter:0}getGutter(){return this.gutter_}}const m1='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class _1 extends p1{constructor(t){t=t||{};let e;t.attributions!==void 0?e=t.attributions:e=[m1];const n=t.crossOrigin!==void 0?t.crossOrigin:"anonymous",r=t.url!==void 0?t.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:e,attributionsCollapsible:!1,cacheSize:t.cacheSize,crossOrigin:n,interpolate:t.interpolate,maxZoom:t.maxZoom!==void 0?t.maxZoom:19,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,transition:t.transition,url:r,wrapX:t.wrapX,zDirection:t.zDirection})}}function y1(i){return{...i,cameraPosition:null,guessedPosition:null,score:null,distance:null,scores:[]}}function Fu(i,t){if(i.country==null)throw new Error("Cannot start round without a selected country");return{...i,cameraPosition:t,guessedPosition:null,score:null,distance:null}}function w1(i,t){const e=il(i.cameraPosition,t),n=I_(e,i.country);return{...i,guessedPosition:t,distance:e,score:n,scores:[...i.scores,n]}}function Nu(i){return Math.round(i.scores.reduce((t,e)=>t+e,0)/i.scores.length)}function v1(i){return i.scores.length===i.roundPerGame}function Ba(i){return i.country!==null&&i.cameraPosition!==null}const qo="game-state";var b1=Object.defineProperty,E1=Object.getOwnPropertyDescriptor,Xo=(i,t,e,n)=>{for(var r=n>1?void 0:n?E1(t,e):t,s=i.length-1,o;s>=0;s--)(o=i[s])&&(r=(n?o(t,e,r):o(r))||r);return n&&r&&b1(t,e,r),r};t_();const C1=[{filter:["==",["get","type"],"guessed"],style:{"circle-radius":8,"circle-fill-color":"#fff","circle-stroke-color":"#f00","circle-stroke-width":3}},{filter:["==",["get","type"],"camera"],style:{"circle-radius":8,"circle-fill-color":"#fff","circle-stroke-color":"#000","circle-stroke-width":3}},{filter:["==",["get","type"],"line"],style:{"stroke-width":6,"stroke-color":"#000","stroke-line-dash":[6,12]}}];let qi=class extends Zt{constructor(){super(),this.showResult=!1,this.guessedFeature=new Zn({type:"guessed"}),this.cameraFeature=new Zn({type:"camera"}),this.lineFeature=new Zn({type:"line"}),this.maskSource=new Du({features:[]}),this.map=new Aw({controls:[],layers:[new Zw({source:new _1}),new Pu({source:new Du({features:[this.guessedFeature,this.cameraFeature,this.lineFeature]}),style:C1})]});const i=new Pu({style:{"fill-color":"rgba(0, 0, 0, 1.0)"},className:"ol-layer mask",updateWhileInteracting:!0,source:this.maskSource});i.on("prerender",x1),this.map.addLayer(i),this.map.on("click",t=>{const e=ki[this.gameState.country];$d(t.coordinate,e)!==!1&&(this.guessedFeature.setGeometry(new Ye(t.coordinate)),this.dispatchEvent(new CustomEvent("map-click",{detail:t.coordinate})))})}shouldUpdate(){return this.gameState.country!==null}willUpdate(){if(this.showResult&&this.gameState.cameraPosition&&this.gameState.guessedPosition?(this.guessedFeature.setGeometry(new Ye(this.gameState.guessedPosition)),this.cameraFeature.setGeometry(new Ye(this.gameState.cameraPosition)),this.lineFeature.setGeometry(new ni([this.gameState.cameraPosition,this.gameState.guessedPosition])),this.map.getView().fit(this.lineFeature.getGeometry().getExtent())):(this.guessedFeature.setGeometry(void 0),this.cameraFeature.setGeometry(void 0),this.lineFeature.setGeometry(void 0),this.map.getView().fit(this.getCountryExtent())),this.gameState.country!==null){const i=ki[this.gameState.country];this.maskSource.clear();const t=new Fv;this.maskSource.addFeature(t.readFeature(i))}}render(){return Y`<div class="map"></div>`}firstUpdated(){this.map.setTarget(this.mapElement);const i=this.getCountryExtent();this.map.setView(new Re({extent:i,center:tn(i),zoom:4}))}getCountryExtent(){return T_(x_[this.gameState.country],1.5)}};qi.styles=Dd`
    :host {
      display: block;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }
    .map {
      width: 100%;
      height: 100%;
      cursor: crosshair;
    }
    .ol-layer.mask {
      filter: blur(5px);
      opacity: 0.5;
    }
  `;Xo([Kl({context:qo,subscribe:!0})],qi.prototype,"gameState",2);Xo([M({attribute:"show-result",type:Boolean})],qi.prototype,"showResult",2);Xo([Ne(".map")],qi.prototype,"mapElement",2);qi=Xo([Nt("element-map")],qi);function x1(i){const t=i.context;t.globalCompositeOperation="copy",t.fillStyle="rgba(0, 0, 0, 1.0)",t.fillRect(0,0,t.canvas.width,t.canvas.height),t.globalCompositeOperation="destination-out"}var S1=Object.defineProperty,I1=Object.getOwnPropertyDescriptor,yg=(i,t,e,n)=>{for(var r=n>1?void 0:n?I1(t,e):t,s=i.length-1,o;s>=0;s--)(o=i[s])&&(r=(n?o(t,e,r):o(r))||r);return n&&r&&S1(t,e,r),r};let Sl=class extends Zt{constructor(){super(...arguments),this.localize=new Ji(this),this.guessedPosition=null}render(){return Y`
      <wa-card>
        <div slot="header">${this.localize.term("where_are_you")}</div>
        <element-map @map-click="${this.handleMapClick}"></element-map>
        <div slot="footer">
          <wa-button
            variant="brand"
            ?disabled="${this.guessedPosition==null}"
            @click="${this.validateGuess}"
            >${this.localize.term("guess")}</wa-button
          >
        </div>
      </wa-card>
    `}handleMapClick(i){this.guessedPosition=i.detail}validateGuess(){this.dispatchEvent(new CustomEvent("guess",{detail:this.guessedPosition})),this.guessedPosition=null}createRenderRoot(){return this}};yg([Fe()],Sl.prototype,"guessedPosition",2);Sl=yg([Nt("element-guess")],Sl);/*! Copyright 2025 Fonticons, Inc. - https://webawesome.com/license */var Il=new Set;function T1(){const i=document.documentElement.clientWidth;return Math.abs(window.innerWidth-i)}function R1(){const i=Number(getComputedStyle(document.body).paddingRight.replace(/px/,""));return isNaN(i)||!i?0:i}function $u(i){if(Il.add(i),!document.documentElement.classList.contains("wa-scroll-lock")){const t=T1()+R1();let e=getComputedStyle(document.documentElement).scrollbarGutter;(!e||e==="auto")&&(e="stable"),t<2&&(e=""),document.documentElement.style.setProperty("--wa-scroll-lock-gutter",e),document.documentElement.classList.add("wa-scroll-lock"),document.documentElement.style.setProperty("--wa-scroll-lock-size",`${t}px`)}}function Vu(i){Il.delete(i),Il.size===0&&(document.documentElement.classList.remove("wa-scroll-lock"),document.documentElement.style.removeProperty("--wa-scroll-lock-size"))}/*! Copyright 2025 Fonticons, Inc. - https://webawesome.com/license */function A1(i){return i.split(" ").map(t=>t.trim()).filter(t=>t!=="")}/*! Copyright 2025 Fonticons, Inc. - https://webawesome.com/license */var P1=class extends Event{constructor(){super("wa-after-hide",{bubbles:!0,cancelable:!1,composed:!0})}},L1=class extends Event{constructor(){super("wa-after-show",{bubbles:!0,cancelable:!1,composed:!0})}},M1=class extends Event{constructor(i){super("wa-hide",{bubbles:!0,cancelable:!0,composed:!0}),this.detail=i}},O1=class extends Event{constructor(){super("wa-show",{bubbles:!0,cancelable:!0,composed:!0})}};/*! Copyright 2025 Fonticons, Inc. - https://webawesome.com/license */function Ls(i,t){return new Promise(e=>{const n=new AbortController,{signal:r}=n;if(i.classList.contains(t))return;i.classList.remove(t),i.classList.add(t);let s=()=>{i.classList.remove(t),e(),n.abort()};i.addEventListener("animationend",s,{once:!0,signal:r}),i.addEventListener("animationcancel",s,{once:!0,signal:r})})}/*! Copyright 2025 Fonticons, Inc. - https://webawesome.com/license */var k1=`:host {
  --width: 31rem;
  --spacing: var(--wa-space-l);
  --show-duration: 200ms;
  --hide-duration: 200ms;

  display: none;
}

:host([open]) {
  display: block;
}

.dialog {
  display: flex;
  flex-direction: column;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  width: var(--width);
  max-width: calc(100% - var(--wa-space-2xl));
  max-height: calc(100% - var(--wa-space-2xl));
  background-color: var(--wa-color-surface-raised);
  border-radius: var(--wa-panel-border-radius);
  border: none;
  box-shadow: var(--wa-shadow-l);
  padding: 0;
  margin: auto;

  &.show {
    animation: show-dialog var(--show-duration) ease;

    &::backdrop {
      animation: show-backdrop var(--show-duration, 200ms) ease;
    }
  }

  &.hide {
    animation: show-dialog var(--hide-duration) ease reverse;

    &::backdrop {
      animation: show-backdrop var(--hide-duration, 200ms) ease reverse;
    }
  }

  &.pulse {
    animation: pulse 250ms ease;
  }
}

.dialog:focus {
  outline: none;
}

/* Ensure there's enough vertical padding for phones that don't update vh when chrome appears (e.g. iPhone) */
@media screen and (max-width: 420px) {
  .dialog {
    max-height: 80vh;
  }
}

.open {
  display: flex;
  opacity: 1;
}

.header {
  flex: 0 0 auto;
  display: flex;
  flex-wrap: nowrap;

  padding-inline-start: var(--spacing);
  padding-block-end: 0;

  /* Subtract the close button's padding so that the X is visually aligned with the edges of the dialog content */
  padding-inline-end: calc(var(--spacing) - var(--wa-form-control-padding-block));
  padding-block-start: calc(var(--spacing) - var(--wa-form-control-padding-block));
}

.title {
  align-self: center;
  flex: 1 1 auto;
  font-family: inherit;
  font-size: var(--wa-font-size-l);
  font-weight: var(--wa-font-weight-heading);
  line-height: var(--wa-line-height-condensed);
  margin: 0;
}

.header-actions {
  align-self: start;
  display: flex;
  flex-shrink: 0;
  flex-wrap: wrap;
  justify-content: end;
  gap: var(--wa-space-2xs);
  padding-inline-start: var(--spacing);
}

.header-actions wa-button,
.header-actions ::slotted(wa-button) {
  flex: 0 0 auto;
  display: flex;
  align-items: center;
}

.body {
  flex: 1 1 auto;
  display: block;
  padding: var(--spacing);
  overflow: auto;
  -webkit-overflow-scrolling: touch;

  &:focus {
    outline: none;
  }

  &:focus-visible {
    outline: var(--wa-focus-ring);
    outline-offset: var(--wa-focus-ring-offset);
  }
}

.footer {
  flex: 0 0 auto;
  display: flex;
  flex-wrap: wrap;
  gap: var(--wa-space-xs);
  justify-content: end;
  padding: var(--spacing);
  padding-block-start: 0;
}

.footer ::slotted(wa-button:not(:first-of-type)) {
  margin-inline-start: var(--wa-spacing-xs);
}

.dialog::backdrop {
  /*
    NOTE: the ::backdrop element doesn't inherit properly in Safari yet, but it will in 17.4! At that time, we can
    remove the fallback values here.
  */
  background-color: var(--wa-color-overlay-modal, rgb(0 0 0 / 0.25));
}

@keyframes pulse {
  0% {
    scale: 1;
  }
  50% {
    scale: 1.02;
  }
  100% {
    scale: 1;
  }
}

@keyframes show-dialog {
  from {
    opacity: 0;
    scale: 0.8;
  }
  to {
    opacity: 1;
    scale: 1;
  }
}

@keyframes show-backdrop {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@media (forced-colors: active) {
  .dialog {
    border: solid 1px white;
  }
}
`,nn=class extends Ve{constructor(){super(...arguments),this.localize=new as(this),this.hasSlotController=new Oo(this,"footer","header-actions","label"),this.open=!1,this.label="",this.withoutHeader=!1,this.lightDismiss=!1,this.handleDocumentKeyDown=i=>{i.key==="Escape"&&this.open&&(i.preventDefault(),i.stopPropagation(),this.requestClose(this.dialog))}}firstUpdated(){this.open&&(this.addOpenListeners(),this.dialog.showModal(),$u(this))}disconnectedCallback(){super.disconnectedCallback(),Vu(this),this.removeOpenListeners()}async requestClose(i){const t=new M1({source:i});if(this.dispatchEvent(t),t.defaultPrevented){this.open=!0,Ls(this.dialog,"pulse");return}this.removeOpenListeners(),await Ls(this.dialog,"hide"),this.open=!1,this.dialog.close(),Vu(this);const e=this.originalTrigger;typeof e?.focus=="function"&&setTimeout(()=>e.focus()),this.dispatchEvent(new P1)}addOpenListeners(){document.addEventListener("keydown",this.handleDocumentKeyDown)}removeOpenListeners(){document.removeEventListener("keydown",this.handleDocumentKeyDown)}handleDialogCancel(i){i.preventDefault(),!this.dialog.classList.contains("hide")&&i.target===this.dialog&&this.requestClose(this.dialog)}handleDialogClick(i){const e=i.target.closest('[data-dialog="close"]');e&&(i.stopPropagation(),this.requestClose(e))}async handleDialogPointerDown(i){i.target===this.dialog&&(this.lightDismiss?this.requestClose(this.dialog):await Ls(this.dialog,"pulse"))}handleOpenChange(){this.open&&!this.dialog.open?this.show():!this.open&&this.dialog.open&&(this.open=!0,this.requestClose(this.dialog))}async show(){const i=new O1;if(this.dispatchEvent(i),i.defaultPrevented){this.open=!1;return}this.addOpenListeners(),this.originalTrigger=document.activeElement,this.open=!0,this.dialog.showModal(),$u(this),requestAnimationFrame(()=>{const t=this.querySelector("[autofocus]");t&&typeof t.focus=="function"?t.focus():this.dialog.focus()}),await Ls(this.dialog,"show"),this.dispatchEvent(new L1)}render(){const i=!this.withoutHeader,t=this.hasSlotController.test("footer");return Y`
      <dialog
        part="dialog"
        class=${wc({dialog:!0,open:this.open})}
        @cancel=${this.handleDialogCancel}
        @click=${this.handleDialogClick}
        @pointerdown=${this.handleDialogPointerDown}
      >
        ${i?Y`
              <header part="header" class="header">
                <h2 part="title" class="title" id="title">
                  <!-- If there's no label, use an invisible character to prevent the header from collapsing -->
                  <slot name="label"> ${this.label.length>0?this.label:"​"} </slot>
                </h2>
                <div part="header-actions" class="header-actions">
                  <slot name="header-actions"></slot>
                  <wa-button
                    part="close-button"
                    exportparts="base:close-button__base"
                    class="close"
                    appearance="plain"
                    @click="${e=>this.requestClose(e.target)}"
                  >
                    <wa-icon
                      name="xmark"
                      label=${this.localize.term("close")}
                      library="system"
                      variant="solid"
                    ></wa-icon>
                  </wa-button>
                </div>
              </header>
            `:""}

        <div part="body" class="body"><slot></slot></div>

        ${t?Y`
              <footer part="footer" class="footer">
                <slot name="footer"></slot>
              </footer>
            `:""}
      </dialog>
    `}};nn.css=k1;L([Ne(".dialog")],nn.prototype,"dialog",2);L([M({type:Boolean,reflect:!0})],nn.prototype,"open",2);L([M({reflect:!0})],nn.prototype,"label",2);L([M({attribute:"without-header",type:Boolean,reflect:!0})],nn.prototype,"withoutHeader",2);L([M({attribute:"light-dismiss",type:Boolean})],nn.prototype,"lightDismiss",2);L([ls("open",{waitUntilFirstUpdate:!0})],nn.prototype,"handleOpenChange",1);nn=L([Nt("wa-dialog")],nn);document.addEventListener("click",i=>{const t=i.target.closest("[data-dialog]");if(t instanceof Element){const[e,n]=A1(t.getAttribute("data-dialog")||"");if(e==="open"&&n?.length){const s=t.getRootNode().getElementById(n);s?.localName==="wa-dialog"?s.open=!0:console.warn(`A dialog with an ID of "${n}" could not be found in this document.`)}}});document.addEventListener("pointerdown",()=>{});var D1=Object.defineProperty,F1=(i,t,e,n)=>{for(var r=void 0,s=i.length-1,o;s>=0;s--)(o=i[s])&&(r=o(t,e,r)||r);return r&&D1(t,e,r),r};const Ko=i=>{class t extends i{constructor(){super(...arguments),this.open=!1}updated(n){if(n.has("open")){const r=this.firstElementChild;r.open!==this.open&&(r.open=this.open)}}firstUpdated(){this.firstElementChild?.addEventListener("wa-hide",n=>{n.defaultPrevented||this.firstElementChild===n.target&&(this.open=!1,this.dispatchEvent(new CustomEvent("close")))}),this.firstElementChild?.addEventListener("wa-show",n=>{n.defaultPrevented||this.firstElementChild===n.target&&(this.open=!0,this.dispatchEvent(new CustomEvent("open")))})}}return F1([M({type:Boolean,reflect:!0})],t.prototype,"open"),t};/*! Copyright 2025 Fonticons, Inc. - https://webawesome.com/license */function N1(i,t,e){const n=r=>Object.is(r,-0)?0:r;return i<t?n(t):i>e?n(e):n(i)}/*! Copyright 2025 Fonticons, Inc. - https://webawesome.com/license */var $1=`:host {
  --track-height: 1rem;
  --track-color: var(--wa-color-neutral-fill-normal);
  --indicator-color: var(--wa-color-brand-fill-loud);

  display: flex;
}

.progress-bar {
  flex: 1 1 auto;
  display: flex;
  position: relative;
  overflow: hidden;
  height: var(--track-height);
  border-radius: var(--wa-border-radius-pill);
  background-color: var(--track-color);
  color: var(--wa-color-brand-on-loud);
  font-size: var(--wa-font-size-s);
}

.indicator {
  width: var(--percentage);
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: var(--indicator-color);
  text-align: center;
  white-space: nowrap;
  overflow: hidden;
  line-height: 1;
  font-weight: var(--wa-font-weight-semibold);
  transition: all var(--wa-transition-slow, 200ms) var(--wa-transition-easing, ease);
  user-select: none;
  -webkit-user-select: none;
}

/* Indeterminate */
:host([indeterminate]) .indicator {
  position: absolute;
  inset-block: 0;
  inline-size: 50%;
  animation: wa-progress-indeterminate 2.5s infinite cubic-bezier(0.37, 0, 0.63, 1);
}

@media (forced-colors: active) {
  .progress-bar {
    outline: solid 1px SelectedItem;
    background-color: var(--wa-color-surface-default);
  }

  .indicator {
    outline: solid 1px SelectedItem;
    background-color: SelectedItem;
  }
}

@keyframes wa-progress-indeterminate {
  0% {
    inset-inline-start: -50%;
  }

  75%,
  100% {
    inset-inline-start: 100%;
  }
}
`,Xi=class extends Ve{constructor(){super(...arguments),this.localize=new as(this),this.value=0,this.indeterminate=!1,this.label=""}updated(i){i.has("value")&&requestAnimationFrame(()=>{this.style.setProperty("--percentage",`${N1(this.value,0,100)}%`)})}render(){return Y`
      <div
        part="base"
        class="progress-bar"
        role="progressbar"
        title=${ut(this.title)}
        aria-label=${this.label.length>0?this.label:this.localize.term("progress")}
        aria-valuemin="0"
        aria-valuemax="100"
        aria-valuenow=${this.indeterminate?"0":this.value}
      >
        <div part="indicator" class="indicator">
          ${this.indeterminate?"":Y` <slot part="label" class="label"></slot> `}
        </div>
      </div>
    `}};Xi.css=$1;L([M({type:Number,reflect:!0})],Xi.prototype,"value",2);L([M({type:Boolean,reflect:!0})],Xi.prototype,"indeterminate",2);L([M()],Xi.prototype,"label",2);Xi=L([Nt("wa-progress-bar")],Xi);var V1=Object.defineProperty,z1=Object.getOwnPropertyDescriptor,wg=(i,t,e,n)=>{for(var r=n>1?void 0:n?z1(t,e):t,s=i.length-1,o;s>=0;s--)(o=i[s])&&(r=(n?o(t,e,r):o(r))||r);return n&&r&&V1(t,e,r),r};let Tl=class extends Ko(Zt){constructor(){super(...arguments),this.localize=new Ji(this)}shouldUpdate(){return this.gameState.score!=null}render(){const i=v1(this.gameState);return Y`
      <wa-dialog label="${this.localize.term("round")} ${this.gameState.scores.length}/${this.gameState.roundPerGame}" open>
        <div class="wa-stack wa-gap-2xs">
          <element-map show-result></element-map>
          <div class="wa-body-xl">${Math.round(this.gameState.score)} ${this.localize.term("points")}</div>
          <!-- <wa-progress-bar value="${this.gameState.score/5e3*100}" style="--track-height: 6px;"></wa-progress-bar> -->
          <div>${this.formatDistance(this.gameState.distance)}</div>
        </div>
        <div slot="footer">
          <wa-button slot="footer" variant="success" data-dialog="close" class="${i?"hidden":""}">
            ${this.localize.term("next_round")}
            <wa-icon slot="end" name="arrow-right" variant="solid"></wa-icon>
          </wa-button>
          <wa-button slot="footer" variant="success" data-dialog="close" @click="${this.handleGameOver}" class="${i?"":"hidden"}">
            ${this.localize.term("scores")}
            <wa-icon slot="end" name="trophy" variant="solid"></wa-icon>
          </wa-button>
        </div>
      </wa-dialog>
        `}formatDistance(i){return this.localize.number(i/1e3,{style:"unit",unit:"kilometer",maximumFractionDigits:1})}handleGameOver(){this.dispatchEvent(new CustomEvent("gameOver"))}createRenderRoot(){return this}};wg([Kl({context:qo,subscribe:!0})],Tl.prototype,"gameState",2);Tl=wg([Nt("element-result")],Tl);var G1=Object.getOwnPropertyDescriptor,U1=(i,t,e,n)=>{for(var r=n>1?void 0:n?G1(t,e):t,s=i.length-1,o;s>=0;s--)(o=i[s])&&(r=o(r)||r);return r};let zu=class extends Ko(Zt){constructor(){super(...arguments),this.localize=new Ji(this)}render(){return Y`
      <wa-dialog without-header>
        <h2>${this.localize.term("choose_country")}</h2>
        <div class="wa-grid" style="--min-column-size: 20px;">
          <wa-card
            class="wa-stack wa-align-items-center"
            @click=${()=>this.selectCountry("ch")}
          >
            <div class="wa-stack wa-align-items-center">
              <div class="flag">🇨🇭</div>
              <div>${this.localize.term("switzerland")}</div>
            </div>
          </wa-card>
          <wa-card
            class="wa-stack wa-align-items-center"
            @click=${()=>this.selectCountry("fr")}
          >
            <div class="wa-stack wa-align-items-center">
              <div class="flag">🇫🇷</div>
              <div>${this.localize.term("france")}</div>
            </div>
          </wa-card>
          <wa-card
            class="wa-stack wa-align-items-center"
            @click=${()=>this.selectCountry("de")}
          >
            <div class="wa-stack wa-align-items-center">
              <div class="flag">🇩🇪</div>
              <div>${this.localize.term("germany")}</div>
            </div>
          </wa-card>
        </div>
      </wa-dialog>
    `}selectCountry(i){this.open=!1,this.dispatchEvent(new CustomEvent("country-selected",{detail:i}))}createRenderRoot(){return this}};zu=U1([Nt("element-country-selector")],zu);/*! Copyright 2025 Fonticons, Inc. - https://webawesome.com/license */var B1=`:host {
  display: flex;
  position: relative;
  align-items: stretch;
  border-radius: var(--wa-panel-border-radius);
  background-color: var(--wa-color-fill-quiet, var(--wa-color-brand-fill-quiet));
  border-color: var(--wa-color-border-quiet, var(--wa-color-brand-border-quiet));
  border-style: var(--wa-panel-border-style);
  border-width: var(--wa-panel-border-width);
  color: var(--wa-color-text-normal);
  padding: 1em;
}

/* Appearance modifiers */
:host([appearance~='plain']) {
  background-color: transparent;
  border-color: transparent;
}

:host([appearance~='outlined']) {
  background-color: transparent;
  border-color: var(--wa-color-border-loud, var(--wa-color-brand-border-loud));
}

:host([appearance~='filled']) {
  background-color: var(--wa-color-fill-quiet, var(--wa-color-brand-fill-quiet));
  border-color: transparent;
}

:host([appearance~='filled-outlined']) {
  border-color: var(--wa-color-border-quiet, var(--wa-color-brand-border-quiet));
}

:host([appearance~='accent']) {
  color: var(--wa-color-on-loud, var(--wa-color-brand-on-loud));
  background-color: var(--wa-color-fill-loud, var(--wa-color-brand-fill-loud));
  border-color: transparent;

  [part~='icon'] {
    color: currentColor;
  }
}

[part~='icon'] {
  flex: 0 0 auto;
  display: flex;
  align-items: center;
  color: var(--wa-color-on-quiet);
  font-size: 1.25em;
}

::slotted([slot='icon']) {
  margin-inline-end: var(--wa-form-control-padding-inline);
}

[part~='message'] {
  flex: 1 1 auto;
  display: block;
  overflow: hidden;
}
`,Ki=class extends Ve{constructor(){super(...arguments),this.variant="brand",this.size="medium"}render(){return Y`
      <div part="icon">
        <slot name="icon"></slot>
      </div>

      <div part="message">
        <slot></slot>
      </div>
    `}};Ki.css=[B1,If,ko];L([M({reflect:!0})],Ki.prototype,"variant",2);L([M({reflect:!0})],Ki.prototype,"appearance",2);L([M({reflect:!0})],Ki.prototype,"size",2);Ki=L([Nt("wa-callout")],Ki);/*! Copyright 2025 Fonticons, Inc. - https://webawesome.com/license */var j1=class extends Event{constructor(){super("wa-clear",{bubbles:!0,cancelable:!1,composed:!0})}};/*! Copyright 2025 Fonticons, Inc. - https://webawesome.com/license */function W1(i,t){const e=i.metaKey||i.ctrlKey||i.shiftKey||i.altKey;i.key==="Enter"&&!e&&setTimeout(()=>{!i.defaultPrevented&&!i.isComposing&&q1(t)})}function q1(i){let t=null;if("form"in i&&(t=i.form),!t&&"getForm"in i&&(t=i.getForm()),!t)return;const e=[...t.elements];if(e.length===1){t.requestSubmit(null);return}const n=e.find(r=>r.type==="submit"&&!r.matches(":disabled"));n&&(["input","button"].includes(n.localName)?t.requestSubmit(n):n.click())}/*! Copyright 2025 Fonticons, Inc. - https://webawesome.com/license */var X1=`:host {
  display: flex;
  flex-direction: column;
}

/* Label */
:is([part~='form-control-label'], [part~='label']):has(*:not(:empty)) {
  display: inline-flex;
  color: var(--wa-form-control-label-color);
  font-weight: var(--wa-form-control-label-font-weight);
  line-height: var(--wa-form-control-label-line-height);
  margin-block-end: 0.5em;
}

:host([required]) :is([part~='form-control-label'], [part~='label'])::after {
  content: var(--wa-form-control-required-content);
  margin-inline-start: var(--wa-form-control-required-content-offset);
  color: var(--wa-form-control-required-content-color);
}

/* Help text */
[part~='hint'] {
  display: block;
  color: var(--wa-form-control-hint-color);
  font-weight: var(--wa-form-control-hint-font-weight);
  line-height: var(--wa-form-control-hint-line-height);
  margin-block-start: 0.5em;
  font-size: var(--wa-font-size-smaller);
  line-height: var(--wa-form-control-label-line-height);

  &:not(.has-slotted) {
    display: none;
  }
}
`;/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const K1=Rf(class extends Af{constructor(i){if(super(i),i.type!==Vn.PROPERTY&&i.type!==Vn.ATTRIBUTE&&i.type!==Vn.BOOLEAN_ATTRIBUTE)throw Error("The `live` directive is not allowed on child or event bindings");if(!yy(i))throw Error("`live` bindings can only contain a single expression")}render(i){return i}update(i,[t]){if(t===we||t===wt)return t;const e=i.element,n=i.name;if(i.type===Vn.PROPERTY){if(t===e[n])return we}else if(i.type===Vn.BOOLEAN_ATTRIBUTE){if(!!t===e.hasAttribute(n))return we}else if(i.type===Vn.ATTRIBUTE&&e.getAttribute(n)===t+"")return we;return vy(i),t}});/*! Copyright 2025 Fonticons, Inc. - https://webawesome.com/license */var H1=`:host {
  border-width: 0;
}

.text-field {
  flex: auto;
  display: flex;
  align-items: stretch;
  justify-content: start;
  position: relative;
  transition: inherit;
  height: var(--wa-form-control-height);
  border-color: var(--wa-form-control-border-color);
  border-radius: var(--wa-form-control-border-radius);
  border-style: var(--wa-form-control-border-style);
  border-width: var(--wa-form-control-border-width);
  cursor: text;
  color: var(--wa-form-control-value-color);
  font-size: var(--wa-form-control-value-font-size);
  font-family: inherit;
  font-weight: var(--wa-form-control-value-font-weight);
  line-height: var(--wa-form-control-value-line-height);
  vertical-align: middle;
  width: 100%;
  transition:
    background-color var(--wa-transition-normal),
    border var(--wa-transition-normal),
    outline var(--wa-transition-fast);
  transition-timing-function: var(--wa-transition-easing);
  background-color: var(--wa-form-control-background-color);
  box-shadow: var(--box-shadow);
  padding: 0 var(--wa-form-control-padding-inline);

  &:focus-within {
    outline: var(--wa-focus-ring);
    outline-offset: var(--wa-focus-ring-offset);
  }

  /* Style disabled inputs */
  &:has(:disabled) {
    cursor: not-allowed;
    opacity: 0.5;
  }
}

/* Appearance modifiers */
:host([appearance='outlined']) .text-field {
  background-color: var(--wa-form-control-background-color);
  border-color: var(--wa-form-control-border-color);
}

:host([appearance='filled']) .text-field {
  background-color: var(--wa-color-neutral-fill-quiet);
  border-color: var(--wa-color-neutral-fill-quiet);
}

:host([appearance='filled-outlined']) .text-field {
  background-color: var(--wa-color-neutral-fill-quiet);
  border-color: var(--wa-form-control-border-color);
}

:host([pill]) .text-field {
  border-radius: var(--wa-border-radius-pill) !important;
}

.text-field {
  /* Show autofill styles over the entire text field, not just the native <input> */
  &:has(:autofill),
  &:has(:-webkit-autofill) {
    background-color: var(--wa-color-brand-fill-quiet) !important;
  }

  input,
  textarea {
    /*
    Fixes an alignment issue with placeholders.
    https://github.com/shoelace-style/webawesome/issues/342
  */
    height: 100%;

    padding: 0;
    border: none;
    outline: none;
    box-shadow: none;
    margin: 0;
    cursor: inherit;
    -webkit-appearance: none;
    font: inherit;

    /* Turn off Safari's autofill styles */
    &:-webkit-autofill,
    &:-webkit-autofill:hover,
    &:-webkit-autofill:focus,
    &:-webkit-autofill:active {
      -webkit-background-clip: text;
      background-color: transparent;
      -webkit-text-fill-color: inherit;
    }
  }
}

input {
  flex: 1 1 auto;
  min-width: 0;
  height: 100%;
  transition: inherit;

  /* prettier-ignore */
  background-color: rgb(118 118 118 / 0); /* ensures proper placeholder styles in webkit's date input */
  height: calc(var(--wa-form-control-height) - var(--border-width) * 2);
  padding-block: 0;
  color: inherit;

  &:autofill {
    &,
    &:hover,
    &:focus,
    &:active {
      box-shadow: none;
      caret-color: var(--wa-form-control-value-color);
    }
  }

  &::placeholder {
    color: var(--wa-form-control-placeholder-color);
    user-select: none;
    -webkit-user-select: none;
  }

  &::-webkit-search-decoration,
  &::-webkit-search-cancel-button,
  &::-webkit-search-results-button,
  &::-webkit-search-results-decoration {
    -webkit-appearance: none;
  }

  &:focus {
    outline: none;
  }
}

textarea {
  &:autofill {
    &,
    &:hover,
    &:focus,
    &:active {
      box-shadow: none;
      caret-color: var(--wa-form-control-value-color);
    }
  }

  &::placeholder {
    color: var(--wa-form-control-placeholder-color);
    user-select: none;
    -webkit-user-select: none;
  }
}

.start,
.end {
  display: inline-flex;
  flex: 0 0 auto;
  align-items: center;
  cursor: default;

  &::slotted(wa-icon) {
    color: var(--wa-color-neutral-on-quiet);
  }
}

.start::slotted(*) {
  margin-inline-end: var(--wa-form-control-padding-inline);
}

.end::slotted(*) {
  margin-inline-start: var(--wa-form-control-padding-inline);
}

/*
 * Clearable + Password Toggle
 */

.clear,
.password-toggle {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: inherit;
  color: var(--wa-color-neutral-on-quiet);
  border: none;
  background: none;
  padding: 0;
  transition: var(--wa-transition-normal) color;
  cursor: pointer;
  margin-inline-start: var(--wa-form-control-padding-inline);

  @media (hover: hover) {
    &:hover {
      color: color-mix(in oklab, currentColor, var(--wa-color-mix-hover));
    }
  }

  &:active {
    color: color-mix(in oklab, currentColor, var(--wa-color-mix-active));
  }

  &:focus {
    outline: none;
  }
}

/* Don't show the browser's password toggle in Edge */
::-ms-reveal {
  display: none;
}

/* Hide the built-in number spinner */
:host([without-spin-buttons]) input[type='number'] {
  -moz-appearance: textfield;

  &::-webkit-outer-spin-button,
  &::-webkit-inner-spin-button {
    -webkit-appearance: none;
    display: none;
  }
}
`,H=class extends Ee{constructor(){super(...arguments),this.assumeInteractionOn=["blur","input"],this.hasSlotController=new Oo(this,"hint","label"),this.localize=new as(this),this.title="",this.type="text",this._value=null,this.defaultValue=this.getAttribute("value")||null,this.size="medium",this.appearance="outlined",this.pill=!1,this.label="",this.hint="",this.withClear=!1,this.placeholder="",this.readonly=!1,this.passwordToggle=!1,this.passwordVisible=!1,this.withoutSpinButtons=!1,this.form=null,this.required=!1,this.spellcheck=!0,this.withLabel=!1,this.withHint=!1}static get validators(){return[...super.validators,xf()]}get value(){return this.valueHasChanged?this._value:this._value??this.defaultValue}set value(i){this._value!==i&&(this.valueHasChanged=!0,this._value=i)}handleChange(i){this.value=this.input.value,this.relayNativeEvent(i,{bubbles:!0,composed:!0})}handleClearClick(i){i.preventDefault(),this.value!==""&&(this.value="",this.updateComplete.then(()=>{this.dispatchEvent(new j1),this.dispatchEvent(new InputEvent("input",{bubbles:!0,composed:!0})),this.dispatchEvent(new Event("change",{bubbles:!0,composed:!0}))})),this.input.focus()}handleInput(){this.value=this.input.value}handleKeyDown(i){W1(i,this)}handlePasswordToggle(){this.passwordVisible=!this.passwordVisible}updated(i){super.updated(i),i.has("value")&&this.customStates.set("blank",!this.value)}handleStepChange(){this.input.step=String(this.step),this.updateValidity()}focus(i){this.input.focus(i)}blur(){this.input.blur()}select(){this.input.select()}setSelectionRange(i,t,e="none"){this.input.setSelectionRange(i,t,e)}setRangeText(i,t,e,n="preserve"){const r=t??this.input.selectionStart,s=e??this.input.selectionEnd;this.input.setRangeText(i,r,s,n),this.value!==this.input.value&&(this.value=this.input.value)}showPicker(){"showPicker"in HTMLInputElement.prototype&&this.input.showPicker()}stepUp(){this.input.stepUp(),this.value!==this.input.value&&(this.value=this.input.value)}stepDown(){this.input.stepDown(),this.value!==this.input.value&&(this.value=this.input.value)}formResetCallback(){this.value=this.defaultValue,super.formResetCallback()}render(){const i=this.hasUpdated?this.hasSlotController.test("label"):this.withLabel,t=this.hasUpdated?this.hasSlotController.test("hint"):this.withHint,e=this.label?!0:!!i,n=this.hint?!0:!!t,r=this.withClear&&!this.disabled&&!this.readonly,s=this.hasUpdated&&r&&(typeof this.value=="number"||this.value&&this.value.length>0);return Y`
      <label part="form-control-label label" class="label" for="input" aria-hidden=${e?"false":"true"}>
        <slot name="label">${this.label}</slot>
      </label>

      <div part="base" class="text-field">
        <slot name="start" part="start" class="start"></slot>

        <input
          part="input"
          id="input"
          class="control"
          type=${this.type==="password"&&this.passwordVisible?"text":this.type}
          title=${this.title}
          name=${ut(this.name)}
          ?disabled=${this.disabled}
          ?readonly=${this.readonly}
          ?required=${this.required}
          placeholder=${ut(this.placeholder)}
          minlength=${ut(this.minlength)}
          maxlength=${ut(this.maxlength)}
          min=${ut(this.min)}
          max=${ut(this.max)}
          step=${ut(this.step)}
          .value=${K1(this.value??"")}
          autocapitalize=${ut(this.autocapitalize)}
          autocomplete=${ut(this.autocomplete)}
          autocorrect=${ut(this.autocorrect)}
          ?autofocus=${this.autofocus}
          spellcheck=${this.spellcheck}
          pattern=${ut(this.pattern)}
          enterkeyhint=${ut(this.enterkeyhint)}
          inputmode=${ut(this.inputmode)}
          aria-describedby="hint"
          @change=${this.handleChange}
          @input=${this.handleInput}
          @keydown=${this.handleKeyDown}
        />

        ${s?Y`
              <button
                part="clear-button"
                class="clear"
                type="button"
                aria-label=${this.localize.term("clearEntry")}
                @click=${this.handleClearClick}
                tabindex="-1"
              >
                <slot name="clear-icon">
                  <wa-icon name="circle-xmark" library="system" variant="regular"></wa-icon>
                </slot>
              </button>
            `:""}
        ${this.passwordToggle&&!this.disabled?Y`
              <button
                part="password-toggle-button"
                class="password-toggle"
                type="button"
                aria-label=${this.localize.term(this.passwordVisible?"hidePassword":"showPassword")}
                @click=${this.handlePasswordToggle}
                tabindex="-1"
              >
                ${this.passwordVisible?Y`
                      <slot name="hide-password-icon">
                        <wa-icon name="eye-slash" library="system" variant="regular"></wa-icon>
                      </slot>
                    `:Y`
                      <slot name="show-password-icon">
                        <wa-icon name="eye" library="system" variant="regular"></wa-icon>
                      </slot>
                    `}
              </button>
            `:""}

        <slot name="end" part="end" class="end"></slot>
      </div>

      <slot
        id="hint"
        part="hint"
        name="hint"
        class=${wc({"has-slotted":n})}
        aria-hidden=${n?"false":"true"}
        >${this.hint}</slot
      >
    `}};H.css=[ko,X1,H1];H.shadowRootOptions={...Ee.shadowRootOptions,delegatesFocus:!0};L([Ne("input")],H.prototype,"input",2);L([M()],H.prototype,"title",2);L([M({reflect:!0})],H.prototype,"type",2);L([Fe()],H.prototype,"value",1);L([M({attribute:"value",reflect:!0})],H.prototype,"defaultValue",2);L([M({reflect:!0})],H.prototype,"size",2);L([M({reflect:!0})],H.prototype,"appearance",2);L([M({type:Boolean,reflect:!0})],H.prototype,"pill",2);L([M()],H.prototype,"label",2);L([M({attribute:"hint"})],H.prototype,"hint",2);L([M({attribute:"with-clear",type:Boolean})],H.prototype,"withClear",2);L([M()],H.prototype,"placeholder",2);L([M({type:Boolean,reflect:!0})],H.prototype,"readonly",2);L([M({attribute:"password-toggle",type:Boolean})],H.prototype,"passwordToggle",2);L([M({attribute:"password-visible",type:Boolean})],H.prototype,"passwordVisible",2);L([M({attribute:"without-spin-buttons",type:Boolean})],H.prototype,"withoutSpinButtons",2);L([M({reflect:!0})],H.prototype,"form",2);L([M({type:Boolean,reflect:!0})],H.prototype,"required",2);L([M()],H.prototype,"pattern",2);L([M({type:Number})],H.prototype,"minlength",2);L([M({type:Number})],H.prototype,"maxlength",2);L([M()],H.prototype,"min",2);L([M()],H.prototype,"max",2);L([M()],H.prototype,"step",2);L([M()],H.prototype,"autocapitalize",2);L([M()],H.prototype,"autocorrect",2);L([M()],H.prototype,"autocomplete",2);L([M({type:Boolean})],H.prototype,"autofocus",2);L([M()],H.prototype,"enterkeyhint",2);L([M({type:Boolean,converter:{fromAttribute:i=>!(!i||i==="false"),toAttribute:i=>i?"true":"false"}})],H.prototype,"spellcheck",2);L([M()],H.prototype,"inputmode",2);L([M({attribute:"with-label",type:Boolean})],H.prototype,"withLabel",2);L([M({attribute:"with-hint",type:Boolean})],H.prototype,"withHint",2);L([ls("step",{waitUntilFirstUpdate:!0})],H.prototype,"handleStepChange",1);H=L([Nt("wa-input")],H);var Y1=Object.defineProperty,Z1=Object.getOwnPropertyDescriptor,Ho=(i,t,e,n)=>{for(var r=n>1?void 0:n?Z1(t,e):t,s=i.length-1,o;s>=0;s--)(o=i[s])&&(r=(n?o(t,e,r):o(r))||r);return n&&r&&Y1(t,e,r),r};let jr=class extends Zt{constructor(){super(...arguments),this.scores=[],this.username=null,this.maxEntries=10}render(){return Y`
      <table>
        <tbody>
          ${this.scores.slice(0,this.maxEntries).map((i,t)=>Y`
              <tr class="${i.username===this.username?"highlight":""}">
                <td>${this.rankStyle(t+1)}</td>
                <td>${i.username}</td>
                <td>${i.score}</td>
              </tr>
            `)}
        </tbody>
      </table>
    `}rankStyle(i){return i===1?Y`<wa-icon name="trophy" variant="solid" style="color: #FFD700;"></wa-icon>`:i===2?Y`<wa-icon name="trophy" variant="solid" style="color: #C0C0C0;"></wa-icon>`:i===3?Y`<wa-icon name="trophy" variant="solid" style="color: #cd7f32;"></wa-icon>`:Y`<span>${i}</span>`}createRenderRoot(){return this}};Ho([M({type:Array})],jr.prototype,"scores",2);Ho([M({type:String})],jr.prototype,"username",2);Ho([M({type:Number})],jr.prototype,"maxEntries",2);jr=Ho([Nt("element-leaderboard")],jr);var J1=Object.defineProperty,Q1=Object.getOwnPropertyDescriptor,Wc=(i,t,e,n)=>{for(var r=n>1?void 0:n?Q1(t,e):t,s=i.length-1,o;s>=0;s--)(o=i[s])&&(r=(n?o(t,e,r):o(r))||r);return n&&r&&J1(t,e,r),r};let ro=class extends Ko(Zt){constructor(){super(...arguments),this.localize=new Ji(this),this.valid=!1}render(){return Y`
      <wa-dialog>
        <wa-input autofocus placeholder=${this.localize.term("username")}></wa-input>
        <wa-button slot="footer" variant="brand" @click="${this.save}">${this.localize.term("save")}</wa-button>
      </wa-dialog>
    `}async save(){const i=this.username.value?.trim();if(!i||i.length==0){this.username.hint=this.localize.term("no_username");return}if(await this.leaderboard.getUserId(i)){this.username.hint=this.localize.term("username_taken");return}this.valid=!0,this.dispatchEvent(new CustomEvent("username",{detail:i})),this.open=!1}firstUpdated(){this.firstElementChild?.addEventListener("wa-hide",i=>{this.valid||i.preventDefault()})}createRenderRoot(){return this}};Wc([M({type:Object})],ro.prototype,"leaderboard",2);Wc([Ne("wa-input")],ro.prototype,"username",2);ro=Wc([Nt("element-username")],ro);const tb=()=>{};var Gu={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vg=function(i){const t=[];let e=0;for(let n=0;n<i.length;n++){let r=i.charCodeAt(n);r<128?t[e++]=r:r<2048?(t[e++]=r>>6|192,t[e++]=r&63|128):(r&64512)===55296&&n+1<i.length&&(i.charCodeAt(n+1)&64512)===56320?(r=65536+((r&1023)<<10)+(i.charCodeAt(++n)&1023),t[e++]=r>>18|240,t[e++]=r>>12&63|128,t[e++]=r>>6&63|128,t[e++]=r&63|128):(t[e++]=r>>12|224,t[e++]=r>>6&63|128,t[e++]=r&63|128)}return t},eb=function(i){const t=[];let e=0,n=0;for(;e<i.length;){const r=i[e++];if(r<128)t[n++]=String.fromCharCode(r);else if(r>191&&r<224){const s=i[e++];t[n++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=i[e++],o=i[e++],a=i[e++],l=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;t[n++]=String.fromCharCode(55296+(l>>10)),t[n++]=String.fromCharCode(56320+(l&1023))}else{const s=i[e++],o=i[e++];t[n++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return t.join("")},bg={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(i,t){if(!Array.isArray(i))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let r=0;r<i.length;r+=3){const s=i[r],o=r+1<i.length,a=o?i[r+1]:0,l=r+2<i.length,c=l?i[r+2]:0,h=s>>2,u=(s&3)<<4|a>>4;let d=(a&15)<<2|c>>6,f=c&63;l||(f=64,o||(d=64)),n.push(e[h],e[u],e[d],e[f])}return n.join("")},encodeString(i,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(i):this.encodeByteArray(vg(i),t)},decodeString(i,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(i):eb(this.decodeStringToByteArray(i,t))},decodeStringToByteArray(i,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let r=0;r<i.length;){const s=e[i.charAt(r++)],a=r<i.length?e[i.charAt(r)]:0;++r;const c=r<i.length?e[i.charAt(r)]:64;++r;const u=r<i.length?e[i.charAt(r)]:64;if(++r,s==null||a==null||c==null||u==null)throw new nb;const d=s<<2|a>>4;if(n.push(d),c!==64){const f=a<<4&240|c>>2;if(n.push(f),u!==64){const m=c<<6&192|u;n.push(m)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}};class nb extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ib=function(i){const t=vg(i);return bg.encodeByteArray(t,!0)},so=function(i){return ib(i).replace(/\./g,"")},rb=function(i){try{return bg.decodeString(i,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sb(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ob=()=>sb().__FIREBASE_DEFAULTS__,ab=()=>{if(typeof process>"u"||typeof Gu>"u")return;const i=Gu.__FIREBASE_DEFAULTS__;if(i)return JSON.parse(i)},lb=()=>{if(typeof document>"u")return;let i;try{i=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=i&&rb(i[1]);return t&&JSON.parse(t)},Eg=()=>{try{return tb()||ob()||ab()||lb()}catch(i){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${i}`);return}},cb=i=>Eg()?.emulatorHosts?.[i],hb=i=>{const t=cb(i);if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const n=parseInt(t.substring(e+1),10);return t[0]==="["?[t.substring(1,e-1),n]:[t.substring(0,e),n]},Cg=()=>Eg()?.config;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ub{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qc(i){try{return(i.startsWith("http://")||i.startsWith("https://")?new URL(i).hostname:i).endsWith(".cloudworkstations.dev")}catch{return!1}}async function db(i){return(await fetch(i,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fb(i,t){if(i.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const e={alg:"none",type:"JWT"},n=t||"demo-project",r=i.iat||0,s=i.sub||i.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...i};return[so(JSON.stringify(e)),so(JSON.stringify(o)),""].join(".")}const Sr={};function gb(){const i={prod:[],emulator:[]};for(const t of Object.keys(Sr))Sr[t]?i.emulator.push(t):i.prod.push(t);return i}function pb(i){let t=document.getElementById(i),e=!1;return t||(t=document.createElement("div"),t.setAttribute("id",i),e=!0),{created:e,element:t}}let Uu=!1;function mb(i,t){if(typeof window>"u"||typeof document>"u"||!qc(window.location.host)||Sr[i]===t||Sr[i]||Uu)return;Sr[i]=t;function e(d){return`__firebase__banner__${d}`}const n="__firebase__banner",s=gb().prod.length>0;function o(){const d=document.getElementById(n);d&&d.remove()}function a(d){d.style.display="flex",d.style.background="#7faaf0",d.style.position="fixed",d.style.bottom="5px",d.style.left="5px",d.style.padding=".5em",d.style.borderRadius="5px",d.style.alignItems="center"}function l(d,f){d.setAttribute("width","24"),d.setAttribute("id",f),d.setAttribute("height","24"),d.setAttribute("viewBox","0 0 24 24"),d.setAttribute("fill","none"),d.style.marginLeft="-6px"}function c(){const d=document.createElement("span");return d.style.cursor="pointer",d.style.marginLeft="16px",d.style.fontSize="24px",d.innerHTML=" &times;",d.onclick=()=>{Uu=!0,o()},d}function h(d,f){d.setAttribute("id",f),d.innerText="Learn more",d.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",d.setAttribute("target","__blank"),d.style.paddingLeft="5px",d.style.textDecoration="underline"}function u(){const d=pb(n),f=e("text"),m=document.getElementById(f)||document.createElement("span"),v=e("learnmore"),w=document.getElementById(v)||document.createElement("a"),E=e("preprendIcon"),I=document.getElementById(E)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(d.created){const R=d.element;a(R),h(w,v);const S=c();l(I,E),R.append(I,m,w,S),document.body.appendChild(R)}s?(m.innerText="Preview backend disconnected.",I.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(I.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,m.innerText="Preview backend running in this workspace."),m.setAttribute("id",f)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",u):u()}function _b(){try{return typeof indexedDB=="object"}catch{return!1}}function yb(){return new Promise((i,t)=>{try{let e=!0;const n="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(n);r.onsuccess=()=>{r.result.close(),e||self.indexedDB.deleteDatabase(n),i(!0)},r.onupgradeneeded=()=>{e=!1},r.onerror=()=>{t(r.error?.message||"")}}catch(e){t(e)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wb="FirebaseError";class nr extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name=wb,Object.setPrototypeOf(this,nr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,xg.prototype.create)}}class xg{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},r=`${this.service}/${t}`,s=this.errors[t],o=s?vb(s,n):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new nr(r,a,n)}}function vb(i,t){return i.replace(bb,(e,n)=>{const r=t[n];return r!=null?String(r):`<${n}?>`})}const bb=/\{\$([^}]+)}/g;function oo(i,t){if(i===t)return!0;const e=Object.keys(i),n=Object.keys(t);for(const r of e){if(!n.includes(r))return!1;const s=i[r],o=t[r];if(Bu(s)&&Bu(o)){if(!oo(s,o))return!1}else if(s!==o)return!1}for(const r of n)if(!e.includes(r))return!1;return!0}function Bu(i){return i!==null&&typeof i=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hi(i){return i&&i._delegate?i._delegate:i}class Wr{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zn="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eb{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const n=new ub;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:e});r&&n.resolve(r)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){const e=this.normalizeInstanceIdentifier(t?.identifier),n=t?.optional??!1;if(this.isInitialized(e)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:e})}catch(r){if(n)return null;throw r}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(xb(t))try{this.getOrInitializeService({instanceIdentifier:zn})}catch{}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const s=this.getOrInitializeService({instanceIdentifier:r});n.resolve(s)}catch{}}}}clearInstance(t=zn){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=zn){return this.instances.has(t)}getOptions(t=zn){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);n===a&&o.resolve(r)}return r}onInit(t,e){const n=this.normalizeInstanceIdentifier(e),r=this.onInitCallbacks.get(n)??new Set;r.add(t),this.onInitCallbacks.set(n,r);const s=this.instances.get(n);return s&&t(s,n),()=>{r.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const r of n)try{r(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:Cb(t),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch{}return n||null}normalizeInstanceIdentifier(t=zn){return this.component?this.component.multipleInstances?t:zn:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Cb(i){return i===zn?void 0:i}function xb(i){return i.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sb{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new Eb(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var lt;(function(i){i[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT"})(lt||(lt={}));const Ib={debug:lt.DEBUG,verbose:lt.VERBOSE,info:lt.INFO,warn:lt.WARN,error:lt.ERROR,silent:lt.SILENT},Tb=lt.INFO,Rb={[lt.DEBUG]:"log",[lt.VERBOSE]:"log",[lt.INFO]:"info",[lt.WARN]:"warn",[lt.ERROR]:"error"},Ab=(i,t,...e)=>{if(t<i.logLevel)return;const n=new Date().toISOString(),r=Rb[t];if(r)console[r](`[${n}]  ${i.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Sg{constructor(t){this.name=t,this._logLevel=Tb,this._logHandler=Ab,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in lt))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?Ib[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,lt.DEBUG,...t),this._logHandler(this,lt.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,lt.VERBOSE,...t),this._logHandler(this,lt.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,lt.INFO,...t),this._logHandler(this,lt.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,lt.WARN,...t),this._logHandler(this,lt.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,lt.ERROR,...t),this._logHandler(this,lt.ERROR,...t)}}const Pb=(i,t)=>t.some(e=>i instanceof e);let ju,Wu;function Lb(){return ju||(ju=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Mb(){return Wu||(Wu=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Ig=new WeakMap,Rl=new WeakMap,Tg=new WeakMap,ja=new WeakMap,Xc=new WeakMap;function Ob(i){const t=new Promise((e,n)=>{const r=()=>{i.removeEventListener("success",s),i.removeEventListener("error",o)},s=()=>{e(Cn(i.result)),r()},o=()=>{n(i.error),r()};i.addEventListener("success",s),i.addEventListener("error",o)});return t.then(e=>{e instanceof IDBCursor&&Ig.set(e,i)}).catch(()=>{}),Xc.set(t,i),t}function kb(i){if(Rl.has(i))return;const t=new Promise((e,n)=>{const r=()=>{i.removeEventListener("complete",s),i.removeEventListener("error",o),i.removeEventListener("abort",o)},s=()=>{e(),r()},o=()=>{n(i.error||new DOMException("AbortError","AbortError")),r()};i.addEventListener("complete",s),i.addEventListener("error",o),i.addEventListener("abort",o)});Rl.set(i,t)}let Al={get(i,t,e){if(i instanceof IDBTransaction){if(t==="done")return Rl.get(i);if(t==="objectStoreNames")return i.objectStoreNames||Tg.get(i);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return Cn(i[t])},set(i,t,e){return i[t]=e,!0},has(i,t){return i instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in i}};function Db(i){Al=i(Al)}function Fb(i){return i===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){const n=i.call(Wa(this),t,...e);return Tg.set(n,t.sort?t.sort():[t]),Cn(n)}:Mb().includes(i)?function(...t){return i.apply(Wa(this),t),Cn(Ig.get(this))}:function(...t){return Cn(i.apply(Wa(this),t))}}function Nb(i){return typeof i=="function"?Fb(i):(i instanceof IDBTransaction&&kb(i),Pb(i,Lb())?new Proxy(i,Al):i)}function Cn(i){if(i instanceof IDBRequest)return Ob(i);if(ja.has(i))return ja.get(i);const t=Nb(i);return t!==i&&(ja.set(i,t),Xc.set(t,i)),t}const Wa=i=>Xc.get(i);function $b(i,t,{blocked:e,upgrade:n,blocking:r,terminated:s}={}){const o=indexedDB.open(i,t),a=Cn(o);return n&&o.addEventListener("upgradeneeded",l=>{n(Cn(o.result),l.oldVersion,l.newVersion,Cn(o.transaction),l)}),e&&o.addEventListener("blocked",l=>e(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),r&&l.addEventListener("versionchange",c=>r(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const Vb=["get","getKey","getAll","getAllKeys","count"],zb=["put","add","delete","clear"],qa=new Map;function qu(i,t){if(!(i instanceof IDBDatabase&&!(t in i)&&typeof t=="string"))return;if(qa.get(t))return qa.get(t);const e=t.replace(/FromIndex$/,""),n=t!==e,r=zb.includes(e);if(!(e in(n?IDBIndex:IDBObjectStore).prototype)||!(r||Vb.includes(e)))return;const s=async function(o,...a){const l=this.transaction(o,r?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(a.shift())),(await Promise.all([c[e](...a),r&&l.done]))[0]};return qa.set(t,s),s}Db(i=>({...i,get:(t,e,n)=>qu(t,e)||i.get(t,e,n),has:(t,e)=>!!qu(t,e)||i.has(t,e)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gb{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(Ub(e)){const n=e.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(e=>e).join(" ")}}function Ub(i){return i.getComponent()?.type==="VERSION"}const Pl="@firebase/app",Xu="0.14.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rn=new Sg("@firebase/app"),Bb="@firebase/app-compat",jb="@firebase/analytics-compat",Wb="@firebase/analytics",qb="@firebase/app-check-compat",Xb="@firebase/app-check",Kb="@firebase/auth",Hb="@firebase/auth-compat",Yb="@firebase/database",Zb="@firebase/data-connect",Jb="@firebase/database-compat",Qb="@firebase/functions",tE="@firebase/functions-compat",eE="@firebase/installations",nE="@firebase/installations-compat",iE="@firebase/messaging",rE="@firebase/messaging-compat",sE="@firebase/performance",oE="@firebase/performance-compat",aE="@firebase/remote-config",lE="@firebase/remote-config-compat",cE="@firebase/storage",hE="@firebase/storage-compat",uE="@firebase/firestore",dE="@firebase/ai",fE="@firebase/firestore-compat",gE="firebase",pE="12.4.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ll="[DEFAULT]",mE={[Pl]:"fire-core",[Bb]:"fire-core-compat",[Wb]:"fire-analytics",[jb]:"fire-analytics-compat",[Xb]:"fire-app-check",[qb]:"fire-app-check-compat",[Kb]:"fire-auth",[Hb]:"fire-auth-compat",[Yb]:"fire-rtdb",[Zb]:"fire-data-connect",[Jb]:"fire-rtdb-compat",[Qb]:"fire-fn",[tE]:"fire-fn-compat",[eE]:"fire-iid",[nE]:"fire-iid-compat",[iE]:"fire-fcm",[rE]:"fire-fcm-compat",[sE]:"fire-perf",[oE]:"fire-perf-compat",[aE]:"fire-rc",[lE]:"fire-rc-compat",[cE]:"fire-gcs",[hE]:"fire-gcs-compat",[uE]:"fire-fst",[fE]:"fire-fst-compat",[dE]:"fire-vertex","fire-js":"fire-js",[gE]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ao=new Map,_E=new Map,Ml=new Map;function Ku(i,t){try{i.container.addComponent(t)}catch(e){rn.debug(`Component ${t.name} failed to register with FirebaseApp ${i.name}`,e)}}function lo(i){const t=i.name;if(Ml.has(t))return rn.debug(`There were multiple attempts to register component ${t}.`),!1;Ml.set(t,i);for(const e of ao.values())Ku(e,i);for(const e of _E.values())Ku(e,i);return!0}function yE(i,t){const e=i.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),i.container.getProvider(t)}function wE(i){return i==null?!1:i.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vE={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},xn=new xg("app","Firebase",vE);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bE{constructor(t,e,n){this._isDeleted=!1,this._options={...t},this._config={...e},this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Wr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw xn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EE=pE;function Rg(i,t={}){let e=i;typeof t!="object"&&(t={name:t});const n={name:Ll,automaticDataCollectionEnabled:!0,...t},r=n.name;if(typeof r!="string"||!r)throw xn.create("bad-app-name",{appName:String(r)});if(e||(e=Cg()),!e)throw xn.create("no-options");const s=ao.get(r);if(s){if(oo(e,s.options)&&oo(n,s.config))return s;throw xn.create("duplicate-app",{appName:r})}const o=new Sb(r);for(const l of Ml.values())o.addComponent(l);const a=new bE(e,n,o);return ao.set(r,a),a}function CE(i=Ll){const t=ao.get(i);if(!t&&i===Ll&&Cg())return Rg();if(!t)throw xn.create("no-app",{appName:i});return t}function Ni(i,t,e){let n=mE[i]??i;e&&(n+=`-${e}`);const r=n.match(/\s|\//),s=t.match(/\s|\//);if(r||s){const o=[`Unable to register library "${n}" with version "${t}":`];r&&o.push(`library name "${n}" contains illegal characters (whitespace or "/")`),r&&s&&o.push("and"),s&&o.push(`version name "${t}" contains illegal characters (whitespace or "/")`),rn.warn(o.join(" "));return}lo(new Wr(`${n}-version`,()=>({library:n,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xE="firebase-heartbeat-database",SE=1,qr="firebase-heartbeat-store";let Xa=null;function Ag(){return Xa||(Xa=$b(xE,SE,{upgrade:(i,t)=>{switch(t){case 0:try{i.createObjectStore(qr)}catch(e){console.warn(e)}}}}).catch(i=>{throw xn.create("idb-open",{originalErrorMessage:i.message})})),Xa}async function IE(i){try{const e=(await Ag()).transaction(qr),n=await e.objectStore(qr).get(Pg(i));return await e.done,n}catch(t){if(t instanceof nr)rn.warn(t.message);else{const e=xn.create("idb-get",{originalErrorMessage:t?.message});rn.warn(e.message)}}}async function Hu(i,t){try{const n=(await Ag()).transaction(qr,"readwrite");await n.objectStore(qr).put(t,Pg(i)),await n.done}catch(e){if(e instanceof nr)rn.warn(e.message);else{const n=xn.create("idb-set",{originalErrorMessage:e?.message});rn.warn(n.message)}}}function Pg(i){return`${i.name}!${i.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TE=1024,RE=30;class AE{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new LE(e),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=Yu();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(r=>r.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:e}),this._heartbeatsCache.heartbeats.length>RE){const r=ME(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(t){rn.warn(t)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Yu(),{heartbeatsToSend:e,unsentEntries:n}=PE(this._heartbeatsCache.heartbeats),r=so(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(t){return rn.warn(t),""}}}function Yu(){return new Date().toISOString().substring(0,10)}function PE(i,t=TE){const e=[];let n=i.slice();for(const r of i){const s=e.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),Zu(e)>t){s.dates.pop();break}}else if(e.push({agent:r.agent,dates:[r.date]}),Zu(e)>t){e.pop();break}n=n.slice(1)}return{heartbeatsToSend:e,unsentEntries:n}}class LE{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return _b()?yb().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const e=await IE(this.app);return e?.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const n=await this.read();return Hu(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const n=await this.read();return Hu(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}else return}}function Zu(i){return so(JSON.stringify({version:2,heartbeats:i})).length}function ME(i){if(i.length===0)return-1;let t=0,e=i[0].date;for(let n=1;n<i.length;n++)i[n].date<e&&(e=i[n].date,t=n);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OE(i){lo(new Wr("platform-logger",t=>new Gb(t),"PRIVATE")),lo(new Wr("heartbeat",t=>new AE(t),"PRIVATE")),Ni(Pl,Xu,i),Ni(Pl,Xu,"esm2020"),Ni("fire-js","")}OE("");var kE="firebase",DE="12.4.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ni(kE,DE,"app");var Ju=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Lg;(function(){var i;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(y,g){function p(){}p.prototype=g.prototype,y.F=g.prototype,y.prototype=new p,y.prototype.constructor=y,y.D=function(b,C,x){for(var _=Array(arguments.length-2),V=2;V<arguments.length;V++)_[V-2]=arguments[V];return g.prototype[C].apply(b,_)}}function e(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}t(n,e),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(y,g,p){p||(p=0);const b=Array(16);if(typeof g=="string")for(var C=0;C<16;++C)b[C]=g.charCodeAt(p++)|g.charCodeAt(p++)<<8|g.charCodeAt(p++)<<16|g.charCodeAt(p++)<<24;else for(C=0;C<16;++C)b[C]=g[p++]|g[p++]<<8|g[p++]<<16|g[p++]<<24;g=y.g[0],p=y.g[1],C=y.g[2];let x=y.g[3],_;_=g+(x^p&(C^x))+b[0]+3614090360&4294967295,g=p+(_<<7&4294967295|_>>>25),_=x+(C^g&(p^C))+b[1]+3905402710&4294967295,x=g+(_<<12&4294967295|_>>>20),_=C+(p^x&(g^p))+b[2]+606105819&4294967295,C=x+(_<<17&4294967295|_>>>15),_=p+(g^C&(x^g))+b[3]+3250441966&4294967295,p=C+(_<<22&4294967295|_>>>10),_=g+(x^p&(C^x))+b[4]+4118548399&4294967295,g=p+(_<<7&4294967295|_>>>25),_=x+(C^g&(p^C))+b[5]+1200080426&4294967295,x=g+(_<<12&4294967295|_>>>20),_=C+(p^x&(g^p))+b[6]+2821735955&4294967295,C=x+(_<<17&4294967295|_>>>15),_=p+(g^C&(x^g))+b[7]+4249261313&4294967295,p=C+(_<<22&4294967295|_>>>10),_=g+(x^p&(C^x))+b[8]+1770035416&4294967295,g=p+(_<<7&4294967295|_>>>25),_=x+(C^g&(p^C))+b[9]+2336552879&4294967295,x=g+(_<<12&4294967295|_>>>20),_=C+(p^x&(g^p))+b[10]+4294925233&4294967295,C=x+(_<<17&4294967295|_>>>15),_=p+(g^C&(x^g))+b[11]+2304563134&4294967295,p=C+(_<<22&4294967295|_>>>10),_=g+(x^p&(C^x))+b[12]+1804603682&4294967295,g=p+(_<<7&4294967295|_>>>25),_=x+(C^g&(p^C))+b[13]+4254626195&4294967295,x=g+(_<<12&4294967295|_>>>20),_=C+(p^x&(g^p))+b[14]+2792965006&4294967295,C=x+(_<<17&4294967295|_>>>15),_=p+(g^C&(x^g))+b[15]+1236535329&4294967295,p=C+(_<<22&4294967295|_>>>10),_=g+(C^x&(p^C))+b[1]+4129170786&4294967295,g=p+(_<<5&4294967295|_>>>27),_=x+(p^C&(g^p))+b[6]+3225465664&4294967295,x=g+(_<<9&4294967295|_>>>23),_=C+(g^p&(x^g))+b[11]+643717713&4294967295,C=x+(_<<14&4294967295|_>>>18),_=p+(x^g&(C^x))+b[0]+3921069994&4294967295,p=C+(_<<20&4294967295|_>>>12),_=g+(C^x&(p^C))+b[5]+3593408605&4294967295,g=p+(_<<5&4294967295|_>>>27),_=x+(p^C&(g^p))+b[10]+38016083&4294967295,x=g+(_<<9&4294967295|_>>>23),_=C+(g^p&(x^g))+b[15]+3634488961&4294967295,C=x+(_<<14&4294967295|_>>>18),_=p+(x^g&(C^x))+b[4]+3889429448&4294967295,p=C+(_<<20&4294967295|_>>>12),_=g+(C^x&(p^C))+b[9]+568446438&4294967295,g=p+(_<<5&4294967295|_>>>27),_=x+(p^C&(g^p))+b[14]+3275163606&4294967295,x=g+(_<<9&4294967295|_>>>23),_=C+(g^p&(x^g))+b[3]+4107603335&4294967295,C=x+(_<<14&4294967295|_>>>18),_=p+(x^g&(C^x))+b[8]+1163531501&4294967295,p=C+(_<<20&4294967295|_>>>12),_=g+(C^x&(p^C))+b[13]+2850285829&4294967295,g=p+(_<<5&4294967295|_>>>27),_=x+(p^C&(g^p))+b[2]+4243563512&4294967295,x=g+(_<<9&4294967295|_>>>23),_=C+(g^p&(x^g))+b[7]+1735328473&4294967295,C=x+(_<<14&4294967295|_>>>18),_=p+(x^g&(C^x))+b[12]+2368359562&4294967295,p=C+(_<<20&4294967295|_>>>12),_=g+(p^C^x)+b[5]+4294588738&4294967295,g=p+(_<<4&4294967295|_>>>28),_=x+(g^p^C)+b[8]+2272392833&4294967295,x=g+(_<<11&4294967295|_>>>21),_=C+(x^g^p)+b[11]+1839030562&4294967295,C=x+(_<<16&4294967295|_>>>16),_=p+(C^x^g)+b[14]+4259657740&4294967295,p=C+(_<<23&4294967295|_>>>9),_=g+(p^C^x)+b[1]+2763975236&4294967295,g=p+(_<<4&4294967295|_>>>28),_=x+(g^p^C)+b[4]+1272893353&4294967295,x=g+(_<<11&4294967295|_>>>21),_=C+(x^g^p)+b[7]+4139469664&4294967295,C=x+(_<<16&4294967295|_>>>16),_=p+(C^x^g)+b[10]+3200236656&4294967295,p=C+(_<<23&4294967295|_>>>9),_=g+(p^C^x)+b[13]+681279174&4294967295,g=p+(_<<4&4294967295|_>>>28),_=x+(g^p^C)+b[0]+3936430074&4294967295,x=g+(_<<11&4294967295|_>>>21),_=C+(x^g^p)+b[3]+3572445317&4294967295,C=x+(_<<16&4294967295|_>>>16),_=p+(C^x^g)+b[6]+76029189&4294967295,p=C+(_<<23&4294967295|_>>>9),_=g+(p^C^x)+b[9]+3654602809&4294967295,g=p+(_<<4&4294967295|_>>>28),_=x+(g^p^C)+b[12]+3873151461&4294967295,x=g+(_<<11&4294967295|_>>>21),_=C+(x^g^p)+b[15]+530742520&4294967295,C=x+(_<<16&4294967295|_>>>16),_=p+(C^x^g)+b[2]+3299628645&4294967295,p=C+(_<<23&4294967295|_>>>9),_=g+(C^(p|~x))+b[0]+4096336452&4294967295,g=p+(_<<6&4294967295|_>>>26),_=x+(p^(g|~C))+b[7]+1126891415&4294967295,x=g+(_<<10&4294967295|_>>>22),_=C+(g^(x|~p))+b[14]+2878612391&4294967295,C=x+(_<<15&4294967295|_>>>17),_=p+(x^(C|~g))+b[5]+4237533241&4294967295,p=C+(_<<21&4294967295|_>>>11),_=g+(C^(p|~x))+b[12]+1700485571&4294967295,g=p+(_<<6&4294967295|_>>>26),_=x+(p^(g|~C))+b[3]+2399980690&4294967295,x=g+(_<<10&4294967295|_>>>22),_=C+(g^(x|~p))+b[10]+4293915773&4294967295,C=x+(_<<15&4294967295|_>>>17),_=p+(x^(C|~g))+b[1]+2240044497&4294967295,p=C+(_<<21&4294967295|_>>>11),_=g+(C^(p|~x))+b[8]+1873313359&4294967295,g=p+(_<<6&4294967295|_>>>26),_=x+(p^(g|~C))+b[15]+4264355552&4294967295,x=g+(_<<10&4294967295|_>>>22),_=C+(g^(x|~p))+b[6]+2734768916&4294967295,C=x+(_<<15&4294967295|_>>>17),_=p+(x^(C|~g))+b[13]+1309151649&4294967295,p=C+(_<<21&4294967295|_>>>11),_=g+(C^(p|~x))+b[4]+4149444226&4294967295,g=p+(_<<6&4294967295|_>>>26),_=x+(p^(g|~C))+b[11]+3174756917&4294967295,x=g+(_<<10&4294967295|_>>>22),_=C+(g^(x|~p))+b[2]+718787259&4294967295,C=x+(_<<15&4294967295|_>>>17),_=p+(x^(C|~g))+b[9]+3951481745&4294967295,y.g[0]=y.g[0]+g&4294967295,y.g[1]=y.g[1]+(C+(_<<21&4294967295|_>>>11))&4294967295,y.g[2]=y.g[2]+C&4294967295,y.g[3]=y.g[3]+x&4294967295}n.prototype.v=function(y,g){g===void 0&&(g=y.length);const p=g-this.blockSize,b=this.C;let C=this.h,x=0;for(;x<g;){if(C==0)for(;x<=p;)r(this,y,x),x+=this.blockSize;if(typeof y=="string"){for(;x<g;)if(b[C++]=y.charCodeAt(x++),C==this.blockSize){r(this,b),C=0;break}}else for(;x<g;)if(b[C++]=y[x++],C==this.blockSize){r(this,b),C=0;break}}this.h=C,this.o+=g},n.prototype.A=function(){var y=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);y[0]=128;for(var g=1;g<y.length-8;++g)y[g]=0;g=this.o*8;for(var p=y.length-8;p<y.length;++p)y[p]=g&255,g/=256;for(this.v(y),y=Array(16),g=0,p=0;p<4;++p)for(let b=0;b<32;b+=8)y[g++]=this.g[p]>>>b&255;return y};function s(y,g){var p=a;return Object.prototype.hasOwnProperty.call(p,y)?p[y]:p[y]=g(y)}function o(y,g){this.h=g;const p=[];let b=!0;for(let C=y.length-1;C>=0;C--){const x=y[C]|0;b&&x==g||(p[C]=x,b=!1)}this.g=p}var a={};function l(y){return-128<=y&&y<128?s(y,function(g){return new o([g|0],g<0?-1:0)}):new o([y|0],y<0?-1:0)}function c(y){if(isNaN(y)||!isFinite(y))return u;if(y<0)return w(c(-y));const g=[];let p=1;for(let b=0;y>=p;b++)g[b]=y/p|0,p*=4294967296;return new o(g,0)}function h(y,g){if(y.length==0)throw Error("number format error: empty string");if(g=g||10,g<2||36<g)throw Error("radix out of range: "+g);if(y.charAt(0)=="-")return w(h(y.substring(1),g));if(y.indexOf("-")>=0)throw Error('number format error: interior "-" character');const p=c(Math.pow(g,8));let b=u;for(let x=0;x<y.length;x+=8){var C=Math.min(8,y.length-x);const _=parseInt(y.substring(x,x+C),g);C<8?(C=c(Math.pow(g,C)),b=b.j(C).add(c(_))):(b=b.j(p),b=b.add(c(_)))}return b}var u=l(0),d=l(1),f=l(16777216);i=o.prototype,i.m=function(){if(v(this))return-w(this).m();let y=0,g=1;for(let p=0;p<this.g.length;p++){const b=this.i(p);y+=(b>=0?b:4294967296+b)*g,g*=4294967296}return y},i.toString=function(y){if(y=y||10,y<2||36<y)throw Error("radix out of range: "+y);if(m(this))return"0";if(v(this))return"-"+w(this).toString(y);const g=c(Math.pow(y,6));var p=this;let b="";for(;;){const C=S(p,g).g;p=E(p,C.j(g));let x=((p.g.length>0?p.g[0]:p.h)>>>0).toString(y);if(p=C,m(p))return x+b;for(;x.length<6;)x="0"+x;b=x+b}},i.i=function(y){return y<0?0:y<this.g.length?this.g[y]:this.h};function m(y){if(y.h!=0)return!1;for(let g=0;g<y.g.length;g++)if(y.g[g]!=0)return!1;return!0}function v(y){return y.h==-1}i.l=function(y){return y=E(this,y),v(y)?-1:m(y)?0:1};function w(y){const g=y.g.length,p=[];for(let b=0;b<g;b++)p[b]=~y.g[b];return new o(p,~y.h).add(d)}i.abs=function(){return v(this)?w(this):this},i.add=function(y){const g=Math.max(this.g.length,y.g.length),p=[];let b=0;for(let C=0;C<=g;C++){let x=b+(this.i(C)&65535)+(y.i(C)&65535),_=(x>>>16)+(this.i(C)>>>16)+(y.i(C)>>>16);b=_>>>16,x&=65535,_&=65535,p[C]=_<<16|x}return new o(p,p[p.length-1]&-2147483648?-1:0)};function E(y,g){return y.add(w(g))}i.j=function(y){if(m(this)||m(y))return u;if(v(this))return v(y)?w(this).j(w(y)):w(w(this).j(y));if(v(y))return w(this.j(w(y)));if(this.l(f)<0&&y.l(f)<0)return c(this.m()*y.m());const g=this.g.length+y.g.length,p=[];for(var b=0;b<2*g;b++)p[b]=0;for(b=0;b<this.g.length;b++)for(let C=0;C<y.g.length;C++){const x=this.i(b)>>>16,_=this.i(b)&65535,V=y.i(C)>>>16,D=y.i(C)&65535;p[2*b+2*C]+=_*D,I(p,2*b+2*C),p[2*b+2*C+1]+=x*D,I(p,2*b+2*C+1),p[2*b+2*C+1]+=_*V,I(p,2*b+2*C+1),p[2*b+2*C+2]+=x*V,I(p,2*b+2*C+2)}for(y=0;y<g;y++)p[y]=p[2*y+1]<<16|p[2*y];for(y=g;y<2*g;y++)p[y]=0;return new o(p,0)};function I(y,g){for(;(y[g]&65535)!=y[g];)y[g+1]+=y[g]>>>16,y[g]&=65535,g++}function R(y,g){this.g=y,this.h=g}function S(y,g){if(m(g))throw Error("division by zero");if(m(y))return new R(u,u);if(v(y))return g=S(w(y),g),new R(w(g.g),w(g.h));if(v(g))return g=S(y,w(g)),new R(w(g.g),g.h);if(y.g.length>30){if(v(y)||v(g))throw Error("slowDivide_ only works with positive integers.");for(var p=d,b=g;b.l(y)<=0;)p=T(p),b=T(b);var C=A(p,1),x=A(b,1);for(b=A(b,2),p=A(p,2);!m(b);){var _=x.add(b);_.l(y)<=0&&(C=C.add(p),x=_),b=A(b,1),p=A(p,1)}return g=E(y,C.j(g)),new R(C,g)}for(C=u;y.l(g)>=0;){for(p=Math.max(1,Math.floor(y.m()/g.m())),b=Math.ceil(Math.log(p)/Math.LN2),b=b<=48?1:Math.pow(2,b-48),x=c(p),_=x.j(g);v(_)||_.l(y)>0;)p-=b,x=c(p),_=x.j(g);m(x)&&(x=d),C=C.add(x),y=E(y,_)}return new R(C,y)}i.B=function(y){return S(this,y).h},i.and=function(y){const g=Math.max(this.g.length,y.g.length),p=[];for(let b=0;b<g;b++)p[b]=this.i(b)&y.i(b);return new o(p,this.h&y.h)},i.or=function(y){const g=Math.max(this.g.length,y.g.length),p=[];for(let b=0;b<g;b++)p[b]=this.i(b)|y.i(b);return new o(p,this.h|y.h)},i.xor=function(y){const g=Math.max(this.g.length,y.g.length),p=[];for(let b=0;b<g;b++)p[b]=this.i(b)^y.i(b);return new o(p,this.h^y.h)};function T(y){const g=y.g.length+1,p=[];for(let b=0;b<g;b++)p[b]=y.i(b)<<1|y.i(b-1)>>>31;return new o(p,y.h)}function A(y,g){const p=g>>5;g%=32;const b=y.g.length-p,C=[];for(let x=0;x<b;x++)C[x]=g>0?y.i(x+p)>>>g|y.i(x+p+1)<<32-g:y.i(x+p);return new o(C,y.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=h,Lg=o}).apply(typeof Ju<"u"?Ju:typeof self<"u"?self:typeof window<"u"?window:{});const Qu="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Bt.UNAUTHENTICATED=new Bt(null),Bt.GOOGLE_CREDENTIALS=new Bt("google-credentials-uid"),Bt.FIRST_PARTY=new Bt("first-party-uid"),Bt.MOCK_USER=new Bt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ir="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yi=new Sg("@firebase/firestore");function co(i,...t){if(Yi.logLevel<=lt.DEBUG){const e=t.map(Hc);Yi.debug(`Firestore (${ir}): ${i}`,...e)}}function Kc(i,...t){if(Yi.logLevel<=lt.ERROR){const e=t.map(Hc);Yi.error(`Firestore (${ir}): ${i}`,...e)}}function Mg(i,...t){if(Yi.logLevel<=lt.WARN){const e=t.map(Hc);Yi.warn(`Firestore (${ir}): ${i}`,...e)}}function Hc(i){if(typeof i=="string")return i;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(e){return JSON.stringify(e)}(i)}catch{return i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mt(i,t,e){let n="Unexpected state";typeof t=="string"?n=t:e=t,Og(i,n,e)}function Og(i,t,e){let n=`FIRESTORE (${ir}) INTERNAL ASSERTION FAILED: ${t} (ID: ${i.toString(16)})`;if(e!==void 0)try{n+=" CONTEXT: "+JSON.stringify(e)}catch{n+=" CONTEXT: "+e}throw Kc(n),new Error(n)}function Rn(i,t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,i||Og(t,r,n)}function Yo(i,t){return i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const td="ok",FE="cancelled",Ir="unknown",j="invalid-argument",NE="deadline-exceeded",$E="not-found",VE="permission-denied",Ol="unauthenticated",zE="resource-exhausted",Zi="failed-precondition",GE="aborted",UE="out-of-range",kg="unimplemented",BE="internal",jE="unavailable";class N extends nr{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dg{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class WE{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable(()=>e(Bt.UNAUTHENTICATED))}shutdown(){}}class qE{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable(()=>e(this.token.user))}shutdown(){this.changeListener=null}}class XE{constructor(t){this.auth=null,t.onInit(e=>{this.auth=e})}getToken(){return this.auth?this.auth.getToken().then(t=>t?(Rn(typeof t.accessToken=="string",42297,{t}),new Dg(t.accessToken,new Bt(this.auth.getUid()))):null):Promise.resolve(null)}invalidateToken(){}start(t,e){}shutdown(){}}class KE{constructor(t,e,n){this.i=t,this.o=e,this.u=n,this.type="FirstParty",this.user=Bt.FIRST_PARTY,this.l=new Map}h(){return this.u?this.u():null}get headers(){this.l.set("X-Goog-AuthUser",this.i);const t=this.h();return t&&this.l.set("Authorization",t),this.o&&this.l.set("X-Goog-Iam-Authorization-Token",this.o),this.l}}class HE{constructor(t,e,n){this.i=t,this.o=e,this.u=n}getToken(){return Promise.resolve(new KE(this.i,this.o,this.u))}start(t,e){t.enqueueRetryable(()=>e(Bt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class ed{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class YE{constructor(t,e){this.m=e,this.appCheck=null,this.T=null,wE(t)&&t.settings.appCheckToken&&(this.T=t.settings.appCheckToken),e.onInit(n=>{this.appCheck=n})}getToken(){return this.T?Promise.resolve(new ed(this.T)):this.appCheck?this.appCheck.getToken().then(t=>t?(Rn(typeof t.token=="string",3470,{tokenResult:t}),new ed(t.token)):null):Promise.resolve(null)}invalidateToken(){}start(t,e){}shutdown(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZE{constructor(t,e,n,r,s,o,a,l,c,h){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=h}}const kl="(default)";class Xr{constructor(t,e){this.projectId=t,this.database=e||kl}static empty(){return new Xr("","")}get isDefaultDatabase(){return this.database===kl}isEqual(t){return t instanceof Xr&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JE(i){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(i);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(e);else for(let n=0;n<i;n++)e[n]=Math.floor(256*Math.random());return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QE{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const r=JE(40);for(let s=0;s<r.length;++s)n.length<20&&r[s]<e&&(n+=t.charAt(r[s]%62))}return n}}function _t(i,t){return i<t?-1:i>t?1:0}function Dl(i,t){const e=Math.min(i.length,t.length);for(let n=0;n<e;n++){const r=i.charAt(n),s=t.charAt(n);if(r!==s)return Ka(r)===Ka(s)?_t(r,s):Ka(r)?1:-1}return _t(i.length,t.length)}const t2=55296,e2=57343;function Ka(i){const t=i.charCodeAt(0);return t>=t2&&t<=e2}function Fg(i,t,e){return i.length===t.length&&i.every((n,r)=>e(n,t[r]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nd="__name__";class Te{constructor(t,e,n){e===void 0?e=0:e>t.length&&mt(637,{offset:e,range:t.length}),n===void 0?n=t.length-e:n>t.length-e&&mt(1746,{length:n,range:t.length-e}),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return Te.comparator(this,t)===0}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Te?t.forEach(n=>{e.push(n)}):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=Te.compareSegments(t.get(r),e.get(r));if(s!==0)return s}return _t(t.length,e.length)}static compareSegments(t,e){const n=Te.isNumericId(t),r=Te.isNumericId(e);return n&&!r?-1:!n&&r?1:n&&r?Te.extractNumericId(t).compare(Te.extractNumericId(e)):Dl(t,e)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return Lg.fromString(t.substring(4,t.length-2))}}class vt extends Te{construct(t,e,n){return new vt(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new N(j,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter(r=>r.length>0))}return new vt(e)}static emptyPath(){return new vt([])}}const n2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ht extends Te{construct(t,e,n){return new Ht(t,e,n)}static isValidIdentifier(t){return n2.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ht.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===nd}static keyField(){return new Ht([nd])}static fromServerFormat(t){const e=[];let n="",r=0;const s=()=>{if(n.length===0)throw new N(j,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let o=!1;for(;r<t.length;){const a=t[r];if(a==="\\"){if(r+1===t.length)throw new N(j,"Path has trailing escape character: "+t);const l=t[r+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new N(j,"Path has invalid escape sequence: "+t);n+=l,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(n+=a,r++):(s(),r++)}if(s(),o)throw new N(j,"Unterminated ` in path: "+t);return new Ht(e)}static emptyPath(){return new Ht([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{constructor(t){this.path=t}static fromPath(t){return new Rt(vt.fromString(t))}static fromName(t){return new Rt(vt.fromString(t).popFirst(5))}static empty(){return new Rt(vt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&vt.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,e){return vt.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Rt(new vt(t.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ng(i,t,e){if(!e)throw new N(j,`Function ${i}() cannot be called with an empty ${t}.`)}function id(i){if(!Rt.isDocumentKey(i))throw new N(j,`Invalid document reference. Document references must have an even number of segments, but ${i} has ${i.length}.`)}function rd(i){if(Rt.isDocumentKey(i))throw new N(j,`Invalid collection reference. Collection references must have an odd number of segments, but ${i} has ${i.length}.`)}function $g(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}function Zo(i){if(i===void 0)return"undefined";if(i===null)return"null";if(typeof i=="string")return i.length>20&&(i=`${i.substring(0,20)}...`),JSON.stringify(i);if(typeof i=="number"||typeof i=="boolean")return""+i;if(typeof i=="object"){if(i instanceof Array)return"an array";{const t=function(n){return n.constructor?n.constructor.name:null}(i);return t?`a custom ${t} object`:"an object"}}return typeof i=="function"?"a function":mt(12329,{type:typeof i})}function Yc(i,t){if("_delegate"in i&&(i=i._delegate),!(i instanceof t)){if(t.name===i.constructor.name)throw new N(j,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=Zo(i);throw new N(j,`Expected type '${t.name}', but it was: ${e}`)}}return i}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vg(i){const t={};return i.timeoutSeconds!==void 0&&(t.timeoutSeconds=i.timeoutSeconds),t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ms=null;function i2(){return Ms===null?Ms=function(){return 268435456+Math.round(2147483648*Math.random())}():Ms++,"0x"+Ms.toString(16)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r2(i){return i==null}function ho(i){return i===0&&1/i==-1/0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ha="RestConnection",s2={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class o2{get P(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.A=e+"://"+t.host,this.R=`projects/${n}/databases/${r}`,this.V=this.databaseId.database===kl?`project_id=${n}`:`project_id=${n}&database_id=${r}`}I(t,e,n,r,s){const o=i2(),a=this.p(t,e.toUriEncodedString());co(Ha,`Sending RPC '${t}' ${o}:`,a,n);const l={"google-cloud-resource-prefix":this.R,"x-goog-request-params":this.V};this.F(l,r,s);const{host:c}=new URL(a),h=qc(c);return this.v(t,a,l,n,h).then(u=>(co(Ha,`Received RPC '${t}' ${o}: `,u),u),u=>{throw Mg(Ha,`RPC '${t}' ${o} failed with error: `,u,"url: ",a,"request:",n),u})}D(t,e,n,r,s,o){return this.I(t,e,n,r,s)}F(t,e,n){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ir}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach((r,s)=>t[s]=r),n&&n.headers.forEach((r,s)=>t[s]=r)}p(t,e){const n=s2[t];return`${this.A}/v1/${e}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var sd,Q;function od(i){if(i===void 0)return Kc("RPC_ERROR","HTTP error has no status"),Ir;switch(i){case 200:return td;case 400:return Zi;case 401:return Ol;case 403:return VE;case 404:return $E;case 409:return GE;case 416:return UE;case 429:return zE;case 499:return FE;case 500:return Ir;case 501:return kg;case 503:return jE;case 504:return NE;default:return i>=200&&i<300?td:i>=400&&i<500?Zi:i>=500&&i<600?BE:Ir}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(Q=sd||(sd={}))[Q.OK=0]="OK",Q[Q.CANCELLED=1]="CANCELLED",Q[Q.UNKNOWN=2]="UNKNOWN",Q[Q.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Q[Q.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Q[Q.NOT_FOUND=5]="NOT_FOUND",Q[Q.ALREADY_EXISTS=6]="ALREADY_EXISTS",Q[Q.PERMISSION_DENIED=7]="PERMISSION_DENIED",Q[Q.UNAUTHENTICATED=16]="UNAUTHENTICATED",Q[Q.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Q[Q.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Q[Q.ABORTED=10]="ABORTED",Q[Q.OUT_OF_RANGE=11]="OUT_OF_RANGE",Q[Q.UNIMPLEMENTED=12]="UNIMPLEMENTED",Q[Q.INTERNAL=13]="INTERNAL",Q[Q.UNAVAILABLE=14]="UNAVAILABLE",Q[Q.DATA_LOSS=15]="DATA_LOSS";class a2 extends o2{S(t,e){throw new Error("Not supported by FetchConnection")}async v(t,e,n,r,s){const o=JSON.stringify(r);let a;try{const l={method:"POST",headers:n,body:o};s&&(l.credentials="include"),a=await fetch(e,l)}catch(l){const c=l;throw new N(od(c.status),"Request failed with error: "+c.statusText)}if(!a.ok){let l=await a.json();Array.isArray(l)&&(l=l[0]);const c=l?.error?.message;throw new N(od(a.status),`Request failed with error: ${c??a.statusText}`)}return a.json()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ad(i){let t=0;for(const e in i)Object.prototype.hasOwnProperty.call(i,e)&&t++;return t}function Jo(i,t){for(const e in i)Object.prototype.hasOwnProperty.call(i,e)&&t(e,i[e])}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l2 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sn{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new l2("Invalid base64 string: "+s):s}}(t);return new sn(e)}static fromUint8Array(t){const e=function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s}(t);return new sn(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(e){return btoa(e)}(this.binaryString)}toUint8Array(){return function(e){const n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return _t(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}sn.EMPTY_BYTE_STRING=new sn("");const c2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ii(i){if(Rn(!!i,39018),typeof i=="string"){let t=0;const e=c2.exec(i);if(Rn(!!e,46558,{timestamp:i}),e[1]){let r=e[1];r=(r+"000000000").substr(0,9),t=Number(r)}const n=new Date(i);return{seconds:Math.floor(n.getTime()/1e3),nanos:t}}return{seconds:yt(i.seconds),nanos:yt(i.nanos)}}function yt(i){return typeof i=="number"?i:typeof i=="string"?Number(i):0}function Kr(i){return typeof i=="string"?sn.fromBase64String(i):sn.fromUint8Array(i)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function de(i,t){const e={typeString:i};return t&&(e.value=t),e}function gs(i,t){if(!$g(i))throw new N(j,"JSON must be an object");let e;for(const n in t)if(t[n]){const r=t[n].typeString,s="value"in t[n]?{value:t[n].value}:void 0;if(!(n in i)){e=`JSON missing required field: '${n}'`;break}const o=i[n];if(r&&typeof o!==r){e=`JSON field '${n}' must be a ${r}.`;break}if(s!==void 0&&o!==s.value){e=`Expected '${n}' field to equal '${s.value}'`;break}}if(e)throw new N(j,e);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ld=-62135596800,cd=1e6;class Et{static now(){return Et.fromMillis(Date.now())}static fromDate(t){return Et.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor((t-1e3*e)*cd);return new Et(e,n)}constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new N(j,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new N(j,"Timestamp nanoseconds out of range: "+e);if(t<ld)throw new N(j,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new N(j,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/cd}_compareTo(t){return this.seconds===t.seconds?_t(this.nanoseconds,t.nanoseconds):_t(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Et._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(gs(t,Et._jsonSchema))return new Et(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-ld;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Et._jsonSchemaVersion="firestore/timestamp/1.0",Et._jsonSchema={type:de("string",Et._jsonSchemaVersion),seconds:de("number"),nanoseconds:de("number")};function zg(i){return(i?.mapValue?.fields||{}).__type__?.stringValue==="server_timestamp"}function Gg(i){const t=i.mapValue.fields.__previous_value__;return zg(t)?Gg(t):t}function Hr(i){const t=ii(i.mapValue.fields.__local_write_time__.timestampValue);return new Et(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ug="__type__",h2="__max__",Os={},Bg="__vector__",uo="value";function ri(i){return"nullValue"in i?0:"booleanValue"in i?1:"integerValue"in i||"doubleValue"in i?2:"timestampValue"in i?3:"stringValue"in i?5:"bytesValue"in i?6:"referenceValue"in i?7:"geoPointValue"in i?8:"arrayValue"in i?9:"mapValue"in i?zg(i)?4:function(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===h2}(i)?9007199254740991:function(e){return(e?.mapValue?.fields||{})[Ug]?.stringValue===Bg}(i)?10:11:mt(28295,{value:i})}function fo(i,t){if(i===t)return!0;const e=ri(i);if(e!==ri(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return i.booleanValue===t.booleanValue;case 4:return Hr(i).isEqual(Hr(t));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=ii(r.timestampValue),a=ii(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(i,t);case 5:return i.stringValue===t.stringValue;case 6:return function(r,s){return Kr(r.bytesValue).isEqual(Kr(s.bytesValue))}(i,t);case 7:return i.referenceValue===t.referenceValue;case 8:return function(r,s){return yt(r.geoPointValue.latitude)===yt(s.geoPointValue.latitude)&&yt(r.geoPointValue.longitude)===yt(s.geoPointValue.longitude)}(i,t);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return yt(r.integerValue)===yt(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=yt(r.doubleValue),a=yt(s.doubleValue);return o===a?ho(o)===ho(a):isNaN(o)&&isNaN(a)}return!1}(i,t);case 9:return Fg(i.arrayValue.values||[],t.arrayValue.values||[],fo);case 10:case 11:return function(r,s){const o=r.mapValue.fields||{},a=s.mapValue.fields||{};if(ad(o)!==ad(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!fo(o[l],a[l])))return!1;return!0}(i,t);default:return mt(52216,{left:i})}}function Yr(i,t){return(i.values||[]).find(e=>fo(e,t))!==void 0}function go(i,t){if(i===t)return 0;const e=ri(i),n=ri(t);if(e!==n)return _t(e,n);switch(e){case 0:case 9007199254740991:return 0;case 1:return _t(i.booleanValue,t.booleanValue);case 2:return function(s,o){const a=yt(s.integerValue||s.doubleValue),l=yt(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(i,t);case 3:return hd(i.timestampValue,t.timestampValue);case 4:return hd(Hr(i),Hr(t));case 5:return Dl(i.stringValue,t.stringValue);case 6:return function(s,o){const a=Kr(s),l=Kr(o);return a.compareTo(l)}(i.bytesValue,t.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const h=_t(a[c],l[c]);if(h!==0)return h}return _t(a.length,l.length)}(i.referenceValue,t.referenceValue);case 8:return function(s,o){const a=_t(yt(s.latitude),yt(o.latitude));return a!==0?a:_t(yt(s.longitude),yt(o.longitude))}(i.geoPointValue,t.geoPointValue);case 9:return ud(i.arrayValue,t.arrayValue);case 10:return function(s,o){const a=s.fields||{},l=o.fields||{},c=a[uo]?.arrayValue,h=l[uo]?.arrayValue,u=_t(c?.values?.length||0,h?.values?.length||0);return u!==0?u:ud(c,h)}(i.mapValue,t.mapValue);case 11:return function(s,o){if(s===Os&&o===Os)return 0;if(s===Os)return 1;if(o===Os)return-1;const a=s.fields||{},l=Object.keys(a),c=o.fields||{},h=Object.keys(c);l.sort(),h.sort();for(let u=0;u<l.length&&u<h.length;++u){const d=Dl(l[u],h[u]);if(d!==0)return d;const f=go(a[l[u]],c[h[u]]);if(f!==0)return f}return _t(l.length,h.length)}(i.mapValue,t.mapValue);default:throw mt(23264,{C:e})}}function hd(i,t){if(typeof i=="string"&&typeof t=="string"&&i.length===t.length)return _t(i,t);const e=ii(i),n=ii(t),r=_t(e.seconds,n.seconds);return r!==0?r:_t(e.nanos,n.nanos)}function ud(i,t){const e=i.values||[],n=t.values||[];for(let r=0;r<e.length&&r<n.length;++r){const s=go(e[r],n[r]);if(s)return s}return _t(e.length,n.length)}function dd(i,t){return{referenceValue:`projects/${i.projectId}/databases/${i.database}/documents/${t.path.canonicalString()}`}}function jg(i){return!!i&&"arrayValue"in i}function fd(i){return!!i&&"nullValue"in i}function gd(i){return!!i&&"doubleValue"in i&&isNaN(Number(i.doubleValue))}function Ya(i){return!!i&&"mapValue"in i}function Tr(i){if(i.geoPointValue)return{geoPointValue:{...i.geoPointValue}};if(i.timestampValue&&typeof i.timestampValue=="object")return{timestampValue:{...i.timestampValue}};if(i.mapValue){const t={mapValue:{fields:{}}};return Jo(i.mapValue.fields,(e,n)=>t.mapValue.fields[e]=Tr(n)),t}if(i.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(i.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=Tr(i.arrayValue.values[e]);return t}return{...i}}class pd{constructor(t,e){this.position=t,this.inclusive=e}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wg{}class Ce extends Wg{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?e==="in"||e==="not-in"?this.createKeyFieldInFilter(t,e,n):new u2(t,e,n):e==="array-contains"?new g2(t,n):e==="in"?new p2(t,n):e==="not-in"?new m2(t,n):e==="array-contains-any"?new _2(t,n):new Ce(t,e,n)}static createKeyFieldInFilter(t,e,n){return e==="in"?new d2(t,n):new f2(t,n)}matches(t){const e=t.data.field(this.field);return this.op==="!="?e!==null&&e.nullValue===void 0&&this.matchesComparison(go(e,this.value)):e!==null&&ri(this.value)===ri(e)&&this.matchesComparison(go(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return mt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ps extends Wg{constructor(t,e){super(),this.filters=t,this.op=e,this.N=null}static create(t,e){return new ps(t,e)}matches(t){return function(n){return n.op==="and"}(this)?this.filters.find(e=>!e.matches(t))===void 0:this.filters.find(e=>e.matches(t))!==void 0}getFlattenedFilters(){return this.N!==null||(this.N=this.filters.reduce((t,e)=>t.concat(e.getFlattenedFilters()),[])),this.N}getFilters(){return Object.assign([],this.filters)}}class u2 extends Ce{constructor(t,e,n){super(t,e,n),this.key=Rt.fromName(n.referenceValue)}matches(t){const e=Rt.comparator(t.key,this.key);return this.matchesComparison(e)}}class d2 extends Ce{constructor(t,e){super(t,"in",e),this.keys=qg("in",e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class f2 extends Ce{constructor(t,e){super(t,"not-in",e),this.keys=qg("not-in",e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function qg(i,t){return(t.arrayValue?.values||[]).map(e=>Rt.fromName(e.referenceValue))}class g2 extends Ce{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return jg(e)&&Yr(e.arrayValue,this.value)}}class p2 extends Ce{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return e!==null&&Yr(this.value.arrayValue,e)}}class m2 extends Ce{constructor(t,e){super(t,"not-in",e)}matches(t){if(Yr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return e!==null&&e.nullValue===void 0&&!Yr(this.value.arrayValue,e)}}class _2 extends Ce{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!jg(e)||!e.arrayValue.values)&&e.arrayValue.values.some(n=>Yr(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fl{constructor(t,e="asc"){this.field=t,this.dir=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{static fromTimestamp(t){return new Dt(t)}static min(){return new Dt(new Et(0,0))}static max(){return new Dt(new Et(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{constructor(t,e){this.comparator=t,this.root=e||At.EMPTY}insert(t,e){return new po(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,At.BLACK,null,null))}remove(t){return new po(this.comparator,this.root.remove(t,this.comparator).copy(null,null,At.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(n===0)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(t,n.key);if(r===0)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((e,n)=>(t(e,n),!1))}toString(){const t=[];return this.inorderTraversal((e,n)=>(t.push(`${e}:${n}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new ks(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new ks(this.root,t,this.comparator,!1)}getReverseIterator(){return new ks(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new ks(this.root,t,this.comparator,!0)}}class ks{constructor(t,e,n,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=e?n(t.key,e):1,e&&r&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(s===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class At{constructor(t,e,n,r,s){this.key=t,this.value=e,this.color=n??At.RED,this.left=r??At.EMPTY,this.right=s??At.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,r,s){return new At(t??this.key,e??this.value,n??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let r=this;const s=n(t,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(t,e,n),null):s===0?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return At.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,r=this;if(e(t,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),e(t,r.key)===0){if(r.right.isEmpty())return At.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,At.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,At.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw mt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw mt(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw mt(27949);return t+(this.isRed()?0:1)}}At.EMPTY=null,At.RED=!0,At.BLACK=!1;At.EMPTY=new class{constructor(){this.size=0}get key(){throw mt(57766)}get value(){throw mt(16141)}get color(){throw mt(16727)}get left(){throw mt(29726)}get right(){throw mt(36894)}copy(t,e,n,r,s){return this}insert(t,e,n){return new At(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr{constructor(t){this.comparator=t,this.data=new po(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((e,n)=>(t(e),!1))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}}forEachWhile(t,e){let n;for(n=e!==void 0?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new md(this.data.getIterator())}getIteratorFrom(t){return new md(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach(n=>{e=e.add(n)}),e}isEqual(t){if(!(t instanceof Zr)||this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const r=e.getNext().key,s=n.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(e=>{t.push(e)}),t}toString(){const t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(t){const e=new Zr(this.comparator);return e.data=t,e}}class md{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jr{constructor(t){this.fields=t,t.sort(Ht.comparator)}static empty(){return new Jr([])}unionWith(t){let e=new Zr(Ht.comparator);for(const n of this.fields)e=e.add(n);for(const n of t)e=e.add(n);return new Jr(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Fg(this.fields,t.fields,(e,n)=>e.isEqual(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{constructor(t){this.value=t}static empty(){return new Pe({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!Ya(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Tr(e)}setAll(t){let e=Ht.emptyPath(),n={},r=[];t.forEach((o,a)=>{if(!e.isImmediateParentOf(a)){const l=this.getFieldsMap(e);this.applyChanges(l,n,r),n={},r=[],e=a.popLast()}o?n[a.lastSegment()]=Tr(o):r.push(a.lastSegment())});const s=this.getFieldsMap(e);this.applyChanges(s,n,r)}delete(t){const e=this.field(t.popLast());Ya(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return fo(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let r=e.mapValue.fields[t.get(n)];Ya(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields}applyChanges(t,e,n){Jo(e,(r,s)=>t[r]=s);for(const r of n)delete t[r]}clone(){return new Pe(Tr(this.value))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(t,e,n,r,s,o,a){this.key=t,this.documentType=e,this.version=n,this.readTime=r,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(t){return new mn(t,0,Dt.min(),Dt.min(),Dt.min(),Pe.empty(),0)}static newFoundDocument(t,e,n,r){return new mn(t,1,e,Dt.min(),n,r,0)}static newNoDocument(t,e){return new mn(t,2,e,Dt.min(),Dt.min(),Pe.empty(),0)}static newUnknownDocument(t,e){return new mn(t,3,e,Dt.min(),Dt.min(),Pe.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(Dt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Pe.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Pe.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Dt.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof mn&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new mn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y2{constructor(t,e=null,n=[],r=[],s=null,o=null,a=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=s,this.startAt=o,this.endAt=a,this.O=null}}function _d(i,t=null,e=[],n=[],r=null,s=null,o=null){return new y2(i,t,e,n,r,s,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xg{constructor(t,e=null,n=[],r=[],s=null,o="F",a=null,l=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.q=null,this.B=null,this.$=null,this.startAt,this.endAt}}function w2(i){return i.collectionGroup!==null}function v2(i){const t=Yo(i);if(t.q===null){t.q=[];const e=new Set;for(const s of t.explicitOrderBy)t.q.push(s),e.add(s.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Zr(Ht.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(t).forEach(s=>{e.has(s.canonicalString())||s.isKeyField()||t.q.push(new Fl(s,n))}),e.has(Ht.keyField().canonicalString())||t.q.push(new Fl(Ht.keyField(),n))}return t.q}function b2(i){const t=Yo(i);return t.B||(t.B=E2(t,v2(i))),t.B}function E2(i,t){if(i.limitType==="F")return _d(i.path,i.collectionGroup,t,i.filters,i.limit,i.startAt,i.endAt);{t=t.map(r=>{const s=r.dir==="desc"?"asc":"desc";return new Fl(r.field,s)});const e=i.endAt?new pd(i.endAt.position,i.endAt.inclusive):null,n=i.startAt?new pd(i.startAt.position,i.startAt.inclusive):null;return _d(i.path,i.collectionGroup,t,i.filters,i.limit,e,n)}}function Nl(i,t){const e=i.filters.concat([t]);return new Xg(i.path,i.collectionGroup,i.explicitOrderBy.slice(),e,i.limit,i.limitType,i.startAt,i.endAt)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kg(i,t){if(i.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ho(t)?"-0":t}}function C2(i,t){return function(n){return typeof n=="number"&&Number.isInteger(n)&&!ho(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}(t)?function(n){return{integerValue:""+n}}(t):Kg(i,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo{constructor(){this._=void 0}}class x2 extends Qo{}class S2 extends Qo{constructor(t){super(),this.elements=t}}class I2 extends Qo{constructor(t){super(),this.elements=t}}class T2 extends Qo{constructor(t,e){super(),this.serializer=t,this.k=e}}class Rr{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Rr}static exists(t){return new Rr(void 0,t)}static updateTime(t){return new Rr(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}class ta{}class Hg extends ta{constructor(t,e,n,r=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Yg extends ta{constructor(t,e,n,r,s=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}class R2 extends ta{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class A2 extends ta{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P2={asc:"ASCENDING",desc:"DESCENDING"},L2={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},M2={and:"AND",or:"OR"};class O2{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function $l(i,t){return i.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function k2(i,t){return i.useProto3Json?t.toBase64():t.toUint8Array()}function D2(i,t){return $l(i,t.toTimestamp())}function yd(i){return Rn(!!i,49232),Dt.fromTimestamp(function(e){const n=ii(e);return new Et(n.seconds,n.nanos)}(i))}function Zc(i,t){return Vl(i,t).canonicalString()}function Vl(i,t){const e=function(r){return new vt(["projects",r.projectId,"databases",r.database])}(i).child("documents");return t===void 0?e:e.child(t)}function zl(i,t){return Zc(i.databaseId,t.path)}function F2(i,t){const e=function(r){const s=vt.fromString(r);return Rn(Jg(s),10190,{key:s.toString()}),s}(t);if(e.get(1)!==i.databaseId.projectId)throw new N(j,"Tried to deserialize key from different project: "+e.get(1)+" vs "+i.databaseId.projectId);if(e.get(3)!==i.databaseId.database)throw new N(j,"Tried to deserialize key from different database: "+e.get(3)+" vs "+i.databaseId.database);return new Rt(function(r){return Rn(r.length>4&&r.get(4)==="documents",29091,{key:r.toString()}),r.popFirst(5)}(e))}function wd(i,t,e){return{name:zl(i,t),fields:e.value.mapValue.fields}}function N2(i,t){let e;if(t instanceof Hg)e={update:wd(i,t.key,t.value)};else if(t instanceof R2)e={delete:zl(i,t.key)};else if(t instanceof Yg)e={update:wd(i,t.key,t.data),updateMask:U2(t.fieldMask)};else{if(!(t instanceof A2))return mt(16599,{L:t.type});e={verify:zl(i,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map(n=>function(s,o){const a=o.transform;if(a instanceof x2)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof S2)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof I2)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof T2)return{fieldPath:o.field.canonicalString(),increment:a.k};throw mt(20930,{transform:o.transform})}(0,n))),t.precondition.isNone||(e.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:D2(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:mt(27497)}(i,t.precondition)),e}function $2(i,t){const e={structuredQuery:{}},n=t.path;let r;t.collectionGroup!==null?(r=n,e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(r=n.popLast(),e.structuredQuery.from=[{collectionId:n.lastSegment()}]),e.parent=function(c,h){return Zc(c.databaseId,h)}(i,r);const s=function(c){if(c.length!==0)return Zg(ps.create(c,"and"))}(t.filters);s&&(e.structuredQuery.where=s);const o=function(c){if(c.length!==0)return c.map(h=>function(d){return{field:Ai(d.field),direction:V2(d.dir)}}(h))}(t.orderBy);o&&(e.structuredQuery.orderBy=o);const a=function(c,h){return c.useProto3Json||r2(h)?h:{value:h}}(i,t.limit);return a!==null&&(e.structuredQuery.limit=a),t.startAt&&(e.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(t.startAt)),t.endAt&&(e.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(t.endAt)),{M:e,parent:r}}function V2(i){return P2[i]}function z2(i){return L2[i]}function G2(i){return M2[i]}function Ai(i){return{fieldPath:i.canonicalString()}}function Zg(i){return i instanceof Ce?function(e){if(e.op==="=="){if(gd(e.value))return{unaryFilter:{field:Ai(e.field),op:"IS_NAN"}};if(fd(e.value))return{unaryFilter:{field:Ai(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(gd(e.value))return{unaryFilter:{field:Ai(e.field),op:"IS_NOT_NAN"}};if(fd(e.value))return{unaryFilter:{field:Ai(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ai(e.field),op:z2(e.op),value:e.value}}}(i):i instanceof ps?function(e){const n=e.getFilters().map(r=>Zg(r));return n.length===1?n[0]:{compositeFilter:{op:G2(e.op),filters:n}}}(i):mt(54877,{filter:i})}function U2(i){const t=[];return i.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function Jg(i){return i.length>=4&&i.get(0)==="projects"&&i.get(2)==="databases"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jc(i){return new O2(i,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B2{}class j2 extends B2{constructor(t,e,n,r){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.serializer=r,this.et=!1}rt(){if(this.et)throw new N(Zi,"The client has already been terminated.")}I(t,e,n,r){return this.rt(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.I(t,Vl(e,n),r,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Ol&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new N(Ir,s.toString())})}D(t,e,n,r,s){return this.rt(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.D(t,Vl(e,n),r,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Ol&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new N(Ir,o.toString())})}terminate(){this.et=!0,this.connection.terminate()}}async function W2(i,t){const e=Yo(i),n={writes:t.map(r=>N2(e.serializer,r))};await e.I("Commit",e.serializer.databaseId,vt.emptyPath(),n)}async function q2(i,t){const e=Yo(i),{M:n,parent:r}=$2(e.serializer,b2(t));return(await e.D("RunQuery",e.serializer.databaseId,r,{structuredQuery:n.structuredQuery})).filter(s=>!!s.document).map(s=>function(a,l,c){const h=F2(a,l.name),u=yd(l.updateTime),d=l.createTime?yd(l.createTime):Dt.min(),f=new Pe({mapValue:{fields:l.fields}}),m=mn.newFoundDocument(h,u,d,f);return c?m.setHasCommittedMutations():m}(e.serializer,s.document,void 0))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qg="ComponentProvider",Ar=new Map;function tp(i){if(i._terminated)throw new N(Zi,"The client has already been terminated.");if(!Ar.has(i)){co(Qg,"Initializing Datastore");const t=function(s){return new a2(s)}(function(s,o,a,l){return new ZE(s,o,a,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,Vg(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator)}(i._databaseId,i.app.options.appId||"",i._persistenceKey,i._freezeSettings())),e=Jc(i._databaseId),n=function(s,o,a,l){return new j2(s,o,a,l)}(i._authCredentials,i._appCheckCredentials,t,e);Ar.set(i,n)}return Ar.get(i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X2=1048576,ep="firestore.googleapis.com",vd=!0;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bd{constructor(t){if(t.host===void 0){if(t.ssl!==void 0)throw new N(j,"Can't provide ssl option if host option is not set");this.host=ep,this.ssl=vd}else this.host=t.host,this.ssl=t.ssl??vd;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<X2)throw new N(j,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}(function(n,r,s,o){if(r===!0&&o===!0)throw new N(j,`${n} and ${s} cannot be used together.`)})("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Vg(t.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new N(j,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new N(j,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new N(j,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(n,r){return n.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class ea{constructor(t,e,n,r){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new bd({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new N(Zi,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new N(Zi,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new bd(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new WE;switch(n.type){case"firstParty":return new HE(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new N(j,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const n=Ar.get(e);n&&(co(Qg,"Removing Datastore"),Ar.delete(e),n.terminate())}(this),Promise.resolve()}}function K2(i,t){const e=typeof i=="object"?i:CE(),n=typeof i=="string"?i:"(default)",r=yE(e,"firestore/lite").getImmediate({identifier:n});if(!r._initialized){const s=hb("firestore");s&&H2(r,...s)}return r}function H2(i,t,e,n={}){i=Yc(i,ea);const r=qc(t),s=i._getSettings(),o={...s,emulatorOptions:i._getEmulatorOptions()},a=`${t}:${e}`;r&&(db(`https://${a}`),mb("Firestore",!0)),s.host!==ep&&s.host!==a&&Mg("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:a,ssl:r,emulatorOptions:n};if(!oo(l,o)&&(i._setSettings(l),n.mockUserToken)){let c,h;if(typeof n.mockUserToken=="string")c=n.mockUserToken,h=Bt.MOCK_USER;else{c=fb(n.mockUserToken,i._app?.options.projectId);const u=n.mockUserToken.sub||n.mockUserToken.user_id;if(!u)throw new N(j,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Bt(u)}i._authCredentials=new qE(new Dg(c,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rr{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new rr(this.firestore,t,this._query)}}class Ct{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Sn(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Ct(this.firestore,t,this._key)}toJSON(){return{type:Ct._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,e,n){if(gs(e,Ct._jsonSchema))return new Ct(t,n||null,new Rt(vt.fromString(e.referencePath)))}}Ct._jsonSchemaVersion="firestore/documentReference/1.0",Ct._jsonSchema={type:de("string",Ct._jsonSchemaVersion),referencePath:de("string")};class Sn extends rr{constructor(t,e,n){super(t,e,function(s){return new Xg(s)}(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Ct(this.firestore,null,new Rt(t))}withConverter(t){return new Sn(this.firestore,t,this._path)}}function Ed(i,t,...e){if(i=Hi(i),Ng("collection","path",t),i instanceof ea){const n=vt.fromString(t,...e);return rd(n),new Sn(i,null,n)}{if(!(i instanceof Ct||i instanceof Sn))throw new N(j,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=i._path.child(vt.fromString(t,...e));return rd(n),new Sn(i.firestore,null,n)}}function Y2(i,t,...e){if(i=Hi(i),arguments.length===1&&(t=QE.newId()),Ng("doc","path",t),i instanceof ea){const n=vt.fromString(t,...e);return id(n),new Ct(i,null,new Rt(n))}{if(!(i instanceof Ct||i instanceof Sn))throw new N(j,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=i._path.child(vt.fromString(t,...e));return id(n),new Ct(i.firestore,i instanceof Sn?i.converter:null,new Rt(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{constructor(t){this._byteString=t}static fromBase64String(t){try{return new le(sn.fromBase64String(t))}catch(e){throw new N(j,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new le(sn.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:le._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(gs(t,le._jsonSchema))return le.fromBase64String(t.bytes)}}le._jsonSchemaVersion="firestore/bytes/1.0",le._jsonSchema={type:de("string",le._jsonSchemaVersion),bytes:de("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc{constructor(...t){for(let e=0;e<t.length;++e)if(t[e].length===0)throw new N(j,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ht(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class np{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ke{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new N(j,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new N(j,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return _t(this._lat,t._lat)||_t(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ke._jsonSchemaVersion}}static fromJSON(t){if(gs(t,ke._jsonSchema))return new ke(t.latitude,t.longitude)}}ke._jsonSchemaVersion="firestore/geoPoint/1.0",ke._jsonSchema={type:de("string",ke._jsonSchemaVersion),latitude:de("number"),longitude:de("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{constructor(t){this._values=(t||[]).map(e=>e)}toArray(){return this._values.map(t=>t)}isEqual(t){/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n,r){if(n.length!==r.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==r[s])return!1;return!0}(this._values,t._values)}toJSON(){return{type:De._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(gs(t,De._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every(e=>typeof e=="number"))return new De(t.vectorValues);throw new N(j,"Expected 'vectorValues' field to be a number array")}}}De._jsonSchemaVersion="firestore/vectorValue/1.0",De._jsonSchema={type:de("string",De._jsonSchemaVersion),vectorValues:de("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z2=/^__.*__$/;class J2{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return this.fieldMask!==null?new Yg(t,this.data,this.fieldMask,e,this.fieldTransforms):new Hg(t,this.data,e,this.fieldTransforms)}}function ip(i){switch(i){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw mt(40011,{it:i})}}class th{constructor(t,e,n,r,s,o){this.settings=t,this.databaseId=e,this.serializer=n,this.ignoreUndefinedProperties=r,s===void 0&&this.st(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get it(){return this.settings.it}ot(t){return new th({...this.settings,...t},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ut(t){const e=this.path?.child(t),n=this.ot({path:e,_t:!1});return n.ct(t),n}lt(t){const e=this.path?.child(t),n=this.ot({path:e,_t:!1});return n.st(),n}ht(t){return this.ot({path:void 0,_t:!0})}ft(t){return mo(t,this.settings.methodName,this.settings.dt||!1,this.path,this.settings.Et)}contains(t){return this.fieldMask.find(e=>t.isPrefixOf(e))!==void 0||this.fieldTransforms.find(e=>t.isPrefixOf(e.field))!==void 0}st(){if(this.path)for(let t=0;t<this.path.length;t++)this.ct(this.path.get(t))}ct(t){if(t.length===0)throw this.ft("Document fields must not be empty");if(ip(this.it)&&Z2.test(t))throw this.ft('Document fields cannot begin and end with "__"')}}class Q2{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=n||Jc(t)}Tt(t,e,n,r=!1){return new th({it:t,methodName:e,Et:n,path:Ht.emptyPath(),_t:!1,dt:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function rp(i){const t=i._freezeSettings(),e=Jc(i._databaseId);return new Q2(i._databaseId,!!t.ignoreUndefinedProperties,e)}function tC(i,t,e,n,r,s={}){const o=i.Tt(s.merge||s.mergeFields?2:0,t,e,r);ap("Data must be an object, but it was:",o,n);const a=sp(n,o);let l,c;if(s.merge)l=new Jr(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const h=[];for(const u of s.mergeFields){const d=nC(t,u,e);if(!o.contains(d))throw new N(j,`Field '${d}' is specified in your field mask but missing from your input data.`);rC(h,d)||h.push(d)}l=new Jr(h),c=o.fieldTransforms.filter(u=>l.covers(u.field))}else l=null,c=o.fieldTransforms;return new J2(new Pe(a),l,c)}function eC(i,t,e,n=!1){return eh(e,i.Tt(n?4:3,t))}function eh(i,t){if(op(i=Hi(i)))return ap("Unsupported field value:",t,i),sp(i,t);if(i instanceof np)return function(n,r){if(!ip(r.it))throw r.ft(`${n._methodName}() can only be used with update() and set()`);if(!r.path)throw r.ft(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(i,t),null;if(i===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),i instanceof Array){if(t.settings._t&&t.it!==4)throw t.ft("Nested arrays are not supported");return function(n,r){const s=[];let o=0;for(const a of n){let l=eh(a,r.ht(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(i,t)}return function(n,r){if((n=Hi(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return C2(r.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=Et.fromDate(n);return{timestampValue:$l(r.serializer,s)}}if(n instanceof Et){const s=new Et(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:$l(r.serializer,s)}}if(n instanceof ke)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof le)return{bytesValue:k2(r.serializer,n._byteString)};if(n instanceof Ct){const s=r.databaseId,o=n.firestore._databaseId;if(!o.isEqual(s))throw r.ft(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Zc(n.firestore._databaseId||r.databaseId,n._key.path)}}if(n instanceof De)return function(o,a){return{mapValue:{fields:{[Ug]:{stringValue:Bg},[uo]:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw a.ft("VectorValues must only contain numeric values.");return Kg(a.serializer,c)})}}}}}}(n,r);throw r.ft(`Unsupported field value: ${Zo(n)}`)}(i,t)}function sp(i,t){const e={};return function(r){for(const s in r)if(Object.prototype.hasOwnProperty.call(r,s))return!1;return!0}(i)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Jo(i,(n,r)=>{const s=eh(r,t.ut(n));s!=null&&(e[n]=s)}),{mapValue:{fields:e}}}function op(i){return!(typeof i!="object"||i===null||i instanceof Array||i instanceof Date||i instanceof Et||i instanceof ke||i instanceof le||i instanceof Ct||i instanceof np||i instanceof De)}function ap(i,t,e){if(!op(e)||!$g(e)){const n=Zo(e);throw n==="an object"?t.ft(i+" a custom object"):t.ft(i+" "+n)}}function nC(i,t,e){if((t=Hi(t))instanceof Qc)return t._internalPath;if(typeof t=="string")return lp(i,t);throw mo("Field path arguments must be of type string or ",i,!1,void 0,e)}const iC=new RegExp("[~\\*/\\[\\]]");function lp(i,t,e){if(t.search(iC)>=0)throw mo(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,i,!1,void 0,e);try{return new Qc(...t.split("."))._internalPath}catch{throw mo(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,i,!1,void 0,e)}}function mo(i,t,e,n,r){const s=n&&!n.isEmpty(),o=r!==void 0;let a=`Function ${t}() called with invalid data`;e&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${n}`),o&&(l+=` in document ${r}`),l+=")"),new N(j,a+i+l)}function rC(i,t){return i.some(e=>e.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sC{constructor(t,e,n,r,s){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Ct(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new cp(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(hp("DocumentSnapshot.get",t));if(e!==null)return this._userDataWriter.convertValue(e)}}}class cp extends sC{data(){return super.data()}}class oC{constructor(t,e){this._docs=e,this.query=t}get docs(){return[...this._docs]}get size(){return this.docs.length}get empty(){return this.docs.length===0}forEach(t,e){this._docs.forEach(t,e)}}function hp(i,t){return typeof t=="string"?lp(i,t):t instanceof Qc?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nh{}class aC extends nh{}function lC(i,t,...e){let n=[];t instanceof nh&&n.push(t),n=n.concat(e),function(s){const o=s.filter(l=>l instanceof ih).length,a=s.filter(l=>l instanceof na).length;if(o>1||o>0&&a>0)throw new N(j,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const r of n)i=r._apply(i);return i}class na extends aC{constructor(t,e,n){super(),this._field=t,this._op=e,this._value=n,this.type="where"}static _create(t,e,n){return new na(t,e,n)}_apply(t){const e=this._parse(t);return up(t._query,e),new rr(t.firestore,t.converter,Nl(t._query,e))}_parse(t){const e=rp(t.firestore);return function(s,o,a,l,c,h,u){let d;if(c.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new N(j,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){xd(u,h);const m=[];for(const v of u)m.push(Cd(l,s,v));d={arrayValue:{values:m}}}else d=Cd(l,s,u)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||xd(u,h),d=eC(a,o,u,h==="in"||h==="not-in");return Ce.create(c,h,d)}(t._query,"where",e,t.firestore._databaseId,this._field,this._op,this._value)}}function cC(i,t,e){const n=t,r=hp("where",i);return na._create(r,n,e)}class ih extends nh{constructor(t,e){super(),this.type=t,this._queryConstraints=e}static _create(t,e){return new ih(t,e)}_parse(t){const e=this._queryConstraints.map(n=>n._parse(t)).filter(n=>n.getFilters().length>0);return e.length===1?e[0]:ps.create(e,this._getOperator())}_apply(t){const e=this._parse(t);return e.getFilters().length===0?t:(function(r,s){let o=r;const a=s.getFlattenedFilters();for(const l of a)up(o,l),o=Nl(o,l)}(t._query,e),new rr(t.firestore,t.converter,Nl(t._query,e)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Cd(i,t,e){if(typeof(e=Hi(e))=="string"){if(e==="")throw new N(j,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!w2(t)&&e.indexOf("/")!==-1)throw new N(j,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${e}' contains a '/' character.`);const n=t.path.child(vt.fromString(e));if(!Rt.isDocumentKey(n))throw new N(j,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return dd(i,new Rt(n))}if(e instanceof Ct)return dd(i,e._key);throw new N(j,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Zo(e)}.`)}function xd(i,t){if(!Array.isArray(i)||i.length===0)throw new N(j,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function up(i,t){const e=function(r,s){for(const o of r)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(i.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(e!==null)throw e===t.op?new N(j,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new N(j,`Invalid query. You cannot use '${t.op.toString()}' filters with '${e.toString()}' filters.`)}class hC{convertValue(t,e="none"){switch(ri(t)){case 0:return null;case 1:return t.booleanValue;case 2:return yt(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Kr(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 11:return this.convertObject(t.mapValue,e);case 10:return this.convertVectorValue(t.mapValue);default:throw mt(62114,{value:t})}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const n={};return Jo(t,(r,s)=>{n[r]=this.convertValue(s,e)}),n}convertVectorValue(t){const e=t.fields?.[uo].arrayValue?.values?.map(n=>yt(n.doubleValue));return new De(e)}convertGeoPoint(t){return new ke(yt(t.latitude),yt(t.longitude))}convertArray(t,e){return(t.values||[]).map(n=>this.convertValue(n,e))}convertServerTimestamp(t,e){switch(e){case"previous":const n=Gg(t);return n==null?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(Hr(t));default:return null}}convertTimestamp(t){const e=ii(t);return new Et(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=vt.fromString(t);Rn(Jg(n),9688,{name:t});const r=new Xr(n.get(1),n.get(3)),s=new Rt(n.popFirst(5));return r.isEqual(e)||Kc(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uC(i,t,e){let n;return n=i?i.toFirestore(t):t,n}class dC extends hC{constructor(t){super(),this.firestore=t}convertBytes(t){return new le(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new Ct(this.firestore,null,e)}}function Sd(i){(function(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new N(kg,"limitToLast() queries require specifying at least one orderBy() clause")})((i=Yc(i,rr))._query);const t=tp(i.firestore),e=new dC(i.firestore);return q2(t,i._query).then(n=>{const r=n.map(s=>new cp(i.firestore,e,s.key,s,i.converter));return i._query.limitType==="L"&&r.reverse(),new oC(i,r)})}function fC(i,t,e){const n=uC((i=Yc(i,Ct)).converter,t),r=tC(rp(i.firestore),"setDoc",i._key,n,i.converter!==null,e);return W2(tp(i.firestore),[r.toMutation(i._key,Rr.none())])}(function(){(function(e){ir=e})(`${EE}_lite`),lo(new Wr("firestore/lite",(t,{instanceIdentifier:e,options:n})=>{const r=t.getProvider("app").getImmediate(),s=new ea(new XE(t.getProvider("auth-internal")),new YE(r,t.getProvider("app-check-internal")),function(a,l){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new N(j,'"projectId" not provided in firebase.initializeApp.');return new Xr(a.options.projectId,l)}(r,e),r);return n&&s._setSettings(n),s},"PUBLIC").setMultipleInstances(!0)),Ni("firestore-lite",Qu,""),Ni("firestore-lite",Qu,"esm2020")})();const _o=class _o{constructor(t,e){this.savePolicy=e,this.collection=t;const n=Rg(_o.firebaseConfig);this.database=K2(n)}async allowedToSubmitScore(t){return this.savePolicy(this,t)}async saveScore(t,e,n){await fC(Y2(this.database,this.collection,t),{userId:t,username:e,score:n})}async getLeaderboard(){const t=[];return(await Sd(Ed(this.database,this.collection))).forEach(n=>{const r=n.data();t.push({username:r.username,score:r.score})}),t.sort((n,r)=>r.score-n.score),t}async getUserId(t){const e=lC(Ed(this.database,this.collection),cC("username","==",t)),n=await Sd(e);return n.size===0?null:n.docs[0].data().userId}};_o.firebaseConfig={authDomain:"switzerland-guess.firebaseapp.com",projectId:"switzerland-guess",storageBucket:"switzerland-guess.appspot.com"};let Gl=_o;async function gC(i,t){return!0}function pC(){let i=localStorage.getItem("userId");return i||(i=crypto.randomUUID(),localStorage.setItem("userId",i)),{userId:i,username:localStorage.getItem("username")}}function mC(i){localStorage.setItem("username",i)}var _C=Object.defineProperty,yC=Object.getOwnPropertyDescriptor,hi=(i,t,e,n)=>{for(var r=n>1?void 0:n?yC(t,e):t,s=i.length-1,o;s>=0;s--)(o=i[s])&&(r=(n?o(t,e,r):o(r))||r);return n&&r&&_C(t,e,r),r};let An=class extends Ko(Zt){constructor(){super(...arguments),this.localize=new Ji(this),this.userInfo=pC(),this.scores=[],this.allowedToSubmitScore=!1}async willUpdate(i){i.has("gameState")&&this.gameState.country&&this.leaderboard?.collection!==this.gameState.country&&(this.leaderboard=new Gl(this.gameState.country,gC),this.scores=await this.leaderboard.getLeaderboard(),this.userInfo&&(this.allowedToSubmitScore=await this.leaderboard.allowedToSubmitScore(this.userInfo.userId)))}render(){return Y`
      <wa-dialog label="${this.localize.term("game_over")}">
        <div class="wa-stack wa-gap-2xl">
          <wa-callout variant="success">
            <wa-icon slot="icon" name="thumbs-up" variant="solid"></wa-icon>
            ${this.localize.term("your_score")}: <strong>${Nu(this.gameState)}</strong>
          </wa-callout>
          <!-- FIXME: check allowedToSubmitScore -->
          <wa-button class="save_score" variant="success" @click="${this.saveScore}">${this.localize.term("submit_score")}</wa-button>
          <element-leaderboard .scores="${this.scores}" .username="${this.userInfo.username}"></element-leaderboard>
        </div>
        <wa-button slot="footer" variant="brand" data-dialog="close">${this.localize.term("new_game")}</wa-button>
      </wa-dialog>
      <element-username .leaderboard="${this.leaderboard}" @username="${this.handleUsernameSet}"></element-username>
    `}async handleUsernameSet(i){const t=i.detail;this.userInfo={...this.userInfo,username:t},mC(t),await this.saveScoreToLeaderboard()}async saveScore(){console.log(this.userInfo),this.userInfo.username===null?this.usernameElement.open=!0:await this.saveScoreToLeaderboard()}async saveScoreToLeaderboard(){this.allowedToSubmitScore&&(await this.leaderboard.saveScore(this.userInfo.userId,this.userInfo.username,Nu(this.gameState)),this.allowedToSubmitScore=await this.leaderboard.allowedToSubmitScore(this.userInfo),this.scores=await this.leaderboard.getLeaderboard()),this.saveScoreButton.disabled=!0}createRenderRoot(){return this}};hi([Kl({context:qo,subscribe:!0}),Fe()],An.prototype,"gameState",2);hi([Fe()],An.prototype,"userInfo",2);hi([Fe()],An.prototype,"scores",2);hi([Fe()],An.prototype,"allowedToSubmitScore",2);hi([Ne("element-username")],An.prototype,"usernameElement",2);hi([Ne(".save_score")],An.prototype,"saveScoreButton",2);An=hi([Nt("element-scores")],An);Object.assign(_p.requestsByServer,{"assets.ion.cesium.com:443":28,"wmts.geo.admin.ch:443":28,"3d.geo.admin.ch:443":28});Ep.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI3NDYzNDViMS01OGZjLTRkMDMtOWQzYi00YTI2NDBmOWNjYzYiLCJpZCI6MjE3NTQsImlhdCI6MTcyODMwMTczM30.JlQVQBkpUc1LW65CyWbH_2ZLz-3u6WDkjR9nBI25VYI";async function wC(i){const t=new yp(i,{scene3DOnly:!0,skyBox:!1,requestRenderMode:!0,baseLayer:vp.fromProviderAsync(bp.fromAssetId(3830182)),terrainProvider:await wp.fromIonAssetId(1)});return t.scene.globe.showGroundAtmosphere=!0,t.scene.globe.enableLighting=!0,t.scene.globe.preloadSiblings=!0,t}function Id(i,t){i.camera.setView({destination:_e.fromDegrees(t[0],t[1],4e3),orientation:{heading:Nn.toRadians(Math.random()*360),pitch:0}})}var vC=Object.defineProperty,bC=Object.getOwnPropertyDescriptor,ia=(i,t,e,n)=>{for(var r=n>1?void 0:n?bC(t,e):t,s=i.length-1,o;s>=0;s--)(o=i[s])&&(r=(n?o(t,e,r):o(r))||r);return n&&r&&vC(t,e,r),r};let Qr=class extends Zt{constructor(){super(...arguments),this.gameState={country:null,cameraPosition:null,guessedPosition:null,score:null,distance:null,scores:[],roundPerGame:3},this.viewer=null}updated(){this.gameState.country!==null&&!Ba(this.gameState)&&(this.gameState=Fu(this.gameState,Vh(this.gameState.country)),Id(this.viewer,this.gameState.cameraPosition))}render(){return Y`
      <element-country-selector .open="${this.gameState.country==null}"
        @country-selected="${this.handleCountrySelected}"
      ></element-country-selector>
      <div id="cesium"></div>
      <div class="header">
        <cesium-compass-bar></cesium-compass-bar>
      </div>
      <element-guess ?hidden="${!Ba(this.gameState)}" @guess="${this.handleGuess}"></element-guess>
      <element-result @close="${this.handleCloseResult}" @gameOver="${this.handleGameOver}"></element-result>
      <element-scores @close="${this.handleCloseScores}"></element-scores>
    `}async firstUpdated(){this.viewer=await wC(this.querySelector("#cesium"));const i=new U_(this.viewer);i.active=!0;const t=this.querySelector("cesium-compass-bar");t.scene=this.viewer.scene}handleCountrySelected(i){this.gameState={...this.gameState,country:i.detail}}handleGuess(i){this.resultElement.open=!0,this.gameState=w1(this.gameState,i.detail)}handleGameOver(){this.scoresElement.open=!0}handleCloseResult(){Ba(this.gameState)&&(this.gameState=Fu(this.gameState,Vh(this.gameState.country)),Id(this.viewer,this.gameState.cameraPosition))}handleCloseScores(){this.gameState=y1(this.gameState)}createRenderRoot(){return this}};ia([zp({context:qo}),Fe()],Qr.prototype,"gameState",2);ia([Ne("element-result")],Qr.prototype,"resultElement",2);ia([Ne("element-scores")],Qr.prototype,"scoresElement",2);Qr=ia([Nt("element-app")],Qr);jl(xp,Cp,Sp);const Td=["fr","de","en"],Za=new URL(location).searchParams.get("lang");if(Za&&Td.includes(Za))document.documentElement.lang=Za;else for(const i of navigator.languages)if(Td.includes(i.substring(0,2))){document.documentElement.lang=i;break}
