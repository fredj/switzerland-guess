import{c as il}from"./countries-DSqLr7v5.js";import{R as Hf,S as ai,C as ca,a as gt,b as An,c as Xf,d as t_,e as e_,f as n_,I as i_,g as r_,h as xo,i as s_,P as o_,j as a_,M as l_,k as c_,l as bu,m as h_}from"./cesium-BXvs4Uvn.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=e(r);fetch(r.href,s)}})();const Hl=new Set,Qi=new Map;let hi,qc="ltr",Hc="en";const Kf=typeof MutationObserver<"u"&&typeof document<"u"&&typeof document.documentElement<"u";if(Kf){const n=new MutationObserver(Yf);qc=document.documentElement.dir||"ltr",Hc=document.documentElement.lang||navigator.language,n.observe(document.documentElement,{attributes:!0,attributeFilter:["dir","lang"]})}function Xc(...n){n.map(t=>{const e=t.$code.toLowerCase();Qi.has(e)?Qi.set(e,Object.assign(Object.assign({},Qi.get(e)),t)):Qi.set(e,t),hi||(hi=t)}),Yf()}function Yf(){Kf&&(qc=document.documentElement.dir||"ltr",Hc=document.documentElement.lang||navigator.language),[...Hl.keys()].map(n=>{typeof n.requestUpdate=="function"&&n.requestUpdate()})}let Jn=class{constructor(t){this.host=t,this.host.addController(this)}hostConnected(){Hl.add(this.host)}hostDisconnected(){Hl.delete(this.host)}dir(){return`${this.host.dir||qc}`.toLowerCase()}lang(){return`${this.host.lang||Hc}`.toLowerCase()}getTranslationData(t){var e,i;const r=new Intl.Locale(t.replace(/_/g,"-")),s=r?.language.toLowerCase(),o=(i=(e=r?.region)===null||e===void 0?void 0:e.toLowerCase())!==null&&i!==void 0?i:"",a=Qi.get(`${s}-${o}`),l=Qi.get(s);return{locale:r,language:s,region:o,primary:a,secondary:l}}exists(t,e){var i;const{primary:r,secondary:s}=this.getTranslationData((i=e.lang)!==null&&i!==void 0?i:this.lang());return e=Object.assign({includeFallback:!1},e),!!(r&&r[t]||s&&s[t]||e.includeFallback&&hi&&hi[t])}term(t,...e){const{primary:i,secondary:r}=this.getTranslationData(this.lang());let s;if(i&&i[t])s=i[t];else if(r&&r[t])s=r[t];else if(hi&&hi[t])s=hi[t];else return console.error(`No translation found for: ${String(t)}`),String(t);return typeof s=="function"?s(...e):s}date(t,e){return t=new Date(t),new Intl.DateTimeFormat(this.lang(),e).format(t)}number(t,e){return t=Number(t),isNaN(t)?"":new Intl.NumberFormat(this.lang(),e).format(t)}relativeTime(t,e,i){return new Intl.RelativeTimeFormat(this.lang(),i).format(t,e)}};const u_={$code:"fr",$name:"Français",$dir:"ltr",about_us:"À propos de nous",close:"Fermer",choose_country:"Choisir un pays",switzerland:"Suisse",france:"France",germany:"Allemagne",where_are_you:"Où êtes-vous ?",guess:"Deviner",next_round:"Tour suivant",scores:"Scores",points:"points",round:"Tour",game_over:"Vous avez terminé !",your_score:"Votre score",username:"Ton nom",submit_score:"Soumettre le score",new_game:"Rejouer",no_username:"Aucun nom d'utilisateur saisi",username_taken:"Nom d'utilisateur déjà pris",save:"Enregistrer"},d_={$code:"en",$name:"English",$dir:"ltr",about_us:"About us",close:"Close",choose_country:"Choose a country",switzerland:"Switzerland",france:"France",germany:"Germany",where_are_you:"Where are you?",guess:"Guess",next_round:"Next round",scores:"Scores",points:"points",round:"Round",game_over:"You finished!",your_score:"Your score",username:"Your name",submit_score:"Save score",new_game:"Play again",no_username:"No username entered",username_taken:"Username already taken",save:"Save"},f_={$code:"de",$name:"Deutsch",$dir:"ltr",about_us:"Über uns",close:"Schließen",choose_country:"Wählen Sie ein Land",switzerland:"Schweiz",france:"Frankreich",germany:"Deutschland",where_are_you:"Wo sind Sie?",guess:"Raten",next_round:"Nächste Runde",scores:"Punktestand",points:"Punkte",round:"Runde",game_over:"Sie sind fertig!",your_score:"Ihre Punktzahl",username:"Dein Name",submit_score:"Punktzahl einreichen",new_game:"Nochmal spielen",no_username:"Kein Benutzername eingegeben",username_taken:"Benutzername bereits vergeben",save:"Speichern"};const bt=n=>(t,e)=>{e!==void 0?e.addInitializer((()=>{customElements.define(n,t)})):customElements.define(n,t)};const wo=globalThis,Kc=wo.ShadowRoot&&(wo.ShadyCSS===void 0||wo.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Yc=Symbol(),Eu=new WeakMap;let Zf=class{constructor(t,e,i){if(this._$cssResult$=!0,i!==Yc)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t,this.t=e}get styleSheet(){let t=this.o;const e=this.t;if(Kc&&t===void 0){const i=e!==void 0&&e.length===1;i&&(t=Eu.get(e)),t===void 0&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),i&&Eu.set(e,t))}return t}toString(){return this.cssText}};const Jf=n=>new Zf(typeof n=="string"?n:n+"",void 0,Yc),Qf=(n,...t)=>{const e=n.length===1?n[0]:t.reduce(((i,r,s)=>i+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(r)+n[s+1]),n[0]);return new Zf(e,n,Yc)},g_=(n,t)=>{if(Kc)n.adoptedStyleSheets=t.map((e=>e instanceof CSSStyleSheet?e:e.styleSheet));else for(const e of t){const i=document.createElement("style"),r=wo.litNonce;r!==void 0&&i.setAttribute("nonce",r),i.textContent=e.cssText,n.appendChild(i)}},xu=Kc?n=>n:n=>n instanceof CSSStyleSheet?(t=>{let e="";for(const i of t.cssRules)e+=i.cssText;return Jf(e)})(n):n;const{is:p_,defineProperty:m_,getOwnPropertyDescriptor:__,getOwnPropertyNames:y_,getOwnPropertySymbols:w_,getPrototypeOf:v_}=Object,ha=globalThis,Cu=ha.trustedTypes,b_=Cu?Cu.emptyScript:"",E_=ha.reactiveElementPolyfillSupport,es=(n,t)=>n,Co={toAttribute(n,t){switch(t){case Boolean:n=n?b_:null;break;case Object:case Array:n=n==null?n:JSON.stringify(n)}return n},fromAttribute(n,t){let e=n;switch(t){case Boolean:e=n!==null;break;case Number:e=n===null?null:Number(n);break;case Object:case Array:try{e=JSON.parse(n)}catch{e=null}}return e}},Zc=(n,t)=>!p_(n,t),Su={attribute:!0,type:String,converter:Co,reflect:!1,useDefault:!1,hasChanged:Zc};Symbol.metadata??=Symbol("metadata"),ha.litPropertyMetadata??=new WeakMap;let Xi=class extends HTMLElement{static addInitializer(t){this._$Ei(),(this.l??=[]).push(t)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(t,e=Su){if(e.state&&(e.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(t)&&((e=Object.create(e)).wrapped=!0),this.elementProperties.set(t,e),!e.noAccessor){const i=Symbol(),r=this.getPropertyDescriptor(t,i,e);r!==void 0&&m_(this.prototype,t,r)}}static getPropertyDescriptor(t,e,i){const{get:r,set:s}=__(this.prototype,t)??{get(){return this[e]},set(o){this[e]=o}};return{get:r,set(o){const a=r?.call(this);s?.call(this,o),this.requestUpdate(t,a,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)??Su}static _$Ei(){if(this.hasOwnProperty(es("elementProperties")))return;const t=v_(this);t.finalize(),t.l!==void 0&&(this.l=[...t.l]),this.elementProperties=new Map(t.elementProperties)}static finalize(){if(this.hasOwnProperty(es("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(es("properties"))){const e=this.properties,i=[...y_(e),...w_(e)];for(const r of i)this.createProperty(r,e[r])}const t=this[Symbol.metadata];if(t!==null){const e=litPropertyMetadata.get(t);if(e!==void 0)for(const[i,r]of e)this.elementProperties.set(i,r)}this._$Eh=new Map;for(const[e,i]of this.elementProperties){const r=this._$Eu(e,i);r!==void 0&&this._$Eh.set(r,e)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(t){const e=[];if(Array.isArray(t)){const i=new Set(t.flat(1/0).reverse());for(const r of i)e.unshift(xu(r))}else t!==void 0&&e.push(xu(t));return e}static _$Eu(t,e){const i=e.attribute;return i===!1?void 0:typeof i=="string"?i:typeof t=="string"?t.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach((t=>t(this)))}addController(t){(this._$EO??=new Set).add(t),this.renderRoot!==void 0&&this.isConnected&&t.hostConnected?.()}removeController(t){this._$EO?.delete(t)}_$E_(){const t=new Map,e=this.constructor.elementProperties;for(const i of e.keys())this.hasOwnProperty(i)&&(t.set(i,this[i]),delete this[i]);t.size>0&&(this._$Ep=t)}createRenderRoot(){const t=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return g_(t,this.constructor.elementStyles),t}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach((t=>t.hostConnected?.()))}enableUpdating(t){}disconnectedCallback(){this._$EO?.forEach((t=>t.hostDisconnected?.()))}attributeChangedCallback(t,e,i){this._$AK(t,i)}_$ET(t,e){const i=this.constructor.elementProperties.get(t),r=this.constructor._$Eu(t,i);if(r!==void 0&&i.reflect===!0){const s=(i.converter?.toAttribute!==void 0?i.converter:Co).toAttribute(e,i.type);this._$Em=t,s==null?this.removeAttribute(r):this.setAttribute(r,s),this._$Em=null}}_$AK(t,e){const i=this.constructor,r=i._$Eh.get(t);if(r!==void 0&&this._$Em!==r){const s=i.getPropertyOptions(r),o=typeof s.converter=="function"?{fromAttribute:s.converter}:s.converter?.fromAttribute!==void 0?s.converter:Co;this._$Em=r;const a=o.fromAttribute(e,s.type);this[r]=a??this._$Ej?.get(r)??a,this._$Em=null}}requestUpdate(t,e,i){if(t!==void 0){const r=this.constructor,s=this[t];if(i??=r.getPropertyOptions(t),!((i.hasChanged??Zc)(s,e)||i.useDefault&&i.reflect&&s===this._$Ej?.get(t)&&!this.hasAttribute(r._$Eu(t,i))))return;this.C(t,e,i)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(t,e,{useDefault:i,reflect:r,wrapped:s},o){i&&!(this._$Ej??=new Map).has(t)&&(this._$Ej.set(t,o??e??this[t]),s!==!0||o!==void 0)||(this._$AL.has(t)||(this.hasUpdated||i||(e=void 0),this._$AL.set(t,e)),r===!0&&this._$Em!==t&&(this._$Eq??=new Set).add(t))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(e){Promise.reject(e)}const t=this.scheduleUpdate();return t!=null&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[r,s]of this._$Ep)this[r]=s;this._$Ep=void 0}const i=this.constructor.elementProperties;if(i.size>0)for(const[r,s]of i){const{wrapped:o}=s,a=this[r];o!==!0||this._$AL.has(r)||a===void 0||this.C(r,void 0,s,a)}}let t=!1;const e=this._$AL;try{t=this.shouldUpdate(e),t?(this.willUpdate(e),this._$EO?.forEach((i=>i.hostUpdate?.())),this.update(e)):this._$EM()}catch(i){throw t=!1,this._$EM(),i}t&&this._$AE(e)}willUpdate(t){}_$AE(t){this._$EO?.forEach((e=>e.hostUpdated?.())),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(t){return!0}update(t){this._$Eq&&=this._$Eq.forEach((e=>this._$ET(e,this[e]))),this._$EM()}updated(t){}firstUpdated(t){}};Xi.elementStyles=[],Xi.shadowRootOptions={mode:"open"},Xi[es("elementProperties")]=new Map,Xi[es("finalized")]=new Map,E_?.({ReactiveElement:Xi}),(ha.reactiveElementVersions??=[]).push("2.1.1");const x_={attribute:!0,type:String,converter:Co,reflect:!1,hasChanged:Zc},C_=(n=x_,t,e)=>{const{kind:i,metadata:r}=e;let s=globalThis.litPropertyMetadata.get(r);if(s===void 0&&globalThis.litPropertyMetadata.set(r,s=new Map),i==="setter"&&((n=Object.create(n)).wrapped=!0),s.set(e.name,n),i==="accessor"){const{name:o}=e;return{set(a){const l=t.get.call(this);t.set.call(this,a),this.requestUpdate(o,l,n)},init(a){return a!==void 0&&this.C(o,void 0,n,a),a}}}if(i==="setter"){const{name:o}=e;return function(a){const l=this[o];t.call(this,a),this.requestUpdate(o,l,n)}}throw Error("Unsupported decorator location: "+i)};function P(n){return(t,e)=>typeof e=="object"?C_(n,t,e):((i,r,s)=>{const o=r.hasOwnProperty(s);return r.constructor.createProperty(s,i),o?Object.getOwnPropertyDescriptor(r,s):void 0})(n,t,e)}function Ft(n){return P({...n,state:!0,attribute:!1})}const tg=(n,t,e)=>(e.configurable=!0,e.enumerable=!0,Reflect.decorate&&typeof t!="object"&&Object.defineProperty(n,t,e),e);function At(n,t){return(e,i,r)=>{const s=o=>o.renderRoot?.querySelector(n)??null;return tg(e,i,{get(){return s(this)}})}}let S_;function T_(n){return(t,e)=>tg(t,e,{get(){return(this.renderRoot??(S_??=document.createDocumentFragment())).querySelectorAll(n)}})}let eg=class extends Event{constructor(t,e,i,r){super("context-request",{bubbles:!0,composed:!0}),this.context=t,this.contextTarget=e,this.callback=i,this.subscribe=r??!1}};let Tu=class{constructor(t,e,i,r){if(this.subscribe=!1,this.provided=!1,this.value=void 0,this.t=(s,o)=>{this.unsubscribe&&(this.unsubscribe!==o&&(this.provided=!1,this.unsubscribe()),this.subscribe||this.unsubscribe()),this.value=s,this.host.requestUpdate(),this.provided&&!this.subscribe||(this.provided=!0,this.callback&&this.callback(s,o)),this.unsubscribe=o},this.host=t,e.context!==void 0){const s=e;this.context=s.context,this.callback=s.callback,this.subscribe=s.subscribe??!1}else this.context=e,this.callback=i,this.subscribe=r??!1;this.host.addController(this)}hostConnected(){this.dispatchRequest()}hostDisconnected(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=void 0)}dispatchRequest(){this.host.dispatchEvent(new eg(this.context,this.host,this.t,this.subscribe))}};let I_=class{get value(){return this.o}set value(t){this.setValue(t)}setValue(t,e=!1){const i=e||!Object.is(t,this.o);this.o=t,i&&this.updateObservers()}constructor(t){this.subscriptions=new Map,this.updateObservers=()=>{for(const[e,{disposer:i}]of this.subscriptions)e(this.o,i)},t!==void 0&&(this.value=t)}addCallback(t,e,i){if(!i)return void t(this.value);this.subscriptions.has(t)||this.subscriptions.set(t,{disposer:()=>{this.subscriptions.delete(t)},consumerHost:e});const{disposer:r}=this.subscriptions.get(t);t(this.value,r)}clearCallbacks(){this.subscriptions.clear()}};let R_=class extends Event{constructor(t,e){super("context-provider",{bubbles:!0,composed:!0}),this.context=t,this.contextTarget=e}},Iu=class extends I_{constructor(t,e,i){super(e.context!==void 0?e.initialValue:i),this.onContextRequest=r=>{if(r.context!==this.context)return;const s=r.contextTarget??r.composedPath()[0];s!==this.host&&(r.stopPropagation(),this.addCallback(r.callback,s,r.subscribe))},this.onProviderRequest=r=>{if(r.context!==this.context||(r.contextTarget??r.composedPath()[0])===this.host)return;const s=new Set;for(const[o,{consumerHost:a}]of this.subscriptions)s.has(o)||(s.add(o),a.dispatchEvent(new eg(this.context,a,o,!0)));r.stopPropagation()},this.host=t,e.context!==void 0?this.context=e.context:this.context=e,this.attachListeners(),this.host.addController?.(this)}attachListeners(){this.host.addEventListener("context-request",this.onContextRequest),this.host.addEventListener("context-provider",this.onProviderRequest)}hostConnected(){this.host.dispatchEvent(new R_(this.context,this.host))}};function A_({context:n}){return(t,e)=>{const i=new WeakMap;if(typeof e=="object")return{get(){return t.get.call(this)},set(r){return i.get(this).setValue(r),t.set.call(this,r)},init(r){return i.set(this,new Iu(this,{context:n,initialValue:r})),r}};{t.constructor.addInitializer((o=>{i.set(o,new Iu(o,{context:n}))}));const r=Object.getOwnPropertyDescriptor(t,e);let s;if(r===void 0){const o=new WeakMap;s={get(){return o.get(this)},set(a){i.get(this).setValue(a),o.set(this,a)},configurable:!0,enumerable:!0}}else{const o=r.set;s={...r,set(a){i.get(this).setValue(a),o?.call(this,a)}}}return void Object.defineProperty(t,e,s)}}}function Jc({context:n,subscribe:t}){return(e,i)=>{typeof i=="object"?i.addInitializer((function(){new Tu(this,{context:n,callback:r=>{e.set.call(this,r)},subscribe:t})})):e.constructor.addInitializer((r=>{new Tu(r,{context:n,callback:s=>{r[i]=s},subscribe:t})}))}}function P_(n,t,e={}){const i={type:"Feature"};return(e.id===0||e.id)&&(i.id=e.id),e.bbox&&(i.bbox=e.bbox),i.properties={},i.geometry=n,i}function rl(n,t,e={}){return P_({type:"MultiPolygon",coordinates:n},t,e)}function L_(n){return!isNaN(n)&&n!==null&&!Array.isArray(n)}function Ru(n){if(!n)throw new Error("bbox is required");if(!Array.isArray(n))throw new Error("bbox must be an Array");if(n.length!==4&&n.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");n.forEach(t=>{if(!L_(t))throw new Error("bbox must only contain numbers")})}function ng(n,t,e){if(n!==null)for(var i,r,s,o,a,l,c,h=0,u=0,d,f=n.type,g=f==="FeatureCollection",y=f==="Feature",_=g?n.features.length:1,b=0;b<_;b++){c=g?n.features[b].geometry:y?n.geometry:n,d=c?c.type==="GeometryCollection":!1,a=d?c.geometries.length:1;for(var S=0;S<a;S++){var R=0,T=0;if(o=d?c.geometries[S]:c,o!==null){l=o.coordinates;var I=o.type;switch(h=0,I){case null:break;case"Point":if(t(l,u,b,R,T)===!1)return!1;u++,R++;break;case"LineString":case"MultiPoint":for(i=0;i<l.length;i++){if(t(l[i],u,b,R,T)===!1)return!1;u++,I==="MultiPoint"&&R++}I==="LineString"&&R++;break;case"Polygon":case"MultiLineString":for(i=0;i<l.length;i++){for(r=0;r<l[i].length-h;r++){if(t(l[i][r],u,b,R,T)===!1)return!1;u++}I==="MultiLineString"&&R++,I==="Polygon"&&T++}I==="Polygon"&&R++;break;case"MultiPolygon":for(i=0;i<l.length;i++){for(T=0,r=0;r<l[i].length;r++){for(s=0;s<l[i][r].length-h;s++){if(t(l[i][r][s],u,b,R,T)===!1)return!1;u++}T++}R++}break;case"GeometryCollection":for(i=0;i<o.geometries.length;i++)if(ng(o.geometries[i],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function O_(n,t={}){if(n.bbox!=null&&t.recompute!==!0)return n.bbox;const e=[1/0,1/0,-1/0,-1/0];return ng(n,i=>{e[0]>i[0]&&(e[0]=i[0]),e[1]>i[1]&&(e[1]=i[1]),e[2]<i[0]&&(e[2]=i[0]),e[3]<i[1]&&(e[3]=i[1])}),e}var ns=O_;const an=11102230246251565e-32,Vt=134217729,k_=(3+8*an)*an;function sl(n,t,e,i,r){let s,o,a,l,c=t[0],h=i[0],u=0,d=0;h>c==h>-c?(s=c,c=t[++u]):(s=h,h=i[++d]);let f=0;if(u<n&&d<e)for(h>c==h>-c?(o=c+s,a=s-(o-c),c=t[++u]):(o=h+s,a=s-(o-h),h=i[++d]),s=o,a!==0&&(r[f++]=a);u<n&&d<e;)h>c==h>-c?(o=s+c,l=o-s,a=s-(o-l)+(c-l),c=t[++u]):(o=s+h,l=o-s,a=s-(o-l)+(h-l),h=i[++d]),s=o,a!==0&&(r[f++]=a);for(;u<n;)o=s+c,l=o-s,a=s-(o-l)+(c-l),c=t[++u],s=o,a!==0&&(r[f++]=a);for(;d<e;)o=s+h,l=o-s,a=s-(o-l)+(h-l),h=i[++d],s=o,a!==0&&(r[f++]=a);return(s!==0||f===0)&&(r[f++]=s),f}function D_(n,t){let e=t[0];for(let i=1;i<n;i++)e+=t[i];return e}function Ms(n){return new Float64Array(n)}const M_=(3+16*an)*an,F_=(2+12*an)*an,N_=(9+64*an)*an*an,Vi=Ms(4),Au=Ms(8),Pu=Ms(12),Lu=Ms(16),Wt=Ms(4);function $_(n,t,e,i,r,s,o){let a,l,c,h,u,d,f,g,y,_,b,S,R,T,I,L,w,p;const m=n-r,E=e-r,x=t-s,C=i-s;T=m*C,d=Vt*m,f=d-(d-m),g=m-f,d=Vt*C,y=d-(d-C),_=C-y,I=g*_-(T-f*y-g*y-f*_),L=x*E,d=Vt*x,f=d-(d-x),g=x-f,d=Vt*E,y=d-(d-E),_=E-y,w=g*_-(L-f*y-g*y-f*_),b=I-w,u=I-b,Vi[0]=I-(b+u)+(u-w),S=T+b,u=S-T,R=T-(S-u)+(b-u),b=R-L,u=R-b,Vi[1]=R-(b+u)+(u-L),p=S+b,u=p-S,Vi[2]=S-(p-u)+(b-u),Vi[3]=p;let v=D_(4,Vi),M=F_*o;if(v>=M||-v>=M||(u=n-m,a=n-(m+u)+(u-r),u=e-E,c=e-(E+u)+(u-r),u=t-x,l=t-(x+u)+(u-s),u=i-C,h=i-(C+u)+(u-s),a===0&&l===0&&c===0&&h===0)||(M=N_*o+k_*Math.abs(v),v+=m*h+C*a-(x*c+E*l),v>=M||-v>=M))return v;T=a*C,d=Vt*a,f=d-(d-a),g=a-f,d=Vt*C,y=d-(d-C),_=C-y,I=g*_-(T-f*y-g*y-f*_),L=l*E,d=Vt*l,f=d-(d-l),g=l-f,d=Vt*E,y=d-(d-E),_=E-y,w=g*_-(L-f*y-g*y-f*_),b=I-w,u=I-b,Wt[0]=I-(b+u)+(u-w),S=T+b,u=S-T,R=T-(S-u)+(b-u),b=R-L,u=R-b,Wt[1]=R-(b+u)+(u-L),p=S+b,u=p-S,Wt[2]=S-(p-u)+(b-u),Wt[3]=p;const F=sl(4,Vi,4,Wt,Au);T=m*h,d=Vt*m,f=d-(d-m),g=m-f,d=Vt*h,y=d-(d-h),_=h-y,I=g*_-(T-f*y-g*y-f*_),L=x*c,d=Vt*x,f=d-(d-x),g=x-f,d=Vt*c,y=d-(d-c),_=c-y,w=g*_-(L-f*y-g*y-f*_),b=I-w,u=I-b,Wt[0]=I-(b+u)+(u-w),S=T+b,u=S-T,R=T-(S-u)+(b-u),b=R-L,u=R-b,Wt[1]=R-(b+u)+(u-L),p=S+b,u=p-S,Wt[2]=S-(p-u)+(b-u),Wt[3]=p;const $=sl(F,Au,4,Wt,Pu);T=a*h,d=Vt*a,f=d-(d-a),g=a-f,d=Vt*h,y=d-(d-h),_=h-y,I=g*_-(T-f*y-g*y-f*_),L=l*c,d=Vt*l,f=d-(d-l),g=l-f,d=Vt*c,y=d-(d-c),_=c-y,w=g*_-(L-f*y-g*y-f*_),b=I-w,u=I-b,Wt[0]=I-(b+u)+(u-w),S=T+b,u=S-T,R=T-(S-u)+(b-u),b=R-L,u=R-b,Wt[1]=R-(b+u)+(u-L),p=S+b,u=p-S,Wt[2]=S-(p-u)+(b-u),Wt[3]=p;const D=sl($,Pu,4,Wt,Lu);return Lu[D-1]}function V_(n,t,e,i,r,s){const o=(t-s)*(e-r),a=(n-r)*(i-s),l=o-a,c=Math.abs(o+a);return Math.abs(l)>=M_*c?l:-$_(n,t,e,i,r,s,c)}function z_(n,t){var e,i,r=0,s,o,a,l,c,h,u,d=n[0],f=n[1],g=t.length;for(e=0;e<g;e++){i=0;var y=t[e],_=y.length-1;if(h=y[0],h[0]!==y[_][0]&&h[1]!==y[_][1])throw new Error("First and last coordinates in a ring must be the same");for(o=h[0]-d,a=h[1]-f,i;i<_;i++){if(u=y[i+1],l=u[0]-d,c=u[1]-f,a===0&&c===0){if(l<=0&&o>=0||o<=0&&l>=0)return 0}else if(c>=0&&a<=0||c<=0&&a>=0){if(s=V_(o,l,a,c,0,0),s===0)return 0;(s>0&&c>0&&a<=0||s<0&&c<=0&&a>0)&&r++}h=u,a=c,o=l}}return r%2!==0}function G_(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return[...n.geometry.coordinates];if(n.type==="Point")return[...n.coordinates]}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return[...n];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function B_(n){return n.type==="Feature"?n.geometry:n}function U_(n,t,e={}){if(!n)throw new Error("point is required");if(!t)throw new Error("polygon is required");const i=G_(n),r=B_(t),s=r.type,o=t.bbox;let a=r.coordinates;if(o&&j_(i,o)===!1)return!1;s==="Polygon"&&(a=[a]);let l=!1;for(var c=0;c<a.length;++c){const h=z_(i,a[c]);if(h===0)return!e.ignoreBoundary;h&&(l=!0)}return l}function j_(n,t){return t[0]<=n[0]&&t[1]<=n[1]&&t[2]>=n[0]&&t[3]>=n[1]}var ig=U_;function Ou(n){return q_(n),W_(n)}function W_(n){return Array.isArray(n)?ku(n):n&&n.bbox?ku(n.bbox):[H_(),X_()]}function q_(n){n!=null&&(Array.isArray(n)?Ru(n):n.bbox!=null&&Ru(n.bbox))}function rg(){return Math.random()-.5}function H_(){return rg()*360}function X_(){return rg()*180}function ku(n){return[Math.random()*(n[2]-n[0])+n[0],Math.random()*(n[3]-n[1])+n[1]]}function K_(n,t,e){let i,r;e=e||ln;let s=0,o=n.length,a=!1;for(;s<o;)i=s+(o-s>>1),r=+e(n[i],t),r<0?s=i+1:(o=i,a=!r);return a?s:~s}function ln(n,t){return n>t?1:n<t?-1:0}function Y_(n,t){return n<t?1:n>t?-1:0}function Qc(n,t,e){if(n[0]<=t)return 0;const i=n.length;if(t<=n[i-1])return i-1;if(typeof e=="function"){for(let r=1;r<i;++r){const s=n[r];if(s===t)return r;if(s<t)return e(t,n[r-1],s)>0?r-1:r}return i-1}if(e>0){for(let r=1;r<i;++r)if(n[r]<t)return r-1;return i-1}if(e<0){for(let r=1;r<i;++r)if(n[r]<=t)return r;return i-1}for(let r=1;r<i;++r){if(n[r]==t)return r;if(n[r]<t)return n[r-1]-t<t-n[r]?r-1:r}return i-1}function Z_(n,t,e){for(;t<e;){const i=n[t];n[t]=n[e],n[e]=i,++t,--e}}function je(n,t){const e=Array.isArray(t)?t:[t],i=e.length;for(let r=0;r<i;r++)n[n.length]=e[r]}function Qn(n,t){const e=n.length;if(e!==t.length)return!1;for(let i=0;i<e;i++)if(n[i]!==t[i])return!1;return!0}function J_(n,t,e){const i=t||ln;return n.every(function(r,s){if(s===0)return!0;const o=i(n[s-1],r);return!(o>0||o===0)})}const Lt={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function Du(n){const t=Ce();for(let e=0,i=n.length;e<i;++e)is(t,n[e]);return t}function Q_(n,t,e){const i=Math.min.apply(null,n),r=Math.min.apply(null,t),s=Math.max.apply(null,n),o=Math.max.apply(null,t);return dn(i,r,s,o,e)}function th(n,t,e){return e?(e[0]=n[0]-t,e[1]=n[1]-t,e[2]=n[2]+t,e[3]=n[3]+t,e):[n[0]-t,n[1]-t,n[2]+t,n[3]+t]}function sg(n,t){return t?(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t):n.slice()}function Ai(n,t,e){let i,r;return t<n[0]?i=n[0]-t:n[2]<t?i=t-n[2]:i=0,e<n[1]?r=n[1]-e:n[3]<e?r=e-n[3]:r=0,i*i+r*r}function cr(n,t){return eh(n,t[0],t[1])}function Kr(n,t){return n[0]<=t[0]&&t[2]<=n[2]&&n[1]<=t[1]&&t[3]<=n[3]}function eh(n,t,e){return n[0]<=t&&t<=n[2]&&n[1]<=e&&e<=n[3]}function Xl(n,t){const e=n[0],i=n[1],r=n[2],s=n[3],o=t[0],a=t[1];let l=Lt.UNKNOWN;return o<e?l=l|Lt.LEFT:o>r&&(l=l|Lt.RIGHT),a<i?l=l|Lt.BELOW:a>s&&(l=l|Lt.ABOVE),l===Lt.UNKNOWN&&(l=Lt.INTERSECTING),l}function Ce(){return[1/0,1/0,-1/0,-1/0]}function dn(n,t,e,i,r){return r?(r[0]=n,r[1]=t,r[2]=e,r[3]=i,r):[n,t,e,i]}function Ir(n){return dn(1/0,1/0,-1/0,-1/0,n)}function og(n,t){const e=n[0],i=n[1];return dn(e,i,e,i,t)}function nh(n,t,e,i,r){const s=Ir(r);return lg(s,n,t,e,i)}function ds(n,t){return n[0]==t[0]&&n[2]==t[2]&&n[1]==t[1]&&n[3]==t[3]}function ag(n,t){return t[0]<n[0]&&(n[0]=t[0]),t[2]>n[2]&&(n[2]=t[2]),t[1]<n[1]&&(n[1]=t[1]),t[3]>n[3]&&(n[3]=t[3]),n}function is(n,t){t[0]<n[0]&&(n[0]=t[0]),t[0]>n[2]&&(n[2]=t[0]),t[1]<n[1]&&(n[1]=t[1]),t[1]>n[3]&&(n[3]=t[1])}function lg(n,t,e,i,r){for(;e<i;e+=r)ty(n,t[e],t[e+1]);return n}function ty(n,t,e){n[0]=Math.min(n[0],t),n[1]=Math.min(n[1],e),n[2]=Math.max(n[2],t),n[3]=Math.max(n[3],e)}function cg(n,t){let e;return e=t(ua(n)),e||(e=t(da(n)),e)||(e=t(fa(n)),e)||(e=t(Pi(n)),e)?e:!1}function Kl(n){let t=0;return Fs(n)||(t=at(n)*Ht(n)),t}function ua(n){return[n[0],n[1]]}function da(n){return[n[2],n[1]]}function fn(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function ey(n,t){let e;if(t==="bottom-left")e=ua(n);else if(t==="bottom-right")e=da(n);else if(t==="top-left")e=Pi(n);else if(t==="top-right")e=fa(n);else throw new Error("Invalid corner");return e}function Yl(n,t,e,i,r){const[s,o,a,l,c,h,u,d]=hg(n,t,e,i);return dn(Math.min(s,a,c,u),Math.min(o,l,h,d),Math.max(s,a,c,u),Math.max(o,l,h,d),r)}function hg(n,t,e,i){const r=t*i[0]/2,s=t*i[1]/2,o=Math.cos(e),a=Math.sin(e),l=r*o,c=r*a,h=s*o,u=s*a,d=n[0],f=n[1];return[d-l+u,f-c-h,d-l-u,f-c+h,d+l-u,f+c+h,d+l+u,f+c-h,d-l+u,f-c-h]}function Ht(n){return n[3]-n[1]}function _i(n,t,e){const i=e||Ce();return Qt(n,t)?(n[0]>t[0]?i[0]=n[0]:i[0]=t[0],n[1]>t[1]?i[1]=n[1]:i[1]=t[1],n[2]<t[2]?i[2]=n[2]:i[2]=t[2],n[3]<t[3]?i[3]=n[3]:i[3]=t[3]):Ir(i),i}function Pi(n){return[n[0],n[3]]}function fa(n){return[n[2],n[3]]}function at(n){return n[2]-n[0]}function Qt(n,t){return n[0]<=t[2]&&n[2]>=t[0]&&n[1]<=t[3]&&n[3]>=t[1]}function Fs(n){return n[2]<n[0]||n[3]<n[1]}function ny(n,t){return t?(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t):n}function iy(n,t,e){let i=!1;const r=Xl(n,t),s=Xl(n,e);if(r===Lt.INTERSECTING||s===Lt.INTERSECTING)i=!0;else{const o=n[0],a=n[1],l=n[2],c=n[3],h=t[0],u=t[1],d=e[0],f=e[1],g=(f-u)/(d-h);let y,_;s&Lt.ABOVE&&!(r&Lt.ABOVE)&&(y=d-(f-c)/g,i=y>=o&&y<=l),!i&&s&Lt.RIGHT&&!(r&Lt.RIGHT)&&(_=f-(d-l)*g,i=_>=a&&_<=c),!i&&s&Lt.BELOW&&!(r&Lt.BELOW)&&(y=d-(f-a)/g,i=y>=o&&y<=l),!i&&s&Lt.LEFT&&!(r&Lt.LEFT)&&(_=f-(d-o)*g,i=_>=a&&_<=c)}return i}function ry(n,t,e,i){if(Fs(n))return Ir(e);let r=[];r=[n[0],n[1],n[2],n[1],n[2],n[3],n[0],n[3]],t(r,r,2);const s=[],o=[];for(let a=0,l=r.length;a<l;a+=2)s.push(r[a]),o.push(r[a+1]);return Q_(s,o,e)}function ug(n,t){const e=t.getExtent(),i=fn(n);if(t.canWrapX()&&(i[0]<e[0]||i[0]>=e[2])){const r=at(e),o=Math.floor((i[0]-e[0])/r)*r;n[0]-=o,n[2]-=o}return n}function dg(n,t,e){if(t.canWrapX()){const i=t.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[i[0],n[1],i[2],n[3]]];ug(n,t);const r=at(i);if(at(n)>r&&!e)return[[i[0],n[1],i[2],n[3]]];if(n[0]<i[0])return[[n[0]+r,n[1],i[2],n[3]],[i[0],n[1],n[2],n[3]]];if(n[2]>i[2])return[[n[0],n[1],i[2],n[3]],[i[0],n[1],n[2]-r,n[3]]]}return[n]}function pt(n,t,e){return Math.min(Math.max(n,t),e)}function sy(n,t,e,i,r,s){const o=r-e,a=s-i;if(o!==0||a!==0){const l=((n-e)*o+(t-i)*a)/(o*o+a*a);l>1?(e=r,i=s):l>0&&(e+=o*l,i+=a*l)}return yi(n,t,e,i)}function yi(n,t,e,i){const r=e-n,s=i-t;return r*r+s*s}function oy(n){const t=n.length;for(let i=0;i<t;i++){let r=i,s=Math.abs(n[i][i]);for(let a=i+1;a<t;a++){const l=Math.abs(n[a][i]);l>s&&(s=l,r=a)}if(s===0)return null;const o=n[r];n[r]=n[i],n[i]=o;for(let a=i+1;a<t;a++){const l=-n[a][i]/n[i][i];for(let c=i;c<t+1;c++)i==c?n[a][c]=0:n[a][c]+=l*n[i][c]}}const e=new Array(t);for(let i=t-1;i>=0;i--){e[i]=n[i][t]/n[i][i];for(let r=i-1;r>=0;r--)n[r][t]-=n[r][i]*e[i]}return e}function Mu(n){return n*180/Math.PI}function $n(n){return n*Math.PI/180}function nr(n,t){const e=n%t;return e*t<0?e+t:e}function oe(n,t,e){return n+e*(t-n)}function ga(n,t){const e=Math.pow(10,t);return Math.round(n*e)/e}function eo(n,t){return Math.floor(ga(n,t))}function no(n,t){return Math.ceil(ga(n,t))}function Zl(n,t,e){if(n>=t&&n<e)return n;const i=e-t;return((n-t)%i+i)%i+t}const ay=63710088e-1;function Jl(n,t,e){e=e||ay;const i=$n(n[1]),r=$n(t[1]),s=(r-i)/2,o=$n(t[0]-n[0])/2,a=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(r);return 2*e*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}function W(){throw new Error("Unimplemented abstract method.")}let ly=0;function nt(n){return n.ol_uid||(n.ol_uid=String(++ly))}const hr={PROPERTYCHANGE:"propertychange"},H={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class pa{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function fs(){return!0}function ma(){return!1}function gs(){}function fg(n){let t,e,i;return function(){const r=Array.prototype.slice.call(arguments);return(!e||this!==i||!Qn(r,e))&&(i=this,e=r,t=n.apply(this,arguments)),t}}function cy(n){function t(){let e;try{e=n()}catch(i){return Promise.reject(i)}return e instanceof Promise?e:Promise.resolve(e)}return t()}function Ns(n){for(const t in n)delete n[t]}function bi(n){let t;for(t in n)return!1;return!t}class yn{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}class _a extends pa{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const i=this.listeners_||(this.listeners_={}),r=i[t]||(i[t]=[]);r.includes(e)||r.push(e)}dispatchEvent(t){const e=typeof t=="string",i=e?t:t.type,r=this.listeners_&&this.listeners_[i];if(!r)return;const s=e?new yn(t):t;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,a[i]=0),++o[i];let l;for(let c=0,h=r.length;c<h;++c)if("handleEvent"in r[c]?l=r[c].handleEvent(s):l=r[c].call(this,s),l===!1||s.propagationStopped){l=!1;break}if(--o[i]===0){let c=a[i];for(delete a[i];c--;)this.removeEventListener(i,gs);delete o[i]}return l}disposeInternal(){this.listeners_&&Ns(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return this.listeners_?t?t in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(t,e){if(!this.listeners_)return;const i=this.listeners_[t];if(!i)return;const r=i.indexOf(e);r!==-1&&(this.pendingRemovals_&&t in this.pendingRemovals_?(i[r]=gs,++this.pendingRemovals_[t]):(i.splice(r,1),i.length===0&&delete this.listeners_[t]))}}function et(n,t,e,i,r){if(r){const o=e;e=function(a){return n.removeEventListener(t,e),o.call(i??this,a)}}else i&&i!==n&&(e=e.bind(i));const s={target:n,type:t,listener:e};return n.addEventListener(t,e),s}function So(n,t,e,i){return et(n,t,e,i,!0)}function ut(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),Ns(n))}class $s extends _a{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(H.CHANGE)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const i=t.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=et(this,t[s],e);return r}return et(this,t,e)}onceInternal(t,e){let i;if(Array.isArray(t)){const r=t.length;i=new Array(r);for(let s=0;s<r;++s)i[s]=So(this,t[s],e)}else i=So(this,t,e);return e.ol_key=i,i}unInternal(t,e){const i=e.ol_key;if(i)hy(i);else if(Array.isArray(t))for(let r=0,s=t.length;r<s;++r)this.removeEventListener(t[r],e);else this.removeEventListener(t,e)}}$s.prototype.on;$s.prototype.once;$s.prototype.un;function hy(n){if(Array.isArray(n))for(let t=0,e=n.length;t<e;++t)ut(n[t]);else ut(n)}class Fu extends yn{constructor(t,e,i){super(t),this.key=e,this.oldValue=i}}class Ke extends $s{constructor(t){super(),this.on,this.once,this.un,nt(this),this.values_=null,t!==void 0&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(t,e){let i;i=`change:${t}`,this.hasListener(i)&&this.dispatchEvent(new Fu(i,t,e)),i=hr.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new Fu(i,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,i){const r=this.values_||(this.values_={});if(i)r[t]=e;else{const s=r[t];r[t]=e,s!==e&&this.notify(t,s)}}setProperties(t,e){for(const i in t)this.set(i,t[i],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const i=this.values_[t];delete this.values_[t],bi(this.values_)&&(this.values_=null),e||this.notify(t,i)}}}function gg(...n){console.warn(...n)}function uy(n,t){return n[0]+=+t[0],n[1]+=+t[1],n}function To(n,t){let e=!0;for(let i=n.length-1;i>=0;--i)if(n[i]!=t[i]){e=!1;break}return e}function ih(n,t){const e=Math.cos(t),i=Math.sin(t),r=n[0]*e-n[1]*i,s=n[1]*e+n[0]*i;return n[0]=r,n[1]=s,n}function dy(n,t){return n[0]*=t,n[1]*=t,n}function pg(n,t){if(t.canWrapX()){const e=at(t.getExtent()),i=fy(n,t,e);i&&(n[0]-=i*e)}return n}function fy(n,t,e){const i=t.getExtent();let r=0;return t.canWrapX()&&(n[0]<i[0]||n[0]>i[2])&&(e=e||at(i),r=Math.floor((n[0]-i[0])/e)),r}const rh={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class sh{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=t.extent!==void 0?t.extent:null,this.worldExtent_=t.worldExtent!==void 0?t.worldExtent:null,this.axisOrientation_=t.axisOrientation!==void 0?t.axisOrientation:"enu",this.global_=t.global!==void 0?t.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||rh[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!!(t&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!!(this.global_&&t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const Vs=6378137,tr=Math.PI*Vs,gy=[-tr,-tr,tr,tr],py=[-180,-85,180,85],io=Vs*Math.log(Math.tan(Math.PI/2));class zi extends sh{constructor(t){super({code:t,units:"m",extent:gy,global:!0,worldExtent:py,getPointResolution:function(e,i){return e/Math.cosh(i[1]/Vs)}})}}const Nu=[new zi("EPSG:3857"),new zi("EPSG:102100"),new zi("EPSG:102113"),new zi("EPSG:900913"),new zi("http://www.opengis.net/def/crs/EPSG/0/3857"),new zi("http://www.opengis.net/gml/srs/epsg.xml#3857")];function my(n,t,e,i){const r=n.length;e=e>1?e:2,i=i??e,t===void 0&&(e>2?t=n.slice():t=new Array(r));for(let s=0;s<r;s+=i){t[s]=tr*n[s]/180;let o=Vs*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));o>io?o=io:o<-io&&(o=-io),t[s+1]=o}return t}function _y(n,t,e,i){const r=n.length;e=e>1?e:2,i=i??e,t===void 0&&(e>2?t=n.slice():t=new Array(r));for(let s=0;s<r;s+=i)t[s]=180*n[s]/tr,t[s+1]=360*Math.atan(Math.exp(n[s+1]/Vs))/Math.PI-90;return t}const yy=6378137,$u=[-180,-90,180,90],wy=Math.PI*yy/180;class ri extends sh{constructor(t,e){super({code:t,units:"degrees",extent:$u,axisOrientation:e,global:!0,metersPerUnit:wy,worldExtent:$u})}}const Vu=[new ri("CRS:84"),new ri("EPSG:4326","neu"),new ri("urn:ogc:def:crs:OGC:1.3:CRS84"),new ri("urn:ogc:def:crs:OGC:2:84"),new ri("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new ri("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new ri("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let Ql={};function vy(n){return Ql[n]||Ql[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function by(n,t){Ql[n]=t}let ir={};function ps(n,t,e){const i=n.getCode(),r=t.getCode();i in ir||(ir[i]={}),ir[i][r]=e}function ol(n,t){return n in ir&&t in ir[n]?ir[n][t]:null}const Io=.9996,Ee=.00669438,ya=Ee*Ee,wa=ya*Ee,di=Ee/(1-Ee),zu=Math.sqrt(1-Ee),ur=(1-zu)/(1+zu),mg=ur*ur,oh=mg*ur,ah=oh*ur,_g=ah*ur,yg=1-Ee/4-3*ya/64-5*wa/256,Ey=3*Ee/8+3*ya/32+45*wa/1024,xy=15*ya/256+45*wa/1024,Cy=35*wa/3072,Sy=3/2*ur-27/32*oh+269/512*_g,Ty=21/16*mg-55/32*ah,Iy=151/96*oh-417/128*_g,Ry=1097/512*ah,Ro=6378137;function Ay(n,t,e){const i=n-5e5,o=(e.north?t:t-1e7)/Io/(Ro*yg),a=o+Sy*Math.sin(2*o)+Ty*Math.sin(4*o)+Iy*Math.sin(6*o)+Ry*Math.sin(8*o),l=Math.sin(a),c=l*l,h=Math.cos(a),u=l/h,d=u*u,f=d*d,g=1-Ee*c,y=Math.sqrt(1-Ee*c),_=Ro/y,b=(1-Ee)/g,S=di*h**2,R=S*S,T=i/(_*Io),I=T*T,L=I*T,w=L*T,p=w*T,m=p*T,E=a-u/b*(I/2-w/24*(5+3*d+10*S-4*R-9*di))+m/720*(61+90*d+298*S+45*f-252*di-3*R);let x=(T-L/6*(1+2*d+S)+p/120*(5-2*S+28*d-3*R+8*di+24*f))/h;return x=Zl(x+$n(wg(e.number)),-Math.PI,Math.PI),[Mu(x),Mu(E)]}const Gu=-80,Bu=84,Py=-180,Ly=180;function Oy(n,t,e){n=Zl(n,Py,Ly),t<Gu?t=Gu:t>Bu&&(t=Bu);const i=$n(t),r=Math.sin(i),s=Math.cos(i),o=r/s,a=o*o,l=a*a,c=$n(n),h=wg(e.number),u=$n(h),d=Ro/Math.sqrt(1-Ee*r**2),f=di*s**2,g=s*Zl(c-u,-Math.PI,Math.PI),y=g*g,_=y*g,b=_*g,S=b*g,R=S*g,T=Ro*(yg*i-Ey*Math.sin(2*i)+xy*Math.sin(4*i)-Cy*Math.sin(6*i)),I=Io*d*(g+_/6*(1-a+f)+S/120*(5-18*a+l+72*f-58*di))+5e5;let L=Io*(T+d*o*(y/2+b/24*(5-a+9*f+4*f**2)+R/720*(61-58*a+l+600*f-330*di)));return e.north||(L+=1e7),[I,L]}function wg(n){return(n-1)*6-180+3}const ky=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function vg(n){let t=0;for(const r of ky){const s=n.match(r);if(s){t=parseInt(s[1]);break}}if(!t)return null;let e=0,i=!1;return t>32700&&t<32761?e=t-32700:t>32600&&t<32661&&(i=!0,e=t-32600),e?{number:e,north:i}:null}function Uu(n,t){return function(e,i,r,s){const o=e.length;r=r>1?r:2,s=s??r,i||(r>2?i=e.slice():i=new Array(o));for(let a=0;a<o;a+=s){const l=e[a],c=e[a+1],h=n(l,c,t);i[a]=h[0],i[a+1]=h[1]}return i}}function Dy(n){return vg(n)?new sh({code:n,units:"m"}):null}function My(n){const t=vg(n.getCode());return t?{forward:Uu(Oy,t),inverse:Uu(Ay,t)}:null}const Fy=[My],Ny=[Dy];let tc=!0;function $y(n){tc=!1}function lh(n,t){if(t!==void 0){for(let e=0,i=n.length;e<i;++e)t[e]=n[e];t=t}else t=n.slice();return t}function ec(n){by(n.getCode(),n),ps(n,n,lh)}function Vy(n){n.forEach(ec)}function dt(n){if(typeof n!="string")return n;const t=vy(n);if(t)return t;for(const e of Ny){const i=e(n);if(i)return i}return null}function ju(n,t,e,i){n=dt(n);let r;const s=n.getPointResolutionFunc();if(s)r=s(t,e);else{const o=n.getUnits();if(o=="degrees"&&!i||i=="degrees")r=t;else{const a=zs(n,dt("EPSG:4326"));if(!a&&o!=="degrees")r=t*n.getMetersPerUnit();else{let c=[e[0]-t/2,e[1],e[0]+t/2,e[1],e[0],e[1]-t/2,e[0],e[1]+t/2];c=a(c,c,2);const h=Jl(c.slice(0,2),c.slice(2,4)),u=Jl(c.slice(4,6),c.slice(6,8));r=(h+u)/2}const l=n.getMetersPerUnit();l!==void 0&&(r/=l)}}return r}function Wu(n){Vy(n),n.forEach(function(t){n.forEach(function(e){t!==e&&ps(t,e,lh)})})}function zy(n,t,e,i){n.forEach(function(r){t.forEach(function(s){ps(r,s,e),ps(s,r,i)})})}function ch(n,t){return n?typeof n=="string"?dt(n):n:dt(t)}function Gy(n){return(function(t,e,i,r){const s=t.length;i=i!==void 0?i:2,r=r??i,e=e!==void 0?e:new Array(s);for(let o=0;o<s;o+=r){const a=n(t.slice(o,o+i)),l=a.length;for(let c=0,h=r;c<h;++c)e[o+c]=c>=l?t[o+c]:a[c]}return e})}function rs(n,t){if(n===t)return!0;const e=n.getUnits()===t.getUnits();return(n.getCode()===t.getCode()||zs(n,t)===lh)&&e}function zs(n,t){const e=n.getCode(),i=t.getCode();let r=ol(e,i);if(r)return r;let s=null,o=null;for(const l of Fy)s||(s=l(n)),o||(o=l(t));if(!s&&!o)return null;const a="EPSG:4326";if(o)if(s)r=al(s.inverse,o.forward);else{const l=ol(e,a);l&&(r=al(l,o.forward))}else{const l=ol(a,i);l&&(r=al(s.inverse,l))}return r&&(ec(n),ec(t),ps(n,t,r)),r}function al(n,t){return function(e,i,r,s){return i=n(e,i,r,s),t(i,i,r,s)}}function dr(n,t){const e=dt(n),i=dt(t);return zs(e,i)}function va(n,t,e){const i=dr(t,e);if(!i){const r=dt(t).getCode(),s=dt(e).getCode();throw new Error(`No transform available between ${r} and ${s}`)}return i(n,void 0,n.length)}function bg(n,t,e,i){const r=dr(t,e);return ry(n,r,void 0)}let Se=null;function By(n){Se=dt(n)}function Ao(){return Se}function Uy(){By("EPSG:4326")}function nc(n,t){return Se?va(n,t,Se):n}function rn(n,t){return Se?va(n,Se,t):(tc&&!To(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(tc=!1,gg("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n)}function Po(n,t){return Se?bg(n,t,Se):n}function Dn(n,t){return Se?bg(n,Se,t):n}function jy(n,t){if(!Se)return n;const e=dt(t).getMetersPerUnit(),i=Se.getMetersPerUnit();return e&&i?n*e/i:n}function Wy(){Wu(Nu),Wu(Vu),zy(Vu,Nu,my,_y)}Wy();function rt(n,t){if(!n)throw new Error(t)}new Array(6);function Pe(){return[1,0,0,1,0,0]}function qy(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n}function Ot(n,t){const e=t[0],i=t[1];return t[0]=n[0]*e+n[2]*i+n[4],t[1]=n[1]*e+n[3]*i+n[5],t}function gn(n,t,e,i,r,s,o,a){const l=Math.sin(s),c=Math.cos(s);return n[0]=i*c,n[1]=r*l,n[2]=-i*l,n[3]=r*c,n[4]=o*i*c-a*i*l+t,n[5]=o*r*l+a*r*c+e,n}function Eg(n,t){const e=Hy(t);rt(e!==0,"Transformation matrix cannot be inverted");const i=t[0],r=t[1],s=t[2],o=t[3],a=t[4],l=t[5];return n[0]=o/e,n[1]=-r/e,n[2]=-s/e,n[3]=i/e,n[4]=(s*l-o*a)/e,n[5]=-(i*l-r*a)/e,n}function Hy(n){return n[0]*n[3]-n[1]*n[2]}const Xy=[1e5,1e5,1e5,1e5,2,2];function Ky(n){return"matrix("+n.join(", ")+")"}function ic(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function Yy(n,t){const e=ic(n),i=ic(t);for(let r=0;r<6;++r)if(Math.round((e[r]-i[r])*Xy[r])!==0)return!1;return!0}function Vn(n,t,e,i,r,s,o){s=s||[],o=o||2;let a=0;for(let l=t;l<e;l+=i){const c=n[l],h=n[l+1];s[a++]=r[0]*c+r[2]*h+r[4],s[a++]=r[1]*c+r[3]*h+r[5];for(let u=2;u<o;u++)s[a++]=n[l+u]}return s&&s.length!=a&&(s.length=a),s}function xg(n,t,e,i,r,s,o){o=o||[];const a=Math.cos(r),l=Math.sin(r),c=s[0],h=s[1];let u=0;for(let d=t;d<e;d+=i){const f=n[d]-c,g=n[d+1]-h;o[u++]=c+f*a-g*l,o[u++]=h+f*l+g*a;for(let y=d+2;y<d+i;++y)o[u++]=n[y]}return o&&o.length!=u&&(o.length=u),o}function Zy(n,t,e,i,r,s,o,a){a=a||[];const l=o[0],c=o[1];let h=0;for(let u=t;u<e;u+=i){const d=n[u]-l,f=n[u+1]-c;a[h++]=l+r*d,a[h++]=c+s*f;for(let g=u+2;g<u+i;++g)a[h++]=n[g]}return a&&a.length!=h&&(a.length=h),a}function Jy(n,t,e,i,r,s,o){o=o||[];let a=0;for(let l=t;l<e;l+=i){o[a++]=n[l]+r,o[a++]=n[l+1]+s;for(let c=l+2;c<l+i;++c)o[a++]=n[c]}return o&&o.length!=a&&(o.length=a),o}const qu=Pe(),Qy=[NaN,NaN];class Cg extends Ke{constructor(){super(),this.extent_=Ce(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=fg((t,e,i)=>{if(!i)return this.getSimplifiedGeometry(e);const r=this.clone();return r.applyTransform(i),r.getSimplifiedGeometry(e)})}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return W()}closestPointXY(t,e,i,r){return W()}containsXY(t,e){return this.closestPointXY(t,e,Qy,Number.MIN_VALUE)===0}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return W()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&Ir(e),this.extentRevision_=this.getRevision()}return ny(this.extent_,t)}rotate(t,e){W()}scale(t,e,i){W()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return W()}getType(){return W()}applyTransform(t){W()}intersectsExtent(t){return W()}translate(t,e){W()}transform(t,e){const i=dt(t),r=i.getUnits()=="tile-pixels"?function(s,o,a){const l=i.getExtent(),c=i.getWorldExtent(),h=Ht(c)/Ht(l);gn(qu,c[0],c[3],h,-h,0,0,0);const u=Vn(s,0,s.length,a,qu,o),d=dr(i,e);return d?d(u,u,a):u}:dr(i,e);return this.applyTransform(r),this}}class Li extends Cg{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(t){return nh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return W()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=Hu(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){W()}setLayout(t,e,i){let r;if(t)r=Hu(t);else{for(let s=0;s<i;++s){if(e.length===0){this.layout="XY",this.stride=2;return}e=e[0]}r=e.length,t=Oi(r)}this.layout=t,this.stride=r}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(t,e){const i=this.getFlatCoordinates();if(i){const r=this.getStride();xg(i,0,i.length,r,t,e,i),this.changed()}}scale(t,e,i){e===void 0&&(e=t),i||(i=fn(this.getExtent()));const r=this.getFlatCoordinates();if(r){const s=this.getStride();Zy(r,0,r.length,s,t,e,i,r),this.changed()}}translate(t,e){const i=this.getFlatCoordinates();if(i){const r=this.getStride();Jy(i,0,i.length,r,t,e,i),this.changed()}}}function Oi(n){let t;return n==2?t="XY":n==3?t="XYZ":n==4&&(t="XYZM"),t}function Hu(n){let t;return n=="XY"?t=2:n=="XYZ"||n=="XYM"?t=3:n=="XYZM"&&(t=4),t}function tw(n,t,e){const i=n.getFlatCoordinates();if(!i)return null;const r=n.getStride();return Vn(i,0,i.length,r,t,e)}function Sg(n,t,e,i){let r=0;const s=n[e-i],o=n[e-i+1];let a=0,l=0;for(;t<e;t+=i){const c=n[t]-s,h=n[t+1]-o;r+=l*c-a*h,a=c,l=h}return r/2}function Tg(n,t,e,i){let r=0;for(let s=0,o=e.length;s<o;++s){const a=e[s];r+=Sg(n,t,a,i),t=a}return r}function ew(n,t,e,i){let r=0;for(let s=0,o=e.length;s<o;++s){const a=e[s];r+=Tg(n,t,a,i),t=a[a.length-1]}return r}function Xu(n,t,e,i,r,s,o){const a=n[t],l=n[t+1],c=n[e]-a,h=n[e+1]-l;let u;if(c===0&&h===0)u=t;else{const d=((r-a)*c+(s-l)*h)/(c*c+h*h);if(d>1)u=e;else if(d>0){for(let f=0;f<i;++f)o[f]=oe(n[t+f],n[e+f],d);o.length=i;return}else u=t}for(let d=0;d<i;++d)o[d]=n[u+d];o.length=i}function hh(n,t,e,i,r){let s=n[t],o=n[t+1];for(t+=i;t<e;t+=i){const a=n[t],l=n[t+1],c=yi(s,o,a,l);c>r&&(r=c),s=a,o=l}return r}function uh(n,t,e,i,r){for(let s=0,o=e.length;s<o;++s){const a=e[s];r=hh(n,t,a,i,r),t=a}return r}function nw(n,t,e,i,r){for(let s=0,o=e.length;s<o;++s){const a=e[s];r=uh(n,t,a,i,r),t=a[a.length-1]}return r}function dh(n,t,e,i,r,s,o,a,l,c,h){if(t==e)return c;let u,d;if(r===0){if(d=yi(o,a,n[t],n[t+1]),d<c){for(u=0;u<i;++u)l[u]=n[t+u];return l.length=i,d}return c}h=h||[NaN,NaN];let f=t+i;for(;f<e;)if(Xu(n,f-i,f,i,o,a,h),d=yi(o,a,h[0],h[1]),d<c){for(c=d,u=0;u<i;++u)l[u]=h[u];l.length=i,f+=i}else f+=i*Math.max((Math.sqrt(d)-Math.sqrt(c))/r|0,1);if(s&&(Xu(n,e-i,t,i,o,a,h),d=yi(o,a,h[0],h[1]),d<c)){for(c=d,u=0;u<i;++u)l[u]=h[u];l.length=i}return c}function fh(n,t,e,i,r,s,o,a,l,c,h){h=h||[NaN,NaN];for(let u=0,d=e.length;u<d;++u){const f=e[u];c=dh(n,t,f,i,r,s,o,a,l,c,h),t=f}return c}function iw(n,t,e,i,r,s,o,a,l,c,h){h=h||[NaN,NaN];for(let u=0,d=e.length;u<d;++u){const f=e[u];c=fh(n,t,f,i,r,s,o,a,l,c,h),t=f[f.length-1]}return c}function rw(n,t,e,i){for(let r=0,s=e.length;r<s;++r)n[t++]=e[r];return t}function ba(n,t,e,i){for(let r=0,s=e.length;r<s;++r){const o=e[r];for(let a=0;a<i;++a)n[t++]=o[a]}return t}function Gs(n,t,e,i,r){r=r||[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=ba(n,t,e[o],i);r[s++]=l,t=l}return r.length=s,r}function Ig(n,t,e,i,r){r=r||[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=Gs(n,t,e[o],i,r[s]);l.length===0&&(l[0]=t),r[s++]=l,t=l[l.length-1]}return r.length=s,r}function Mn(n,t,e,i,r){r=r!==void 0?r:[];let s=0;for(let o=t;o<e;o+=i)r[s++]=n.slice(o,o+i);return r.length=s,r}function ms(n,t,e,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=e[o];r[s++]=Mn(n,t,l,i,r[s]),t=l}return r.length=s,r}function rc(n,t,e,i,r){r=r!==void 0?r:[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=e[o];r[s++]=l.length===1&&l[0]===t?[]:ms(n,t,l,i,r[s]),t=l[l.length-1]}return r.length=s,r}function Ea(n,t,e,i,r,s,o){const a=(e-t)/i;if(a<3){for(;t<e;t+=i)s[o++]=n[t],s[o++]=n[t+1];return o}const l=new Array(a);l[0]=1,l[a-1]=1;const c=[t,e-i];let h=0;for(;c.length>0;){const u=c.pop(),d=c.pop();let f=0;const g=n[d],y=n[d+1],_=n[u],b=n[u+1];for(let S=d+i;S<u;S+=i){const R=n[S],T=n[S+1],I=sy(R,T,g,y,_,b);I>f&&(h=S,f=I)}f>r&&(l[(h-t)/i]=1,d+i<h&&c.push(d,h),h+i<u&&c.push(h,u))}for(let u=0;u<a;++u)l[u]&&(s[o++]=n[t+u*i],s[o++]=n[t+u*i+1]);return o}function Rg(n,t,e,i,r,s,o,a){for(let l=0,c=e.length;l<c;++l){const h=e[l];o=Ea(n,t,h,i,r,s,o),a.push(o),t=h}return o}function li(n,t){return t*Math.round(n/t)}function sw(n,t,e,i,r,s,o){if(t==e)return o;let a=li(n[t],r),l=li(n[t+1],r);t+=i,s[o++]=a,s[o++]=l;let c,h;do if(c=li(n[t],r),h=li(n[t+1],r),t+=i,t==e)return s[o++]=c,s[o++]=h,o;while(c==a&&h==l);for(;t<e;){const u=li(n[t],r),d=li(n[t+1],r);if(t+=i,u==c&&d==h)continue;const f=c-a,g=h-l,y=u-a,_=d-l;if(f*_==g*y&&(f<0&&y<f||f==y||f>0&&y>f)&&(g<0&&_<g||g==_||g>0&&_>g)){c=u,h=d;continue}s[o++]=c,s[o++]=h,a=c,l=h,c=u,h=d}return s[o++]=c,s[o++]=h,o}function gh(n,t,e,i,r,s,o,a){for(let l=0,c=e.length;l<c;++l){const h=e[l];o=sw(n,t,h,i,r,s,o),a.push(o),t=h}return o}function ow(n,t,e,i,r,s,o,a){for(let l=0,c=e.length;l<c;++l){const h=e[l],u=[];o=gh(n,t,h,i,r,s,o,u),a.push(u),t=h[h.length-1]}return o}class _s extends Li{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}clone(){return new _s(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,i,r){return r<Ai(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(hh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),dh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,r))}getArea(){return Sg(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Mn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=Ea(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new _s(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ba(this.flatCoordinates,0,t,this.stride),this.changed()}}class cn extends Li{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new cn(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,r){const s=this.flatCoordinates,o=yi(t,e,s[0],s[1]);if(o<r){const a=this.stride;for(let l=0;l<a;++l)i[l]=s[l];return i.length=a,o}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return og(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return eh(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=rw(this.flatCoordinates,0,t,this.stride),this.changed()}}function aw(n,t,e,i,r){return!cg(r,function(o){return!fi(n,t,e,i,o[0],o[1])})}function fi(n,t,e,i,r,s){let o=0,a=n[e-i],l=n[e-i+1];for(;t<e;t+=i){const c=n[t],h=n[t+1];l<=s?h>s&&(c-a)*(s-l)-(r-a)*(h-l)>0&&o++:h<=s&&(c-a)*(s-l)-(r-a)*(h-l)<0&&o--,a=c,l=h}return o!==0}function ph(n,t,e,i,r,s){if(e.length===0||!fi(n,t,e[0],i,r,s))return!1;for(let o=1,a=e.length;o<a;++o)if(fi(n,e[o-1],e[o],i,r,s))return!1;return!0}function lw(n,t,e,i,r,s){if(e.length===0)return!1;for(let o=0,a=e.length;o<a;++o){const l=e[o];if(ph(n,t,l,i,r,s))return!0;t=l[l.length-1]}return!1}function mh(n,t,e,i,r,s,o){let a,l,c,h,u,d,f;const g=r[s+1],y=[];for(let S=0,R=e.length;S<R;++S){const T=e[S];for(h=n[T-i],d=n[T-i+1],a=t;a<T;a+=i)u=n[a],f=n[a+1],(g<=d&&f<=g||d<=g&&g<=f)&&(c=(g-d)/(f-d)*(u-h)+h,y.push(c)),h=u,d=f}let _=NaN,b=-1/0;for(y.sort(ln),h=y[0],a=1,l=y.length;a<l;++a){u=y[a];const S=Math.abs(u-h);S>b&&(c=(h+u)/2,ph(n,t,e,i,c,g)&&(_=c,b=S)),h=u}return isNaN(_)&&(_=r[s]),o?(o.push(_,g,b),o):[_,g,b]}function Ag(n,t,e,i,r){let s=[];for(let o=0,a=e.length;o<a;++o){const l=e[o];s=mh(n,t,l,i,r,2*o,s),t=l[l.length-1]}return s}function Pg(n,t,e,i,r){let s;for(t+=i;t<e;t+=i)if(s=r(n.slice(t-i,t),n.slice(t,t+i)),s)return s;return!1}function xa(n,t,e,i,r,s){return s=s??lg(Ce(),n,t,e,i),Qt(r,s)?s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]?!0:Pg(n,t,e,i,function(o,a){return iy(r,o,a)}):!1}function cw(n,t,e,i,r){for(let s=0,o=e.length;s<o;++s){if(xa(n,t,e[s],i,r))return!0;t=e[s]}return!1}function Lg(n,t,e,i,r){return!!(xa(n,t,e,i,r)||fi(n,t,e,i,r[0],r[1])||fi(n,t,e,i,r[0],r[3])||fi(n,t,e,i,r[2],r[1])||fi(n,t,e,i,r[2],r[3]))}function Og(n,t,e,i,r){if(!Lg(n,t,e[0],i,r))return!1;if(e.length===1)return!0;for(let s=1,o=e.length;s<o;++s)if(aw(n,e[s-1],e[s],i,r)&&!xa(n,e[s-1],e[s],i,r))return!1;return!0}function hw(n,t,e,i,r){for(let s=0,o=e.length;s<o;++s){const a=e[s];if(Og(n,t,a,i,r))return!0;t=a[a.length-1]}return!1}function uw(n,t,e,i){for(;t<e-i;){for(let r=0;r<i;++r){const s=n[t+r];n[t+r]=n[e-i+r],n[e-i+r]=s}t+=i,e-=i}}function _h(n,t,e,i){let r=0,s=n[e-i],o=n[e-i+1];for(;t<e;t+=i){const a=n[t],l=n[t+1];r+=(a-s)*(l+o),s=a,o=l}return r===0?void 0:r>0}function yh(n,t,e,i,r){r=r!==void 0?r:!1;for(let s=0,o=e.length;s<o;++s){const a=e[s],l=_h(n,t,a,i);if(s===0){if(r&&l||!r&&!l)return!1}else if(r&&!l||!r&&l)return!1;t=a}return!0}function kg(n,t,e,i,r){for(let s=0,o=e.length;s<o;++s){const a=e[s];if(!yh(n,t,a,i,r))return!1;a.length&&(t=a[a.length-1])}return!0}function Lo(n,t,e,i,r){r=r!==void 0?r:!1;for(let s=0,o=e.length;s<o;++s){const a=e[s],l=_h(n,t,a,i);(s===0?r&&l||!r&&!l:r&&!l||!r&&l)&&uw(n,t,a,i),t=a}return t}function sc(n,t,e,i,r){for(let s=0,o=e.length;s<o;++s)t=Lo(n,t,e[s],i,r);return t}function dw(n,t){const e=[];let i=0,r=0,s;for(let o=0,a=t.length;o<a;++o){const l=t[o],c=_h(n,i,l,2);if(s===void 0&&(s=c),c===s)e.push(t.slice(r,o+1));else{if(e.length===0)continue;e[e.length-1].push(t[r])}r=o+1,i=l}return e}class jn extends Li{constructor(t,e,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,e!==void 0&&i?(this.setFlatCoordinates(e,t),this.ends_=i):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?je(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new jn(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,r){return r<Ai(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(uh(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),fh(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,r))}containsXY(t,e){return ph(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return Tg(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),Lo(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,ms(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=fn(this.getExtent());this.flatInteriorPoint_=mh(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new cn(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new _s(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,i=this.ends_,r=[];let s=0;for(let o=0,a=i.length;o<a;++o){const l=i[o],c=new _s(e.slice(s,l),t);r.push(c),s=l}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;yh(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Lo(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=gh(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,i),new jn(e,"XY",i)}getType(){return"Polygon"}intersectsExtent(t){return Og(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=Gs(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}function oc(n){if(Fs(n))throw new Error("Cannot create polygon from empty extent");const t=n[0],e=n[1],i=n[2],r=n[3],s=[t,e,t,r,i,r,i,e,t,e];return new jn(s,"XY",[s.length])}const rr={ch:rl(il.features.find(n=>n.properties.code==="ch").geometry.coordinates),fr:rl(il.features.find(n=>n.properties.code==="fr").geometry.coordinates),de:rl(il.features.find(n=>n.properties.code==="de").geometry.coordinates)},fw={ch:ns(rr.ch),fr:ns(rr.fr),de:ns(rr.de)},gw={ch:355620,fr:1079440,de:879452};function pw(n,t){const e=gw[t];return 5e3*Math.exp(-10*n/e)}function Ku(n){const t=rr[n];let e=Ou(ns(t));for(;;){if(ig(e,t))return e;e=Ou(ns(t))}}function mw(n,t){const e=oc(n);return e.scale(t),e.getExtent()}const wh=globalThis,Oo=wh.trustedTypes,Yu=Oo?Oo.createPolicy("lit-html",{createHTML:n=>n}):void 0,Dg="$lit$",kn=`lit$${Math.random().toFixed(9).slice(2)}$`,Mg="?"+kn,_w=`<${Mg}>`,Ei=document,ys=()=>Ei.createComment(""),ws=n=>n===null||typeof n!="object"&&typeof n!="function",vh=Array.isArray,yw=n=>vh(n)||typeof n?.[Symbol.iterator]=="function",ll=`[ 	
\f\r]`,Br=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Zu=/-->/g,Ju=/>/g,si=RegExp(`>|${ll}(?:([^\\s"'>=/]+)(${ll}*=${ll}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),Qu=/'/g,td=/"/g,Fg=/^(?:script|style|textarea|title)$/i,ww=n=>(t,...e)=>({_$litType$:n,strings:t,values:e}),U=ww(1),ye=Symbol.for("lit-noChange"),yt=Symbol.for("lit-nothing"),ed=new WeakMap,gi=Ei.createTreeWalker(Ei,129);function Ng(n,t){if(!vh(n)||!n.hasOwnProperty("raw"))throw Error("invalid template strings array");return Yu!==void 0?Yu.createHTML(t):t}const vw=(n,t)=>{const e=n.length-1,i=[];let r,s=t===2?"<svg>":t===3?"<math>":"",o=Br;for(let a=0;a<e;a++){const l=n[a];let c,h,u=-1,d=0;for(;d<l.length&&(o.lastIndex=d,h=o.exec(l),h!==null);)d=o.lastIndex,o===Br?h[1]==="!--"?o=Zu:h[1]!==void 0?o=Ju:h[2]!==void 0?(Fg.test(h[2])&&(r=RegExp("</"+h[2],"g")),o=si):h[3]!==void 0&&(o=si):o===si?h[0]===">"?(o=r??Br,u=-1):h[1]===void 0?u=-2:(u=o.lastIndex-h[2].length,c=h[1],o=h[3]===void 0?si:h[3]==='"'?td:Qu):o===td||o===Qu?o=si:o===Zu||o===Ju?o=Br:(o=si,r=void 0);const f=o===si&&n[a+1].startsWith("/>")?" ":"";s+=o===Br?l+_w:u>=0?(i.push(c),l.slice(0,u)+Dg+l.slice(u)+kn+f):l+kn+(u===-2?a:f)}return[Ng(n,s+(n[e]||"<?>")+(t===2?"</svg>":t===3?"</math>":"")),i]};let ac=class $g{constructor({strings:t,_$litType$:e},i){let r;this.parts=[];let s=0,o=0;const a=t.length-1,l=this.parts,[c,h]=vw(t,e);if(this.el=$g.createElement(c,i),gi.currentNode=this.el.content,e===2||e===3){const u=this.el.content.firstChild;u.replaceWith(...u.childNodes)}for(;(r=gi.nextNode())!==null&&l.length<a;){if(r.nodeType===1){if(r.hasAttributes())for(const u of r.getAttributeNames())if(u.endsWith(Dg)){const d=h[o++],f=r.getAttribute(u).split(kn),g=/([.?@])?(.*)/.exec(d);l.push({type:1,index:s,name:g[2],strings:f,ctor:g[1]==="."?Ew:g[1]==="?"?xw:g[1]==="@"?Cw:Ca}),r.removeAttribute(u)}else u.startsWith(kn)&&(l.push({type:6,index:s}),r.removeAttribute(u));if(Fg.test(r.tagName)){const u=r.textContent.split(kn),d=u.length-1;if(d>0){r.textContent=Oo?Oo.emptyScript:"";for(let f=0;f<d;f++)r.append(u[f],ys()),gi.nextNode(),l.push({type:2,index:++s});r.append(u[d],ys())}}}else if(r.nodeType===8)if(r.data===Mg)l.push({type:2,index:s});else{let u=-1;for(;(u=r.data.indexOf(kn,u+1))!==-1;)l.push({type:7,index:s}),u+=kn.length-1}s++}}static createElement(t,e){const i=Ei.createElement("template");return i.innerHTML=t,i}};function fr(n,t,e=n,i){if(t===ye)return t;let r=i!==void 0?e._$Co?.[i]:e._$Cl;const s=ws(t)?void 0:t._$litDirective$;return r?.constructor!==s&&(r?._$AO?.(!1),s===void 0?r=void 0:(r=new s(n),r._$AT(n,e,i)),i!==void 0?(e._$Co??=[])[i]=r:e._$Cl=r),r!==void 0&&(t=fr(n,r._$AS(n,t.values),r,i)),t}let bw=class{constructor(t,e){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=e}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){const{el:{content:e},parts:i}=this._$AD,r=(t?.creationScope??Ei).importNode(e,!0);gi.currentNode=r;let s=gi.nextNode(),o=0,a=0,l=i[0];for(;l!==void 0;){if(o===l.index){let c;l.type===2?c=new bh(s,s.nextSibling,this,t):l.type===1?c=new l.ctor(s,l.name,l.strings,this,t):l.type===6&&(c=new Sw(s,this,t)),this._$AV.push(c),l=i[++a]}o!==l?.index&&(s=gi.nextNode(),o++)}return gi.currentNode=Ei,r}p(t){let e=0;for(const i of this._$AV)i!==void 0&&(i.strings!==void 0?(i._$AI(t,i,e),e+=i.strings.length-2):i._$AI(t[e])),e++}},bh=class Vg{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(t,e,i,r){this.type=2,this._$AH=yt,this._$AN=void 0,this._$AA=t,this._$AB=e,this._$AM=i,this.options=r,this._$Cv=r?.isConnected??!0}get parentNode(){let t=this._$AA.parentNode;const e=this._$AM;return e!==void 0&&t?.nodeType===11&&(t=e.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,e=this){t=fr(this,t,e),ws(t)?t===yt||t==null||t===""?(this._$AH!==yt&&this._$AR(),this._$AH=yt):t!==this._$AH&&t!==ye&&this._(t):t._$litType$!==void 0?this.$(t):t.nodeType!==void 0?this.T(t):yw(t)?this.k(t):this._(t)}O(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}T(t){this._$AH!==t&&(this._$AR(),this._$AH=this.O(t))}_(t){this._$AH!==yt&&ws(this._$AH)?this._$AA.nextSibling.data=t:this.T(Ei.createTextNode(t)),this._$AH=t}$(t){const{values:e,_$litType$:i}=t,r=typeof i=="number"?this._$AC(t):(i.el===void 0&&(i.el=ac.createElement(Ng(i.h,i.h[0]),this.options)),i);if(this._$AH?._$AD===r)this._$AH.p(e);else{const s=new bw(r,this),o=s.u(this.options);s.p(e),this.T(o),this._$AH=s}}_$AC(t){let e=ed.get(t.strings);return e===void 0&&ed.set(t.strings,e=new ac(t)),e}k(t){vh(this._$AH)||(this._$AH=[],this._$AR());const e=this._$AH;let i,r=0;for(const s of t)r===e.length?e.push(i=new Vg(this.O(ys()),this.O(ys()),this,this.options)):i=e[r],i._$AI(s),r++;r<e.length&&(this._$AR(i&&i._$AB.nextSibling,r),e.length=r)}_$AR(t=this._$AA.nextSibling,e){for(this._$AP?.(!1,!0,e);t!==this._$AB;){const i=t.nextSibling;t.remove(),t=i}}setConnected(t){this._$AM===void 0&&(this._$Cv=t,this._$AP?.(t))}},Ca=class{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(t,e,i,r,s){this.type=1,this._$AH=yt,this._$AN=void 0,this.element=t,this.name=e,this._$AM=r,this.options=s,i.length>2||i[0]!==""||i[1]!==""?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=yt}_$AI(t,e=this,i,r){const s=this.strings;let o=!1;if(s===void 0)t=fr(this,t,e,0),o=!ws(t)||t!==this._$AH&&t!==ye,o&&(this._$AH=t);else{const a=t;let l,c;for(t=s[0],l=0;l<s.length-1;l++)c=fr(this,a[i+l],e,l),c===ye&&(c=this._$AH[l]),o||=!ws(c)||c!==this._$AH[l],c===yt?t=yt:t!==yt&&(t+=(c??"")+s[l+1]),this._$AH[l]=c}o&&!r&&this.j(t)}j(t){t===yt?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t??"")}},Ew=class extends Ca{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===yt?void 0:t}},xw=class extends Ca{constructor(){super(...arguments),this.type=4}j(t){this.element.toggleAttribute(this.name,!!t&&t!==yt)}},Cw=class extends Ca{constructor(t,e,i,r,s){super(t,e,i,r,s),this.type=5}_$AI(t,e=this){if((t=fr(this,t,e,0)??yt)===ye)return;const i=this._$AH,r=t===yt&&i!==yt||t.capture!==i.capture||t.once!==i.once||t.passive!==i.passive,s=t!==yt&&(i===yt||r);r&&this.element.removeEventListener(this.name,this,i),s&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,t):this._$AH.handleEvent(t)}},Sw=class{constructor(t,e,i){this.element=t,this.type=6,this._$AN=void 0,this._$AM=e,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(t){fr(this,t)}};const Tw=wh.litHtmlPolyfillSupport;Tw?.(ac,bh),(wh.litHtmlVersions??=[]).push("3.3.1");const Iw=(n,t,e)=>{const i=e?.renderBefore??t;let r=i._$litPart$;if(r===void 0){const s=e?.renderBefore??null;i._$litPart$=r=new bh(t.insertBefore(ys(),s),s,void 0,e??{})}return r._$AI(n),r};const Eh=globalThis;let Xt=class extends Xi{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const t=super.createRenderRoot();return this.renderOptions.renderBefore??=t.firstChild,t}update(t){const e=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=Iw(e,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return ye}};Xt._$litElement$=!0,Xt.finalized=!0,Eh.litElementHydrateSupport?.({LitElement:Xt});const Rw=Eh.litElementPolyfillSupport;Rw?.({LitElement:Xt});(Eh.litElementVersions??=[]).push("4.2.1");const Aw=!1,Gi=new ca,Bi=new ca,nd=new Hf,id=new Hf,Pw=new gt,Lw=new gt;class Ow{constructor(t){this.viewer=t,this.dragging_=!1,this.active_=!1,this.handleDownEvent_=this.handleDownEvent.bind(this),this.handleMoveEvent_=this.handleMoveEvent.bind(this),this.handleUpEvent_=this.handleUpEvent.bind(this)}get active(){return this.active_}set active(t){t!==this.active_&&(this.active_=t,this.viewer.scene.screenSpaceCameraController.enableInputs=!t,t?(this.viewer.screenSpaceEventHandler.setInputAction(this.handleDownEvent_,ai.LEFT_DOWN),this.viewer.screenSpaceEventHandler.setInputAction(this.handleMoveEvent_,ai.MOUSE_MOVE),this.viewer.screenSpaceEventHandler.setInputAction(this.handleUpEvent_,ai.LEFT_UP)):(this.viewer.screenSpaceEventHandler.removeInputAction(ai.LEFT_DOWN),this.viewer.screenSpaceEventHandler.removeInputAction(ai.MOUSE_MOVE),this.viewer.screenSpaceEventHandler.removeInputAction(ai.LEFT_UP)))}handleDownEvent(){this.dragging_=!0}handleMoveEvent(t){if(!this.dragging_)return;const e=this.viewer.camera;let i=0;Gi.x=t.startPosition.x,Gi.y=0,Bi.x=t.endPosition.x,Bi.y=0;let r=e.getPickRay(Gi,nd).direction,s=e.getPickRay(Bi,id).direction,o=gt.dot(r,s);o<1&&(i=Math.acos(o)),i=t.startPosition.x>t.endPosition.x?-i:i;const a=this.viewer.scene.globe.ellipsoid.geodeticSurfaceNormal(e.position);e.look(a,-i),Gi.x=0,Gi.y=t.startPosition.y,Bi.x=0,Bi.y=t.endPosition.y,r=e.getPickRay(Gi,nd).direction,s=e.getPickRay(Bi,id).direction,i=0,o=gt.dot(r,s),o<1&&(i=Math.acos(o)),i=t.startPosition.y>t.endPosition.y?-i:i;const l=e.direction,c=gt.negate(a,Pw),h=gt.equalsEpsilon(l,a,An.EPSILON2),u=gt.equalsEpsilon(l,c,An.EPSILON2);if(!h&&!u){o=gt.dot(l,a);let d=An.acosClamped(o);i>0&&i>d&&(i=d-An.EPSILON4),o=gt.dot(l,c),d=An.acosClamped(o),i<0&&-i>d&&(i=-d+An.EPSILON4);const f=gt.cross(a,l,Lw);e.look(f,i)}else(h&&i<0||u&&i>0)&&e.look(e.right,-i)}handleUpEvent(){this.dragging_=!1}}var zg=()=>({checkValidity(n){const t=n.input,e={message:"",isValid:!0,invalidKeys:[]};if(!t)return e;let i=!0;if("checkValidity"in t&&(i=t.checkValidity()),i)return e;if(e.isValid=!1,"validationMessage"in t&&(e.message=t.validationMessage),!("validity"in t))return e.invalidKeys.push("customError"),e;for(const r in t.validity){if(r==="valid")continue;const s=r;t.validity[s]&&e.invalidKeys.push(s)}return e}});var kw=Object.defineProperty,Dw=Object.getOwnPropertyDescriptor,Gg=n=>{throw TypeError(n)},A=(n,t,e,i)=>{for(var r=i>1?void 0:i?Dw(t,e):t,s=n.length-1,o;s>=0;s--)(o=n[s])&&(r=(i?o(t,e,r):o(r))||r);return i&&r&&kw(t,e,r),r},Bg=(n,t,e)=>t.has(n)||Gg("Cannot "+e),Mw=(n,t,e)=>(Bg(n,t,"read from private field"),t.get(n)),Fw=(n,t,e)=>t.has(n)?Gg("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,e),Nw=(n,t,e,i)=>(Bg(n,t,"write to private field"),t.set(n,e),e);var $w=`:host {
  box-sizing: border-box !important;
}

:host *,
:host *::before,
:host *::after {
  box-sizing: inherit !important;
}

[hidden] {
  display: none !important;
}
`,vo,ue=class extends Xt{constructor(){super(),Fw(this,vo,!1),this.initialReflectedProperties=new Map,this.didSSR=!!this.shadowRoot,this.customStates={set:(t,e)=>{if(this.internals?.states)try{e?this.internals.states.add(t):this.internals.states.delete(t)}catch(i){if(String(i).includes("must start with '--'"))console.error("Your browser implements an outdated version of CustomStateSet. Consider using a polyfill");else throw i}},has:t=>{if(!this.internals?.states)return!1;try{return this.internals.states.has(t)}catch{return!1}}};try{this.internals=this.attachInternals()}catch{console.error("Element internals are not supported in your browser. Consider using a polyfill")}this.customStates.set("wa-defined",!0);let n=this.constructor;for(let[t,e]of n.elementProperties)e.default==="inherit"&&e.initial!==void 0&&typeof t=="string"&&this.customStates.set(`initial-${t}-${e.initial}`,!0)}static get styles(){const n=Array.isArray(this.css)?this.css:this.css?[this.css]:[];return[$w,...n].map(t=>typeof t=="string"?Jf(t):t)}attributeChangedCallback(n,t,e){Mw(this,vo)||(this.constructor.elementProperties.forEach((i,r)=>{i.reflect&&this[r]!=null&&this.initialReflectedProperties.set(r,this[r])}),Nw(this,vo,!0)),super.attributeChangedCallback(n,t,e)}willUpdate(n){super.willUpdate(n),this.initialReflectedProperties.forEach((t,e)=>{n.has(e)&&this[e]==null&&(this[e]=t)})}firstUpdated(n){super.firstUpdated(n),this.didSSR&&this.shadowRoot?.querySelectorAll("slot").forEach(t=>{t.dispatchEvent(new Event("slotchange",{bubbles:!0,composed:!1,cancelable:!1}))})}update(n){try{super.update(n)}catch(t){if(this.didSSR&&!this.hasUpdated){const e=new Event("lit-hydration-error",{bubbles:!0,composed:!0,cancelable:!1});e.error=t,this.dispatchEvent(e)}throw t}}relayNativeEvent(n,t){n.stopImmediatePropagation(),this.dispatchEvent(new n.constructor(n.type,{...n,...t}))}};vo=new WeakMap;A([P()],ue.prototype,"dir",2);A([P()],ue.prototype,"lang",2);A([P({type:Boolean,reflect:!0,attribute:"did-ssr"})],ue.prototype,"didSSR",2);var Ug=class extends Event{constructor(){super("wa-invalid",{bubbles:!0,cancelable:!1,composed:!0})}},Vw=()=>({observedAttributes:["custom-error"],checkValidity(n){const t={message:"",isValid:!0,invalidKeys:[]};return n.customError&&(t.message=n.customError,t.isValid=!1,t.invalidKeys=["customError"]),t}}),Te=class extends ue{constructor(){super(),this.name=null,this.disabled=!1,this.required=!1,this.assumeInteractionOn=["input"],this.validators=[],this.valueHasChanged=!1,this.hasInteracted=!1,this.customError=null,this.emittedEvents=[],this.emitInvalid=n=>{n.target===this&&(this.hasInteracted=!0,this.dispatchEvent(new Ug))},this.handleInteraction=n=>{const t=this.emittedEvents;t.includes(n.type)||t.push(n.type),t.length===this.assumeInteractionOn?.length&&(this.hasInteracted=!0)},this.addEventListener("invalid",this.emitInvalid)}static get validators(){return[Vw()]}static get observedAttributes(){const n=new Set(super.observedAttributes||[]);for(const t of this.validators)if(t.observedAttributes)for(const e of t.observedAttributes)n.add(e);return[...n]}connectedCallback(){super.connectedCallback(),this.updateValidity(),this.assumeInteractionOn.forEach(n=>{this.addEventListener(n,this.handleInteraction)})}firstUpdated(...n){super.firstUpdated(...n),this.updateValidity()}willUpdate(n){if(n.has("customError")&&(this.customError||(this.customError=null),this.setCustomValidity(this.customError||"")),n.has("value")||n.has("disabled")){const t=this.value;if(Array.isArray(t)){if(this.name){const e=new FormData;for(const i of t)e.append(this.name,i);this.setValue(e,e)}}else this.setValue(t,t)}n.has("disabled")&&(this.customStates.set("disabled",this.disabled),(this.hasAttribute("disabled")||!this.matches(":disabled"))&&this.toggleAttribute("disabled",this.disabled)),this.updateValidity(),super.willUpdate(n)}get labels(){return this.internals.labels}getForm(){return this.internals.form}get validity(){return this.internals.validity}get willValidate(){return this.internals.willValidate}get validationMessage(){return this.internals.validationMessage}checkValidity(){return this.updateValidity(),this.internals.checkValidity()}reportValidity(){return this.updateValidity(),this.hasInteracted=!0,this.internals.reportValidity()}get validationTarget(){return this.input||void 0}setValidity(...n){const t=n[0],e=n[1];let i=n[2];i||(i=this.validationTarget),this.internals.setValidity(t,e,i||void 0),this.requestUpdate("validity"),this.setCustomStates()}setCustomStates(){const n=!!this.required,t=this.internals.validity.valid,e=this.hasInteracted;this.customStates.set("required",n),this.customStates.set("optional",!n),this.customStates.set("invalid",!t),this.customStates.set("valid",t),this.customStates.set("user-invalid",!t&&e),this.customStates.set("user-valid",t&&e)}setCustomValidity(n){if(!n){this.customError=null,this.setValidity({});return}this.customError=n,this.setValidity({customError:!0},n,this.validationTarget)}formResetCallback(){this.resetValidity(),this.hasInteracted=!1,this.valueHasChanged=!1,this.emittedEvents=[],this.updateValidity()}formDisabledCallback(n){this.disabled=n,this.updateValidity()}formStateRestoreCallback(n,t){this.value=n,t==="restore"&&this.resetValidity(),this.updateValidity()}setValue(...n){const[t,e]=n;this.internals.setFormValue(t,e)}get allValidators(){const n=this.constructor.validators||[],t=this.validators||[];return[...n,...t]}resetValidity(){this.setCustomValidity(""),this.setValidity({})}updateValidity(){if(this.disabled||this.hasAttribute("disabled")||!this.willValidate){this.resetValidity();return}const n=this.allValidators;if(!n?.length)return;const t={customError:!!this.customError},e=this.validationTarget||this.input||void 0;let i="";for(const r of n){const{isValid:s,message:o,invalidKeys:a}=r.checkValidity(this);s||(i||(i=o),a?.length>=0&&a.forEach(l=>t[l]=!0))}i||(i=this.validationMessage),this.setValidity(t,i,e)}};Te.formAssociated=!0;A([P({reflect:!0})],Te.prototype,"name",2);A([P({type:Boolean})],Te.prototype,"disabled",2);A([P({state:!0,attribute:!1})],Te.prototype,"valueHasChanged",2);A([P({state:!0,attribute:!1})],Te.prototype,"hasInteracted",2);A([P({attribute:"custom-error",reflect:!0})],Te.prototype,"customError",2);A([P({attribute:!1,state:!0,type:Object})],Te.prototype,"validity",1);var xh=`@layer wa-utilities {
  :where(:root),
  .wa-neutral,
  :host([variant='neutral']) {
    --wa-color-fill-loud: var(--wa-color-neutral-fill-loud);
    --wa-color-fill-normal: var(--wa-color-neutral-fill-normal);
    --wa-color-fill-quiet: var(--wa-color-neutral-fill-quiet);
    --wa-color-border-loud: var(--wa-color-neutral-border-loud);
    --wa-color-border-normal: var(--wa-color-neutral-border-normal);
    --wa-color-border-quiet: var(--wa-color-neutral-border-quiet);
    --wa-color-on-loud: var(--wa-color-neutral-on-loud);
    --wa-color-on-normal: var(--wa-color-neutral-on-normal);
    --wa-color-on-quiet: var(--wa-color-neutral-on-quiet);
  }

  .wa-brand,
  :host([variant='brand']) {
    --wa-color-fill-loud: var(--wa-color-brand-fill-loud);
    --wa-color-fill-normal: var(--wa-color-brand-fill-normal);
    --wa-color-fill-quiet: var(--wa-color-brand-fill-quiet);
    --wa-color-border-loud: var(--wa-color-brand-border-loud);
    --wa-color-border-normal: var(--wa-color-brand-border-normal);
    --wa-color-border-quiet: var(--wa-color-brand-border-quiet);
    --wa-color-on-loud: var(--wa-color-brand-on-loud);
    --wa-color-on-normal: var(--wa-color-brand-on-normal);
    --wa-color-on-quiet: var(--wa-color-brand-on-quiet);
  }

  .wa-success,
  :host([variant='success']) {
    --wa-color-fill-loud: var(--wa-color-success-fill-loud);
    --wa-color-fill-normal: var(--wa-color-success-fill-normal);
    --wa-color-fill-quiet: var(--wa-color-success-fill-quiet);
    --wa-color-border-loud: var(--wa-color-success-border-loud);
    --wa-color-border-normal: var(--wa-color-success-border-normal);
    --wa-color-border-quiet: var(--wa-color-success-border-quiet);
    --wa-color-on-loud: var(--wa-color-success-on-loud);
    --wa-color-on-normal: var(--wa-color-success-on-normal);
    --wa-color-on-quiet: var(--wa-color-success-on-quiet);
  }

  .wa-warning,
  :host([variant='warning']) {
    --wa-color-fill-loud: var(--wa-color-warning-fill-loud);
    --wa-color-fill-normal: var(--wa-color-warning-fill-normal);
    --wa-color-fill-quiet: var(--wa-color-warning-fill-quiet);
    --wa-color-border-loud: var(--wa-color-warning-border-loud);
    --wa-color-border-normal: var(--wa-color-warning-border-normal);
    --wa-color-border-quiet: var(--wa-color-warning-border-quiet);
    --wa-color-on-loud: var(--wa-color-warning-on-loud);
    --wa-color-on-normal: var(--wa-color-warning-on-normal);
    --wa-color-on-quiet: var(--wa-color-warning-on-quiet);
  }

  .wa-danger,
  :host([variant='danger']) {
    --wa-color-fill-loud: var(--wa-color-danger-fill-loud);
    --wa-color-fill-normal: var(--wa-color-danger-fill-normal);
    --wa-color-fill-quiet: var(--wa-color-danger-fill-quiet);
    --wa-color-border-loud: var(--wa-color-danger-border-loud);
    --wa-color-border-normal: var(--wa-color-danger-border-normal);
    --wa-color-border-quiet: var(--wa-color-danger-border-quiet);
    --wa-color-on-loud: var(--wa-color-danger-on-loud);
    --wa-color-on-normal: var(--wa-color-danger-on-normal);
    --wa-color-on-quiet: var(--wa-color-danger-on-quiet);
  }
}
`;var Bs=class{constructor(n,...t){this.slotNames=[],this.handleSlotChange=e=>{const i=e.target;(this.slotNames.includes("[default]")&&!i.name||i.name&&this.slotNames.includes(i.name))&&this.host.requestUpdate()},(this.host=n).addController(this),this.slotNames=t}hasDefaultSlot(){return[...this.host.childNodes].some(n=>{if(n.nodeType===Node.TEXT_NODE&&n.textContent.trim()!=="")return!0;if(n.nodeType===Node.ELEMENT_NODE){const t=n;if(t.tagName.toLowerCase()==="wa-visually-hidden")return!1;if(!t.hasAttribute("slot"))return!0}return!1})}hasNamedSlot(n){return this.host.querySelector(`:scope > [slot="${n}"]`)!==null}test(n){return n==="[default]"?this.hasDefaultSlot():this.hasNamedSlot(n)}hostConnected(){this.host.shadowRoot.addEventListener("slotchange",this.handleSlotChange)}hostDisconnected(){this.host.shadowRoot.removeEventListener("slotchange",this.handleSlotChange)}};var Rr=`@layer wa-utilities {
  :host([size='small']),
  .wa-size-s {
    font-size: var(--wa-font-size-s);
  }

  :host([size='medium']),
  .wa-size-m {
    font-size: var(--wa-font-size-m);
  }

  :host([size='large']),
  .wa-size-l {
    font-size: var(--wa-font-size-l);
  }
}
`;var jg={$code:"en",$name:"English",$dir:"ltr",carousel:"Carousel",clearEntry:"Clear entry",close:"Close",copied:"Copied",copy:"Copy",currentValue:"Current value",error:"Error",goToSlide:(n,t)=>`Go to slide ${n} of ${t}`,hidePassword:"Hide password",loading:"Loading",nextSlide:"Next slide",numOptionsSelected:n=>n===0?"No options selected":n===1?"1 option selected":`${n} options selected`,pauseAnimation:"Pause animation",playAnimation:"Play animation",previousSlide:"Previous slide",progress:"Progress",remove:"Remove",resize:"Resize",scrollableRegion:"Scrollable region",scrollToEnd:"Scroll to end",scrollToStart:"Scroll to start",selectAColorFromTheScreen:"Select a color from the screen",showPassword:"Show password",slideNum:n=>`Slide ${n}`,toggleColorFormat:"Toggle color format",zoomIn:"Zoom in",zoomOut:"Zoom out"};Xc(jg);var zw=jg;var wn=class extends Jn{};Xc(zw);function ti(n,t){const e={waitUntilFirstUpdate:!1,...t};return(i,r)=>{const{update:s}=i,o=Array.isArray(n)?n:[n];i.update=function(a){o.forEach(l=>{const c=l;if(a.has(c)){const h=a.get(c),u=this[c];h!==u&&(!e.waitUntilFirstUpdate||this.hasUpdated)&&this[r](h,u)}}),s.call(this,a)}}}const Pn={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4},Ch=n=>(...t)=>({_$litDirective$:n,values:t});let Sh=class{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,e,i){this._$Ct=t,this._$AM=e,this._$Ci=i}_$AS(t,e){return this.update(t,e)}update(t,e){return this.render(...e)}};const zn=Ch(class extends Sh{constructor(n){if(super(n),n.type!==Pn.ATTRIBUTE||n.name!=="class"||n.strings?.length>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(n){return" "+Object.keys(n).filter((t=>n[t])).join(" ")+" "}update(n,[t]){if(this.st===void 0){this.st=new Set,n.strings!==void 0&&(this.nt=new Set(n.strings.join(" ").split(/\s/).filter((i=>i!==""))));for(const i in t)t[i]&&!this.nt?.has(i)&&this.st.add(i);return this.render(t)}const e=n.element.classList;for(const i of this.st)i in t||(e.remove(i),this.st.delete(i));for(const i in t){const r=!!t[i];r===this.st.has(i)||this.nt?.has(i)||(r?(e.add(i),this.st.add(i)):(e.remove(i),this.st.delete(i)))}return ye}});const ft=n=>n??yt;const Wg=Symbol.for(""),Gw=n=>{if(n?.r===Wg)return n?._$litStatic$},rd=(n,...t)=>({_$litStatic$:t.reduce(((e,i,r)=>e+(s=>{if(s._$litStatic$!==void 0)return s._$litStatic$;throw Error(`Value passed to 'literal' function must be a 'literal' result: ${s}. Use 'unsafeStatic' to pass non-literal values, but
            take care to ensure page security.`)})(i)+n[r+1]),n[0]),r:Wg}),sd=new Map,Bw=n=>(t,...e)=>{const i=e.length;let r,s;const o=[],a=[];let l,c=0,h=!1;for(;c<i;){for(l=t[c];c<i&&(s=e[c],(r=Gw(s))!==void 0);)l+=r+t[++c],h=!0;c!==i&&a.push(s),o.push(l),c++}if(c===i&&o.push(t[i]),h){const u=o.join("$$lit$$");(t=sd.get(u))===void 0&&(o.raw=o,sd.set(u,t=o)),e=a}return n(t,...e)},cl=Bw(U);var Uw=`@layer wa-component {
  :host {
    display: inline-block;

    /* Workaround because Chrome doesn't like :host(:has()) below
     * https://issues.chromium.org/issues/40062355
     * Firefox doesn't like this nested rule, so both are needed */
    &:has(wa-badge) {
      position: relative;
    }
  }

  /* Apply relative positioning only when needed to position wa-badge
   * This avoids creating a new stacking context for every button */
  :host(:has(wa-badge)) {
    position: relative;
  }
}

.button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  text-decoration: none;
  user-select: none;
  -webkit-user-select: none;
  white-space: nowrap;
  vertical-align: middle;
  transition-property: background, border, box-shadow, color;
  transition-duration: var(--wa-transition-fast);
  transition-timing-function: var(--wa-transition-easing);
  cursor: pointer;
  padding: 0 var(--wa-form-control-padding-inline);
  font-family: inherit;
  font-size: inherit;
  font-weight: var(--wa-font-weight-action);
  line-height: calc(var(--wa-form-control-height) - var(--border-width) * 2);
  height: var(--wa-form-control-height);
  width: 100%;

  background-color: var(--wa-color-fill-loud, var(--wa-color-neutral-fill-loud));
  border-color: transparent;
  color: var(--wa-color-on-loud, var(--wa-color-neutral-on-loud));
  border-radius: var(--wa-form-control-border-radius);
  border-style: var(--wa-border-style);
  border-width: var(--wa-border-width-s);
}

/* Appearance modifiers */
:host([appearance='plain']) {
  .button {
    color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
    background-color: transparent;
    border-color: transparent;
  }
  @media (hover: hover) {
    .button:not(.disabled):not(.loading):hover {
      color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
      background-color: var(--wa-color-fill-quiet, var(--wa-color-neutral-fill-quiet));
    }
  }
  .button:not(.disabled):not(.loading):active {
    color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
    background-color: color-mix(
      in oklab,
      var(--wa-color-fill-quiet, var(--wa-color-neutral-fill-quiet)),
      var(--wa-color-mix-active)
    );
  }
}

:host([appearance='outlined']) {
  .button {
    color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
    background-color: transparent;
    border-color: var(--wa-color-border-loud, var(--wa-color-neutral-border-loud));
  }
  @media (hover: hover) {
    .button:not(.disabled):not(.loading):hover {
      color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
      background-color: var(--wa-color-fill-quiet, var(--wa-color-neutral-fill-quiet));
    }
  }
  .button:not(.disabled):not(.loading):active {
    color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
    background-color: color-mix(
      in oklab,
      var(--wa-color-fill-quiet, var(--wa-color-neutral-fill-quiet)),
      var(--wa-color-mix-active)
    );
  }
}

:host([appearance='filled']) {
  .button {
    color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
    background-color: var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal));
    border-color: transparent;
  }
  @media (hover: hover) {
    .button:not(.disabled):not(.loading):hover {
      color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
      background-color: color-mix(
        in oklab,
        var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal)),
        var(--wa-color-mix-hover)
      );
    }
  }
  .button:not(.disabled):not(.loading):active {
    color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
    background-color: color-mix(
      in oklab,
      var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal)),
      var(--wa-color-mix-active)
    );
  }
}

:host([appearance='filled-outlined']) {
  .button {
    color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
    background-color: var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal));
    border-color: var(--wa-color-border-normal, var(--wa-color-neutral-border-normal));
  }
  @media (hover: hover) {
    .button:not(.disabled):not(.loading):hover {
      color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
      background-color: color-mix(
        in oklab,
        var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal)),
        var(--wa-color-mix-hover)
      );
    }
  }
  .button:not(.disabled):not(.loading):active {
    color: var(--wa-color-on-normal, var(--wa-color-neutral-on-normal));
    background-color: color-mix(
      in oklab,
      var(--wa-color-fill-normal, var(--wa-color-neutral-fill-normal)),
      var(--wa-color-mix-active)
    );
  }
}

:host([appearance='accent']) {
  .button {
    color: var(--wa-color-on-loud, var(--wa-color-neutral-on-loud));
    background-color: var(--wa-color-fill-loud, var(--wa-color-neutral-fill-loud));
    border-color: transparent;
  }
  @media (hover: hover) {
    .button:not(.disabled):not(.loading):hover {
      background-color: color-mix(
        in oklab,
        var(--wa-color-fill-loud, var(--wa-color-neutral-fill-loud)),
        var(--wa-color-mix-hover)
      );
    }
  }
  .button:not(.disabled):not(.loading):active {
    background-color: color-mix(
      in oklab,
      var(--wa-color-fill-loud, var(--wa-color-neutral-fill-loud)),
      var(--wa-color-mix-active)
    );
  }
}

/* Focus states */
.button:focus {
  outline: none;
}

.button:focus-visible {
  outline: var(--wa-focus-ring);
  outline-offset: var(--wa-focus-ring-offset);
}

/* Disabled state */
.button.disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* When disabled, prevent mouse events from bubbling up from children */
.button.disabled * {
  pointer-events: none;
}

/* Keep it last so Safari doesn't stop parsing this block */
.button::-moz-focus-inner {
  border: 0;
}

/* Icon buttons */
.button.is-icon-button {
  outline-offset: 2px;
  width: var(--wa-form-control-height);
  aspect-ratio: 1;
}

.button.is-icon-button:has(wa-icon) {
  width: auto;
}

/* Pill modifier */
:host([pill]) .button {
  border-radius: var(--wa-border-radius-pill);
}

/*
 * Label
 */

.start,
.end {
  flex: 0 0 auto;
  display: flex;
  align-items: center;
  pointer-events: none;
}

.label {
  display: inline-block;
}

.is-icon-button .label {
  display: flex;
}

.label::slotted(wa-icon) {
  align-self: center;
}

/*
 * Caret modifier
 */

wa-icon[part='caret'] {
  display: flex;
  align-self: center;
  align-items: center;

  &::part(svg) {
    width: 0.875em;
    height: 0.875em;
  }

  .button:has(&) .end {
    display: none;
  }
}

/*
 * Loading modifier
 */

.loading {
  position: relative;
  cursor: wait;

  .start,
  .label,
  .end,
  .caret {
    visibility: hidden;
  }

  wa-spinner {
    --indicator-color: currentColor;
    --track-color: color-mix(in oklab, currentColor, transparent 90%);

    position: absolute;
    font-size: 1em;
    height: 1em;
    width: 1em;
    top: calc(50% - 0.5em);
    left: calc(50% - 0.5em);
  }
}

/*
 * Badges
 */

.button ::slotted(wa-badge) {
  border-color: var(--wa-color-surface-default);
  position: absolute;
  inset-block-start: 0;
  inset-inline-end: 0;
  translate: 50% -50%;
  pointer-events: none;
}

:host(:dir(rtl)) ::slotted(wa-badge) {
  translate: -50% -50%;
}

/*
* Button spacing
*/

slot[name='start']::slotted(*) {
  margin-inline-end: 0.75em;
}

slot[name='end']::slotted(*),
.button:not(.visually-hidden-label) [part='caret'] {
  margin-inline-start: 0.75em;
}

/*
 * Button group border radius modifications
 */

/* Remove border radius from all grouped buttons by default */
:host(.wa-button-group__button) .button {
  border-radius: 0;
}

/* Horizontal orientation */
:host(.wa-button-group__horizontal.wa-button-group__button-first) .button {
  border-start-start-radius: var(--wa-form-control-border-radius);
  border-end-start-radius: var(--wa-form-control-border-radius);
}

:host(.wa-button-group__horizontal.wa-button-group__button-last) .button {
  border-start-end-radius: var(--wa-form-control-border-radius);
  border-end-end-radius: var(--wa-form-control-border-radius);
}

/* Vertical orientation */
:host(.wa-button-group__vertical) {
  flex: 1 1 auto;
}

:host(.wa-button-group__vertical) .button {
  width: 100%;
  justify-content: start;
}

:host(.wa-button-group__vertical.wa-button-group__button-first) .button {
  border-start-start-radius: var(--wa-form-control-border-radius);
  border-start-end-radius: var(--wa-form-control-border-radius);
}

:host(.wa-button-group__vertical.wa-button-group__button-last) .button {
  border-end-start-radius: var(--wa-form-control-border-radius);
  border-end-end-radius: var(--wa-form-control-border-radius);
}

/* Handle pill modifier for button groups */
:host([pill].wa-button-group__horizontal.wa-button-group__button-first) .button {
  border-start-start-radius: var(--wa-border-radius-pill);
  border-end-start-radius: var(--wa-border-radius-pill);
}

:host([pill].wa-button-group__horizontal.wa-button-group__button-last) .button {
  border-start-end-radius: var(--wa-border-radius-pill);
  border-end-end-radius: var(--wa-border-radius-pill);
}

:host([pill].wa-button-group__vertical.wa-button-group__button-first) .button {
  border-start-start-radius: var(--wa-border-radius-pill);
  border-start-end-radius: var(--wa-border-radius-pill);
}

:host([pill].wa-button-group__vertical.wa-button-group__button-last) .button {
  border-end-start-radius: var(--wa-border-radius-pill);
  border-end-end-radius: var(--wa-border-radius-pill);
}
`,st=class extends Te{constructor(){super(...arguments),this.assumeInteractionOn=["click"],this.hasSlotController=new Bs(this,"[default]","start","end"),this.localize=new wn(this),this.invalid=!1,this.isIconButton=!1,this.title="",this.variant="neutral",this.appearance="accent",this.size="medium",this.withCaret=!1,this.disabled=!1,this.loading=!1,this.pill=!1,this.type="button",this.form=null}static get validators(){return[...super.validators,zg()]}constructLightDOMButton(){const n=document.createElement("button");return n.type=this.type,n.style.position="absolute",n.style.width="0",n.style.height="0",n.style.clipPath="inset(50%)",n.style.overflow="hidden",n.style.whiteSpace="nowrap",this.name&&(n.name=this.name),n.value=this.value||"",["form","formaction","formenctype","formmethod","formnovalidate","formtarget"].forEach(t=>{this.hasAttribute(t)&&n.setAttribute(t,this.getAttribute(t))}),n}handleClick(){if(!this.getForm())return;const t=this.constructLightDOMButton();this.parentElement?.append(t),t.click(),t.remove()}handleInvalid(){this.dispatchEvent(new Ug)}handleLabelSlotChange(){const n=this.labelSlot.assignedNodes({flatten:!0});let t=!1,e=!1,i=!1,r=!1;[...n].forEach(s=>{if(s.nodeType===Node.ELEMENT_NODE){const o=s;o.localName==="wa-icon"?(e=!0,t||(t=o.label!==void 0)):r=!0}else s.nodeType===Node.TEXT_NODE&&(s.textContent?.trim()||"").length>0&&(i=!0)}),this.isIconButton=e&&!i&&!r,this.isIconButton&&!t&&console.warn('Icon buttons must have a label for screen readers. Add <wa-icon label="..."> to remove this warning.',this)}isButton(){return!this.href}isLink(){return!!this.href}handleDisabledChange(){this.updateValidity()}setValue(...n){}click(){this.button.click()}focus(n){this.button.focus(n)}blur(){this.button.blur()}render(){const n=this.isLink(),t=n?rd`a`:rd`button`;return cl`
      <${t}
        part="base"
        class=${zn({button:!0,caret:this.withCaret,disabled:this.disabled,loading:this.loading,rtl:this.localize.dir()==="rtl","has-label":this.hasSlotController.test("[default]"),"has-start":this.hasSlotController.test("start"),"has-end":this.hasSlotController.test("end"),"is-icon-button":this.isIconButton})}
        ?disabled=${ft(n?void 0:this.disabled)}
        type=${ft(n?void 0:this.type)}
        title=${this.title}
        name=${ft(n?void 0:this.name)}
        value=${ft(n?void 0:this.value)}
        href=${ft(n?this.href:void 0)}
        target=${ft(n?this.target:void 0)}
        download=${ft(n?this.download:void 0)}
        rel=${ft(n&&this.rel?this.rel:void 0)}
        role=${ft(n?void 0:"button")}
        aria-disabled=${this.disabled?"true":"false"}
        tabindex=${this.disabled?"-1":"0"}
        @invalid=${this.isButton()?this.handleInvalid:null}
        @click=${this.handleClick}
      >
        <slot name="start" part="start" class="start"></slot>
        <slot part="label" class="label" @slotchange=${this.handleLabelSlotChange}></slot>
        <slot name="end" part="end" class="end"></slot>
        ${this.withCaret?cl`
                <wa-icon part="caret" class="caret" library="system" name="chevron-down" variant="solid"></wa-icon>
              `:""}
        ${this.loading?cl`<wa-spinner part="spinner"></wa-spinner>`:""}
      </${t}>
    `}};st.shadowRootOptions={...Te.shadowRootOptions,delegatesFocus:!0};st.css=[Uw,xh,Rr];A([At(".button")],st.prototype,"button",2);A([At("slot:not([name])")],st.prototype,"labelSlot",2);A([Ft()],st.prototype,"invalid",2);A([Ft()],st.prototype,"isIconButton",2);A([P()],st.prototype,"title",2);A([P({reflect:!0})],st.prototype,"variant",2);A([P({reflect:!0})],st.prototype,"appearance",2);A([P({reflect:!0})],st.prototype,"size",2);A([P({attribute:"with-caret",type:Boolean,reflect:!0})],st.prototype,"withCaret",2);A([P({type:Boolean})],st.prototype,"disabled",2);A([P({type:Boolean,reflect:!0})],st.prototype,"loading",2);A([P({type:Boolean,reflect:!0})],st.prototype,"pill",2);A([P()],st.prototype,"type",2);A([P({reflect:!0})],st.prototype,"name",2);A([P({reflect:!0})],st.prototype,"value",2);A([P({reflect:!0})],st.prototype,"href",2);A([P()],st.prototype,"target",2);A([P()],st.prototype,"rel",2);A([P()],st.prototype,"download",2);A([P({reflect:!0})],st.prototype,"form",2);A([P({attribute:"formaction"})],st.prototype,"formAction",2);A([P({attribute:"formenctype"})],st.prototype,"formEnctype",2);A([P({attribute:"formmethod"})],st.prototype,"formMethod",2);A([P({attribute:"formnovalidate",type:Boolean})],st.prototype,"formNoValidate",2);A([P({attribute:"formtarget"})],st.prototype,"formTarget",2);A([ti("disabled",{waitUntilFirstUpdate:!0})],st.prototype,"handleDisabledChange",1);st=A([bt("wa-button")],st);var jw=`:host {
  --track-width: 2px;
  --track-color: var(--wa-color-neutral-fill-normal);
  --indicator-color: var(--wa-color-brand-fill-loud);
  --speed: 2s;

  /* Resizing a spinner element using anything but font-size will break the animation because the animation uses em units.
   Therefore, if a spinner is used in a flex container without \`flex: none\` applied, the spinner can grow/shrink and
   break the animation. The use of \`flex: none\` on the host element prevents this by always having the spinner sized
   according to its actual dimensions.
  */
  flex: none;
  display: inline-flex;
  width: 1em;
  height: 1em;
}

svg {
  width: 100%;
  height: 100%;
  aspect-ratio: 1;
  animation: spin var(--speed) linear infinite;
}

.track {
  stroke: var(--track-color);
}

.indicator {
  stroke: var(--indicator-color);
  stroke-dasharray: 75, 100;
  stroke-dashoffset: -5;
  animation: dash 1.5s ease-in-out infinite;
  stroke-linecap: round;
}

@keyframes spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}

@keyframes dash {
  0% {
    stroke-dasharray: 1, 150;
    stroke-dashoffset: 0;
  }
  50% {
    stroke-dasharray: 90, 150;
    stroke-dashoffset: -35;
  }
  100% {
    stroke-dasharray: 90, 150;
    stroke-dashoffset: -124;
  }
}
`,lc=class extends ue{constructor(){super(...arguments),this.localize=new wn(this)}render(){return U`
      <svg
        part="base"
        role="progressbar"
        aria-label=${this.localize.term("loading")}
        fill="none"
        viewBox="0 0 50 50"
        xmlns="http://www.w3.org/2000/svg"
      >
        <circle class="track" cx="25" cy="25" r="20" fill="none" stroke-width="5" />
        <circle class="indicator" cx="25" cy="25" r="20" fill="none" stroke-width="5" />
      </svg>
    `}};lc.css=jw;lc=A([bt("wa-spinner")],lc);var Ww=class extends Event{constructor(){super("wa-load",{bubbles:!0,cancelable:!1,composed:!0})}};var cc="";function qw(n){cc=n}function Hw(){if(!cc){const n=document.querySelector("[data-fa-kit-code]");n&&qw(n.getAttribute("data-fa-kit-code")||"")}return cc}var tn="7.0.1";function Xw(n,t,e){const i=Hw(),r=i.length>0;let s="solid";return t==="notdog"?(e==="solid"&&(s="solid"),e==="duo-solid"&&(s="duo-solid"),`https://ka-p.fontawesome.com/releases/v${tn}/svgs/notdog-${s}/${n}.svg?token=${encodeURIComponent(i)}`):t==="chisel"?`https://ka-p.fontawesome.com/releases/v${tn}/svgs/chisel-regular/${n}.svg?token=${encodeURIComponent(i)}`:t==="etch"?`https://ka-p.fontawesome.com/releases/v${tn}/svgs/etch-solid/${n}.svg?token=${encodeURIComponent(i)}`:t==="jelly"?(e==="regular"&&(s="regular"),e==="duo-regular"&&(s="duo-regular"),e==="fill-regular"&&(s="fill-regular"),`https://ka-p.fontawesome.com/releases/v${tn}/svgs/jelly-${s}/${n}.svg?token=${encodeURIComponent(i)}`):t==="slab"?((e==="solid"||e==="regular")&&(s="regular"),e==="press-regular"&&(s="press-regular"),`https://ka-p.fontawesome.com/releases/v${tn}/svgs/slab-${s}/${n}.svg?token=${encodeURIComponent(i)}`):t==="thumbprint"?`https://ka-p.fontawesome.com/releases/v${tn}/svgs/thumbprint-light/${n}.svg?token=${encodeURIComponent(i)}`:t==="whiteboard"?`https://ka-p.fontawesome.com/releases/v${tn}/svgs/whiteboard-semibold/${n}.svg?token=${encodeURIComponent(i)}`:(t==="classic"&&(e==="thin"&&(s="thin"),e==="light"&&(s="light"),e==="regular"&&(s="regular"),e==="solid"&&(s="solid")),t==="sharp"&&(e==="thin"&&(s="sharp-thin"),e==="light"&&(s="sharp-light"),e==="regular"&&(s="sharp-regular"),e==="solid"&&(s="sharp-solid")),t==="duotone"&&(e==="thin"&&(s="duotone-thin"),e==="light"&&(s="duotone-light"),e==="regular"&&(s="duotone-regular"),e==="solid"&&(s="duotone")),t==="sharp-duotone"&&(e==="thin"&&(s="sharp-duotone-thin"),e==="light"&&(s="sharp-duotone-light"),e==="regular"&&(s="sharp-duotone-regular"),e==="solid"&&(s="sharp-duotone-solid")),t==="brands"&&(s="brands"),r?`https://ka-p.fontawesome.com/releases/v${tn}/svgs/${s}/${n}.svg?token=${encodeURIComponent(i)}`:`https://ka-f.fontawesome.com/releases/v${tn}/svgs/${s}/${n}.svg`)}var Kw={name:"default",resolver:(n,t="classic",e="solid")=>Xw(n,t,e),mutator:(n,t)=>{if(t?.family&&!n.hasAttribute("data-duotone-initialized")){const{family:e,variant:i}=t;if(e==="duotone"||e==="sharp-duotone"||e==="notdog"&&i==="duo-solid"||e==="jelly"&&i==="duo-regular"||e==="thumbprint"){const r=[...n.querySelectorAll("path")],s=r.find(a=>!a.hasAttribute("opacity")),o=r.find(a=>a.hasAttribute("opacity"));if(!s||!o)return;if(s.setAttribute("data-duotone-primary",""),o.setAttribute("data-duotone-secondary",""),t.swapOpacity&&s&&o){const a=o.getAttribute("opacity")||"0.4";s.style.setProperty("--path-opacity",a),o.style.setProperty("--path-opacity","1")}n.setAttribute("data-duotone-initialized","")}}}},Yw=Kw;function Zw(n){return`data:image/svg+xml,${encodeURIComponent(n)}`}var hl={solid:{check:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M434.8 70.1c14.3 10.4 17.5 30.4 7.1 44.7l-256 352c-5.5 7.6-14 12.3-23.4 13.1s-18.5-2.7-25.1-9.3l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l101.5 101.5 234-321.7c10.4-14.3 30.4-17.5 44.7-7.1z"/></svg>',"chevron-down":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M201.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 338.7 54.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"/></svg>',"chevron-left":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l192 192c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256 246.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192z"/></svg>',"chevron-right":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M311.1 233.4c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L243.2 256 73.9 86.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l192 192z"/></svg>',circle:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M0 256a256 256 0 1 1 512 0 256 256 0 1 1 -512 0z"/></svg>',eyedropper:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M341.6 29.2l-101.6 101.6-9.4-9.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-9.4-9.4 101.6-101.6c39-39 39-102.2 0-141.1s-102.2-39-141.1 0zM55.4 323.3c-15 15-23.4 35.4-23.4 56.6l0 42.4-26.6 39.9c-8.5 12.7-6.8 29.6 4 40.4s27.7 12.5 40.4 4l39.9-26.6 42.4 0c21.2 0 41.6-8.4 56.6-23.4l109.4-109.4-45.3-45.3-109.4 109.4c-3 3-7.1 4.7-11.3 4.7l-36.1 0 0-36.1c0-4.2 1.7-8.3 4.7-11.3l109.4-109.4-45.3-45.3-109.4 109.4z"/></svg>',"grip-vertical":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M128 40c0-22.1-17.9-40-40-40L40 0C17.9 0 0 17.9 0 40L0 88c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48zm0 192c0-22.1-17.9-40-40-40l-48 0c-22.1 0-40 17.9-40 40l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48zM0 424l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48c0-22.1-17.9-40-40-40l-48 0c-22.1 0-40 17.9-40 40zM320 40c0-22.1-17.9-40-40-40L232 0c-22.1 0-40 17.9-40 40l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48zM192 232l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48c0-22.1-17.9-40-40-40l-48 0c-22.1 0-40 17.9-40 40zM320 424c0-22.1-17.9-40-40-40l-48 0c-22.1 0-40 17.9-40 40l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48z"/></svg>',indeterminate:'<svg part="indeterminate-icon" class="icon" viewBox="0 0 16 16"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round"><g stroke="currentColor" stroke-width="2"><g transform="translate(2.285714 6.857143)"><path d="M10.2857143,1.14285714 L1.14285714,1.14285714"/></g></g></g></svg>',minus:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M0 256c0-17.7 14.3-32 32-32l384 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 288c-17.7 0-32-14.3-32-32z"/></svg>',pause:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M48 32C21.5 32 0 53.5 0 80L0 432c0 26.5 21.5 48 48 48l64 0c26.5 0 48-21.5 48-48l0-352c0-26.5-21.5-48-48-48L48 32zm224 0c-26.5 0-48 21.5-48 48l0 352c0 26.5 21.5 48 48 48l64 0c26.5 0 48-21.5 48-48l0-352c0-26.5-21.5-48-48-48l-64 0z"/></svg>',play:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M91.2 36.9c-12.4-6.8-27.4-6.5-39.6 .7S32 57.9 32 72l0 368c0 14.1 7.5 27.2 19.6 34.4s27.2 7.5 39.6 .7l336-184c12.8-7 20.8-20.5 20.8-35.1s-8-28.1-20.8-35.1l-336-184z"/></svg>',star:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M309.5-18.9c-4.1-8-12.4-13.1-21.4-13.1s-17.3 5.1-21.4 13.1L193.1 125.3 33.2 150.7c-8.9 1.4-16.3 7.7-19.1 16.3s-.5 18 5.8 24.4l114.4 114.5-25.2 159.9c-1.4 8.9 2.3 17.9 9.6 23.2s16.9 6.1 25 2L288.1 417.6 432.4 491c8 4.1 17.7 3.3 25-2s11-14.2 9.6-23.2L441.7 305.9 556.1 191.4c6.4-6.4 8.6-15.8 5.8-24.4s-10.1-14.9-19.1-16.3L383 125.3 309.5-18.9z"/></svg>',user:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M224 248a120 120 0 1 0 0-240 120 120 0 1 0 0 240zm-29.7 56C95.8 304 16 383.8 16 482.3 16 498.7 29.3 512 45.7 512l356.6 0c16.4 0 29.7-13.3 29.7-29.7 0-98.5-79.8-178.3-178.3-178.3l-59.4 0z"/></svg>',xmark:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M55.1 73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L147.2 256 9.9 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192.5 301.3 329.9 438.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.8 256 375.1 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192.5 210.7 55.1 73.4z"/></svg>'},regular:{"circle-question":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M464 256a208 208 0 1 0 -416 0 208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0 256 256 0 1 1 -512 0zm256-80c-17.7 0-32 14.3-32 32 0 13.3-10.7 24-24 24s-24-10.7-24-24c0-44.2 35.8-80 80-80s80 35.8 80 80c0 47.2-36 67.2-56 74.5l0 3.8c0 13.3-10.7 24-24 24s-24-10.7-24-24l0-8.1c0-20.5 14.8-35.2 30.1-40.2 6.4-2.1 13.2-5.5 18.2-10.3 4.3-4.2 7.7-10 7.7-19.6 0-17.7-14.3-32-32-32zM224 368a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"/></svg>',"circle-xmark":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M256 48a208 208 0 1 1 0 416 208 208 0 1 1 0-416zm0 464a256 256 0 1 0 0-512 256 256 0 1 0 0 512zM167 167c-9.4 9.4-9.4 24.6 0 33.9l55 55-55 55c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l55-55 55 55c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-55-55 55-55c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-55 55-55-55c-9.4-9.4-24.6-9.4-33.9 0z"/></svg>',copy:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M384 336l-192 0c-8.8 0-16-7.2-16-16l0-256c0-8.8 7.2-16 16-16l133.5 0c4.2 0 8.3 1.7 11.3 4.7l58.5 58.5c3 3 4.7 7.1 4.7 11.3L400 320c0 8.8-7.2 16-16 16zM192 384l192 0c35.3 0 64-28.7 64-64l0-197.5c0-17-6.7-33.3-18.7-45.3L370.7 18.7C358.7 6.7 342.5 0 325.5 0L192 0c-35.3 0-64 28.7-64 64l0 256c0 35.3 28.7 64 64 64zM64 128c-35.3 0-64 28.7-64 64L0 448c0 35.3 28.7 64 64 64l192 0c35.3 0 64-28.7 64-64l0-16-48 0 0 16c0 8.8-7.2 16-16 16L64 464c-8.8 0-16-7.2-16-16l0-256c0-8.8 7.2-16 16-16l16 0 0-48-16 0z"/></svg>',eye:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M288 80C222.8 80 169.2 109.6 128.1 147.7 89.6 183.5 63 226 49.4 256 63 286 89.6 328.5 128.1 364.3 169.2 402.4 222.8 432 288 432s118.8-29.6 159.9-67.7C486.4 328.5 513 286 526.6 256 513 226 486.4 183.5 447.9 147.7 406.8 109.6 353.2 80 288 80zM95.4 112.6C142.5 68.8 207.2 32 288 32s145.5 36.8 192.6 80.6c46.8 43.5 78.1 95.4 93 131.1 3.3 7.9 3.3 16.7 0 24.6-14.9 35.7-46.2 87.7-93 131.1-47.1 43.7-111.8 80.6-192.6 80.6S142.5 443.2 95.4 399.4c-46.8-43.5-78.1-95.4-93-131.1-3.3-7.9-3.3-16.7 0-24.6 14.9-35.7 46.2-87.7 93-131.1zM288 336c44.2 0 80-35.8 80-80 0-29.6-16.1-55.5-40-69.3-1.4 59.7-49.6 107.9-109.3 109.3 13.8 23.9 39.7 40 69.3 40zm-79.6-88.4c2.5 .3 5 .4 7.6 .4 35.3 0 64-28.7 64-64 0-2.6-.2-5.1-.4-7.6-37.4 3.9-67.2 33.7-71.1 71.1zm45.6-115c10.8-3 22.2-4.5 33.9-4.5 8.8 0 17.5 .9 25.8 2.6 .3 .1 .5 .1 .8 .2 57.9 12.2 101.4 63.7 101.4 125.2 0 70.7-57.3 128-128 128-61.6 0-113-43.5-125.2-101.4-1.8-8.6-2.8-17.5-2.8-26.6 0-11 1.4-21.8 4-32 .2-.7 .3-1.3 .5-1.9 11.9-43.4 46.1-77.6 89.5-89.5z"/></svg>',"eye-slash":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M41-24.9c-9.4-9.4-24.6-9.4-33.9 0S-2.3-.3 7 9.1l528 528c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-96.4-96.4c2.7-2.4 5.4-4.8 8-7.2 46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7 0-24.6-14.9-35.7-46.2-87.7-93-131.1-47.1-43.7-111.8-80.6-192.6-80.6-56.8 0-105.6 18.2-146 44.2L41-24.9zM176.9 111.1c32.1-18.9 69.2-31.1 111.1-31.1 65.2 0 118.8 29.6 159.9 67.7 38.5 35.7 65.1 78.3 78.6 108.3-13.6 30-40.2 72.5-78.6 108.3-3.1 2.8-6.2 5.6-9.4 8.4L393.8 328c14-20.5 22.2-45.3 22.2-72 0-70.7-57.3-128-128-128-26.7 0-51.5 8.2-72 22.2l-39.1-39.1zm182 182l-108-108c11.1-5.8 23.7-9.1 37.1-9.1 44.2 0 80 35.8 80 80 0 13.4-3.3 26-9.1 37.1zM103.4 173.2l-34-34c-32.6 36.8-55 75.8-66.9 104.5-3.3 7.9-3.3 16.7 0 24.6 14.9 35.7 46.2 87.7 93 131.1 47.1 43.7 111.8 80.6 192.6 80.6 37.3 0 71.2-7.9 101.5-20.6L352.2 422c-20 6.4-41.4 10-64.2 10-65.2 0-118.8-29.6-159.9-67.7-38.5-35.7-65.1-78.3-78.6-108.3 10.4-23.1 28.6-53.6 54-82.8z"/></svg>',star:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc. --><path fill="currentColor" d="M288.1-32c9 0 17.3 5.1 21.4 13.1L383 125.3 542.9 150.7c8.9 1.4 16.3 7.7 19.1 16.3s.5 18-5.8 24.4L441.7 305.9 467 465.8c1.4 8.9-2.3 17.9-9.6 23.2s-17 6.1-25 2L288.1 417.6 143.8 491c-8 4.1-17.7 3.3-25-2s-11-14.2-9.6-23.2L134.4 305.9 20 191.4c-6.4-6.4-8.6-15.8-5.8-24.4s10.1-14.9 19.1-16.3l159.9-25.4 73.6-144.2c4.1-8 12.4-13.1 21.4-13.1zm0 76.8L230.3 158c-3.5 6.8-10 11.6-17.6 12.8l-125.5 20 89.8 89.9c5.4 5.4 7.9 13.1 6.7 20.7l-19.8 125.5 113.3-57.6c6.8-3.5 14.9-3.5 21.8 0l113.3 57.6-19.8-125.5c-1.2-7.6 1.3-15.3 6.7-20.7l89.8-89.9-125.5-20c-7.6-1.2-14.1-6-17.6-12.8L288.1 44.8z"/></svg>'}},Jw={name:"system",resolver:(n,t="classic",e="solid")=>{let r=hl[e][n]??hl.regular[n]??hl.regular["circle-question"];return r?Zw(r):""}},Qw=Jw;var t0="classic",e0=[Yw,Qw],hc=[];function n0(n){hc.push(n)}function i0(n){hc=hc.filter(t=>t!==n)}function ul(n){return e0.find(t=>t.name===n)}function r0(){return t0}const s0=(n,t)=>n?._$litType$!==void 0,o0=n=>n.strings===void 0,a0={},l0=(n,t=a0)=>n._$AH=t;var c0=class extends Event{constructor(){super("wa-error",{bubbles:!0,cancelable:!1,composed:!0})}},h0=`:host {
  --primary-color: currentColor;
  --primary-opacity: 1;
  --secondary-color: currentColor;
  --secondary-opacity: 0.4;

  box-sizing: content-box;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  vertical-align: -0.125em;
}

/* Standard */
:host(:not([auto-width])) {
  width: 1.25em;
  height: 1em;
}

/* Auto-width */
:host([auto-width]) {
  width: auto;
  height: 1em;
}

svg {
  height: 1em;
  fill: currentColor;
  overflow: visible;

  /* Duotone colors with path-specific opacity fallback */
  path[data-duotone-primary] {
    color: var(--primary-color);
    opacity: var(--path-opacity, var(--primary-opacity));
  }

  path[data-duotone-secondary] {
    color: var(--secondary-color);
    opacity: var(--path-opacity, var(--secondary-opacity));
  }
}
`,Ur=Symbol(),ro=Symbol(),dl,fl=new Map,ie=class extends ue{constructor(){super(...arguments),this.svg=null,this.autoWidth=!1,this.swapOpacity=!1,this.label="",this.library="default",this.resolveIcon=async(n,t)=>{let e;if(t?.spriteSheet){this.hasUpdated||await this.updateComplete,this.svg=U`<svg part="svg">
        <use part="use" href="${n}"></use>
      </svg>`,await this.updateComplete;const i=this.shadowRoot.querySelector("[part='svg']");return typeof t.mutator=="function"&&t.mutator(i,this),this.svg}try{if(e=await fetch(n,{mode:"cors"}),!e.ok)return e.status===410?Ur:ro}catch{return ro}try{const i=document.createElement("div");i.innerHTML=await e.text();const r=i.firstElementChild;if(r?.tagName?.toLowerCase()!=="svg")return Ur;dl||(dl=new DOMParser);const o=dl.parseFromString(r.outerHTML,"text/html").body.querySelector("svg");return o?(o.part.add("svg"),document.adoptNode(o)):Ur}catch{return Ur}}}connectedCallback(){super.connectedCallback(),n0(this)}firstUpdated(n){super.firstUpdated(n),this.setIcon()}disconnectedCallback(){super.disconnectedCallback(),i0(this)}getIconSource(){const n=ul(this.library),t=this.family||r0();return this.name&&n?{url:n.resolver(this.name,t,this.variant,this.autoWidth),fromLibrary:!0}:{url:this.src,fromLibrary:!1}}handleLabelChange(){typeof this.label=="string"&&this.label.length>0?(this.setAttribute("role","img"),this.setAttribute("aria-label",this.label),this.removeAttribute("aria-hidden")):(this.removeAttribute("role"),this.removeAttribute("aria-label"),this.setAttribute("aria-hidden","true"))}async setIcon(){const{url:n,fromLibrary:t}=this.getIconSource(),e=t?ul(this.library):void 0;if(!n){this.svg=null;return}let i=fl.get(n);i||(i=this.resolveIcon(n,e),fl.set(n,i));const r=await i;if(r===ro&&fl.delete(n),n===this.getIconSource().url){if(s0(r)){this.svg=r;return}switch(r){case ro:case Ur:this.svg=null,this.dispatchEvent(new c0);break;default:this.svg=r.cloneNode(!0),e?.mutator?.(this.svg,this),this.dispatchEvent(new Ww)}}}updated(n){super.updated(n);const t=ul(this.library),e=this.shadowRoot?.querySelector("svg");e&&t?.mutator?.(e,this)}render(){return this.hasUpdated?this.svg:U`<svg part="svg" fill="currentColor" width="16" height="16"></svg>`}};ie.css=h0;A([Ft()],ie.prototype,"svg",2);A([P({reflect:!0})],ie.prototype,"name",2);A([P({reflect:!0})],ie.prototype,"family",2);A([P({reflect:!0})],ie.prototype,"variant",2);A([P({attribute:"auto-width",type:Boolean,reflect:!0})],ie.prototype,"autoWidth",2);A([P({attribute:"swap-opacity",type:Boolean,reflect:!0})],ie.prototype,"swapOpacity",2);A([P()],ie.prototype,"src",2);A([P()],ie.prototype,"label",2);A([P({reflect:!0})],ie.prototype,"library",2);A([ti("label")],ie.prototype,"handleLabelChange",1);A([ti(["family","name","library","variant","src","autoWidth","swapOpacity"])],ie.prototype,"setIcon",1);ie=A([bt("wa-icon")],ie);class u0 extends Xt{static get properties(){return{scene:{type:Object},heading:{type:Number}}}static get styles(){return Qf`
      :host {
        --cesium-compass-bar-tick-color: #000;
        --cesium-compass-bar-intercardinal-width: 100px;
      }
      :host * {
        box-sizing: content-box;
      }
      .container {
        display: flex;
        justify-content: center;
        height: 100%;
        overflow: hidden;
      }
      .compass-bar {
        display: flex;
        align-items: flex-end;
      }
      .compass-bar > div {
        width: var(--cesium-compass-bar-intercardinal-width);
        text-align: center;
      }
      .label {
        padding: 4px;
        color: var(--cesium-compass-bar-tick-color);
      }
      .ticks {
        display: flex;
        justify-content: space-around;
      }
      .ticks > div {
        width: 1px;
        height: 6px;
        background-color: var(--cesium-compass-bar-tick-color);
      }
      .ticks > div:nth-child(4) {
        height: 10px;
      }
      .center-tick {
        margin: auto;
        width: 4px;
        height: 4px;
        border-radius: 50%;
        background-color: var(--cesium-compass-bar-tick-color);
      }
    `}constructor(){super(),this.scene,this.intercardinalWidth,this.unlistenFromPostRender=null}updated(){this.scene&&!this.unlistenFromPostRender&&(this.unlistenFromPostRender=this.scene.postRender.addEventListener(()=>{this.heading=this.scene.camera.heading}),this.intercardinalWidth=parseInt(getComputedStyle(this).getPropertyValue("--cesium-compass-bar-intercardinal-width")))}getTransform(t){const e=this.intercardinalWidth;let i=-e/2;const r=-this.heading/(Math.PI/4)+4,s=r-t;return s<-4&&(i+=8*e),s>4&&(i-=8*e),`transform: translate(${r*e+i}px)`}render(){const t=U`
      <div class="ticks">
        ${Array(7).fill().map(()=>U`<div part="tick"></div>`)}
      </div>
    `;return U`
      <div class="container">
        <div class="compass-bar">
          <div style=${this.getTransform(4)}>
            <div class="label" part="label major">N</div>
            ${t}
          </div>
          <div style=${this.getTransform(3)}>
            <div class="label" part="label minor">NE</div>
            ${t}
          </div>
          <div style=${this.getTransform(2)}>
            <div class="label" part="label major">E</div>
            ${t}
          </div>
          <div style=${this.getTransform(1)}>
            <div class="label" part="label minor">SE</div>
            ${t}
          </div>
          <div style=${this.getTransform(0)}>
            <div class="label" part="label major">S</div>
            ${t}
          </div>
          <div style=${this.getTransform(-1)}>
            <div class="label" part="label minor">SW</div>
            ${t}
          </div>
          <div style=${this.getTransform(-2)}>
            <div class="label" part="label major">W</div>
            ${t}
          </div>
          <div style=${this.getTransform(-3)}>
            <div class="label" part="label minor">NW</div>
            ${t}
          </div>
        </div>
      </div>
      <div class="center-tick" part="center-tick"></div>
    `}}customElements.define("cesium-compass-bar",u0);var d0=`:host {
  --spacing: var(--wa-space-l);

  /* Internal calculated properties */
  --inner-border-radius: calc(var(--wa-panel-border-radius) - var(--wa-panel-border-width));

  display: flex;
  flex-direction: column;
  background-color: var(--wa-color-surface-default);
  border-color: var(--wa-color-surface-border);
  border-radius: var(--wa-panel-border-radius);
  border-style: var(--wa-panel-border-style);
  box-shadow: var(--wa-shadow-s);
  border-width: var(--wa-panel-border-width);
  color: var(--wa-color-text-normal);
}

/* Appearance modifiers */
:host([appearance~='plain']) {
  background-color: transparent;
  border-color: transparent;
  box-shadow: none;
}

:host([appearance~='outlined']) {
  background-color: var(--wa-color-surface-default);
  border-color: var(--wa-color-surface-border);
}

:host([appearance~='filled']) {
  background-color: var(--wa-color-neutral-fill-quiet);
  border-color: transparent;
}

:host([appearance~='filled'][appearance~='outlined']) {
  border-color: var(--wa-color-neutral-border-quiet);
}

:host([appearance~='accent']) {
  color: var(--wa-color-neutral-on-loud);
  background-color: var(--wa-color-neutral-fill-loud);
  border-color: transparent;
}

/* Take care of top and bottom radii */
.media,
:host(:not([with-media])) .header,
:host(:not([with-media], [with-header])) .body {
  border-start-start-radius: var(--inner-border-radius);
  border-start-end-radius: var(--inner-border-radius);
}

:host(:not([with-footer])) .body,
.footer {
  border-end-start-radius: var(--inner-border-radius);
  border-end-end-radius: var(--inner-border-radius);
}

.media {
  display: flex;
  overflow: hidden;

  &::slotted(*) {
    display: block;
    width: 100%;
    border-radius: 0 !important;
  }
}

/* Round all corners for plain appearance */
:host([appearance='plain']) .media {
  border-radius: var(--inner-border-radius);

  &::slotted(*) {
    border-radius: inherit !important;
  }
}

.header {
  display: block;
  border-block-end-style: inherit;
  border-block-end-color: var(--wa-color-surface-border);
  border-block-end-width: var(--wa-panel-border-width);
  padding: calc(var(--spacing) / 2) var(--spacing);
}

.body {
  display: block;
  padding: var(--spacing);
}

.footer {
  display: block;
  border-block-start-style: inherit;
  border-block-start-color: var(--wa-color-surface-border);
  border-block-start-width: var(--wa-panel-border-width);
  padding: var(--spacing);
}

/* Push slots to sides when the action slots renders */
.has-actions {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

:host(:not([with-header])) .header,
:host(:not([with-footer])) .footer,
:host(:not([with-media])) .media {
  display: none;
}

/* Orientation Styles */
:host([orientation='horizontal']) {
  flex-direction: row;

  .media {
    border-start-start-radius: var(--inner-border-radius);
    border-end-start-radius: var(--inner-border-radius);
    border-start-end-radius: 0;

    &::slotted(*) {
      block-size: 100%;
      inline-size: 100%;
      object-fit: cover;
    }
  }
}

:host([orientation='horizontal']) ::slotted([slot='body']) {
  display: block;
  height: 100%;
  margin: 0;
}

:host([orientation='horizontal']) ::slotted([slot='actions']) {
  display: flex;
  align-items: center;
  padding: var(--spacing);
}
`,Wn=class extends ue{constructor(){super(...arguments),this.hasSlotController=new Bs(this,"footer","header","media"),this.appearance="outlined",this.withHeader=!1,this.withMedia=!1,this.withFooter=!1,this.orientation="vertical"}updated(){!this.withHeader&&this.hasSlotController.test("header")&&(this.withHeader=!0),!this.withMedia&&this.hasSlotController.test("media")&&(this.withMedia=!0),!this.withFooter&&this.hasSlotController.test("footer")&&(this.withFooter=!0)}render(){return this.orientation==="horizontal"?U`
        <slot name="media" part="media" class="media"></slot>
        <slot part="body" class="body"></slot>
        <slot name="actions" part="actions" class="actions"></slot>
      `:U`
      <slot name="media" part="media" class="media"></slot>

      ${this.hasSlotController.test("header-actions")?U` <header part="header" class="header has-actions">
            <slot name="header"></slot>
            <slot name="header-actions"></slot>
          </header>`:U` <header part="header" class="header">
            <slot name="header"></slot>
          </header>`}

      <slot part="body" class="body"></slot>
      ${this.hasSlotController.test("footer-actions")?U` <footer part="footer" class="footer has-actions">
            <slot name="footer"></slot>
            <slot name="footer-actions"></slot>
          </footer>`:U` <footer part="footer" class="footer">
            <slot name="footer"></slot>
          </footer>`}
    `}};Wn.css=[Rr,d0];A([P({reflect:!0})],Wn.prototype,"appearance",2);A([P({attribute:"with-header",type:Boolean,reflect:!0})],Wn.prototype,"withHeader",2);A([P({attribute:"with-media",type:Boolean,reflect:!0})],Wn.prototype,"withMedia",2);A([P({attribute:"with-footer",type:Boolean,reflect:!0})],Wn.prototype,"withFooter",2);A([P({reflect:!0})],Wn.prototype,"orientation",2);Wn=A([bt("wa-card")],Wn);const Yt={ADD:"add",REMOVE:"remove"},od={LENGTH:"length"};class so extends yn{constructor(t,e,i){super(t),this.element=e,this.index=i}}class we extends Ke{constructor(t,e){if(super(),this.on,this.once,this.un,e=e||{},this.unique_=!!e.unique,this.array_=t??[],this.unique_)for(let i=1,r=this.array_.length;i<r;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,i=t.length;e<i;++e)this.push(t[e]);return this}forEach(t){const e=this.array_;for(let i=0,r=e.length;i<r;++i)t(e[i],i,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(od.LENGTH)}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new so(Yt.ADD,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){const e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){const e=this.array_;for(let i=0,r=e.length;i<r;++i)if(e[i]===t)return this.removeAt(i)}removeAt(t){if(t<0||t>=this.getLength())return;const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new so(Yt.REMOVE,e,t)),e}setAt(t,e){const i=this.getLength();if(t>=i){this.insertAt(t,e);return}if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);const r=this.array_[t];this.array_[t]=e,this.dispatchEvent(new so(Yt.REMOVE,r,t)),this.dispatchEvent(new so(Yt.ADD,e,t))}updateLength_(){this.set(od.LENGTH,this.array_.length)}assertUnique_(t,e){const i=this.array_;for(let r=0,s=i.length;r<s;++r)if(i[r]===t&&r!==e)throw new Error("Duplicate item added to a unique collection")}}class Ki extends yn{constructor(t,e,i){super(t),this.map=e,this.frameState=i!==void 0?i:null}}class In extends Ki{constructor(t,e,i,r,s,o){super(t,e,s),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=r!==void 0?r:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const _t={SINGLECLICK:"singleclick",CLICK:H.CLICK,DBLCLICK:H.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},xi=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",f0=xi.includes("safari")&&!xi.includes("chrom");f0&&(xi.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(xi));const g0=xi.includes("webkit")&&!xi.includes("edge"),qg=xi.includes("macintosh"),p0=typeof devicePixelRatio<"u"?devicePixelRatio:1,ce=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,Hg=typeof Image<"u"&&Image.prototype.decode,Xg=(function(){let n=!1;try{const t=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,t),window.removeEventListener("_",null,t)}catch{}return n})(),uc={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class m0 extends _a{constructor(t,e){super(t),this.map_=t,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=e===void 0?1:e,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=et(i,uc.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=et(i,uc.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(H.TOUCHMOVE,this.boundHandleTouchMove_,Xg?{passive:!1}:!1)}emulateClick_(t){let e=new In(_t.CLICK,this.map_,t);this.dispatchEvent(e),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new In(_t.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const i=new In(_t.SINGLECLICK,this.map_,t);this.dispatchEvent(i)},250)}updateActivePointers_(t){const e=t,i=e.pointerId;if(e.type==_t.POINTERUP||e.type==_t.POINTERCANCEL){delete this.trackedTouches_[i];for(const r in this.trackedTouches_)if(this.trackedTouches_[r].target!==e.target){delete this.trackedTouches_[r];break}}else(e.type==_t.POINTERDOWN||e.type==_t.POINTERMOVE)&&(this.trackedTouches_[i]=e);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(t){this.updateActivePointers_(t);const e=new In(_t.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(ut),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return t.button===0}handlePointerDown_(t){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(t);const e=new In(_t.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);if(this.dispatchEvent(e),this.down_=new PointerEvent(t.type,t),Object.defineProperty(this.down_,"target",{writable:!1,value:t.target}),this.dragListenerKeys_.length===0){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(et(i,_t.POINTERMOVE,this.handlePointerMove_,this),et(i,_t.POINTERUP,this.handlePointerUp_,this),et(this.element_,_t.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(et(this.element_.getRootNode(),_t.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;const e=new In(_t.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}relayMoveEvent_(t){this.originalPointerMoveEvent_=t;const e=!!(this.down_&&this.isMoving_(t));this.dispatchEvent(new In(_t.POINTERMOVE,this.map_,t,e))}handleTouchMove_(t){const e=this.originalPointerMoveEvent_;(!e||e.defaultPrevented)&&(typeof t.cancelable!="boolean"||t.cancelable===!0)&&t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(ut(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(H.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(ut(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(ut),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const Rn={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},zt={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},z={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4},ko=1/0;class _0{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,Ns(this.queuedElements_)}dequeue(){const t=this.elements_,e=this.priorities_,i=t[0];t.length==1?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));const r=this.keyFunction_(i);return delete this.queuedElements_[r],i}enqueue(t){rt(!(this.keyFunction_(t)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const e=this.priorityFunction_(t);return e!=ko?(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(t){return t*2+1}getRightChildIndex_(t){return t*2+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}isEmpty(){return this.elements_.length===0}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){const e=this.elements_,i=this.priorities_,r=e.length,s=e[t],o=i[t],a=t;for(;t<r>>1;){const l=this.getLeftChildIndex_(t),c=this.getRightChildIndex_(t),h=c<r&&i[c]<i[l]?c:l;e[t]=e[h],i[t]=i[h],t=h}e[t]=s,i[t]=o,this.siftDown_(a,t)}siftDown_(t,e){const i=this.elements_,r=this.priorities_,s=i[e],o=r[e];for(;e>t;){const a=this.getParentIndex_(e);if(r[a]>o)i[e]=i[a],r[e]=r[a],e=a;else break}i[e]=s,r[e]=o}reprioritize(){const t=this.priorityFunction_,e=this.elements_,i=this.priorities_;let r=0;const s=e.length;let o,a,l;for(a=0;a<s;++a)o=e[a],l=t(o),l==ko?delete this.queuedElements_[this.keyFunction_(o)]:(i[r]=l,e[r++]=o);e.length=r,i.length=r,this.heapify_()}}class y0 extends _0{constructor(t,e){super(i=>t.apply(null,i),i=>i[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){const e=super.enqueue(t);return e&&t[0].addEventListener(H.CHANGE,this.boundHandleTileChange_),e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){const e=t.target,i=e.getState();if(i===z.LOADED||i===z.ERROR||i===z.EMPTY){i!==z.ERROR&&e.removeEventListener(H.CHANGE,this.boundHandleTileChange_);const r=e.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let i=0;for(;this.tilesLoading_<t&&i<e&&this.getCount()>0;){const r=this.dequeue()[0],s=r.getKey();r.getState()===z.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++i,r.load())}}}function w0(n,t,e,i,r){if(!n||!(e in n.wantedTiles)||!n.wantedTiles[e][t.getKey()])return ko;const s=n.viewState.center,o=i[0]-s[0],a=i[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+a*a)/r}const Bt={ANIMATING:0,INTERACTING:1},Re={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function ad(n,t,e){return(function(i,r,s,o,a){if(!i)return;if(!r&&!t)return i;const l=t?0:s[0]*r,c=t?0:s[1]*r,h=a?a[0]:0,u=a?a[1]:0;let d=n[0]+l/2+h,f=n[2]-l/2+h,g=n[1]+c/2+u,y=n[3]-c/2+u;d>f&&(d=(f+d)/2,f=d),g>y&&(g=(y+g)/2,y=g);let _=pt(i[0],d,f),b=pt(i[1],g,y);if(o&&e&&r){const S=30*r;_+=-S*Math.log(1+Math.max(0,d-i[0])/S)+S*Math.log(1+Math.max(0,i[0]-f)/S),b+=-S*Math.log(1+Math.max(0,g-i[1])/S)+S*Math.log(1+Math.max(0,i[1]-y)/S)}return[_,b]})}function v0(n){return n}function Kg(n){return Math.pow(n,3)}function Ar(n){return 1-Kg(1-n)}function b0(n){return 3*n*n-2*n*n*n}function E0(n){return n}function Th(n,t,e,i){const r=at(t)/e[0],s=Ht(t)/e[1];return i?Math.min(n,Math.max(r,s)):Math.min(n,Math.min(r,s))}function Ih(n,t,e){let i=Math.min(n,t);const r=50;return i*=Math.log(1+r*Math.max(0,n/t-1))/r+1,e&&(i=Math.max(i,e),i/=Math.log(1+r*Math.max(0,e/n-1))/r+1),pt(i,e/2,t*2)}function x0(n,t,e,i){return t=t!==void 0?t:!0,(function(r,s,o,a){if(r!==void 0){const l=n[0],c=n[n.length-1],h=e?Th(l,e,o,i):l;if(a)return t?Ih(r,h,c):pt(r,c,h);const u=Math.min(h,r),d=Math.floor(Qc(n,u,s));return n[d]>h&&d<n.length-1?n[d+1]:n[d]}})}function C0(n,t,e,i,r,s){return i=i!==void 0?i:!0,e=e!==void 0?e:0,(function(o,a,l,c){if(o!==void 0){const h=r?Th(t,r,l,s):t;if(c)return i?Ih(o,h,e):pt(o,e,h);const u=1e-9,d=Math.ceil(Math.log(t/h)/Math.log(n)-u),f=-a*(.5-u)+.5,g=Math.min(h,o),y=Math.floor(Math.log(t/g)/Math.log(n)+f),_=Math.max(d,y),b=t/Math.pow(n,_);return pt(b,e,h)}})}function ld(n,t,e,i,r){return e=e!==void 0?e:!0,(function(s,o,a,l){if(s!==void 0){const c=i?Th(n,i,a,r):n;return!e||!l?pt(s,t,c):Ih(s,c,t)}})}function Rh(n){if(n!==void 0)return 0}function cd(n){if(n!==void 0)return n}function S0(n){const t=2*Math.PI/n;return(function(e,i){if(i)return e;if(e!==void 0)return e=Math.floor(e/t+.5)*t,e})}function T0(n){const t=$n(5);return(function(e,i){return i||e===void 0?e:Math.abs(e)<=t?0:e})}const I0=42,Ah=256,gl=0;class ze extends Ke{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=ch(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&$y(),t.center&&(t.center=rn(t.center,this.projection_)),t.extent&&(t.extent=Dn(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){const e=Object.assign({},t);for(const a in Re)delete e[a];this.setProperties(e,!0);const i=A0(t);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=i.minZoom;const r=R0(t),s=i.constraint,o=P0(t);this.constraints_={center:r,resolution:s,rotation:o},this.setRotation(t.rotation!==void 0?t.rotation:0),this.setCenterInternal(t.center!==void 0?t.center:null),t.resolution!==void 0?this.setResolution(t.resolution):t.zoom!==void 0&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;const i=this.getCenterInternal();if(i){const r=t||[0,0,0,0];e=e||[0,0,0,0];const s=this.getResolution(),o=s/2*(r[3]-e[3]+e[1]-r[1]),a=s/2*(r[0]-e[0]+e[2]-r[2]);this.setCenterInternal([i[0]+o,i[1]-a])}}getUpdatedOptions_(t){const e=this.getProperties();return e.resolution!==void 0?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const e=new Array(arguments.length);for(let i=0;i<e.length;++i){let r=arguments[i];r.center&&(r=Object.assign({},r),r.center=rn(r.center,this.getProjection())),r.anchor&&(r=Object.assign({},r),r.anchor=rn(r.anchor,this.getProjection())),e[i]=r}this.animateInternal.apply(this,e)}animateInternal(t){let e=arguments.length,i;e>1&&typeof arguments[e-1]=="function"&&(i=arguments[e-1],--e);let r=0;for(;r<e&&!this.isDef();++r){const h=arguments[r];h.center&&this.setCenterInternal(h.center),h.zoom!==void 0?this.setZoom(h.zoom):h.resolution&&this.setResolution(h.resolution),h.rotation!==void 0&&this.setRotation(h.rotation)}if(r===e){i&&oo(i,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,l=this.targetRotation_;const c=[];for(;r<e;++r){const h=arguments[r],u={start:s,complete:!1,anchor:h.anchor,duration:h.duration!==void 0?h.duration:1e3,easing:h.easing||b0,callback:i};if(h.center&&(u.sourceCenter=o,u.targetCenter=h.center.slice(),o=u.targetCenter),h.zoom!==void 0?(u.sourceResolution=a,u.targetResolution=this.getResolutionForZoom(h.zoom),a=u.targetResolution):h.resolution&&(u.sourceResolution=a,u.targetResolution=h.resolution,a=u.targetResolution),h.rotation!==void 0){u.sourceRotation=l;const d=nr(h.rotation-l+Math.PI,2*Math.PI)-Math.PI;u.targetRotation=l+d,l=u.targetRotation}L0(u)?u.complete=!0:s+=u.duration,c.push(u)}this.animations_.push(c),this.setHint(Bt.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Bt.ANIMATING]>0}getInteracting(){return this.hints_[Bt.INTERACTING]>0}cancelAnimations(){this.setHint(Bt.ANIMATING,-this.hints_[Bt.ANIMATING]);let t;for(let e=0,i=this.animations_.length;e<i;++e){const r=this.animations_[e];if(r[0].callback&&oo(r[0].callback,!1),!t)for(let s=0,o=r.length;s<o;++s){const a=r[s];if(!a.complete){t=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let e=!1;for(let i=this.animations_.length-1;i>=0;--i){const r=this.animations_[i];let s=!0;for(let o=0,a=r.length;o<a;++o){const l=r[o];if(l.complete)continue;const c=t-l.start;let h=l.duration>0?c/l.duration:1;h>=1?(l.complete=!0,h=1):s=!1;const u=l.easing(h);if(l.sourceCenter){const d=l.sourceCenter[0],f=l.sourceCenter[1],g=l.targetCenter[0],y=l.targetCenter[1];this.nextCenter_=l.targetCenter;const _=d+u*(g-d),b=f+u*(y-f);this.targetCenter_=[_,b]}if(l.sourceResolution&&l.targetResolution){const d=u===1?l.targetResolution:l.sourceResolution+u*(l.targetResolution-l.sourceResolution);if(l.anchor){const f=this.getViewportSize_(this.getRotation()),g=this.constraints_.resolution(d,0,f,!0);this.targetCenter_=this.calculateCenterZoom(g,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=d,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){const d=u===1?nr(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+u*(l.targetRotation-l.sourceRotation);if(l.anchor){const f=this.constraints_.rotation(d,!0);this.targetCenter_=this.calculateCenterRotate(f,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=d}if(this.applyTargetState_(!0),e=!0,!l.complete)break}if(s){this.animations_[i]=null,this.setHint(Bt.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=r[0].callback;o&&oo(o,!0)}}this.animations_=this.animations_.filter(Boolean),e&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let i;const r=this.getCenterInternal();return r!==void 0&&(i=[r[0]-e[0],r[1]-e[1]],ih(i,t-this.getRotation()),uy(i,e)),i}calculateCenterZoom(t,e){let i;const r=this.getCenterInternal(),s=this.getResolution();if(r!==void 0&&s!==void 0){const o=e[0]-t*(e[0]-r[0])/s,a=e[1]-t*(e[1]-r[1])/s;i=[o,a]}return i}getViewportSize_(t){const e=this.viewportSize_;if(t){const i=e[0],r=e[1];return[Math.abs(i*Math.cos(t))+Math.abs(r*Math.sin(t)),Math.abs(i*Math.sin(t))+Math.abs(r*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t&&nc(t,this.getProjection())}getCenterInternal(){return this.get(Re.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return t!==void 0?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){const e=this.calculateExtentInternal(t);return Po(e,this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();const e=this.getCenterInternal();rt(e,"The view center is not defined");const i=this.getResolution();rt(i!==void 0,"The view resolution is not defined");const r=this.getRotation();return rt(r!==void 0,"The view rotation is not defined"),Yl(e,i,r,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(Re.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(Dn(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();const i=at(t)/e[0],r=Ht(t)/e[1];return Math.max(i,r)}getResolutionForValueFunction(t){t=t||2;const e=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,r=Math.log(e/i)/Math.log(t);return(function(s){return e/Math.pow(t,s*r)})}getRotation(){return this.get(Re.ROTATION)}getValueForResolutionFunction(t){const e=Math.log(t||2),i=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,s=Math.log(i/r)/e;return(function(o){return Math.log(i/o)/e/s})}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);const i=this.padding_;return i&&(e=[e[0]-i[1]-i[3],e[1]-i[0]-i[2]]),e}getState(){const t=this.getProjection(),e=this.getResolution(),i=this.getRotation();let r=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();r=pl(r,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],e,i)}return{center:r.slice(0),projection:t!==void 0?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t;const e=this.getResolution();return e!==void 0&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e=this.minZoom_||0,i,r;if(this.resolutions_){const s=Qc(this.resolutions_,t,1);e=s,i=this.resolutions_[s],s==this.resolutions_.length-1?r=2:r=i/this.resolutions_[s+1]}else i=this.maxResolution_,r=this.zoomFactor_;return e+Math.log(i/t)/Math.log(r)}getResolutionForZoom(t){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const e=pt(Math.floor(t),0,this.resolutions_.length-2),i=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(i,pt(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let i;if(rt(Array.isArray(t)||typeof t.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(t)){rt(!Fs(t),"Cannot fit empty extent provided as `geometry`");const r=Dn(t,this.getProjection());i=oc(r)}else if(t.getType()==="Circle"){const r=Dn(t.getExtent(),this.getProjection());i=oc(r),i.rotate(this.getRotation(),fn(r))}else{const r=Ao();r?i=t.clone().transform(r,this.getProjection()):i=t}this.fitInternal(i,e)}rotatedExtentForGeometry(t){const e=this.getRotation(),i=Math.cos(e),r=Math.sin(-e),s=t.getFlatCoordinates(),o=t.getStride();let a=1/0,l=1/0,c=-1/0,h=-1/0;for(let u=0,d=s.length;u<d;u+=o){const f=s[u]*i-s[u+1]*r,g=s[u]*r+s[u+1]*i;a=Math.min(a,f),l=Math.min(l,g),c=Math.max(c,f),h=Math.max(h,g)}return[a,l,c,h]}fitInternal(t,e){e=e||{};let i=e.size;i||(i=this.getViewportSizeMinusPadding_());const r=e.padding!==void 0?e.padding:[0,0,0,0],s=e.nearest!==void 0?e.nearest:!1;let o;e.minResolution!==void 0?o=e.minResolution:e.maxZoom!==void 0?o=this.getResolutionForZoom(e.maxZoom):o=0;const a=this.rotatedExtentForGeometry(t);let l=this.getResolutionForExtentInternal(a,[i[0]-r[1]-r[3],i[1]-r[0]-r[2]]);l=isNaN(l)?o:Math.max(l,o),l=this.getConstrainedResolution(l,s?0:1);const c=this.getRotation(),h=Math.sin(c),u=Math.cos(c),d=fn(a);d[0]+=(r[1]-r[3])/2*l,d[1]+=(r[0]-r[2])/2*l;const f=d[0]*u-d[1]*h,g=d[1]*u+d[0]*h,y=this.getConstrainedCenter([f,g],l),_=e.callback?e.callback:gs;e.duration!==void 0?this.animateInternal({resolution:l,center:y,duration:e.duration,easing:e.easing},_):(this.targetResolution_=l,this.targetCenter_=y,this.applyTargetState_(!1,!0),oo(_,!0))}centerOn(t,e,i){this.centerOnInternal(rn(t,this.getProjection()),e,i)}centerOnInternal(t,e,i){this.setCenterInternal(pl(t,e,i,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,i,r){let s;const o=this.padding_;if(o&&t){const a=this.getViewportSizeMinusPadding_(-i),l=pl(t,r,[a[0]/2+o[3],a[1]/2+o[0]],e,i);s=[t[0]-l[0],t[1]-l[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(t){const e=nc(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){const e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&rn(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){const i=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*t,0,r,i);e&&(this.targetCenter_=this.calculateCenterZoom(s,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=rn(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){const i=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+t,i);e&&(this.targetCenter_=this.calculateCenterRotate(r,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t&&rn(t,this.getProjection()))}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){const i=this.getAnimating()||this.getInteracting()||e,r=this.constraints_.rotation(this.targetRotation_,i),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,s,i),a=this.constraints_.center(this.targetCenter_,o,s,i,this.calculateCenterShift(this.targetCenter_,o,r,s));this.get(Re.ROTATION)!==r&&this.set(Re.ROTATION,r),this.get(Re.RESOLUTION)!==o&&(this.set(Re.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(Re.CENTER)||!To(this.get(Re.CENTER),a))&&this.set(Re.CENTER,a),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,i){t=t!==void 0?t:200;const r=e||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),a=this.constraints_.resolution(this.targetResolution_,r,o),l=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,s,o));if(t===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=s,this.targetCenter_=l,this.applyTargetState_();return}i=i||(t===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==s||!this.getCenterInternal()||!To(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:l,resolution:a,duration:t,easing:Ar,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Bt.INTERACTING,1)}endInteraction(t,e,i){i=i&&rn(i,this.getProjection()),this.endInteractionInternal(t,e,i)}endInteractionInternal(t,e,i){this.getInteracting()&&(this.setHint(Bt.INTERACTING,-1),this.resolveConstraints(t,e,i))}getConstrainedCenter(t,e){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),i)}getConstrainedZoom(t,e){const i=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(i,e))}getConstrainedResolution(t,e){e=e||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,i)}}function oo(n,t){setTimeout(function(){n(t)},0)}function R0(n){if(n.extent!==void 0){const e=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return ad(n.extent,n.constrainOnlyCenter,e)}const t=ch(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&t.isGlobal()){const e=t.getExtent().slice();return e[0]=-1/0,e[2]=1/0,ad(e,!1,!1)}return v0}function A0(n){let t,e,i,o=n.minZoom!==void 0?n.minZoom:gl,a=n.maxZoom!==void 0?n.maxZoom:28;const l=n.zoomFactor!==void 0?n.zoomFactor:2,c=n.multiWorld!==void 0?n.multiWorld:!1,h=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,u=n.showFullExtent!==void 0?n.showFullExtent:!1,d=ch(n.projection,"EPSG:3857"),f=d.getExtent();let g=n.constrainOnlyCenter,y=n.extent;if(!c&&!y&&d.isGlobal()&&(g=!1,y=f),n.resolutions!==void 0){const _=n.resolutions;e=_[o],i=_[a]!==void 0?_[a]:_[_.length-1],n.constrainResolution?t=x0(_,h,!g&&y,u):t=ld(e,i,h,!g&&y,u)}else{const b=(f?Math.max(at(f),Ht(f)):360*rh.degrees/d.getMetersPerUnit())/Ah/Math.pow(2,gl),S=b/Math.pow(2,28-gl);e=n.maxResolution,e!==void 0?o=0:e=b/Math.pow(l,o),i=n.minResolution,i===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?i=e/Math.pow(l,a):i=b/Math.pow(l,a):i=S),a=o+Math.floor(Math.log(e/i)/Math.log(l)),i=e/Math.pow(l,a-o),n.constrainResolution?t=C0(l,e,i,h,!g&&y,u):t=ld(e,i,h,!g&&y,u)}return{constraint:t,maxResolution:e,minResolution:i,minZoom:o,zoomFactor:l}}function P0(n){if(n.enableRotation!==void 0?n.enableRotation:!0){const e=n.constrainRotation;return e===void 0||e===!0?T0():e===!1?cd:typeof e=="number"?S0(e):cd}return Rh}function L0(n){return!(n.sourceCenter&&n.targetCenter&&!To(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function pl(n,t,e,i,r){const s=Math.cos(-r);let o=Math.sin(-r),a=n[0]*s-n[1]*o,l=n[1]*s+n[0]*o;a+=(t[0]/2-e[0])*i,l+=(e[1]-t[1]/2)*i,o=-o;const c=a*s-l*o,h=l*s+a*o;return[c,h]}const ao="ol-hidden",Sa="ol-unselectable",Ph="ol-control",hd="ol-collapsed",O0=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),ud=["style","variant","weight","size","lineHeight","family"],dc={normal:400,bold:700},fc=function(n){const t=n.match(O0);if(!t)return null;const e={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let i=0,r=ud.length;i<r;++i){const s=t[i+1];s!==void 0&&(e[ud[i]]=typeof s=="string"?s.trim():s)}return isNaN(Number(e.weight))&&e.weight in dc&&(e.weight=dc[e.weight]),e.families=e.family.split(/,\s?/).map(i=>i.trim().replace(/^['"]|['"]$/g,"")),e};function Rt(n,t,e,i){let r;return e&&e.length?r=e.shift():ce?r=new class extends OffscreenCanvas{style={}}(n??300,t??150):r=document.createElement("canvas"),n&&(r.width=n),t&&(r.height=t),r.getContext("2d",i)}let ml;function Do(){return ml||(ml=Rt(1,1)),ml}function Ta(n){const t=n.canvas;t.width=1,t.height=1,n.clearRect(0,0,1,1)}function dd(n,t){const e=t.parentNode;e&&e.replaceChild(n,t)}function k0(n){for(;n.lastChild;)n.lastChild.remove()}function D0(n,t){const e=n.childNodes;for(let i=0;;++i){const r=e[i],s=t[i];if(!r&&!s)break;if(r!==s){if(!r){n.appendChild(s);continue}if(!s){n.removeChild(r),--i;continue}n.insertBefore(s,r)}}}function Yg(){return new Proxy({childNodes:[],appendChild:function(t){return this.childNodes.push(t),t},remove:function(){},removeChild:function(t){const e=this.childNodes.indexOf(t);if(e===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(e,1),t},insertBefore:function(t,e){const i=this.childNodes.indexOf(e);if(i===-1)throw new Error("Reference node not found");return this.childNodes.splice(i,0,t),t},style:{}},{get(t,e,i){return e==="firstElementChild"?t.childNodes.length>0?t.childNodes[0]:null:Reflect.get(t,e,i)}})}function Fn(n){return typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas}class Lh extends Ke{constructor(t){super();const e=t.element;e&&!t.target&&!e.style.pointerEvents&&(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(t){this.map_&&this.element?.remove();for(let e=0,i=this.listenerKeys.length;e<i;++e)ut(this.listenerKeys[e]);if(this.listenerKeys.length=0,this.map_=t,t){const e=this.target_??t.getOverlayContainerStopEvent();this.element&&e.appendChild(this.element),this.render!==gs&&this.listenerKeys.push(et(t,Rn.POSTRENDER,this.render,this)),t.render()}}render(t){}setTarget(t){this.target_=typeof t=="string"?document.getElementById(t):t}}class M0 extends Lh{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=t.collapsed!==void 0?t.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=t.collapsible!==void 0,this.collapsible_=t.collapsible!==void 0?t.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=t.attributions;const e=t.className!==void 0?t.className:"ol-attribution",i=t.tipLabel!==void 0?t.tipLabel:"Attributions",r=t.expandClassName!==void 0?t.expandClassName:e+"-expand",s=t.collapseLabel!==void 0?t.collapseLabel:"›",o=t.collapseClassName!==void 0?t.collapseClassName:e+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const a=t.label!==void 0?t.label:"i";typeof a=="string"?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=r):this.label_=a;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(H.CLICK,this.handleClick_.bind(this),!1);const c=e+" "+Sa+" "+Ph+(this.collapsed_&&this.collapsible_?" "+hd:"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=c,h.appendChild(this.toggleButton_),h.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(t){const e=this.getMap().getAllLayers(),i=new Set(e.flatMap(r=>r.getAttributions(t)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(r=>i.add(r)):i.add(this.attributions_)),!this.overrideCollapsible_){const r=!e.some(s=>s.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(r)}return Array.from(i)}async updateElement_(t){if(!t){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const e=await Promise.all(this.collectSourceAttributions_(t).map(r=>cy(()=>r))),i=e.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!Qn(e,this.renderedAttributions_)){k0(this.ulElement_);for(let r=0,s=e.length;r<s;++r){const o=document.createElement("li");o.innerHTML=e[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=e}}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(hd),this.collapsed_?dd(this.collapseLabel_,this.label_):dd(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(t){this.userCollapsed_=t,!(!this.collapsible_||this.collapsed_===t)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}}class F0 extends Lh{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target});const e=t.className!==void 0?t.className:"ol-rotate",i=t.label!==void 0?t.label:"⇧",r=t.compassClassName!==void 0?t.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(r));const s=t.tipLabel?t.tipLabel:"Reset rotation",o=document.createElement("button");o.className=e+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(H.CLICK,this.handleClick_.bind(this),!1);const a=e+" "+Sa+" "+Ph,l=this.element;l.className=a,l.appendChild(o),this.callResetNorth_=t.resetNorth?t.resetNorth:void 0,this.duration_=t.duration!==void 0?t.duration:250,this.autoHide_=t.autoHide!==void 0?t.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(ao)}handleClick_(t){t.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const e=this.getMap().getView();if(!e)return;const i=e.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?e.animate({rotation:0,duration:this.duration_,easing:Ar}):e.setRotation(0))}render(t){const e=t.frameState;if(!e)return;const i=e.viewState.rotation;if(i!=this.rotation_){const r="rotate("+i+"rad)";if(this.autoHide_){const s=this.element.classList.contains(ao);!s&&i===0?this.element.classList.add(ao):s&&i!==0&&this.element.classList.remove(ao)}this.label_.style.transform=r}this.rotation_=i}}class N0 extends Lh{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target});const e=t.className!==void 0?t.className:"ol-zoom",i=t.delta!==void 0?t.delta:1,r=t.zoomInClassName!==void 0?t.zoomInClassName:e+"-in",s=t.zoomOutClassName!==void 0?t.zoomOutClassName:e+"-out",o=t.zoomInLabel!==void 0?t.zoomInLabel:"+",a=t.zoomOutLabel!==void 0?t.zoomOutLabel:"–",l=t.zoomInTipLabel!==void 0?t.zoomInTipLabel:"Zoom in",c=t.zoomOutTipLabel!==void 0?t.zoomOutTipLabel:"Zoom out",h=document.createElement("button");h.className=r,h.setAttribute("type","button"),h.title=l,h.appendChild(typeof o=="string"?document.createTextNode(o):o),h.addEventListener(H.CLICK,this.handleClick_.bind(this,i),!1);const u=document.createElement("button");u.className=s,u.setAttribute("type","button"),u.title=c,u.appendChild(typeof a=="string"?document.createTextNode(a):a),u.addEventListener(H.CLICK,this.handleClick_.bind(this,-i),!1);const d=e+" "+Sa+" "+Ph,f=this.element;f.className=d,f.appendChild(h),f.appendChild(u),this.duration_=t.duration!==void 0?t.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){const i=this.getMap().getView();if(!i)return;const r=i.getZoom();if(r!==void 0){const s=i.getConstrainedZoom(r+t);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:s,duration:this.duration_,easing:Ar})):i.setZoom(s)}}}function $0(n){n=n||{};const t=new we;return(n.zoom!==void 0?n.zoom:!0)&&t.push(new N0(n.zoomOptions)),(n.rotate!==void 0?n.rotate:!0)&&t.push(new F0(n.rotateOptions)),(n.attribution!==void 0?n.attribution:!0)&&t.push(new M0(n.attributionOptions)),t}class V0{constructor(t,e,i){this.decay_=t,this.minVelocity_=e,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;const t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;let i=e-3;for(;i>0&&this.points_[i+2]>t;)i-=3;const r=this.points_[e+2]-this.points_[i+2];if(r<1e3/60)return!1;const s=this.points_[e]-this.points_[i],o=this.points_[e+1]-this.points_[i+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const fd={ACTIVE:"active"};class Us extends Ke{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(fd.ACTIVE)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(fd.ACTIVE,t)}setMap(t){this.map_=t}}function z0(n,t,e){const i=n.getCenterInternal();if(i){const r=[i[0]+t[0],i[1]+t[1]];n.animateInternal({duration:e!==void 0?e:250,easing:E0,center:n.getConstrainedCenter(r)})}}function Oh(n,t,e,i){const r=n.getZoom();if(r===void 0)return;const s=n.getConstrainedZoom(r+t),o=n.getResolutionForZoom(s);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:o,anchor:e,duration:i!==void 0?i:250,easing:Ar})}class G0 extends Us{constructor(t){super(),t=t||{},this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:250}handleEvent(t){let e=!1;if(t.type==_t.DBLCLICK){const i=t.originalEvent,r=t.map,s=t.coordinate,o=i.shiftKey?-this.delta_:this.delta_,a=r.getView();Oh(a,o,s,this.duration_),i.preventDefault(),e=!0}return!e}}function gc(n){const t=arguments;return function(e){let i=!0;for(let r=0,s=t.length;r<s&&(i=i&&t[r](e),!!i);++r);return i}}const B0=function(n){const t=n.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},U0=function(n){const t=n.map.getTargetElement(),e=t.getRootNode(),i=n.map.getOwnerDocument().activeElement;return e instanceof ShadowRoot?e.host.contains(i):t.contains(i)},Zg=function(n){const t=n.map.getTargetElement(),e=t.getRootNode();return(e instanceof ShadowRoot?e.host:t).hasAttribute("tabindex")?U0(n):!0},j0=fs,Jg=function(n){const t=n.originalEvent;return"pointerId"in t&&t.button==0&&!(g0&&qg&&t.ctrlKey)},Qg=function(n){const t=n.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},W0=function(n){const t=n.originalEvent;return qg?t.metaKey:t.ctrlKey},q0=function(n){const t=n.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},tp=function(n){const t=n.originalEvent,e=t.target.tagName;return e!=="INPUT"&&e!=="SELECT"&&e!=="TEXTAREA"&&!t.target.isContentEditable},_l=function(n){const t=n.originalEvent;return"pointerId"in t&&t.pointerType=="mouse"},H0=function(n){const t=n.originalEvent;return"pointerId"in t&&t.isPrimary&&t.button===0};class js extends Us{constructor(t){t=t||{},super(t),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==_t.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==_t.POINTERUP){const i=this.handleUpEvent(t);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(t.type==_t.POINTERDOWN){const i=this.handleDownEvent(t);this.handlingDownUpSequence=i,e=this.stopDown(i)}else t.type==_t.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}}function kh(n){const t=n.length;let e=0,i=0;for(let r=0;r<t;r++)e+=n[r].clientX,i+=n[r].clientY;return{clientX:e/t,clientY:i/t}}class X0 extends js{constructor(t){super({stopDown:ma}),t=t||{},this.kinetic_=t.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const e=t.condition?t.condition:gc(Qg,H0);this.condition_=t.onFocusOnly?gc(Zg,e):e,this.noKinetic_=!1}handleDragEvent(t){const e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());const i=this.targetPointers,r=e.getEventPixel(kh(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const s=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],a=t.map.getView();dy(s,a.getResolution()),ih(s,a.getRotation()),a.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=i.length,t.originalEvent.preventDefault()}handleUpEvent(t){const e=t.map,i=e.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const r=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=i.getCenterInternal(),a=e.getPixelFromCoordinateInternal(o),l=e.getCoordinateFromPixelInternal([a[0]-r*Math.cos(s),a[1]-r*Math.sin(s)]);i.animateInternal({center:i.getConstrainedCenter(l),duration:500,easing:Ar})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(t){if(this.targetPointers.length>0&&this.condition_(t)){const i=t.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class K0 extends js{constructor(t){t=t||{},super({stopDown:ma}),this.condition_=t.condition?t.condition:B0,this.lastAngle_=void 0,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){if(!_l(t))return;const e=t.map,i=e.getView();if(i.getConstraints().rotation===Rh)return;const r=e.getSize(),s=t.pixel,o=Math.atan2(r[1]/2-s[1],s[0]-r[0]/2);if(this.lastAngle_!==void 0){const a=o-this.lastAngle_;i.adjustRotationInternal(-a)}this.lastAngle_=o}handleUpEvent(t){return _l(t)?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){return _l(t)&&Jg(t)&&this.condition_(t)?(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class Y0 extends pa{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const t=this.startPixel_,e=this.endPixel_,i="px",r=this.element_.style;r.left=Math.min(t[0],e[0])+i,r.top=Math.min(t[1],e[1])+i,r.width=Math.abs(e[0]-t[0])+i,r.height=Math.abs(e[1]-t[1])+i}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const e=this.element_.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const t=this.startPixel_,e=this.endPixel_,r=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new jn([r])}getGeometry(){return this.geometry_}}const Ui={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class jr extends yn{constructor(t,e,i){super(t),this.coordinate=e,this.mapBrowserEvent=i}}class Z0 extends js{constructor(t){super(),this.on,this.once,this.un,t=t??{},this.box_=new Y0(t.className||"ol-dragbox"),this.minArea_=t.minArea??64,t.onBoxEnd&&(this.onBoxEnd=t.onBoxEnd),this.startPixel_=null,this.condition_=t.condition??Jg,this.boxEndCondition_=t.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,i){const r=i[0]-e[0],s=i[1]-e[1];return r*r+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.startPixel_&&(this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new jr(Ui.BOXDRAG,t.coordinate,t)))}handleUpEvent(t){if(!this.startPixel_)return!1;const e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new jr(e?Ui.BOXEND:Ui.BOXCANCEL,t.coordinate,t)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(t){return this.condition_(t)?(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new jr(Ui.BOXSTART,t.coordinate,t)),!0):!1}onBoxEnd(t){}setActive(t){t||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new jr(Ui.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(t)}setMap(t){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new jr(Ui.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(t)}}class J0 extends Z0{constructor(t){t=t||{};const e=t.condition?t.condition:q0;super({condition:e,className:t.className||"ol-dragzoom",minArea:t.minArea}),this.duration_=t.duration!==void 0?t.duration:200,this.out_=t.out!==void 0?t.out:!1}onBoxEnd(t){const i=this.getMap().getView();let r=this.getGeometry();if(this.out_){const s=i.rotatedExtentForGeometry(r),o=i.getResolutionForExtentInternal(s),a=i.getResolution()/o;r=r.clone(),r.scale(a*a)}i.fitInternal(r,{duration:this.duration_,easing:Ar})}}const oi={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class Q0 extends Us{constructor(t){super(),t=t||{},this.defaultCondition_=function(e){return Qg(e)&&tp(e)},this.condition_=t.condition!==void 0?t.condition:this.defaultCondition_,this.duration_=t.duration!==void 0?t.duration:100,this.pixelDelta_=t.pixelDelta!==void 0?t.pixelDelta:128}handleEvent(t){let e=!1;if(t.type==H.KEYDOWN){const i=t.originalEvent,r=i.key;if(this.condition_(t)&&(r==oi.DOWN||r==oi.LEFT||r==oi.RIGHT||r==oi.UP)){const o=t.map.getView(),a=o.getResolution()*this.pixelDelta_;let l=0,c=0;r==oi.DOWN?c=-a:r==oi.LEFT?l=-a:r==oi.RIGHT?l=a:c=a;const h=[l,c];ih(h,o.getRotation()),z0(o,h,this.duration_),i.preventDefault(),e=!0}}return!e}}class tv extends Us{constructor(t){super(),t=t||{},this.condition_=t.condition?t.condition:function(e){return!W0(e)&&tp(e)},this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:100}handleEvent(t){let e=!1;if(t.type==H.KEYDOWN||t.type==H.KEYPRESS){const i=t.originalEvent,r=i.key;if(this.condition_(t)&&(r==="+"||r==="-")){const s=t.map,o=r==="+"?this.delta_:-this.delta_,a=s.getView();Oh(a,o,void 0,this.duration_),i.preventDefault(),e=!0}}return!e}}const ev=40,nv=300;class iv extends Us{constructor(t){t=t||{},super(t),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=t.maxDelta!==void 0?t.maxDelta:1,this.duration_=t.duration!==void 0?t.duration:250,this.timeout_=t.timeout!==void 0?t.timeout:80,this.useAnchor_=t.useAnchor!==void 0?t.useAnchor:!0,this.constrainResolution_=t.constrainResolution!==void 0?t.constrainResolution:!1;const e=t.condition?t.condition:j0;this.condition_=t.onFocusOnly?gc(Zg,e):e,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const t=this.getMap();if(!t)return;t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?t.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(t){if(!this.condition_(t)||t.type!==H.WHEEL)return!0;const i=t.map,r=t.originalEvent;r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.pixel);let s=r.deltaY;switch(r.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=ev;break;case WheelEvent.DOM_DELTA_PAGE:s*=nv;break}if(s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const a=i.getView();if(this.mode_==="trackpad"&&!(a.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(a.getAnimating()&&a.cancelAnimations(),a.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),a.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?i.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=s;const l=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),l),!1}handleWheelZoom_(t){const e=t.getView();e.getAnimating()&&e.cancelAnimations();let i=-pt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),Oh(e,i,this.lastAnchor_?t.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}}class rv extends js{constructor(t){t=t||{};const e=t;e.stopDown||(e.stopDown=ma),super(e),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=t.threshold!==void 0?t.threshold:.3,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){let e=0;const i=this.targetPointers[0],r=this.targetPointers[1],s=Math.atan2(r.clientY-i.clientY,r.clientX-i.clientX);if(this.lastAngle_!==void 0){const l=s-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=l}this.lastAngle_=s;const o=t.map,a=o.getView();a.getConstraints().rotation!==Rh&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(kh(this.targetPointers))),this.rotating_&&(o.render(),a.adjustRotationInternal(e,this.anchor_)))}handleUpEvent(t){return this.targetPointers.length<2?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}class sv extends js{constructor(t){t=t||{};const e=t;e.stopDown||(e.stopDown=ma),super(e),this.anchor_=null,this.duration_=t.duration!==void 0?t.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1;const i=this.targetPointers[0],r=this.targetPointers[1],s=i.clientX-r.clientX,o=i.clientY-r.clientY,a=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(e=this.lastDistance_/a),this.lastDistance_=a;const l=t.map,c=l.getView();e!=1&&(this.lastScaleDelta_=e),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(kh(this.targetPointers))),l.render(),c.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){if(this.targetPointers.length<2){const i=t.map.getView(),r=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,r),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}function ov(n){n=n||{};const t=new we,e=new V0(-.005,.05,100);return(n.altShiftDragRotate!==void 0?n.altShiftDragRotate:!0)&&t.push(new K0),(n.doubleClickZoom!==void 0?n.doubleClickZoom:!0)&&t.push(new G0({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan!==void 0?n.dragPan:!0)&&t.push(new X0({onFocusOnly:n.onFocusOnly,kinetic:e})),(n.pinchRotate!==void 0?n.pinchRotate:!0)&&t.push(new rv),(n.pinchZoom!==void 0?n.pinchZoom:!0)&&t.push(new sv({duration:n.zoomDuration})),(n.keyboard!==void 0?n.keyboard:!0)&&(t.push(new Q0),t.push(new tv({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom!==void 0?n.mouseWheelZoom:!0)&&t.push(new iv({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom!==void 0?n.shiftDragZoom:!0)&&t.push(new J0({duration:n.zoomDuration})),t}const ot={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class ep extends Ke{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;const e=Object.assign({},t);typeof t.properties=="object"&&(delete e.properties,Object.assign(e,t.properties)),e[ot.OPACITY]=t.opacity!==void 0?t.opacity:1,rt(typeof e[ot.OPACITY]=="number","Layer opacity must be a number"),e[ot.VISIBLE]=t.visible!==void 0?t.visible:!0,e[ot.Z_INDEX]=t.zIndex,e[ot.MAX_RESOLUTION]=t.maxResolution!==void 0?t.maxResolution:1/0,e[ot.MIN_RESOLUTION]=t.minResolution!==void 0?t.minResolution:0,e[ot.MIN_ZOOM]=t.minZoom!==void 0?t.minZoom:-1/0,e[ot.MAX_ZOOM]=t.maxZoom!==void 0?t.maxZoom:1/0,this.className_=e.className!==void 0?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){const e=this.state_||{layer:this,managed:t===void 0?!0:t},i=this.getZIndex();return e.opacity=pt(Math.round(this.getOpacity()*100)/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=i===void 0&&!e.managed?1/0:i,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return W()}getLayerStatesArray(t){return W()}getExtent(){return this.get(ot.EXTENT)}getMaxResolution(){return this.get(ot.MAX_RESOLUTION)}getMinResolution(){return this.get(ot.MIN_RESOLUTION)}getMinZoom(){return this.get(ot.MIN_ZOOM)}getMaxZoom(){return this.get(ot.MAX_ZOOM)}getOpacity(){return this.get(ot.OPACITY)}getSourceState(){return W()}getVisible(){return this.get(ot.VISIBLE)}getZIndex(){return this.get(ot.Z_INDEX)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(ot.EXTENT,t)}setMaxResolution(t){this.set(ot.MAX_RESOLUTION,t)}setMinResolution(t){this.set(ot.MIN_RESOLUTION,t)}setMaxZoom(t){this.set(ot.MAX_ZOOM,t)}setMinZoom(t){this.set(ot.MIN_ZOOM,t)}setOpacity(t){rt(typeof t=="number","Layer opacity must be a number"),this.set(ot.OPACITY,t)}setVisible(t){this.set(ot.VISIBLE,t)}setZIndex(t){this.set(ot.Z_INDEX,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}const bn={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class Ln extends yn{constructor(t,e){super(t),this.layer=e}}const yl={LAYERS:"layers"};class Pr extends ep{constructor(t){t=t||{};const e=Object.assign({},t);delete e.layers;let i=t.layers;super(e),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(yl.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new we(i.slice(),{unique:!0}):rt(typeof i.getArray=="function","Expected `layers` to be an array or a `Collection`"):i=new we(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(ut),this.layersListenerKeys_.length=0;const t=this.getLayers();this.layersListenerKeys_.push(et(t,Yt.ADD,this.handleLayersAdd_,this),et(t,Yt.REMOVE,this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(ut);Ns(this.listenerKeys_);const e=t.getArray();for(let i=0,r=e.length;i<r;i++){const s=e[i];this.registerLayerListeners_(s),this.dispatchEvent(new Ln(bn.ADDLAYER,s))}this.changed()}registerLayerListeners_(t){const e=[et(t,hr.PROPERTYCHANGE,this.handleLayerChange_,this),et(t,H.CHANGE,this.handleLayerChange_,this)];t instanceof Pr&&e.push(et(t,bn.ADDLAYER,this.handleLayerGroupAdd_,this),et(t,bn.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[nt(t)]=e}handleLayerGroupAdd_(t){this.dispatchEvent(new Ln(bn.ADDLAYER,t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new Ln(bn.REMOVELAYER,t.layer))}handleLayersAdd_(t){const e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new Ln(bn.ADDLAYER,e)),this.changed()}handleLayersRemove_(t){const e=t.element,i=nt(e);this.listenerKeys_[i].forEach(ut),delete this.listenerKeys_[i],this.dispatchEvent(new Ln(bn.REMOVELAYER,e)),this.changed()}getLayers(){return this.get(yl.LAYERS)}setLayers(t){const e=this.getLayers();if(e){const i=e.getArray();for(let r=0,s=i.length;r<s;++r)this.dispatchEvent(new Ln(bn.REMOVELAYER,i[r]))}this.set(yl.LAYERS,t)}getLayersArray(t){return t=t!==void 0?t:[],this.getLayers().forEach(function(e){e.getLayersArray(t)}),t}getLayerStatesArray(t){const e=t!==void 0?t:[],i=e.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(e)});const r=this.getLayerState();let s=r.zIndex;!t&&r.zIndex===void 0&&(s=0);for(let o=i,a=e.length;o<a;o++){const l=e[o];l.opacity*=r.opacity,l.visible=l.visible&&r.visible,l.maxResolution=Math.min(l.maxResolution,r.maxResolution),l.minResolution=Math.max(l.minResolution,r.minResolution),l.minZoom=Math.max(l.minZoom,r.minZoom),l.maxZoom=Math.min(l.maxZoom,r.maxZoom),r.extent!==void 0&&(l.extent!==void 0?l.extent=_i(l.extent,r.extent):l.extent=r.extent),l.zIndex===void 0&&(l.zIndex=s)}return e}getSourceState(){return"ready"}}const ve={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"};class Ia extends ep{constructor(t){const e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(ot.SOURCE,this.handleSourcePropertyChange_);const i=t.source?t.source:null;this.setSource(i)}getLayersArray(t){return t=t||[],t.push(this),t}getLayerStatesArray(t){return t=t||[],t.push(this.getLayerState()),t}getSource(){return this.get(ot.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(ut(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const t=this.getSource();t&&(this.sourceChangeKey_=et(t,H.CHANGE,this.handleSourceChange_,this),t.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return!this.renderer_||!this.rendered?null:this.renderer_.getData(t)}isVisible(t){let e;const i=this.getMapInternal();!t&&i&&(t=i.getView()),t instanceof ze?e={viewState:t.getState(),extent:t.calculateExtent()}:e=t,!e.layerStatesArray&&i&&(e.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let r;if(e.layerStatesArray){if(r=e.layerStatesArray.find(o=>o.layer===this),!r)return!1}else r=this.getLayerState();const s=this.getExtent();return Dh(r,e.viewState)&&(!s||Qt(s,e.extent))}getAttributions(t){if(!this.isVisible(t))return[];const e=this.getSource()?.getAttributions();if(!e)return[];const i=t instanceof ze?t.getViewStateAndExtent():t;let r=e(i);return Array.isArray(r)||(r=[r]),r}render(t,e){const i=this.getRenderer();return i.prepareFrame(t)?(this.rendered=!0,i.renderFrame(t,e)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(t,e){}renderDeferred(t){const e=this.getRenderer();e&&e.renderDeferred(t)}setMapInternal(t){t||this.unrender(),this.set(ot.MAP,t)}getMapInternal(){return this.get(ot.MAP)}setMap(t){this.mapPrecomposeKey_&&(ut(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(ut(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=et(t,ve.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=et(this,H.CHANGE,t.render,t),this.changed())}handlePrecompose_(t){const e=t.frameState.layerStatesArray,i=this.getLayerState(!1);rt(!e.some(r=>r.layer===i.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),e.push(i)}setSource(t){this.set(ot.SOURCE,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function Dh(n,t){if(!n.visible)return!1;const e=t.resolution;if(e<n.minResolution||e>=n.maxResolution)return!1;const i=t.zoom;return i>n.minZoom&&i<=n.maxZoom}const Mh=[NaN,NaN,NaN,0];let wl;function av(){return wl||(wl=Rt(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),wl}const lv=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,cv=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,hv=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,uv=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function lo(n,t){return n.endsWith("%")?Number(n.substring(0,n.length-1))/t:Number(n)}function ss(n){throw new Error('failed to parse "'+n+'" as color')}function np(n){if(n.toLowerCase().startsWith("rgb")){const s=n.match(cv)||n.match(lv)||n.match(hv);if(s){const o=s[4],a=100/255;return[pt(lo(s[1],a)+.5|0,0,255),pt(lo(s[2],a)+.5|0,0,255),pt(lo(s[3],a)+.5|0,0,255),o!==void 0?pt(lo(o,100),0,1):1]}ss(n)}if(n.startsWith("#")){if(uv.test(n)){const s=n.substring(1),o=s.length<=4?1:2,a=[0,0,0,255];for(let l=0,c=s.length;l<c;l+=o){let h=parseInt(s.substring(l,l+o),16);o===1&&(h+=h<<4),a[l/o]=h}return a[3]=a[3]/255,a}ss(n)}const t=av();t.fillStyle="#abcdef";let e=t.fillStyle;t.fillStyle=n,t.fillStyle===e&&(t.fillStyle="#fedcba",e=t.fillStyle,t.fillStyle=n,t.fillStyle===e&&ss(n));const i=t.fillStyle;if(i.startsWith("#")||i.startsWith("rgba"))return np(i);t.clearRect(0,0,1,1),t.fillRect(0,0,1,1);const r=Array.from(t.getImageData(0,0,1,1).data);return r[3]=ga(r[3]/255,3),r}function dv(n){return typeof n=="string"?n:Nh(n)}const fv=1024,Wr={};let vl=0;function gv(n){if(n.length===4)return n;const t=n.slice();return t[3]=1,t}function bl(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function El(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function xl(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function Cl(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function gd(n){const t=xl(n[0]),e=xl(n[1]),i=xl(n[2]),r=Cl(t*.222488403+e*.716873169+i*.06060791),s=500*(Cl(t*.452247074+e*.399439023+i*.148375274)-r),o=200*(r-Cl(t*.016863605+e*.117638439+i*.865350722)),a=Math.atan2(o,s)*(180/Math.PI);return[116*r-16,Math.sqrt(s*s+o*o),a<0?a+360:a,n[3]]}function pv(n){const t=(n[0]+16)/116,e=n[1],i=n[2]*Math.PI/180,r=El(t),s=El(t+e/500*Math.cos(i)),o=El(t-e/200*Math.sin(i)),a=bl(s*3.021973625-r*1.617392459-o*.404875592),l=bl(s*-.943766287+r*1.916279586+o*.027607165),c=bl(s*.069407491-r*.22898585+o*1.159737864);return[pt(a+.5|0,0,255),pt(l+.5|0,0,255),pt(c+.5|0,0,255),n[3]]}function Fh(n){if(n==="none")return Mh;if(Wr.hasOwnProperty(n))return Wr[n];if(vl>=fv){let e=0;for(const i in Wr)(e++&3)===0&&(delete Wr[i],--vl)}const t=np(n);t.length!==4&&ss(n);for(const e of t)isNaN(e)&&ss(n);return Wr[n]=t,++vl,t}function gr(n){return Array.isArray(n)?n:Fh(n)}function Nh(n){let t=n[0];t!=(t|0)&&(t=t+.5|0);let e=n[1];e!=(e|0)&&(e=e+.5|0);let i=n[2];i!=(i|0)&&(i=i+.5|0);const r=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+t+","+e+","+i+","+r+")"}function pd(n){return n[0]>0&&n[1]>0}function mv(n,t,e){return e===void 0&&(e=[0,0]),e[0]=n[0]*t+.5|0,e[1]=n[1]*t+.5|0,e}function ne(n,t){return Array.isArray(n)?n:(t===void 0?t=[n,n]:(t[0]=n,t[1]=n),t)}let ki=0;const qt=1<<ki++,J=1<<ki++,Zt=1<<ki++,Ae=1<<ki++,Ci=1<<ki++,Yr=1<<ki++,co=Math.pow(2,ki)-1,$h={[qt]:"boolean",[J]:"number",[Zt]:"string",[Ae]:"color",[Ci]:"number[]",[Yr]:"size"},_v=Object.keys($h).map(Number).sort(ln);function yv(n){return n in $h}function Zr(n){const t=[];for(const e of _v)Jr(n,e)&&t.push($h[e]);return t.length===0?"untyped":t.length<3?t.join(" or "):t.slice(0,-1).join(", ")+", or "+t[t.length-1]}function Jr(n,t){return(n&t)===t}function En(n,t){return n===t}class St{constructor(t,e){if(!yv(t))throw new Error(`literal expressions must have a specific type, got ${Zr(t)}`);this.type=t,this.value=e}}class wv{constructor(t,e,...i){this.type=t,this.operator=e,this.args=i}}function ip(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function Mt(n,t,e){switch(typeof n){case"boolean":{if(En(t,Zt))return new St(Zt,n?"true":"false");if(!Jr(t,qt))throw new Error(`got a boolean, but expected ${Zr(t)}`);return new St(qt,n)}case"number":{if(En(t,Yr))return new St(Yr,ne(n));if(En(t,qt))return new St(qt,!!n);if(En(t,Zt))return new St(Zt,n.toString());if(!Jr(t,J))throw new Error(`got a number, but expected ${Zr(t)}`);return new St(J,n)}case"string":{if(En(t,Ae))return new St(Ae,Fh(n));if(En(t,qt))return new St(qt,!!n);if(!Jr(t,Zt))throw new Error(`got a string, but expected ${Zr(t)}`);return new St(Zt,n)}}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return Pv(n,t,e);for(const i of n)if(typeof i!="number")throw new Error("expected an array of numbers");if(En(t,Yr)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new St(Yr,n)}if(En(t,Ae)){if(n.length===3)return new St(Ae,[...n,1]);if(n.length===4)return new St(Ae,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!Jr(t,Ci))throw new Error(`got an array of numbers, but expected ${Zr(t)}`);return new St(Ci,n)}const O={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},vv={[O.Get]:j(X(1,1/0),md),[O.Var]:j(X(1,1),bv),[O.Has]:j(X(1,1/0),md),[O.Id]:j(Ev,ji),[O.Concat]:j(X(2,1/0),it(Zt)),[O.GeometryType]:j(xv,ji),[O.LineMetric]:j(ji),[O.Resolution]:j(Sl,ji),[O.Zoom]:j(Sl,ji),[O.Time]:j(Sl,ji),[O.Any]:j(X(2,1/0),it(qt)),[O.All]:j(X(2,1/0),it(qt)),[O.Not]:j(X(1,1),it(qt)),[O.Equal]:j(X(2,2),it(co)),[O.NotEqual]:j(X(2,2),it(co)),[O.GreaterThan]:j(X(2,2),it(J)),[O.GreaterThanOrEqualTo]:j(X(2,2),it(J)),[O.LessThan]:j(X(2,2),it(J)),[O.LessThanOrEqualTo]:j(X(2,2),it(J)),[O.Multiply]:j(X(2,1/0),_d),[O.Coalesce]:j(X(2,1/0),_d),[O.Divide]:j(X(2,2),it(J)),[O.Add]:j(X(2,1/0),it(J)),[O.Subtract]:j(X(2,2),it(J)),[O.Clamp]:j(X(3,3),it(J)),[O.Mod]:j(X(2,2),it(J)),[O.Pow]:j(X(2,2),it(J)),[O.Abs]:j(X(1,1),it(J)),[O.Floor]:j(X(1,1),it(J)),[O.Ceil]:j(X(1,1),it(J)),[O.Round]:j(X(1,1),it(J)),[O.Sin]:j(X(1,1),it(J)),[O.Cos]:j(X(1,1),it(J)),[O.Atan]:j(X(1,2),it(J)),[O.Sqrt]:j(X(1,1),it(J)),[O.Match]:j(X(4,1/0),yd,Sv),[O.Between]:j(X(3,3),it(J)),[O.Interpolate]:j(X(6,1/0),yd,Tv),[O.Case]:j(X(3,1/0),Cv,Iv),[O.In]:j(X(2,2),Rv),[O.Number]:j(X(1,1/0),it(co)),[O.String]:j(X(1,1/0),it(co)),[O.Array]:j(X(1,1/0),it(J)),[O.Color]:j(X(1,4),it(J)),[O.Band]:j(X(1,3),it(J)),[O.Palette]:j(X(2,2),Av),[O.ToString]:j(X(1,1),it(qt|J|Zt|Ae))};function md(n,t,e){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=n[s+1];switch(typeof o){case"number":{r[s]=new St(J,o);break}case"string":{r[s]=new St(Zt,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}s===0&&e.properties.add(String(o))}return r}function bv(n,t,e){const i=n[1];if(typeof i!="string")throw new Error("expected a string argument for var operation");return e.variables.add(i),[new St(Zt,i)]}function Ev(n,t,e){e.featureId=!0}function xv(n,t,e){e.geometryType=!0}function Sl(n,t,e){e.mapState=!0}function ji(n,t,e){const i=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${i} operation`);return[]}function X(n,t){return function(e,i,r){const s=e[0],o=e.length-1;if(n===t){if(o!==n){const a=n===1?"":"s";throw new Error(`expected ${n} argument${a} for ${s}, got ${o}`)}}else if(o<n||o>t){const a=t===1/0?`${n} or more`:`${n} to ${t}`;throw new Error(`expected ${a} arguments for ${s}, got ${o}`)}}}function _d(n,t,e){const i=n.length-1,r=new Array(i);for(let s=0;s<i;++s){const o=Mt(n[s+1],t,e);r[s]=o}return r}function it(n){return function(t,e,i){const r=t.length-1,s=new Array(r);for(let o=0;o<r;++o){const a=Mt(t[o+1],n,i);s[o]=a}return s}}function Cv(n,t,e){const i=n[0],r=n.length-1;if(r%2===0)throw new Error(`expected an odd number of arguments for ${i}, got ${r} instead`)}function yd(n,t,e){const i=n[0],r=n.length-1;if(r%2===1)throw new Error(`expected an even number of arguments for operation ${i}, got ${r} instead`)}function Sv(n,t,e){const i=n.length-1,r=Zt|J|qt,s=Mt(n[1],r,e),o=Mt(n[n.length-1],t,e),a=new Array(i-2);for(let l=0;l<i-2;l+=2){try{const c=Mt(n[l+2],s.type,e);a[l]=c}catch(c){throw new Error(`failed to parse argument ${l+1} of match expression: ${c.message}`)}try{const c=Mt(n[l+3],o.type,e);a[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+2} of match expression: ${c.message}`)}}return[s,...a,o]}function Tv(n,t,e){const i=n[1];let r;switch(i[0]){case"linear":r=1;break;case"exponential":const l=i[1];if(typeof l!="number"||l<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(l)} instead`);r=l;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(i)}`)}const s=new St(J,r);let o;try{o=Mt(n[2],J,e)}catch(l){throw new Error(`failed to parse argument 1 in interpolate expression: ${l.message}`)}const a=new Array(n.length-3);for(let l=0;l<a.length;l+=2){try{const c=Mt(n[l+3],J,e);a[l]=c}catch(c){throw new Error(`failed to parse argument ${l+2} for interpolate expression: ${c.message}`)}try{const c=Mt(n[l+4],t,e);a[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+3} for interpolate expression: ${c.message}`)}}return[s,o,...a]}function Iv(n,t,e){const i=Mt(n[n.length-1],t,e),r=new Array(n.length-1);for(let s=0;s<r.length-1;s+=2){try{const o=Mt(n[s+1],qt,e);r[s]=o}catch(o){throw new Error(`failed to parse argument ${s} of case expression: ${o.message}`)}try{const o=Mt(n[s+2],i.type,e);r[s+1]=o}catch(o){throw new Error(`failed to parse argument ${s+1} of case expression: ${o.message}`)}}return r[r.length-1]=i,r}function Rv(n,t,e){let i=n[2];if(!Array.isArray(i))throw new Error('the second argument for the "in" operator must be an array');let r;if(typeof i[0]=="string"){if(i[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(i[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');i=i[1],r=Zt}else r=J;const s=new Array(i.length);for(let a=0;a<s.length;a++)try{const l=Mt(i[a],r,e);s[a]=l}catch(l){throw new Error(`failed to parse haystack item ${a} for "in" expression: ${l.message}`)}return[Mt(n[1],r,e),...s]}function Av(n,t,e){let i;try{i=Mt(n[1],J,e)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const r=n[2];if(!Array.isArray(r))throw new Error("the second argument of palette must be an array");const s=new Array(r.length);for(let o=0;o<s.length;o++){let a;try{a=Mt(r[o],Ae,e)}catch(l){throw new Error(`failed to parse color at index ${o} in palette expression: ${l.message}`)}if(!(a instanceof St))throw new Error(`the palette color at index ${o} must be a literal value`);s[o]=a}return[i,...s]}function j(...n){return function(t,e,i){const r=t[0];let s;for(let o=0;o<n.length;o++){const a=n[o](t,e,i);if(o==n.length-1){if(!a)throw new Error("expected last argument validator to return the parsed args");s=a}}return new wv(e,r,...s)}}function Pv(n,t,e){const i=n[0],r=vv[i];if(!r)throw new Error(`unknown operator: ${i}`);return r(n,t,e)}function rp(n){if(!n)return"";const t=n.getType();switch(t){case"Point":case"LineString":case"Polygon":return t;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return t.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return rp(n.getGeometries()[0]);default:return""}}function sp(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function vn(n,t,e){const i=Mt(n,t,e);return Le(i)}function Le(n,t){if(n instanceof St){if(n.type===Ae&&typeof n.value=="string"){const i=Fh(n.value);return function(){return i}}return function(){return n.value}}const e=n.operator;switch(e){case O.Number:case O.String:case O.Coalesce:return Lv(n);case O.Get:case O.Var:case O.Has:return Ov(n);case O.Id:return i=>i.featureId;case O.GeometryType:return i=>i.geometryType;case O.Concat:{const i=n.args.map(r=>Le(r));return r=>"".concat(...i.map(s=>s(r).toString()))}case O.Resolution:return i=>i.resolution;case O.Any:case O.All:case O.Between:case O.In:case O.Not:return Dv(n);case O.Equal:case O.NotEqual:case O.LessThan:case O.LessThanOrEqualTo:case O.GreaterThan:case O.GreaterThanOrEqualTo:return kv(n);case O.Multiply:case O.Divide:case O.Add:case O.Subtract:case O.Clamp:case O.Mod:case O.Pow:case O.Abs:case O.Floor:case O.Ceil:case O.Round:case O.Sin:case O.Cos:case O.Atan:case O.Sqrt:return Mv(n);case O.Case:return Fv(n);case O.Match:return Nv(n);case O.Interpolate:return $v(n);case O.ToString:return Vv(n);default:throw new Error(`Unsupported operator ${e}`)}}function Lv(n,t){const e=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Le(n.args[s]);switch(e){case O.Coalesce:return s=>{for(let o=0;o<i;++o){const a=r[o](s);if(typeof a<"u"&&a!==null)return a}throw new Error("Expected one of the values to be non-null")};case O.Number:case O.String:return s=>{for(let o=0;o<i;++o){const a=r[o](s);if(typeof a===e)return a}throw new Error(`Expected one of the values to be a ${e}`)};default:throw new Error(`Unsupported assertion operator ${e}`)}}function Ov(n,t){const i=n.args[0].value;switch(n.operator){case O.Get:return r=>{const s=n.args;let o=r.properties[i];for(let a=1,l=s.length;a<l;++a){const h=s[a].value;o=o[h]}return o};case O.Var:return r=>r.variables[i];case O.Has:return r=>{const s=n.args;if(!(i in r.properties))return!1;let o=r.properties[i];for(let a=1,l=s.length;a<l;++a){const h=s[a].value;if(!o||!Object.hasOwn(o,h))return!1;o=o[h]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function kv(n,t){const e=n.operator,i=Le(n.args[0]),r=Le(n.args[1]);switch(e){case O.Equal:return s=>i(s)===r(s);case O.NotEqual:return s=>i(s)!==r(s);case O.LessThan:return s=>i(s)<r(s);case O.LessThanOrEqualTo:return s=>i(s)<=r(s);case O.GreaterThan:return s=>i(s)>r(s);case O.GreaterThanOrEqualTo:return s=>i(s)>=r(s);default:throw new Error(`Unsupported comparison operator ${e}`)}}function Dv(n,t){const e=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Le(n.args[s]);switch(e){case O.Any:return s=>{for(let o=0;o<i;++o)if(r[o](s))return!0;return!1};case O.All:return s=>{for(let o=0;o<i;++o)if(!r[o](s))return!1;return!0};case O.Between:return s=>{const o=r[0](s),a=r[1](s),l=r[2](s);return o>=a&&o<=l};case O.In:return s=>{const o=r[0](s);for(let a=1;a<i;++a)if(o===r[a](s))return!0;return!1};case O.Not:return s=>!r[0](s);default:throw new Error(`Unsupported logical operator ${e}`)}}function Mv(n,t){const e=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Le(n.args[s]);switch(e){case O.Multiply:return s=>{let o=1;for(let a=0;a<i;++a)o*=r[a](s);return o};case O.Divide:return s=>r[0](s)/r[1](s);case O.Add:return s=>{let o=0;for(let a=0;a<i;++a)o+=r[a](s);return o};case O.Subtract:return s=>r[0](s)-r[1](s);case O.Clamp:return s=>{const o=r[0](s),a=r[1](s);if(o<a)return a;const l=r[2](s);return o>l?l:o};case O.Mod:return s=>r[0](s)%r[1](s);case O.Pow:return s=>Math.pow(r[0](s),r[1](s));case O.Abs:return s=>Math.abs(r[0](s));case O.Floor:return s=>Math.floor(r[0](s));case O.Ceil:return s=>Math.ceil(r[0](s));case O.Round:return s=>Math.round(r[0](s));case O.Sin:return s=>Math.sin(r[0](s));case O.Cos:return s=>Math.cos(r[0](s));case O.Atan:return i===2?s=>Math.atan2(r[0](s),r[1](s)):s=>Math.atan(r[0](s));case O.Sqrt:return s=>Math.sqrt(r[0](s));default:throw new Error(`Unsupported numeric operator ${e}`)}}function Fv(n,t){const e=n.args.length,i=new Array(e);for(let r=0;r<e;++r)i[r]=Le(n.args[r]);return r=>{for(let s=0;s<e-1;s+=2)if(i[s](r))return i[s+1](r);return i[e-1](r)}}function Nv(n,t){const e=n.args.length,i=new Array(e);for(let r=0;r<e;++r)i[r]=Le(n.args[r]);return r=>{const s=i[0](r);for(let o=1;o<e-1;o+=2)if(s===i[o](r))return i[o+1](r);return i[e-1](r)}}function $v(n,t){const e=n.args.length,i=new Array(e);for(let r=0;r<e;++r)i[r]=Le(n.args[r]);return r=>{const s=i[0](r),o=i[1](r);let a,l;for(let c=2;c<e;c+=2){const h=i[c](r);let u=i[c+1](r);const d=Array.isArray(u);if(d&&(u=gv(u)),h>=o)return c===2?u:d?zv(s,o,a,l,h,u):Qr(s,o,a,l,h,u);a=h,l=u}return l}}function Vv(n,t){const e=n.operator,i=n.args.length,r=new Array(i);for(let s=0;s<i;++s)r[s]=Le(n.args[s]);switch(e){case O.ToString:return s=>{const o=r[0](s);return n.args[0].type===Ae?Nh(o):o.toString()};default:throw new Error(`Unsupported convert operator ${e}`)}}function Qr(n,t,e,i,r,s){const o=r-e;if(o===0)return i;const a=t-e,l=n===1?a/o:(Math.pow(n,a)-1)/(Math.pow(n,o)-1);return i+l*(s-i)}function zv(n,t,e,i,r,s){if(r-e===0)return i;const a=gd(i),l=gd(s);let c=l[2]-a[2];c>180?c-=360:c<-180&&(c+=360);const h=[Qr(n,t,e,a[0],r,l[0]),Qr(n,t,e,a[1],r,l[1]),a[2]+Qr(n,t,e,0,r,c),Qr(n,t,e,i[3],r,s[3])];return pv(h)}const K={IDLE:0,LOADING:1,LOADED:2,ERROR:3};function Gv(n,t,e){const i=n;let r=!0,s=!1,o=!1;const a=[So(i,H.LOAD,function(){o=!0,s||t()})];return i.src&&Hg?(s=!0,i.decode().then(function(){r&&t()}).catch(function(l){r&&(o?t():e())})):a.push(So(i,H.ERROR,e)),function(){r=!1,a.forEach(ut)}}function Bv(n,t){return new Promise((e,i)=>{function r(){o(),e(n)}function s(){o(),i(new Error("Image load error"))}function o(){n.removeEventListener("load",r),n.removeEventListener("error",s)}n.addEventListener("load",r),n.addEventListener("error",s)})}function Uv(n,t){return t&&(n.src=t),n.src&&Hg?new Promise((e,i)=>n.decode().then(()=>e(n)).catch(r=>n.complete&&n.width?e(n):i(r))):Bv(n)}class jv{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const e in this.cache_){const i=this.cache_[e];(t++&3)===0&&!i.hasListener()&&(delete this.cache_[e],delete this.patternCache_[e],--this.cacheSize_)}}}get(t,e,i){const r=Tl(t,e,i);return r in this.cache_?this.cache_[r]:null}getPattern(t,e,i){const r=Tl(t,e,i);return r in this.patternCache_?this.patternCache_[r]:null}set(t,e,i,r,s){const o=Tl(t,e,i),a=o in this.cache_;this.cache_[o]=r,s&&(r.getImageState()===K.IDLE&&r.load(),r.getImageState()===K.LOADING?r.ready().then(()=>{this.patternCache_[o]=Do().createPattern(r.getImage(1),"repeat")}):this.patternCache_[o]=Do().createPattern(r.getImage(1),"repeat")),a||++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}}function Tl(n,t,e){const i=e?gr(e):"null";return t+":"+n+":"+i}const be=new jv;let qr=null;class op extends _a{constructor(t,e,i,r,s){super(),this.hitDetectionImage_=null,this.image_=t,this.crossOrigin_=i,this.canvas_={},this.color_=s,this.imageState_=r===void 0?K.IDLE:r,this.size_=t&&t.width&&t.height?[t.width,t.height]:null,this.src_=e,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===K.LOADED){qr||(qr=Rt(1,1,void 0,{willReadFrequently:!0})),qr.drawImage(this.image_,0,0);try{qr.getImageData(0,0,1,1),this.tainted_=!1}catch{qr=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(H.CHANGE)}handleImageError_(){this.imageState_=K.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=K.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}getPixelRatio(t){return this.replaceColor_(t),this.canvas_[t]?t:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const t=this.size_[0],e=this.size_[1],i=Rt(t,e);i.fillRect(0,0,t,e),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===K.IDLE){this.image_||this.initializeImage_(),this.imageState_=K.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&Uv(this.image_,this.src_).then(t=>{this.image_=t,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(t){if(!this.color_||this.canvas_[t]||this.imageState_!==K.LOADED)return;const e=this.image_,i=Rt(Math.ceil(e.width*t),Math.ceil(e.height*t)),r=i.canvas;i.scale(t,t),i.drawImage(e,0,0),i.globalCompositeOperation="multiply",i.fillStyle=dv(this.color_),i.fillRect(0,0,r.width/t,r.height/t),i.globalCompositeOperation="destination-in",i.drawImage(e,0,0),this.canvas_[t]=r}ready(){return this.ready_||(this.ready_=new Promise(t=>{if(this.imageState_===K.LOADED||this.imageState_===K.ERROR)t();else{const e=()=>{(this.imageState_===K.LOADED||this.imageState_===K.ERROR)&&(this.removeEventListener(H.CHANGE,e),t())};this.addEventListener(H.CHANGE,e)}})),this.ready_}}function Mo(n,t,e,i,r,s){let o=t===void 0?void 0:be.get(t,e,r);return o||(o=new op(n,n&&"src"in n?n.src||void 0:t,e,i,r),be.set(t,e,r,o,s)),s&&o&&!be.getPattern(t,e,r)&&be.set(t,e,r,o,s),o}function Ue(n){return n?Array.isArray(n)?Nh(n):typeof n=="object"&&"src"in n?Wv(n):n:null}function Wv(n){if(!n.offset||!n.size)return be.getPattern(n.src,"anonymous",n.color);const t=n.src+":"+n.offset,e=be.getPattern(t,void 0,n.color);if(e)return e;const i=be.get(n.src,"anonymous",null);if(i.getImageState()!==K.LOADED)return null;const r=Rt(n.size[0],n.size[1]);return r.drawImage(i.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),Mo(r.canvas,t,void 0,K.LOADED,n.color,!0),be.getPattern(t,void 0,n.color)}const ap="10px sans-serif",Jt="#000",pr="round",hn=[],un=0,mr="round",vs=10,bs="#000",Es="center",Fo="middle",pi=[0,0,0,0],xs=1,Yi=new Ke;let Hr=null,wd;const pc={},qv=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function Hv(n,t,e){return`${n} ${t} 16px "${e}"`}const Xv=(function(){let t,e;async function i(s){await e.ready;const o=await e.load(s);if(o.length===0)return!1;const a=fc(s),l=a.families[0].toLowerCase(),c=a.weight;return o.some(h=>{const u=h.family.replace(/^['"]|['"]$/g,"").toLowerCase(),d=dc[h.weight]||h.weight;return u===l&&h.style===a.style&&d==c})}async function r(){await e.ready;let s=!0;const o=Yi.getProperties(),a=Object.keys(o).filter(l=>o[l]<100);for(let l=a.length-1;l>=0;--l){const c=a[l];let h=o[c];h<100&&(await i(c)?(Ns(pc),Yi.set(c,100)):(h+=10,Yi.set(c,h,!0),h<100&&(s=!1)))}t=void 0,s||(t=setTimeout(r,100))}return async function(s){e||(e=ce?self.fonts:document.fonts);const o=fc(s);if(!o)return;const a=o.families;let l=!1;for(const c of a){if(qv.has(c))continue;const h=Hv(o.style,o.weight,c);Yi.get(h)===void 0&&(Yi.set(h,0,!0),l=!0)}l&&(clearTimeout(t),t=setTimeout(r,100))}})(),Kv=(function(){let n;return function(t){let e=pc[t];if(e==null){if(ce){const i=fc(t),r=lp(t,"Žg");e=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=t,document.body.appendChild(n),e=n.offsetHeight,document.body.removeChild(n);pc[t]=e}return e}})();function lp(n,t){return Hr||(Hr=Rt(1,1)),n!=wd&&(Hr.font=n,wd=Hr.font),Hr.measureText(t)}function cp(n,t){return lp(n,t).width}function vd(n,t,e){if(t in e)return e[t];const i=t.split(`
`).reduce((r,s)=>Math.max(r,cp(n,s)),0);return e[t]=i,i}function Yv(n,t){const e=[],i=[],r=[];let s=0,o=0,a=0,l=0;for(let c=0,h=t.length;c<=h;c+=2){const u=t[c];if(u===`
`||c===h){s=Math.max(s,o),r.push(o),o=0,a+=l,l=0;continue}const d=t[c+1]||n.font,f=cp(d,u);e.push(f),o+=f;const g=Kv(d);i.push(g),l=Math.max(l,g)}return{width:s,height:a,widths:e,heights:i,lineWidths:r}}function Zv(n,t,e,i,r,s,o,a,l,c,h){n.save(),e!==1&&(n.globalAlpha===void 0?n.globalAlpha=u=>u.globalAlpha*=e:n.globalAlpha*=e),t&&n.transform.apply(n,t),i.contextInstructions?(n.translate(l,c),n.scale(h[0],h[1]),Jv(i,n)):h[0]<0||h[1]<0?(n.translate(l,c),n.scale(h[0],h[1]),n.drawImage(i,r,s,o,a,0,0,o,a)):n.drawImage(i,r,s,o,a,l,c,o*h[0],a*h[1]),n.restore()}function Jv(n,t){const e=n.contextInstructions;for(let i=0,r=e.length;i<r;i+=2)Array.isArray(e[i+1])?t[e[i]].apply(t,e[i+1]):t[e[i]]=e[i+1]}class Ra{constructor(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=ne(t.scale),this.displacement_=t.displacement,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new Ra({opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return W()}getImage(t){return W()}getHitDetectionImage(){return W()}getPixelRatio(t){return 1}getImageState(){return W()}getImageSize(){return W()}getOrigin(){return W()}getSize(){return W()}setDisplacement(t){this.displacement_=t}setOpacity(t){this.opacity_=t}setRotateWithView(t){this.rotateWithView_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=ne(t)}listenImageChange(t){W()}load(){W()}unlistenImageChange(t){W()}ready(){return Promise.resolve()}}class Aa extends Ra{constructor(t){super({opacity:1,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,rotation:t.rotation!==void 0?t.rotation:0,scale:t.scale!==void 0?t.scale:1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=t.fill!==void 0?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius=t.radius,this.radius2_=t.radius2,this.angle_=t.angle!==void 0?t.angle:0,this.stroke_=t.stroke!==void 0?t.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?K.LOADING:K.LOADED,this.imageState_===K.LOADING&&this.ready().then(()=>this.imageState_=K.LOADED),this.render()}clone(){const t=this.getScale(),e=new Aa({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}getAnchor(){const t=this.size_,e=this.getDisplacement(),i=this.getScaleArray();return[t[0]/2-e[0]/i[0],t[1]/2+e[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(t){this.fill_=t,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(t){const e=this.fill_?.getKey(),i=`${t},${this.angle_},${this.radius},${this.radius2_},${this.points_},${e}`+Object.values(this.renderOptions_).join(",");let r=be.get(i,null,null)?.getImage(1);if(!r){const s=this.renderOptions_,o=Math.ceil(s.size*t),a=Rt(o,o);this.draw_(s,a,t),r=a.canvas,be.set(i,null,null,new op(r,void 0,null,K.LOADED,null))}return r}getPixelRatio(t){return t}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t,this.render()}listenImageChange(t){}load(){}unlistenImageChange(t){}calculateLineJoinSize_(t,e,i){if(e===0||this.points_===1/0||t!=="bevel"&&t!=="miter")return e;let r=this.radius,s=this.radius2_===void 0?r:this.radius2_;if(r<s){const L=r;r=s,s=L}const o=this.radius2_===void 0?this.points_:this.points_*2,a=2*Math.PI/o,l=s*Math.sin(a),c=Math.sqrt(s*s-l*l),h=r-c,u=Math.sqrt(l*l+h*h),d=u/l;if(t==="miter"&&d<=i)return d*e;const f=e/2/d,g=e/2*(h/u),_=Math.sqrt((r+f)*(r+f)+g*g)-r;if(this.radius2_===void 0||t==="bevel")return _*2;const b=r*Math.sin(a),S=Math.sqrt(r*r-b*b),R=s-S,I=Math.sqrt(b*b+R*R)/b;if(I<=i){const L=I*e/2-s-r;return 2*Math.max(_,L)}return _*2}createRenderOptions(){let t=pr,e=mr,i=0,r=null,s=0,o,a=0;this.stroke_&&(o=Ue(this.stroke_.getColor()??bs),a=this.stroke_.getWidth()??xs,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,e=this.stroke_.getLineJoin()??mr,t=this.stroke_.getLineCap()??pr,i=this.stroke_.getMiterLimit()??vs);const l=this.calculateLineJoinSize_(e,a,i),c=Math.max(this.radius,this.radius2_||0),h=Math.ceil(2*c+l);return{strokeStyle:o,strokeWidth:a,size:h,lineCap:t,lineDash:r,lineDashOffset:s,lineJoin:e,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const t=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[t,t]}draw_(t,e,i){if(e.scale(i,i),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){let r=this.fill_.getColor();r===null&&(r=Jt),e.fillStyle=Ue(r),e.fill()}t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}createHitDetectionCanvas_(t){let e;if(this.fill_){let i=this.fill_.getColor(),r=0;typeof i=="string"&&(i=gr(i)),i===null?r=1:Array.isArray(i)&&(r=i.length===4?i[3]:1),r===0&&(e=Rt(t.size,t.size),this.drawHitDetectionCanvas_(t,e))}return e?e.canvas:this.getImage(1)}createPath_(t){let e=this.points_;const i=this.radius;if(e===1/0)t.arc(0,0,i,0,2*Math.PI);else{const r=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(e*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/e;for(let a=0;a<e;a++){const l=s+a*o,c=a%2===0?i:r;t.lineTo(c*Math.cos(l),c*Math.sin(l))}t.closePath()}}drawHitDetectionCanvas_(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=Jt,e.fill(),t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class Pa extends Aa{constructor(t){t=t||{radius:5},super({points:1/0,fill:t.fill,radius:t.radius,stroke:t.stroke,scale:t.scale!==void 0?t.scale:1,rotation:t.rotation!==void 0?t.rotation:0,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode})}clone(){const t=this.getScale(),e=new Pa({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}setRadius(t){this.radius=t,this.render()}}class _r{constructor(t){t=t||{},this.patternImage_=null,this.color_=null,t.color!==void 0&&this.setColor(t.color)}clone(){const t=this.getColor();return new _r({color:Array.isArray(t)?t.slice():t||void 0})}getColor(){return this.color_}setColor(t){if(t!==null&&typeof t=="object"&&"src"in t){const e=Mo(null,t.src,"anonymous",void 0,t.offset?null:t.color?t.color:null,!(t.offset&&t.size));e.ready().then(()=>{this.patternImage_=null}),e.getImageState()===K.IDLE&&e.load(),e.getImageState()===K.LOADING&&(this.patternImage_=e)}this.color_=t}getKey(){const t=this.getColor();return t?t instanceof CanvasPattern||t instanceof CanvasGradient?nt(t):typeof t=="object"&&"src"in t?t.src+":"+t.offset:gr(t).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}function bd(n,t,e,i){return e!==void 0&&i!==void 0?[e/n,i/t]:e!==void 0?e/n:i!==void 0?i/t:1}class La extends Ra{constructor(t){t=t||{};const e=t.opacity!==void 0?t.opacity:1,i=t.rotation!==void 0?t.rotation:0,r=t.scale!==void 0?t.scale:1,s=t.rotateWithView!==void 0?t.rotateWithView:!1;super({opacity:e,rotation:i,scale:r,displacement:t.displacement!==void 0?t.displacement:[0,0],rotateWithView:s,declutterMode:t.declutterMode}),this.anchor_=t.anchor!==void 0?t.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=t.anchorOrigin!==void 0?t.anchorOrigin:"top-left",this.anchorXUnits_=t.anchorXUnits!==void 0?t.anchorXUnits:"fraction",this.anchorYUnits_=t.anchorYUnits!==void 0?t.anchorYUnits:"fraction",this.crossOrigin_=t.crossOrigin!==void 0?t.crossOrigin:null;const o=t.img!==void 0?t.img:null;let a=t.src;rt(!(a!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(a===void 0||a.length===0)&&o&&(a=o.src||nt(o)),rt(a!==void 0&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),rt(!((t.width!==void 0||t.height!==void 0)&&t.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(t.src!==void 0?l=K.IDLE:o!==void 0&&("complete"in o?o.complete?l=o.src?K.LOADED:K.IDLE:l=K.LOADING:l=K.LOADED),this.color_=t.color!==void 0?gr(t.color):null,this.iconImage_=Mo(o,a,this.crossOrigin_,l,this.color_),this.offset_=t.offset!==void 0?t.offset:[0,0],this.offsetOrigin_=t.offsetOrigin!==void 0?t.offsetOrigin:"top-left",this.origin_=null,this.size_=t.size!==void 0?t.size:null,this.initialOptions_,t.width!==void 0||t.height!==void 0){let c,h;if(t.size)[c,h]=t.size;else{const u=this.getImage(1);if(u.width&&u.height)c=u.width,h=u.height;else if(u instanceof HTMLImageElement){this.initialOptions_=t;const d=()=>{if(this.unlistenImageChange(d),!this.initialOptions_)return;const f=this.iconImage_.getSize();this.setScale(bd(f[0],f[1],t.width,t.height))};this.listenImageChange(d);return}}c!==void 0&&this.setScale(bd(c,h,t.width,t.height))}}clone(){let t,e,i;return this.initialOptions_?(e=this.initialOptions_.width,i=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t),new La({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:e,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let t=this.normalizedAnchor_;if(!t){t=this.anchor_;const r=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!r)return null;t=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(t[0]*=r[0]),this.anchorYUnits_=="fraction"&&(t[1]*=r[1])}if(this.anchorOrigin_!="top-left"){if(!r)return null;t===this.anchor_&&(t=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(t[0]=-t[0]+r[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(t[1]=-t[1]+r[1])}this.normalizedAnchor_=t}const e=this.getDisplacement(),i=this.getScaleArray();return[t[0]-e[0]/i[0],t[1]+e[1]/i[1]]}setAnchor(t){this.anchor_=t,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(t){return this.iconImage_.getImage(t)}getPixelRatio(t){return this.iconImage_.getPixelRatio(t)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let t=this.offset_;if(this.offsetOrigin_!="top-left"){const e=this.getSize(),i=this.iconImage_.getSize();if(!e||!i)return null;t=t.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(t[0]=i[0]-e[0]-t[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(t[1]=i[1]-e[1]-t[1])}return this.origin_=t,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(t){this.iconImage_=Mo(null,t,this.crossOrigin_,K.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const t=this.getScaleArray();if(this.size_)return this.size_[0]*t[0];if(this.iconImage_.getImageState()==K.LOADED)return this.iconImage_.getSize()[0]*t[0]}getHeight(){const t=this.getScaleArray();if(this.size_)return this.size_[1]*t[1];if(this.iconImage_.getImageState()==K.LOADED)return this.iconImage_.getSize()[1]*t[1]}setScale(t){delete this.initialOptions_,super.setScale(t)}listenImageChange(t){this.iconImage_.addEventListener(H.CHANGE,t)}load(){this.iconImage_.load()}unlistenImageChange(t){this.iconImage_.removeEventListener(H.CHANGE,t)}ready(){return this.iconImage_.ready()}}class Oa{constructor(t){t=t||{},this.color_=t.color!==void 0?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=t.lineDash!==void 0?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}clone(){const t=this.getColor();return new Oa({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(t){this.color_=t}setLineCap(t){this.lineCap_=t}setLineDash(t){this.lineDash_=t}setLineDashOffset(t){this.lineDashOffset_=t}setLineJoin(t){this.lineJoin_=t}setMiterLimit(t){this.miterLimit_=t}setWidth(t){this.width_=t}}class wi{constructor(t){t=t||{},this.geometry_=null,this.geometryFunction_=Ed,t.geometry!==void 0&&this.setGeometry(t.geometry),this.fill_=t.fill!==void 0?t.fill:null,this.image_=t.image!==void 0?t.image:null,this.renderer_=t.renderer!==void 0?t.renderer:null,this.hitDetectionRenderer_=t.hitDetectionRenderer!==void 0?t.hitDetectionRenderer:null,this.stroke_=t.stroke!==void 0?t.stroke:null,this.text_=t.text!==void 0?t.text:null,this.zIndex_=t.zIndex}clone(){let t=this.getGeometry();return t&&typeof t=="object"&&(t=t.clone()),new wi({geometry:t??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(t){this.renderer_=t}setHitDetectionRenderer(t){this.hitDetectionRenderer_=t}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(t){this.fill_=t}getImage(){return this.image_}setImage(t){this.image_=t}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t}getText(){return this.text_}setText(t){this.text_=t}getZIndex(){return this.zIndex_}setGeometry(t){typeof t=="function"?this.geometryFunction_=t:typeof t=="string"?this.geometryFunction_=function(e){return e.get(t)}:t?t!==void 0&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=Ed,this.geometry_=t}setZIndex(t){this.zIndex_=t}}function Qv(n){let t;if(typeof n=="function")t=n;else{let e;Array.isArray(n)?e=n:(rt(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),e=[n]),t=function(){return e}}return t}let Il=null;function hp(n,t){if(!Il){const e=new _r({color:"rgba(255,255,255,0.4)"}),i=new Oa({color:"#3399CC",width:1.25});Il=[new wi({image:new Pa({fill:e,stroke:i,radius:5}),fill:e,stroke:i})]}return Il}function Ed(n){return n.getGeometry()}const tb="#333";class Vh{constructor(t){t=t||{},this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.keepUpright_=t.keepUpright,this.scale_=t.scale,this.scaleArray_=ne(t.scale!==void 0?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.repeat_=t.repeat,this.textBaseline_=t.textBaseline,this.fill_=t.fill!==void 0?t.fill:new _r({color:tb}),this.maxAngle_=t.maxAngle!==void 0?t.maxAngle:Math.PI/4,this.placement_=t.placement!==void 0?t.placement:"point",this.overflow_=!!t.overflow,this.stroke_=t.stroke!==void 0?t.stroke:null,this.offsetX_=t.offsetX!==void 0?t.offsetX:0,this.offsetY_=t.offsetY!==void 0?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=t.padding===void 0?null:t.padding,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new Vh({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof _r?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(t){this.overflow_=t}setFont(t){this.font_=t}setMaxAngle(t){this.maxAngle_=t}setOffsetX(t){this.offsetX_=t}setOffsetY(t){this.offsetY_=t}setPlacement(t){this.placement_=t}setRepeat(t){this.repeat_=t}setRotateWithView(t){this.rotateWithView_=t}setKeepUpright(t){this.keepUpright_=t}setFill(t){this.fill_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=ne(t!==void 0?t:1)}setStroke(t){this.stroke_=t}setText(t){this.text_=t}setTextAlign(t){this.textAlign_=t}setJustify(t){this.justify_=t}setTextBaseline(t){this.textBaseline_=t}setBackgroundFill(t){this.backgroundFill_=t}setBackgroundStroke(t){this.backgroundStroke_=t}setPadding(t){this.padding_=t}}function eb(n){return!0}function nb(n){const t=ip(),e=ib(n,t),i=sp();return function(r,s){if(i.properties=r.getPropertiesInternal(),i.resolution=s,t.featureId){const o=r.getId();o!==void 0?i.featureId=o:i.featureId=null}return t.geometryType&&(i.geometryType=rp(r.getGeometry())),e(i)}}function xd(n){const t=ip(),e=n.length,i=new Array(e);for(let o=0;o<e;++o)i[o]=mc(n[o],t);const r=sp(),s=new Array(e);return function(o,a){if(r.properties=o.getPropertiesInternal(),r.resolution=a,t.featureId){const c=o.getId();c!==void 0?r.featureId=c:r.featureId=null}let l=0;for(let c=0;c<e;++c){const h=i[c](r);h&&(s[l]=h,l+=1)}return s.length=l,s}}function ib(n,t){const e=n.length,i=new Array(e);for(let r=0;r<e;++r){const s=n[r],o="filter"in s?vn(s.filter,qt,t):eb;let a;if(Array.isArray(s.style)){const l=s.style.length;a=new Array(l);for(let c=0;c<l;++c)a[c]=mc(s.style[c],t)}else a=[mc(s.style,t)];i[r]={filter:o,styles:a}}return function(r){const s=[];let o=!1;for(let a=0;a<e;++a){const l=i[a].filter;if(l(r)&&!(n[a].else&&o)){o=!0;for(const c of i[a].styles){const h=c(r);h&&s.push(h)}}}return s}}function mc(n,t){const e=Cs(n,"",t),i=Ss(n,"",t),r=rb(n,t),s=sb(n,t),o=te(n,"z-index",t);if(!e&&!i&&!r&&!s&&!bi(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));const a=new wi;return function(l){let c=!0;if(e){const h=e(l);h&&(c=!1),a.setFill(h)}if(i){const h=i(l);h&&(c=!1),a.setStroke(h)}if(r){const h=r(l);h&&(c=!1),a.setText(h)}if(s){const h=s(l);h&&(c=!1),a.setImage(h)}return o&&a.setZIndex(o(l)),c?null:a}}function Cs(n,t,e){let i;if(t+"fill-pattern-src"in n)i=cb(n,t+"fill-",e);else{if(n[t+"fill-color"]==="none")return s=>null;i=zh(n,t+"fill-color",e)}if(!i)return null;const r=new _r;return function(s){const o=i(s);return o===Mh?null:(r.setColor(o),r)}}function Ss(n,t,e){const i=te(n,t+"stroke-width",e),r=zh(n,t+"stroke-color",e);if(!i&&!r)return null;const s=sn(n,t+"stroke-line-cap",e),o=sn(n,t+"stroke-line-join",e),a=up(n,t+"stroke-line-dash",e),l=te(n,t+"stroke-line-dash-offset",e),c=te(n,t+"stroke-miter-limit",e),h=new Oa;return function(u){if(r){const d=r(u);if(d===Mh)return null;h.setColor(d)}if(i&&h.setWidth(i(u)),s){const d=s(u);if(d!=="butt"&&d!=="round"&&d!=="square")throw new Error("Expected butt, round, or square line cap");h.setLineCap(d)}if(o){const d=o(u);if(d!=="bevel"&&d!=="round"&&d!=="miter")throw new Error("Expected bevel, round, or miter line join");h.setLineJoin(d)}return a&&h.setLineDash(a(u)),l&&h.setLineDashOffset(l(u)),c&&h.setMiterLimit(c(u)),h}}function rb(n,t){const e="text-",i=sn(n,e+"value",t);if(!i)return null;const r=Cs(n,e,t),s=Cs(n,e+"background-",t),o=Ss(n,e,t),a=Ss(n,e+"background-",t),l=sn(n,e+"font",t),c=te(n,e+"max-angle",t),h=te(n,e+"offset-x",t),u=te(n,e+"offset-y",t),d=sr(n,e+"overflow",t),f=sn(n,e+"placement",t),g=te(n,e+"repeat",t),y=ka(n,e+"scale",t),_=sr(n,e+"rotate-with-view",t),b=te(n,e+"rotation",t),S=sn(n,e+"align",t),R=sn(n,e+"justify",t),T=sn(n,e+"baseline",t),I=sr(n,e+"keep-upright",t),L=up(n,e+"padding",t),w=Da(n,e+"declutter-mode"),p=new Vh({declutterMode:w});return function(m){if(p.setText(i(m)),r&&p.setFill(r(m)),s&&p.setBackgroundFill(s(m)),o&&p.setStroke(o(m)),a&&p.setBackgroundStroke(a(m)),l&&p.setFont(l(m)),c&&p.setMaxAngle(c(m)),h&&p.setOffsetX(h(m)),u&&p.setOffsetY(u(m)),d&&p.setOverflow(d(m)),f){const E=f(m);if(E!=="point"&&E!=="line")throw new Error("Expected point or line for text-placement");p.setPlacement(E)}if(g&&p.setRepeat(g(m)),y&&p.setScale(y(m)),_&&p.setRotateWithView(_(m)),b&&p.setRotation(b(m)),S){const E=S(m);if(E!=="left"&&E!=="center"&&E!=="right"&&E!=="end"&&E!=="start")throw new Error("Expected left, right, center, start, or end for text-align");p.setTextAlign(E)}if(R){const E=R(m);if(E!=="left"&&E!=="right"&&E!=="center")throw new Error("Expected left, right, or center for text-justify");p.setJustify(E)}if(T){const E=T(m);if(E!=="bottom"&&E!=="top"&&E!=="middle"&&E!=="alphabetic"&&E!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");p.setTextBaseline(E)}return L&&p.setPadding(L(m)),I&&p.setKeepUpright(I(m)),p}}function sb(n,t){return"icon-src"in n?ob(n,t):"shape-points"in n?ab(n,t):"circle-radius"in n?lb(n,t):null}function ob(n,t){const e="icon-",i=e+"src",r=dp(n[i],i),s=No(n,e+"anchor",t),o=ka(n,e+"scale",t),a=te(n,e+"opacity",t),l=No(n,e+"displacement",t),c=te(n,e+"rotation",t),h=sr(n,e+"rotate-with-view",t),u=Sd(n,e+"anchor-origin"),d=Td(n,e+"anchor-x-units"),f=Td(n,e+"anchor-y-units"),g=fb(n,e+"color"),y=ub(n,e+"cross-origin"),_=db(n,e+"offset"),b=Sd(n,e+"offset-origin"),S=$o(n,e+"width"),R=$o(n,e+"height"),T=hb(n,e+"size"),I=Da(n,e+"declutter-mode"),L=new La({src:r,anchorOrigin:u,anchorXUnits:d,anchorYUnits:f,color:g,crossOrigin:y,offset:_,offsetOrigin:b,height:R,width:S,size:T,declutterMode:I});return function(w){return a&&L.setOpacity(a(w)),l&&L.setDisplacement(l(w)),c&&L.setRotation(c(w)),h&&L.setRotateWithView(h(w)),o&&L.setScale(o(w)),s&&L.setAnchor(s(w)),L}}function ab(n,t){const e="shape-",i=e+"points",r=e+"radius",s=_c(n[i],i),o=_c(n[r],r),a=Cs(n,e,t),l=Ss(n,e,t),c=ka(n,e+"scale",t),h=No(n,e+"displacement",t),u=te(n,e+"rotation",t),d=sr(n,e+"rotate-with-view",t),f=$o(n,e+"radius2"),g=$o(n,e+"angle"),y=Da(n,e+"declutter-mode"),_=new Aa({points:s,radius:o,radius2:f,angle:g,declutterMode:y});return function(b){return a&&_.setFill(a(b)),l&&_.setStroke(l(b)),h&&_.setDisplacement(h(b)),u&&_.setRotation(u(b)),d&&_.setRotateWithView(d(b)),c&&_.setScale(c(b)),_}}function lb(n,t){const e="circle-",i=Cs(n,e,t),r=Ss(n,e,t),s=te(n,e+"radius",t),o=ka(n,e+"scale",t),a=No(n,e+"displacement",t),l=te(n,e+"rotation",t),c=sr(n,e+"rotate-with-view",t),h=Da(n,e+"declutter-mode"),u=new Pa({radius:5,declutterMode:h});return function(d){return s&&u.setRadius(s(d)),i&&u.setFill(i(d)),r&&u.setStroke(r(d)),a&&u.setDisplacement(a(d)),l&&u.setRotation(l(d)),c&&u.setRotateWithView(c(d)),o&&u.setScale(o(d)),u}}function te(n,t,e){if(!(t in n))return;const i=vn(n[t],J,e);return function(r){return _c(i(r),t)}}function sn(n,t,e){if(!(t in n))return null;const i=vn(n[t],Zt,e);return function(r){return dp(i(r),t)}}function cb(n,t,e){const i=sn(n,t+"pattern-src",e),r=Cd(n,t+"pattern-offset",e),s=Cd(n,t+"pattern-size",e),o=zh(n,t+"color",e);return function(a){return{src:i(a),offset:r&&r(a),size:s&&s(a),color:o&&o(a)}}}function sr(n,t,e){if(!(t in n))return null;const i=vn(n[t],qt,e);return function(r){const s=i(r);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${t}`);return s}}function zh(n,t,e){if(!(t in n))return null;const i=vn(n[t],Ae,e);return function(r){return fp(i(r),t)}}function up(n,t,e){if(!(t in n))return null;const i=vn(n[t],Ci,e);return function(r){return Ws(i(r),t)}}function No(n,t,e){if(!(t in n))return null;const i=vn(n[t],Ci,e);return function(r){const s=Ws(i(r),t);if(s.length!==2)throw new Error(`Expected two numbers for ${t}`);return s}}function Cd(n,t,e){if(!(t in n))return null;const i=vn(n[t],Ci,e);return function(r){return gp(i(r),t)}}function ka(n,t,e){if(!(t in n))return null;const i=vn(n[t],Ci|J,e);return function(r){return gb(i(r),t)}}function $o(n,t){const e=n[t];if(e!==void 0){if(typeof e!="number")throw new Error(`Expected a number for ${t}`);return e}}function hb(n,t){const e=n[t];if(e!==void 0){if(typeof e=="number")return ne(e);if(!Array.isArray(e))throw new Error(`Expected a number or size array for ${t}`);if(e.length!==2||typeof e[0]!="number"||typeof e[1]!="number")throw new Error(`Expected a number or size array for ${t}`);return e}}function ub(n,t){const e=n[t];if(e!==void 0){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);return e}}function Sd(n,t){const e=n[t];if(e!==void 0){if(e!=="bottom-left"&&e!=="bottom-right"&&e!=="top-left"&&e!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${t}`);return e}}function Td(n,t){const e=n[t];if(e!==void 0){if(e!=="pixels"&&e!=="fraction")throw new Error(`Expected pixels or fraction for ${t}`);return e}}function db(n,t){const e=n[t];if(e!==void 0)return Ws(e,t)}function Da(n,t){const e=n[t];if(e!==void 0){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);if(e!=="declutter"&&e!=="obstacle"&&e!=="none")throw new Error(`Expected declutter, obstacle, or none for ${t}`);return e}}function fb(n,t){const e=n[t];if(e!==void 0)return fp(e,t)}function Ws(n,t){if(!Array.isArray(n))throw new Error(`Expected an array for ${t}`);const e=n.length;for(let i=0;i<e;++i)if(typeof n[i]!="number")throw new Error(`Expected an array of numbers for ${t}`);return n}function dp(n,t){if(typeof n!="string")throw new Error(`Expected a string for ${t}`);return n}function _c(n,t){if(typeof n!="number")throw new Error(`Expected a number for ${t}`);return n}function fp(n,t){if(typeof n=="string")return n;const e=Ws(n,t),i=e.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${t}`);return e}function gp(n,t){const e=Ws(n,t);if(e.length!==2)throw new Error(`Expected an array of two numbers for ${t}`);return e}function gb(n,t){return typeof n=="number"?n:gp(n,t)}const Id={RENDER_ORDER:"renderOrder"};class pp extends Ia{constructor(t){t=t||{};const e=Object.assign({},t);delete e.style,delete e.renderBuffer,delete e.updateWhileAnimating,delete e.updateWhileInteracting,super(e),this.declutter_=t.declutter?String(t.declutter):void 0,this.renderBuffer_=t.renderBuffer!==void 0?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=t.updateWhileAnimating!==void 0?t.updateWhileAnimating:!1,this.updateWhileInteracting_=t.updateWhileInteracting!==void 0?t.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(t){return super.getFeatures(t)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(Id.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(t,e){const i=this.getDeclutter();i in t.declutter||(t.declutter[i]=new Xf(9)),this.getRenderer().renderDeclutter(t,e)}setRenderOrder(t){this.set(Id.RENDER_ORDER,t)}setStyle(t){this.style_=t===void 0?hp:t;const e=pb(t);this.styleFunction_=t===null?void 0:Qv(e),this.changed()}setDeclutter(t){this.declutter_=t?String(t):void 0,this.changed()}}function pb(n){if(n===void 0)return hp;if(!n)return null;if(typeof n=="function"||n instanceof wi)return n;if(!Array.isArray(n))return xd([n]);if(n.length===0)return[];const t=n.length,e=n[0];if(e instanceof wi){const r=new Array(t);for(let s=0;s<t;++s){const o=n[s];if(!(o instanceof wi))throw new Error("Expected a list of style instances");r[s]=o}return r}if("style"in e){const r=new Array(t);for(let s=0;s<t;++s){const o=n[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");r[s]=o}return nb(r)}return xd(n)}class mp extends yn{constructor(t,e,i,r){super(t),this.inversePixelTransform=e,this.frameState=i,this.context=r}}class mb extends pa{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){W()}calculateMatrices2D(t){const e=t.viewState,i=t.coordinateToPixelTransform,r=t.pixelToCoordinateTransform;gn(i,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),Eg(r,i)}forEachFeatureAtCoordinate(t,e,i,r,s,o,a,l){let c;const h=e.viewState;function u(T,I,L,w){return s.call(o,I,T?L:null,w)}const d=h.projection,f=pg(t.slice(),d),g=[[0,0]];if(d.canWrapX()&&r){const T=d.getExtent(),I=at(T);g.push([-I,0],[I,0])}const y=e.layerStatesArray,_=y.length,b=[],S=[];for(let T=0;T<g.length;T++)for(let I=_-1;I>=0;--I){const L=y[I],w=L.layer;if(w.hasRenderer()&&Dh(L,h)&&a.call(l,w)){const p=w.getRenderer(),m=w.getSource();if(p&&m){const E=m.getWrapX()?f:t,x=u.bind(null,L.managed);S[0]=E[0]+g[T][0],S[1]=E[1]+g[T][1],c=p.forEachFeatureAtCoordinate(S,e,i,x,b)}if(c)return c}}if(b.length===0)return;const R=1/b.length;return b.forEach((T,I)=>T.distanceSq+=I*R),b.sort((T,I)=>T.distanceSq-I.distanceSq),b.some(T=>c=T.callback(T.feature,T.layer,T.geometry)),c}hasFeatureAtCoordinate(t,e,i,r,s,o){return this.forEachFeatureAtCoordinate(t,e,i,r,fs,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(t){W()}scheduleExpireIconCache(t){be.canExpireCache()&&t.postRenderFunctions.push(_b)}}function _b(n,t){be.expire()}class yb extends mb{constructor(t){super(t),this.fontChangeListenerKey_=et(Yi,hr.PROPERTYCHANGE,t.redrawText,t),this.element_=ce?Yg():document.createElement("div");const e=this.element_.style;e.position="absolute",e.width="100%",e.height="100%",e.zIndex="0",this.element_.className=Sa+" ol-layers";const i=t.getViewport();i&&i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(t,e){const i=this.getMap();if(i.hasListener(t)){const r=new mp(t,void 0,e);i.dispatchEvent(r)}}disposeInternal(){ut(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(t){if(!t){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(t),this.dispatchRenderEvent(ve.PRECOMPOSE,t);const e=t.layerStatesArray.sort((c,h)=>c.zIndex-h.zIndex);e.some(c=>c.layer instanceof pp&&c.layer.getDeclutter())&&(t.declutter={});const r=t.viewState;this.children_.length=0;const s=[];let o=null;for(let c=0,h=e.length;c<h;++c){const u=e[c];t.layerIndex=c;const d=u.layer,f=d.getSourceState();if(!Dh(u,r)||f!="ready"&&f!="undefined"){d.unrender();continue}const g=d.render(t,o);g&&(g!==o&&(this.children_.push(g),o=g),s.push(u))}this.declutter(t,s),D0(this.element_,this.children_);const l=this.getMap().getTargetElement();if(Fn(l)){const c=l.getContext("2d");for(const h of this.children_){const u=h.firstElementChild||h,d=h.style.backgroundColor;if(d&&(!Fn(u)||u.width>0)&&(c.fillStyle=d,c.fillRect(0,0,l.width,l.height)),Fn(u)&&u.width>0){const f=h.style.opacity||u.style.opacity;c.globalAlpha=f===""?1:Number(f);const g=u.style.transform;if(g)c.setTransform(...ic(g));else{const y=parseFloat(u.style.width)/u.width,_=parseFloat(u.style.height)/u.height;c.setTransform(y,0,0,_,0,0)}c.drawImage(u,0,0)}}c.globalAlpha=1,c.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(ve.POSTCOMPOSE,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}declutter(t,e){if(t.declutter){for(let i=e.length-1;i>=0;--i){const r=e[i],s=r.layer;s.getDeclutter()&&s.renderDeclutter(t,r)}e.forEach(i=>i.layer.renderDeferred(t))}}}function _p(n){if(n instanceof Ia){n.setMapInternal(null);return}n instanceof Pr&&n.getLayers().forEach(_p)}function yp(n,t){if(n instanceof Ia){n.setMapInternal(t);return}if(n instanceof Pr){const e=n.getLayers().getArray();for(let i=0,r=e.length;i<r;++i)yp(e[i],t)}}let wb=class extends Ke{constructor(t){super(),t=t||{},this.on,this.once,this.un;const e=vb(t);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=t.maxTilesLoading!==void 0?t.maxTilesLoading:16,this.pixelRatio_=t.pixelRatio!==void 0?t.pixelRatio:p0,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Pe(),this.pixelToCoordinateTransform_=Pe(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,ce||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=t.moveTolerance,this.keyboardEventTarget_=e.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,ce||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=e.controls||(ce?new we:$0()),this.interactions=e.interactions||(ce?new we:ov({onFocusOnly:!0})),this.overlays_=e.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new y0(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(zt.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(zt.VIEW,this.handleViewChanged_),this.addChangeListener(zt.SIZE,this.handleSizeChanged_),this.addChangeListener(zt.TARGET,this.handleTargetChanged_),this.setProperties(e.values);const i=this;t.view&&!(t.view instanceof ze)&&t.view.then(function(r){i.setView(new ze(r))}),this.controls.addEventListener(Yt.ADD,r=>{r.element.setMap(this)}),this.controls.addEventListener(Yt.REMOVE,r=>{r.element.setMap(null)}),this.interactions.addEventListener(Yt.ADD,r=>{r.element.setMap(this)}),this.interactions.addEventListener(Yt.REMOVE,r=>{r.element.setMap(null)}),this.overlays_.addEventListener(Yt.ADD,r=>{this.addOverlayInternal_(r.element)}),this.overlays_.addEventListener(Yt.REMOVE,r=>{const s=r.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],r.element.setMap(null)}),this.controls.forEach(r=>{r.setMap(this)}),this.interactions.forEach(r=>{r.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(t){this.getControls().push(t)}addInteraction(t){this.getInteractions().push(t)}addLayer(t){this.getLayerGroup().getLayers().push(t)}handleLayerAdd_(t){yp(t.layer,this)}addOverlay(t){this.getOverlays().push(t)}addOverlayInternal_(t){const e=t.getId();e!==void 0&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_?.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(t,e,i){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(t);i=i!==void 0?i:{};const s=i.hitTolerance!==void 0?i.hitTolerance:0,o=i.layerFilter!==void 0?i.layerFilter:fs,a=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,s,a,e,null,o,null)}getFeaturesAtPixel(t,e){const i=[];return this.forEachFeatureAtPixel(t,function(r){i.push(r)},e),i}getAllLayers(){const t=[];function e(i){i.forEach(function(r){r instanceof Pr?e(r.getLayers()):t.push(r)})}return e(this.getLayers()),t}hasFeatureAtPixel(t,e){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(t);e=e!==void 0?e:{};const r=e.layerFilter!==void 0?e.layerFilter:fs,s=e.hitTolerance!==void 0?e.hitTolerance:0,o=e.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,s,o,r,null)}getEventCoordinate(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}getEventCoordinateInternal(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}getEventPixel(t){const i=this.viewport_.getBoundingClientRect(),r=this.getSize(),s=i.width/r[0],o=i.height/r[1],a="changedTouches"in t?t.changedTouches[0]:t;return[(a.clientX-i.left)/s,(a.clientY-i.top)/o]}getTarget(){return this.get(zt.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(t){return nc(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}getCoordinateFromPixelInternal(t){const e=this.frameState_;return e?Ot(e.pixelToCoordinateTransform,t.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(t){const e=this.overlayIdIndex_[t.toString()];return e!==void 0?e:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(zt.LAYERGROUP)}setLayers(t){const e=this.getLayerGroup();if(t instanceof we){e.setLayers(t);return}const i=e.getLayers();i.clear(),i.extend(t)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,i=t.length;e<i;++e){const r=t[e];if(!r.visible)continue;const s=r.layer.getRenderer();if(s&&!s.ready)return!0;const o=r.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(t){const e=rn(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}getPixelFromCoordinateInternal(t){const e=this.frameState_;return e?Ot(e.coordinateToPixelTransform,t.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(zt.SIZE)}getView(){return this.get(zt.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const t=this.getTargetElement();return t?t.ownerDocument:document}getTilePriority(t,e,i,r){return w0(this.frameState_,t,e,i,r)}handleBrowserEvent(t,e){e=e||t.type;const i=new In(e,this,t);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(t){if(!this.frameState_)return;const e=t.originalEvent,i=e.type;if(i===uc.POINTERDOWN||i===H.WHEEL||i===H.KEYDOWN){const r=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o=e.target,a=s instanceof ShadowRoot?s.host===o?s.host.ownerDocument:s:s===r?r.documentElement:s;if(this.overlayContainerStopEvent_.contains(o)||!a.contains(o))return}if(t.frameState=this.frameState_,this.dispatchEvent(t)!==!1){const r=this.getInteractions().getArray().slice();for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(t)||t.propagationStopped)break}}}handlePostRender(){const t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){let r=this.maxTilesLoading_,s=r;if(t){const o=t.viewHints;if(o[Bt.ANIMATING]||o[Bt.INTERACTING]){const a=Date.now()-t.time>8;r=a?0:8,s=a?0:2}}e.getTilesLoading()<r&&(e.reprioritize(),e.loadMoreTiles(r,s))}t&&this.renderer_&&!t.animate&&(this.renderComplete_?(this.hasListener(ve.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(ve.RENDERCOMPLETE,t),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Ki(Rn.LOADEND,this,t)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Ki(Rn.LOADSTART,this,t))));const i=this.postRenderFunctions_;if(t)for(let r=0,s=i.length;r<s;++r)i[r](this,t);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let i=0,r=this.targetChangeHandlerKeys_.length;i<r;++i)ut(this.targetChangeHandlerKeys_[i]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(H.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(H.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!Fn(this.targetElement_)){this.resizeObserver_?.unobserve(this.targetElement_);const i=this.targetElement_.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.unobserve(i.host),this.setSize(void 0)}const t=this.getTarget(),e=typeof t=="string"?document.getElementById(t):t;if(this.targetElement_=e,!e)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(Fn(e)||e.appendChild(this.viewport_),this.renderer_||(this.renderer_=new yb(this)),!Fn(e)){this.mapBrowserEventHandler_=new m0(this,this.moveTolerance_);for(const r in _t)this.mapBrowserEventHandler_.addEventListener(_t[r],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(H.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(H.WHEEL,this.boundHandleBrowserEvent_,Xg?{passive:!1}:!1);let i;if(this.keyboardEventTarget_)i=this.keyboardEventTarget_;else{const r=e.getRootNode();i=r instanceof ShadowRoot?r.host:e}if(this.targetChangeHandlerKeys_=[et(i,H.KEYDOWN,this.handleBrowserEvent,this),et(i,H.KEYPRESS,this.handleBrowserEvent,this)],e instanceof HTMLElement){const r=e.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.observe(r.host),this.resizeObserver_?.observe(e)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(ut(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(ut(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const t=this.getView();t&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=et(t,hr.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=et(t,H.CHANGE,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(ut),this.layerGroupPropertyListenerKeys_=null);const t=this.getLayerGroup();t&&(this.handleLayerAdd_(new Ln("addlayer",t)),this.layerGroupPropertyListenerKeys_=[et(t,hr.PROPERTYCHANGE,this.render,this),et(t,H.CHANGE,this.render,this),et(t,"addlayer",this.handleLayerAdd_,this),et(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const t=this.frameState_.layerStatesArray;for(let e=0,i=t.length;e<i;++e){const r=t[e].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(t){return this.getControls().remove(t)}removeInteraction(t){return this.getInteractions().remove(t)}removeLayer(t){return this.getLayerGroup().getLayers().remove(t)}handleLayerRemove_(t){_p(t.layer)}removeOverlay(t){return this.getOverlays().remove(t)}renderFrame_(t){const e=this.getSize(),i=this.getView(),r=this.frameState_;let s=null;if(e!==void 0&&pd(e)&&i&&i.isDef()){const o=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=i.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:Yl(a.center,a.resolution,a.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{},mapId:nt(this),renderTargets:{}},a.nextCenter&&a.nextResolution){const l=isNaN(a.nextRotation)?a.rotation:a.nextRotation;s.nextExtent=Yl(a.nextCenter,a.nextResolution,l,e)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),r&&(!this.previousExtent_||!Fs(this.previousExtent_)&&!ds(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Ki(Rn.MOVESTART,this,r)),this.previousExtent_=Ir(this.previousExtent_)),this.previousExtent_&&!s.viewHints[Bt.ANIMATING]&&!s.viewHints[Bt.INTERACTING]&&!ds(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Ki(Rn.MOVEEND,this,s)),sg(s.extent,this.previousExtent_))),this.dispatchEvent(new Ki(Rn.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(Rn.LOADSTART)||this.hasListener(Rn.LOADEND)||this.hasListener(ve.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(t){const e=this.getLayerGroup();e&&this.handleLayerRemove_(new Ln("removelayer",e)),this.set(zt.LAYERGROUP,t)}setSize(t){this.set(zt.SIZE,t)}setTarget(t){this.set(zt.TARGET,t)}setView(t){if(!t||t instanceof ze){this.set(zt.VIEW,t);return}this.set(zt.VIEW,new ze);const e=this;t.then(function(i){e.setView(new ze(i))})}updateSize(){const t=this.getTargetElement();let e;if(t){let r,s;if(Fn(t))r=t.width,s=t.height;else{const o=getComputedStyle(t);r=t.offsetWidth-parseFloat(o.borderLeftWidth)-parseFloat(o.paddingLeft)-parseFloat(o.paddingRight)-parseFloat(o.borderRightWidth),s=t.offsetHeight-parseFloat(o.borderTopWidth)-parseFloat(o.paddingTop)-parseFloat(o.paddingBottom)-parseFloat(o.borderBottomWidth)}!isNaN(r)&&!isNaN(s)&&(e=[Math.max(0,r),Math.max(0,s)],!pd(e)&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&gg("No map visible because the map container's width or height are 0."))}const i=this.getSize();e&&(!i||!Qn(e,i))&&(this.setSize(e),this.updateViewportSize_(e))}updateViewportSize_(t){const e=this.getView();e&&e.setViewportSize(t)}};function vb(n){let t=null;n.keyboardEventTarget!==void 0&&(t=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);const e={},i=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new Pr({layers:n.layers});e[zt.LAYERGROUP]=i,e[zt.TARGET]=n.target,e[zt.VIEW]=n.view instanceof ze?n.view:new ze;let r;n.controls!==void 0&&(Array.isArray(n.controls)?r=new we(n.controls.slice()):(rt(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),r=n.controls));let s;n.interactions!==void 0&&(Array.isArray(n.interactions)?s=new we(n.interactions.slice()):(rt(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=n.interactions));let o;return n.overlays!==void 0?Array.isArray(n.overlays)?o=new we(n.overlays.slice()):(rt(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=n.overlays):o=new we,{controls:r,interactions:s,keyboardEventTarget:t,overlays:o,values:e}}class Gh extends _a{constructor(t,e,i){super(),i=i||{},this.tileCoord=t,this.state=e,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(H.CHANGE)}release(){this.setState(z.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(this.state!==z.EMPTY){if(this.state!==z.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}}load(){W()}getAlpha(t,e){if(!this.transition_)return 1;let i=this.transitionStarts_[t];if(!i)i=e,this.transitionStarts_[t]=i;else if(i===-1)return 1;const r=e-i+1e3/60;return r>=this.transition_?1:Kg(r/this.transition_)}inTransition(t){return this.transition_?this.transitionStarts_[t]!==-1:!1}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function yc(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}const bb=new Error("disposed"),Eb=[256,256];class Rd extends Gh{constructor(t){const e=z.IDLE;super(t.tileCoord,e,{transition:t.transition,interpolate:t.interpolate}),this.loader_=t.loader,this.data_=null,this.error_=null,this.size_=t.size||null,this.controller_=t.controller||null}getSize(){if(this.size_)return this.size_;const t=yc(this.data_);return t?[t.width,t.height]:Eb}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==z.IDLE&&this.state!==z.ERROR)return;this.state=z.LOADING,this.changed();const t=this;this.loader_().then(function(e){t.data_=e,t.state=z.LOADED,t.changed()}).catch(function(e){t.error_=e,t.state=z.ERROR,t.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(bb),this.controller_=null),super.disposeInternal()}}class wp extends Gh{constructor(t,e,i,r,s,o){super(t,e,o),this.crossOrigin_=r,this.src_=i,this.key=i,this.image_,ce?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,r!==null&&(this.image_.crossOrigin=r)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(t){this.image_=t,this.state=z.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=z.ERROR,this.unlistenImage_(),this.image_=xb(),this.changed()}handleImageLoad_(){if(ce)this.state=z.LOADED;else{const t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=z.LOADED:this.state=z.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==z.ERROR&&(this.state=z.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==z.IDLE&&(this.state=z.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=Gv(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function xb(){const n=Rt(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}class Bh{constructor(t,e,i,r){this.minX=t,this.maxX=e,this.minY=i,this.maxY=r}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}function Wi(n,t,e,i,r){return r!==void 0?(r.minX=n,r.maxX=t,r.minY=e,r.maxY=i,r):new Bh(n,t,e,i)}let Rl;const or=[];function Ad(n,t,e,i,r){n.beginPath(),n.moveTo(0,0),n.lineTo(t,e),n.lineTo(i,r),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(t,i)+1,Math.max(e,r)),n.restore()}function Al(n,t){return Math.abs(n[t*4]-210)>2||Math.abs(n[t*4+3]-.75*255)>2}function Cb(){if(Rl===void 0){const n=Rt(6,6,or);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",Ad(n,4,5,4,0),Ad(n,4,5,0,5);const t=n.getImageData(0,0,3,3).data;Rl=Al(t,0)||Al(t,4)||Al(t,8),Ta(n),or.push(n.canvas)}return Rl}function Pd(n,t,e,i){const r=va(e,t,n);let s=ju(t,i,e);const o=t.getMetersPerUnit();o!==void 0&&(s*=o);const a=n.getMetersPerUnit();a!==void 0&&(s/=a);const l=n.getExtent();if(!l||cr(l,r)){const c=ju(n,s,r)/s;isFinite(c)&&c>0&&(s/=c)}return s}function Sb(n,t,e,i){const r=fn(e);let s=Pd(n,t,r,i);return(!isFinite(s)||s<=0)&&cg(e,function(o){return s=Pd(n,t,o,i),isFinite(s)&&s>0}),s}function Tb(n,t,e,i,r,s,o,a,l,c,h,u,d,f){const g=Rt(Math.round(e*n),Math.round(e*t),or);if(u||(g.imageSmoothingEnabled=!1),l.length===0)return g.canvas;g.scale(e,e);function y(I){return Math.round(I*e)/e}g.globalCompositeOperation="lighter";const _=Ce();l.forEach(function(I,L,w){ag(_,I.extent)});let b;const S=e/i,R=(u?1:1+Math.pow(2,-24))/S;b=Rt(Math.round(at(_)*S),Math.round(Ht(_)*S),or),u||(b.imageSmoothingEnabled=!1),l.forEach(function(I,L,w){if(I.image.width>0&&I.image.height>0){if(I.clipExtent){b.save();const C=(I.clipExtent[0]-_[0])*S,v=-(I.clipExtent[3]-_[3])*S,M=at(I.clipExtent)*S,F=Ht(I.clipExtent)*S;b.rect(u?C:Math.round(C),u?v:Math.round(v),u?M:Math.round(C+M)-Math.round(C),u?F:Math.round(v+F)-Math.round(v)),b.clip()}const p=(I.extent[0]-_[0])*S,m=-(I.extent[3]-_[3])*S,E=at(I.extent)*S,x=Ht(I.extent)*S;b.drawImage(I.image,c,c,I.image.width-2*c,I.image.height-2*c,u?p:Math.round(p),u?m:Math.round(m),u?E:Math.round(p+E)-Math.round(p),u?x:Math.round(m+x)-Math.round(m)),I.clipExtent&&b.restore()}});const T=Pi(o);return a.getTriangles().forEach(function(I,L,w){const p=I.source,m=I.target;let E=p[0][0],x=p[0][1],C=p[1][0],v=p[1][1],M=p[2][0],F=p[2][1];const $=y((m[0][0]-T[0])/s),D=y(-(m[0][1]-T[1])/s),N=y((m[1][0]-T[0])/s),B=y(-(m[1][1]-T[1])/s),Z=y((m[2][0]-T[0])/s),lt=y(-(m[2][1]-T[1])/s),k=E,Nt=x;E=0,x=0,C-=k,v-=Nt,M-=k,F-=Nt;const Ut=[[C,v,0,0,N-$],[M,F,0,0,Z-$],[0,0,C,v,B-D],[0,0,M,F,lt-D]],wt=oy(Ut);if(!wt)return;if(g.save(),g.beginPath(),Cb()||!u){g.moveTo(N,B);const $t=4,Fe=$-N,Ie=D-B;for(let se=0;se<$t;se++)g.lineTo(N+y((se+1)*Fe/$t),B+y(se*Ie/($t-1))),se!=$t-1&&g.lineTo(N+y((se+1)*Fe/$t),B+y((se+1)*Ie/($t-1)));g.lineTo(Z,lt)}else g.moveTo(N,B),g.lineTo($,D),g.lineTo(Z,lt);g.clip(),g.transform(wt[0],wt[2],wt[1],wt[3],$,D),g.translate(_[0]-k,_[3]-Nt);let re;if(b)re=b.canvas,g.scale(R,-R);else{const $t=l[0],Fe=$t.extent;re=$t.image,g.scale(at(Fe)/re.width,-Ht(Fe)/re.height)}g.drawImage(re,0,0),g.restore()}),b&&(Ta(b),or.push(b.canvas)),h&&(g.save(),g.globalCompositeOperation="source-over",g.strokeStyle="black",g.lineWidth=1,a.getTriangles().forEach(function(I,L,w){const p=I.target,m=(p[0][0]-T[0])/s,E=-(p[0][1]-T[1])/s,x=(p[1][0]-T[0])/s,C=-(p[1][1]-T[1])/s,v=(p[2][0]-T[0])/s,M=-(p[2][1]-T[1])/s;g.beginPath(),g.moveTo(x,C),g.lineTo(m,E),g.lineTo(v,M),g.closePath(),g.stroke()}),g.restore()),g.canvas}const Ib=10,Ld=.25;class Rb{constructor(t,e,i,r,s,o,a){this.sourceProj_=t,this.targetProj_=e;let l={};const c=a?Gy(R=>Ot(a,va(R,this.targetProj_,this.sourceProj_))):dr(this.targetProj_,this.sourceProj_);this.transformInv_=function(R){const T=R[0]+"/"+R[1];return l[T]||(l[T]=c(R)),l[T]},this.maxSourceExtent_=r,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&at(r)>=at(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?at(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?at(this.targetProj_.getExtent()):null;const h=Pi(i),u=fa(i),d=da(i),f=ua(i),g=this.transformInv_(h),y=this.transformInv_(u),_=this.transformInv_(d),b=this.transformInv_(f),S=Ib+(o?Math.max(0,Math.ceil(Math.log2(Kl(i)/(o*o*256*256)))):0);if(this.addQuad_(h,u,d,f,g,y,_,b,S),this.wrapsXInSource_){let R=1/0;this.triangles_.forEach(function(T,I,L){R=Math.min(R,T.source[0][0],T.source[1][0],T.source[2][0])}),this.triangles_.forEach(T=>{if(Math.max(T.source[0][0],T.source[1][0],T.source[2][0])-R>this.sourceWorldWidth_/2){const I=[[T.source[0][0],T.source[0][1]],[T.source[1][0],T.source[1][1]],[T.source[2][0],T.source[2][1]]];I[0][0]-R>this.sourceWorldWidth_/2&&(I[0][0]-=this.sourceWorldWidth_),I[1][0]-R>this.sourceWorldWidth_/2&&(I[1][0]-=this.sourceWorldWidth_),I[2][0]-R>this.sourceWorldWidth_/2&&(I[2][0]-=this.sourceWorldWidth_);const L=Math.min(I[0][0],I[1][0],I[2][0]);Math.max(I[0][0],I[1][0],I[2][0])-L<this.sourceWorldWidth_/2&&(T.source=I)}})}l={}}addTriangle_(t,e,i,r,s,o){this.triangles_.push({source:[r,s,o],target:[t,e,i]})}addQuad_(t,e,i,r,s,o,a,l,c){const h=Du([s,o,a,l]),u=this.sourceWorldWidth_?at(h)/this.sourceWorldWidth_:null,d=this.sourceWorldWidth_,f=this.sourceProj_.canWrapX()&&u>.5&&u<1;let g=!1;if(c>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const _=Du([t,e,i,r]);g=at(_)/this.targetWorldWidth_>Ld||g}!f&&this.sourceProj_.isGlobal()&&u&&(g=u>Ld||g)}if(!g&&this.maxSourceExtent_&&isFinite(h[0])&&isFinite(h[1])&&isFinite(h[2])&&isFinite(h[3])&&!Qt(h,this.maxSourceExtent_))return;let y=0;if(!g&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(l[0])||!isFinite(l[1]))){if(c>0)g=!0;else if(y=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),y!=1&&y!=2&&y!=4&&y!=8)return}if(c>0){if(!g){const _=[(t[0]+i[0])/2,(t[1]+i[1])/2],b=this.transformInv_(_);let S;f?S=(nr(s[0],d)+nr(a[0],d))/2-nr(b[0],d):S=(s[0]+a[0])/2-b[0];const R=(s[1]+a[1])/2-b[1];g=S*S+R*R>this.errorThresholdSquared_}if(g){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){const _=[(e[0]+i[0])/2,(e[1]+i[1])/2],b=this.transformInv_(_),S=[(r[0]+t[0])/2,(r[1]+t[1])/2],R=this.transformInv_(S);this.addQuad_(t,e,_,S,s,o,b,R,c-1),this.addQuad_(S,_,i,r,R,b,a,l,c-1)}else{const _=[(t[0]+e[0])/2,(t[1]+e[1])/2],b=this.transformInv_(_),S=[(i[0]+r[0])/2,(i[1]+r[1])/2],R=this.transformInv_(S);this.addQuad_(t,_,S,r,s,b,R,l,c-1),this.addQuad_(_,e,i,S,b,o,a,R,c-1)}return}}if(f){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(y&11)==0&&this.addTriangle_(t,i,r,s,a,l),(y&14)==0&&this.addTriangle_(t,i,e,s,a,o),y&&((y&13)==0&&this.addTriangle_(e,r,t,o,l,s),(y&7)==0&&this.addTriangle_(e,r,i,o,l,a))}calculateSourceExtent(){const t=Ce();return this.triangles_.forEach(function(e,i,r){const s=e.source;is(t,s[0]),is(t,s[1]),is(t,s[2])}),t}getTriangles(){return this.triangles_}}const Ab=.5;class vp extends Gh{constructor(t,e,i,r,s,o,a,l,c,h,u,d){super(s,z.IDLE,d),this.renderEdges_=u!==void 0?u:!1,this.pixelRatio_=a,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=r,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=t.canWrapX()?t.getExtent():void 0;const f=r.getTileCoordExtent(this.wrappedTileCoord_),g=this.targetTileGrid_.getExtent();let y=this.sourceTileGrid_.getExtent();const _=g?_i(f,g):f;if(Kl(_)===0){this.state=z.EMPTY;return}const b=t.getExtent();b&&(y?y=_i(y,b):y=b);const S=r.getResolution(this.wrappedTileCoord_[0]),R=Sb(t,i,_,S);if(!isFinite(R)||R<=0){this.state=z.EMPTY;return}const T=h!==void 0?h:Ab;if(this.triangulation_=new Rb(t,i,_,y,R*T,S),this.triangulation_.getTriangles().length===0){this.state=z.EMPTY;return}this.sourceZ_=e.getZForResolution(R);let I=this.triangulation_.calculateSourceExtent();if(y&&(t.canWrapX()?(I[1]=pt(I[1],y[1],y[3]),I[3]=pt(I[3],y[1],y[3])):I=_i(I,y)),!Kl(I))this.state=z.EMPTY;else{let L=0,w=0;t.canWrapX()&&(L=at(b),w=Math.floor((I[0]-b[0])/L)),dg(I.slice(),t,!0).forEach(m=>{const E=e.getTileRangeForExtentAndZ(m,this.sourceZ_);for(let x=E.minX;x<=E.maxX;x++)for(let C=E.minY;C<=E.maxY;C++){const v=c(this.sourceZ_,x,C,a);if(v){const M=w*L;this.sourceTiles_.push({tile:v,offset:M})}}++w}),this.sourceTiles_.length===0&&(this.state=z.EMPTY)}}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach(e=>{const i=e.tile;if(i&&i.getState()==z.LOADED){const r=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);r[0]+=e.offset,r[2]+=e.offset;const s=this.clipExtent_?.slice();s&&(s[0]+=e.offset,s[2]+=e.offset),t.push({extent:r,clipExtent:s,image:i.getImage()})}}),this.sourceTiles_.length=0,t.length===0)this.state=z.ERROR;else{const e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),r=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(e),a=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=Tb(r,s,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,l,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=z.LOADED}this.changed()}load(){if(this.state==z.IDLE){this.state=z.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:e})=>{const i=e.getState();if(i==z.IDLE||i==z.LOADING){t++;const r=et(e,H.CHANGE,s=>{const o=e.getState();(o==z.LOADED||o==z.ERROR||o==z.EMPTY)&&(ut(r),t--,t===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(r)}}),t===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:e},i,r){e.getState()==z.IDLE&&e.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(ut),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Ta(this.canvas_.getContext("2d")),or.push(this.canvas_),this.canvas_=null),super.release()}}class Od{constructor(t){this.highWaterMark=t!==void 0?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const t=this.pop();t instanceof pa&&t.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){const i=this.entries_[t];return rt(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(t){const e=this.entries_[t];return rt(e!==void 0,"Tried to get a value for a key that does not exist in the cache"),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){const t=new Array(this.count_);let e=0,i;for(i=this.newest_;i;i=i.older)t[e++]=i.key_;return t}getValues(){const t=new Array(this.count_);let e=0,i;for(i=this.newest_;i;i=i.older)t[e++]=i.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){return this.entries_[t]?.value_}pop(){const t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){rt(!(t in this.entries_),"Tried to set a value for a key that is used already");const i={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_}setSize(t){this.highWaterMark=t}}function Vo(n,t,e,i){return i!==void 0?(i[0]=n,i[1]=t,i[2]=e,i):[n,t,e]}function Pb(n,t,e){return n+"/"+t+"/"+e}function bo(n,t,e,i,r){return`${nt(n)},${t},${Pb(e,i,r)}`}function Lb(n){return Ob(n[0],n[1],n[2])}function Ob(n,t,e){return(t<<n)+e}function kb(n,t){const e=n[0],i=n[1],r=n[2];if(t.getMinZoom()>e||e>t.getMaxZoom())return!1;const s=t.getFullTileRange(e);return s?s.containsXY(i,r):!0}class bp{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(Do(),{get:(t,e)=>{if(typeof Do()[e]=="function")return this.push_(e),this.pushMethodArgs_},set:(t,e,i)=>(this.push_(e,i),!0)})}push_(...t){const e=this.instructions_,i=this.zIndex+this.offset_;e[i]||(e[i]=[]),e[i].push(...t)}pushMethodArgs_=(...t)=>(this.push_(t),this);pushFunction(t){this.push_(t)}getContext(){return this.context_}draw(t){this.instructions_.forEach(e=>{for(let i=0,r=e.length;i<r;++i){const s=e[i];if(typeof s=="function"){s(t);continue}const o=e[++i];if(typeof t[s]=="function")t[s](...o);else{if(typeof o=="function"){t[s]=o(t);continue}t[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const Db=5;class Mb extends $s{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.staleKeys_=new Array,this.maxStaleKeys=Db}getStaleKeys(){return this.staleKeys_}prependStaleKey(t){this.staleKeys_.unshift(t),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(t){return W()}getData(t){return null}prepareFrame(t){return W()}renderFrame(t,e){return W()}forEachFeatureAtCoordinate(t,e,i,r,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){const e=t.target;(e.getState()===K.LOADED||e.getState()===K.ERROR)&&this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return e!=K.LOADED&&e!=K.ERROR&&t.addEventListener(H.CHANGE,this.boundHandleImageChange_),e==K.IDLE&&(t.load(),e=t.getState()),e==K.LOADED}renderIfReadyAndVisible(){const t=this.getLayer();t&&t.getVisible()&&t.getSourceState()==="ready"&&t.changed()}renderDeferred(t){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const kd=[];let Zi=null;function Fb(){Zi=Rt(1,1,void 0,{willReadFrequently:!0})}class Ep extends Mb{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=Pe(),this.pixelTransform=Pe(),this.inversePixelTransform=Pe(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(t,e,i){Zi||Fb(),Zi.clearRect(0,0,1,1);let r;try{Zi.drawImage(t,e,i,1,1,0,0,1,1),r=Zi.getImageData(0,0,1,1).data}catch{return Zi=null,null}return r}getBackground(t){let i=this.getLayer().getBackground();return typeof i=="function"&&(i=i(t.viewState.resolution)),i||void 0}useContainer(t,e,i){const r=this.getLayer().getClassName();let s,o;if(t&&t.className===r&&(!i||t&&t.style.backgroundColor&&Qn(gr(t.style.backgroundColor),gr(i)))){const a=t.firstElementChild;Fn(a)&&(o=a.getContext("2d"))}if(o&&Yy(o.canvas.style.transform,e)?(this.container=t,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=ce?Yg():document.createElement("div"),s.className=r;let a=s.style;a.position="absolute",a.width="100%",a.height="100%",o=Rt();const l=o.canvas;s.appendChild(l),a=l.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(t,e,i){const r=Pi(i),s=fa(i),o=da(i),a=ua(i);Ot(e.coordinateToPixelTransform,r),Ot(e.coordinateToPixelTransform,s),Ot(e.coordinateToPixelTransform,o),Ot(e.coordinateToPixelTransform,a);const l=this.inversePixelTransform;Ot(l,r),Ot(l,s),Ot(l,o),Ot(l,a),t.save(),t.beginPath(),t.moveTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.clip()}prepareContainer(t,e){const i=t.extent,r=t.viewState.resolution,s=t.viewState.rotation,o=t.pixelRatio,a=Math.round(at(i)/r*o),l=Math.round(Ht(i)/r*o);gn(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/o,1/o,s,-a/2,-l/2),Eg(this.inversePixelTransform,this.pixelTransform);const c=Ky(this.pixelTransform);if(this.useContainer(e,c,this.getBackground(t)),!this.containerReused){const h=this.context.canvas;h.width!=a||h.height!=l?(h.width=a,h.height=l):this.context.clearRect(0,0,a,l),c!==h.style.transform&&(h.style.transform=c)}}dispatchRenderEvent_(t,e,i){const r=this.getLayer();if(r.hasListener(t)){const s=new mp(t,this.inversePixelTransform,i,e);r.dispatchEvent(s)}}preRender(t,e){this.frameState=e,!e.declutter&&this.dispatchRenderEvent_(ve.PRERENDER,t,e)}postRender(t,e){e.declutter||this.dispatchRenderEvent_(ve.POSTRENDER,t,e)}renderDeferredInternal(t){}getRenderContext(t){return t.declutter&&!this.deferredContext_&&(this.deferredContext_=new bp),t.declutter?this.deferredContext_.getContext():this.context}renderDeferred(t){t.declutter&&(this.dispatchRenderEvent_(ve.PRERENDER,this.context,t),t.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(t),this.dispatchRenderEvent_(ve.POSTRENDER,this.context,t))}getRenderTransform(t,e,i,r,s,o,a){const l=s/2,c=o/2,h=r/e,u=-h,d=-t[0]+a,f=-t[1];return gn(this.tempTransform,l,c,h,u,-i,d,f)}disposeInternal(){delete this.frameState,super.disposeInternal()}}function Pl(n,t,e){if(!(e in n))return n[e]=new Set([t]),!0;const i=n[e],r=i.has(t);return r||i.add(t),!r}function Nb(n,t,e){const i=n[e];return i?i.delete(t):!1}function Dd(n,t){const e=n.layerStatesArray[n.layerIndex];e.extent&&(t=_i(t,Dn(e.extent,n.viewState.projection)));const i=e.layer.getRenderSource();if(!i.getWrapX()){const r=i.getTileGridForProjection(n.viewState.projection).getExtent();r&&(t=_i(t,r))}return t}class $b extends Ep{constructor(t,e){super(t),e=e||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=Ce(),this.tempTileRange_=new Bh(0,0,0,0),this.tempTileCoord_=Vo(0,0,0);const i=e.cacheSize!==void 0?e.cacheSize:512;this.tileCache_=new Od(i),this.sourceTileCache_=null,this.maxStaleKeys=i*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new Od(512)),this.sourceTileCache_}getOrCreateTile(t,e,i,r){const s=this.tileCache_,a=this.getLayer().getSource(),l=bo(a,a.getKey(),t,e,i);let c;if(s.containsKey(l))c=s.get(l);else{const h=r.viewState.projection,u=a.getProjection();if(c=a.getTile(t,e,i,r.pixelRatio,h,!u||rs(u,h)?void 0:this.getSourceTileCache()),!c)return null;s.set(l,c)}return c}getTile(t,e,i,r){const s=this.getOrCreateTile(t,e,i,r);return s||null}getData(t){const e=this.frameState;if(!e)return null;const i=this.getLayer(),r=Ot(e.pixelToCoordinateTransform,t.slice()),s=i.getExtent();if(s&&!cr(s,r))return null;const o=e.viewState,a=i.getRenderSource(),l=a.getTileGridForProjection(o.projection),c=a.getTilePixelRatio(e.pixelRatio);for(let h=l.getZForResolution(o.resolution);h>=l.getMinZoom();--h){const u=l.getTileCoordForCoordAndZ(r,h),d=this.getTile(h,u[1],u[2],e);if(!d||d.getState()!==z.LOADED)continue;const f=l.getOrigin(h),g=ne(l.getTileSize(h)),y=l.getResolution(h);let _;if(d instanceof wp||d instanceof vp)_=d.getImage();else if(d instanceof Rd){if(_=yc(d.getData()),!_)continue}else continue;const b=Math.floor(c*((r[0]-f[0])/y-u[1]*g[0])),S=Math.floor(c*((f[1]-r[1])/y-u[2]*g[1])),R=Math.round(c*a.getGutterForProjection(o.projection));return this.getImageData(_,b+R,S+R)}return null}prepareFrame(t){this.renderedProjection?t.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=t.viewState.projection):this.renderedProjection=t.viewState.projection;const e=this.getLayer().getSource();if(!e)return!1;const i=e.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==i&&(this.renderedSourceRevision_=i,this.renderedSourceKey_===e.getKey()&&(this.tileCache_.clear(),this.sourceTileCache_?.clear())):this.renderedSourceRevision_=i,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(t,e,i,r,s){const o=t.viewState,a=this.getLayer(),l=a.getRenderSource(),c=l.getTileGridForProjection(o.projection),h=nt(l);h in t.wantedTiles||(t.wantedTiles[h]={});const u=t.wantedTiles[h],d=a.getMapInternal(),f=Math.max(i-s,c.getMinZoom(),c.getZForResolution(Math.min(a.getMaxResolution(),d?d.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):c.getResolution(0)),l.zDirection)),g=o.rotation,y=g?hg(o.center,o.resolution,g,t.size):void 0;for(let _=i;_>=f;--_){const b=c.getTileRangeForExtentAndZ(e,_,this.tempTileRange_),S=c.getResolution(_);for(let R=b.minX;R<=b.maxX;++R)for(let T=b.minY;T<=b.maxY;++T){if(g&&!c.tileCoordIntersectsViewport([_,R,T],y))continue;const I=this.getTile(_,R,T,t);if(!I||!Pl(r,I,_))continue;const w=I.getKey();if(u[w]=!0,I.getState()===z.IDLE&&!t.tileQueue.isKeyQueued(w)){const p=Vo(_,R,T,this.tempTileCoord_);t.tileQueue.enqueue([I,h,c.getTileCoordCenter(p),S])}}}}findStaleTile_(t,e){const i=this.tileCache_,r=t[0],s=t[1],o=t[2],a=this.getStaleKeys();for(let l=0;l<a.length;++l){const c=bo(this.getLayer().getSource(),a[l],r,s,o);if(i.containsKey(c)){const h=i.peek(c);if(h.getState()===z.LOADED)return h.endTransition(nt(this)),Pl(e,h,r),!0}}return!1}findAltTiles_(t,e,i,r){const s=t.getTileRangeForTileCoordAndZ(e,i,this.tempTileRange_);if(!s)return!1;let o=!0;const a=this.tileCache_,l=this.getLayer().getRenderSource(),c=l.getKey();for(let h=s.minX;h<=s.maxX;++h)for(let u=s.minY;u<=s.maxY;++u){const d=bo(l,c,i,h,u);let f=!1;if(a.containsKey(d)){const g=a.peek(d);g.getState()===z.LOADED&&(Pl(r,g,i),f=!0)}f||(o=!1)}return o}renderFrame(t,e){this.renderComplete=!0;const i=t.layerStatesArray[t.layerIndex],r=t.viewState,s=r.projection,o=r.resolution,a=r.center,l=t.pixelRatio,c=this.getLayer(),h=c.getSource(),u=h.getTileGridForProjection(s),d=u.getZForResolution(o,h.zDirection),f=u.getResolution(d),g=h.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==g&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=g):this.renderedSourceKey_=g;let y=t.extent;const _=h.getTilePixelRatio(l);this.prepareContainer(t,e);const b=this.context.canvas.width,S=this.context.canvas.height,R=i.extent&&Dn(i.extent,s);R&&(y=_i(y,Dn(i.extent,s)));const T=f*b/2/_,I=f*S/2/_,L=[a[0]-T,a[1]-I,a[0]+T,a[1]+I],w={};this.renderedTiles.length=0;const p=c.getPreload();if(t.nextExtent&&this.enqueueTilesForNextExtent()){const N=u.getZForResolution(r.nextResolution,h.zDirection),B=Dd(t,t.nextExtent);this.enqueueTiles(t,B,N,w,p)}const m=Dd(t,y);if(this.enqueueTiles(t,m,d,w,0),p>0&&setTimeout(()=>{this.enqueueTiles(t,m,d-1,w,p-1)},0),!(d in w))return this.container;const E=nt(this),x=t.time;for(const N of w[d]){const B=N.getState();if(B===z.EMPTY)continue;const Z=N.tileCoord;if(B===z.LOADED&&N.getAlpha(E,x)===1){N.endTransition(E);continue}if(B!==z.ERROR&&(this.renderComplete=!1),this.findStaleTile_(Z,w)){Nb(w,N,d),t.animate=!0;continue}if(this.findAltTiles_(u,Z,d+1,w))continue;const Nt=u.getMinZoom();for(let Ut=d-1;Ut>=Nt&&!this.findAltTiles_(u,Z,Ut,w);--Ut);}const C=f/o*l/_,v=this.getRenderContext(t);gn(this.tempTransform,b/2,S/2,C,C,0,-b/2,-S/2),i.extent&&this.clipUnrotated(v,t,R),h.getInterpolate()||(v.imageSmoothingEnabled=!1),this.preRender(v,t);const M=Object.keys(w).map(Number);M.sort(ln);let F;const $=[],D=[];for(let N=M.length-1;N>=0;--N){const B=M[N],Z=h.getTilePixelSize(B,l,s),k=u.getResolution(B)/f,Nt=Z[0]*k*C,Ut=Z[1]*k*C,wt=u.getTileCoordForCoordAndZ(Pi(L),B),re=u.getTileCoordExtent(wt),$t=Ot(this.tempTransform,[_*(re[0]-L[0])/f,_*(L[3]-re[3])/f]),Fe=_*h.getGutterForProjection(s);for(const Ie of w[B]){if(Ie.getState()!==z.LOADED)continue;const se=Ie.tileCoord,Js=wt[1]-se[1],Za=Math.round($t[0]-(Js-1)*Nt),Nr=wt[2]-se[2],ei=Math.round($t[1]-(Nr-1)*Ut),de=Math.round($t[0]-Js*Nt),Ne=Math.round($t[1]-Nr*Ut),Mi=Za-de,Fi=ei-Ne,$r=M.length===1;let ni=!1;F=[de,Ne,de+Mi,Ne,de+Mi,Ne+Fi,de,Ne+Fi];for(let Ni=0,$i=$.length;Ni<$i;++Ni)if(!$r&&B<D[Ni]){const Pt=$[Ni];Qt([de,Ne,de+Mi,Ne+Fi],[Pt[0],Pt[3],Pt[4],Pt[7]])&&(ni||(v.save(),ni=!0),v.beginPath(),v.moveTo(F[0],F[1]),v.lineTo(F[2],F[3]),v.lineTo(F[4],F[5]),v.lineTo(F[6],F[7]),v.moveTo(Pt[6],Pt[7]),v.lineTo(Pt[4],Pt[5]),v.lineTo(Pt[2],Pt[3]),v.lineTo(Pt[0],Pt[1]),v.clip())}$.push(F),D.push(B),this.drawTile(Ie,t,de,Ne,Mi,Fi,Fe,$r),ni&&v.restore(),this.renderedTiles.unshift(Ie),this.updateUsedTiles(t.usedTiles,h,Ie)}}if(this.renderedResolution=f,this.extentChanged=!this.renderedExtent_||!ds(this.renderedExtent_,L),this.renderedExtent_=L,this.renderedPixelRatio=l,this.postRender(this.context,t),i.extent&&v.restore(),v.imageSmoothingEnabled=!0,this.renderComplete){const N=(B,Z)=>{const lt=nt(h),k=Z.wantedTiles[lt],Nt=k?Object.keys(k).length:0;this.updateCacheSize(Nt),this.tileCache_.expireCache(),this.sourceTileCache_?.expireCache()};t.postRenderFunctions.push(N)}return this.container}updateCacheSize(t){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,t*2)}drawTile(t,e,i,r,s,o,a,l){let c;if(t instanceof Rd){if(c=yc(t.getData()),!c)throw new Error("Rendering array data is not yet supported")}else c=this.getTileImage(t);if(!c)return;const h=this.getRenderContext(e),u=nt(this),d=e.layerStatesArray[e.layerIndex],f=d.opacity*(l?t.getAlpha(u,e.time):1),g=f!==h.globalAlpha;g&&(h.save(),h.globalAlpha=f),h.drawImage(c,a,a,c.width-2*a,c.height-2*a,i,r,s,o),g&&h.restore(),f!==d.opacity?e.animate=!0:l&&t.endTransition(u)}getImage(){const t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}updateUsedTiles(t,e,i){const r=nt(e);r in t||(t[r]={}),t[r][i.getKey()]=!0}}const ho={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class Vb extends Ia{constructor(t){t=t||{};const e=Object.assign({},t),i=t.cacheSize;delete t.cacheSize,delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.cacheSize_=i,this.setPreload(t.preload!==void 0?t.preload:0),this.setUseInterimTilesOnError(t.useInterimTilesOnError!==void 0?t.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(ho.PRELOAD)}setPreload(t){this.set(ho.PRELOAD,t)}getUseInterimTilesOnError(){return this.get(ho.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(t){this.set(ho.USE_INTERIM_TILES_ON_ERROR,t)}getData(t){return super.getData(t)}}class zb extends Vb{constructor(t){super(t)}createRenderer(){return new $b(this,{cacheSize:this.getCacheSize()})}}class xp{drawCustom(t,e,i,r,s){}drawGeometry(t){}setStyle(t){}drawCircle(t,e,i){}drawFeature(t,e,i){}drawGeometryCollection(t,e,i){}drawLineString(t,e,i){}drawMultiLineString(t,e,i){}drawMultiPoint(t,e,i){}drawMultiPolygon(t,e,i){}drawPoint(t,e,i){}drawPolygon(t,e,i){}drawText(t,e,i){}setFillStrokeStyle(t,e){}setImageStyle(t,e){}setTextStyle(t,e){}}const G={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},uo=[G.FILL],Nn=[G.STROKE],mi=[G.BEGIN_PATH],Md=[G.CLOSE_PATH];class qs extends xp{constructor(t,e,i,r){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const e=this.pixelRatio;return e==1?t:t.map(function(i){return i*e})}appendFlatPointCoordinates(t,e){const i=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let a=0,l=t.length;a<l;a+=e)r[0]=t[a],r[1]=t[a+1],cr(i,r)&&(s[o++]=r[0],s[o++]=r[1]);return o}appendFlatLineCoordinates(t,e,i,r,s,o){const a=this.coordinates;let l=a.length;const c=this.getBufferedMaxExtent();o&&(e+=r);let h=t[e],u=t[e+1];const d=this.tmpCoordinate_;let f=!0,g,y,_;for(g=e+r;g<i;g+=r)d[0]=t[g],d[1]=t[g+1],_=Xl(c,d),_!==y?(f&&(a[l++]=h,a[l++]=u,f=!1),a[l++]=d[0],a[l++]=d[1]):_===Lt.INTERSECTING?(a[l++]=d[0],a[l++]=d[1],f=!1):f=!0,h=d[0],u=d[1],y=_;return(s&&f||g===e+r)&&(a[l++]=h,a[l++]=u),l}drawCustomCoordinates_(t,e,i,r,s){for(let o=0,a=i.length;o<a;++o){const l=i[o],c=this.appendFlatLineCoordinates(t,e,l,r,!1,!1);s.push(c),e=l}return e}drawCustom(t,e,i,r,s){this.beginGeometry(t,e,s);const o=t.getType(),a=t.getStride(),l=this.coordinates.length;let c,h,u,d,f;switch(o){case"MultiPolygon":c=t.getOrientedFlatCoordinates(),d=[];const g=t.getEndss();f=0;for(let y=0,_=g.length;y<_;++y){const b=[];f=this.drawCustomCoordinates_(c,f,g[y],a,b),d.push(b)}this.instructions.push([G.CUSTOM,l,d,t,i,rc,s]),this.hitDetectionInstructions.push([G.CUSTOM,l,d,t,r||i,rc,s]);break;case"Polygon":case"MultiLineString":u=[],c=o=="Polygon"?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),f=this.drawCustomCoordinates_(c,0,t.getEnds(),a,u),this.instructions.push([G.CUSTOM,l,u,t,i,ms,s]),this.hitDetectionInstructions.push([G.CUSTOM,l,u,t,r||i,ms,s]);break;case"LineString":case"Circle":c=t.getFlatCoordinates(),h=this.appendFlatLineCoordinates(c,0,c.length,a,!1,!1),this.instructions.push([G.CUSTOM,l,h,t,i,Mn,s]),this.hitDetectionInstructions.push([G.CUSTOM,l,h,t,r||i,Mn,s]);break;case"MultiPoint":c=t.getFlatCoordinates(),h=this.appendFlatPointCoordinates(c,a),h>l&&(this.instructions.push([G.CUSTOM,l,h,t,i,Mn,s]),this.hitDetectionInstructions.push([G.CUSTOM,l,h,t,r||i,Mn,s]));break;case"Point":c=t.getFlatCoordinates(),this.coordinates.push(c[0],c[1]),h=this.coordinates.length,this.instructions.push([G.CUSTOM,l,h,t,i,void 0,s]),this.hitDetectionInstructions.push([G.CUSTOM,l,h,t,r||i,void 0,s]);break}this.endGeometry(e)}beginGeometry(t,e,i){this.beginGeometryInstruction1_=[G.BEGIN_GEOMETRY,e,0,t,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[G.BEGIN_GEOMETRY,e,0,t,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;t.reverse();let e;const i=t.length;let r,s,o=-1;for(e=0;e<i;++e)r=t[e],s=r[0],s==G.END_GEOMETRY?o=e:s==G.BEGIN_GEOMETRY&&(r[2]=e,Z_(this.hitDetectionInstructions,o,e),o=-1)}fillStyleToState(t,e={}){if(t){const i=t.getColor();e.fillPatternScale=i&&typeof i=="object"&&"src"in i?this.pixelRatio:1,e.fillStyle=Ue(i||Jt)}else e.fillStyle=void 0;return e}strokeStyleToState(t,e={}){if(t){const i=t.getColor();e.strokeStyle=Ue(i||bs);const r=t.getLineCap();e.lineCap=r!==void 0?r:pr;const s=t.getLineDash();e.lineDash=s?s.slice():hn;const o=t.getLineDashOffset();e.lineDashOffset=o||un;const a=t.getLineJoin();e.lineJoin=a!==void 0?a:mr;const l=t.getWidth();e.lineWidth=l!==void 0?l:xs;const c=t.getMiterLimit();e.miterLimit=c!==void 0?c:vs,e.lineWidth>this.maxLineWidth&&(this.maxLineWidth=e.lineWidth,this.bufferedMaxExtent_=null)}else e.strokeStyle=void 0,e.lineCap=void 0,e.lineDash=null,e.lineDashOffset=void 0,e.lineJoin=void 0,e.lineWidth=void 0,e.miterLimit=void 0;return e}setFillStrokeStyle(t,e){const i=this.state;this.fillStyleToState(t,i),this.strokeStyleToState(e,i)}createFill(t){const e=t.fillStyle,i=[G.SET_FILL_STYLE,e];return typeof e!="string"&&i.push(t.fillPatternScale),i}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[G.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,t.lineDash?this.applyPixelRatio(t.lineDash):null,t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){const i=t.fillStyle;(typeof i!="string"||t.currentFillStyle!=i)&&(this.instructions.push(e.call(this,t)),t.currentFillStyle=i)}updateStrokeStyle(t,e){const i=t.strokeStyle,r=t.lineCap,s=t.lineDash,o=t.lineDashOffset,a=t.lineJoin,l=t.lineWidth,c=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=r||s!=t.currentLineDash&&!Qn(t.currentLineDash,s)||t.currentLineDashOffset!=o||t.currentLineJoin!=a||t.currentLineWidth!=l||t.currentMiterLimit!=c)&&(e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=r,t.currentLineDash=s,t.currentLineDashOffset=o,t.currentLineJoin=a,t.currentLineWidth=l,t.currentMiterLimit=c)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const e=[G.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=sg(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;th(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class Gb extends qs{constructor(t,e,i,r){super(t,e,i,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e,i){if(!this.image_||this.maxExtent&&!cr(this.maxExtent,t.getFlatCoordinates()))return;this.beginGeometry(t,e,i);const r=t.getFlatCoordinates(),s=t.getStride(),o=this.coordinates.length,a=this.appendFlatPointCoordinates(r,s);this.instructions.push([G.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([G.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e,i){if(!this.image_)return;this.beginGeometry(t,e,i);const r=t.getFlatCoordinates(),s=[];for(let l=0,c=r.length;l<c;l+=t.getStride())(!this.maxExtent||cr(this.maxExtent,r.slice(l,l+2)))&&s.push(r[l],r[l+1]);const o=this.coordinates.length,a=this.appendFlatPointCoordinates(s,2);this.instructions.push([G.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([G.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){const i=t.getAnchor(),r=t.getSize(),s=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=t.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=r[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}class Bb extends qs{constructor(t,e,i,r){super(t,e,i,r)}drawFlatCoordinates_(t,e,i,r){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(t,e,i,r,!1,!1),a=[G.MOVE_TO_LINE_TO,s,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),i}drawLineString(t,e,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(t,e,i),this.hitDetectionInstructions.push([G.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,hn,un],mi);const a=t.getFlatCoordinates(),l=t.getStride();this.drawFlatCoordinates_(a,0,a.length,l),this.hitDetectionInstructions.push(Nn),this.endGeometry(e)}drawMultiLineString(t,e,i){const r=this.state,s=r.strokeStyle,o=r.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(t,e,i),this.hitDetectionInstructions.push([G.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,hn,un],mi);const a=t.getEnds(),l=t.getFlatCoordinates(),c=t.getStride();let h=0;for(let u=0,d=a.length;u<d;++u)h=this.drawFlatCoordinates_(l,h,a[u],c);this.hitDetectionInstructions.push(Nn),this.endGeometry(e)}finish(){const t=this.state;return t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&this.instructions.push(Nn),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(Nn),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(mi)}}class Fd extends qs{constructor(t,e,i,r){super(t,e,i,r)}drawFlatCoordinatess_(t,e,i,r){const s=this.state,o=s.fillStyle!==void 0,a=s.strokeStyle!==void 0,l=i.length;this.instructions.push(mi),this.hitDetectionInstructions.push(mi);for(let c=0;c<l;++c){const h=i[c],u=this.coordinates.length,d=this.appendFlatLineCoordinates(t,e,h,r,!0,!a),f=[G.MOVE_TO_LINE_TO,u,d];this.instructions.push(f),this.hitDetectionInstructions.push(f),a&&(this.instructions.push(Md),this.hitDetectionInstructions.push(Md)),e=h}return o&&(this.instructions.push(uo),this.hitDetectionInstructions.push(uo)),a&&(this.instructions.push(Nn),this.hitDetectionInstructions.push(Nn)),e}drawCircle(t,e,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([G.SET_FILL_STYLE,Jt]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([G.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,hn,un]);const a=t.getFlatCoordinates(),l=t.getStride(),c=this.coordinates.length;this.appendFlatLineCoordinates(a,0,a.length,l,!1,!1);const h=[G.CIRCLE,c];this.instructions.push(mi,h),this.hitDetectionInstructions.push(mi,h),r.fillStyle!==void 0&&(this.instructions.push(uo),this.hitDetectionInstructions.push(uo)),r.strokeStyle!==void 0&&(this.instructions.push(Nn),this.hitDetectionInstructions.push(Nn)),this.endGeometry(e)}drawPolygon(t,e,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([G.SET_FILL_STYLE,Jt]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([G.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,hn,un]);const a=t.getEnds(),l=t.getOrientedFlatCoordinates(),c=t.getStride();this.drawFlatCoordinatess_(l,0,a,c),this.endGeometry(e)}drawMultiPolygon(t,e,i){const r=this.state,s=r.fillStyle,o=r.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),r.fillStyle!==void 0&&this.hitDetectionInstructions.push([G.SET_FILL_STYLE,Jt]),r.strokeStyle!==void 0&&this.hitDetectionInstructions.push([G.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,hn,un]);const a=t.getEndss(),l=t.getOrientedFlatCoordinates(),c=t.getStride();let h=0;for(let u=0,d=a.length;u<d;++u)h=this.drawFlatCoordinatess_(l,h,a[u],c);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(t!==0){const e=this.coordinates;for(let i=0,r=e.length;i<r;++i)e[i]=li(e[i],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;this.updateFillStyle(t,this.createFill),this.updateStrokeStyle(t,this.applyStroke)}}function Ub(n,t,e,i,r){const s=[];let o=e,a=0,l=t.slice(e,2);for(;a<n&&o+r<i;){const[c,h]=l.slice(-2),u=t[o+r],d=t[o+r+1],f=Math.sqrt((u-c)*(u-c)+(d-h)*(d-h));if(a+=f,a>=n){const g=(n-a+f)/f,y=oe(c,u,g),_=oe(h,d,g);l.push(y,_),s.push(l),l=[y,_],a==n&&(o+=r),a=0}else if(a<n)l.push(t[o+r],t[o+r+1]),o+=r;else{const g=f-a,y=oe(c,u,g/f),_=oe(h,d,g/f);l.push(y,_),s.push(l),l=[y,_],a=0,o+=r}}return a>0&&s.push(l),s}function jb(n,t,e,i,r){let s=e,o=e,a=0,l=0,c=e,h,u,d,f,g,y,_,b,S,R;for(u=e;u<i;u+=r){const T=t[u],I=t[u+1];g!==void 0&&(S=T-g,R=I-y,f=Math.sqrt(S*S+R*R),_!==void 0&&(l+=d,h=Math.acos((_*S+b*R)/(d*f)),h>n&&(l>a&&(a=l,s=c,o=u),l=0,c=u-r)),d=f,_=S,b=R),g=T,y=I}return l+=f,l>a?[c,u]:[s,o]}const zo={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class Wb extends qs{constructor(t,e,i,r){super(t,e,i,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[Jt]={fillStyle:Jt},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e,i){const r=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!r&&!s)return;const a=this.coordinates;let l=a.length;const c=t.getType();let h=null,u=t.getStride();if(o.placement==="line"&&(c=="LineString"||c=="MultiLineString"||c=="Polygon"||c=="MultiPolygon")){if(!Qt(this.maxExtent,t.getExtent()))return;let d;if(h=t.getFlatCoordinates(),c=="LineString")d=[h.length];else if(c=="MultiLineString")d=t.getEnds();else if(c=="Polygon")d=t.getEnds().slice(0,1);else if(c=="MultiPolygon"){const _=t.getEndss();d=[];for(let b=0,S=_.length;b<S;++b)d.push(_[b][0])}this.beginGeometry(t,e,i);const f=o.repeat,g=f?void 0:o.textAlign;let y=0;for(let _=0,b=d.length;_<b;++_){let S;f?S=Ub(f*this.resolution,h,y,d[_],u):S=[h.slice(y,d[_])];for(let R=0,T=S.length;R<T;++R){const I=S[R];let L=0,w=I.length;if(g==null){const m=jb(o.maxAngle,I,0,I.length,2);L=m[0],w=m[1]}for(let m=L;m<w;m+=u)a.push(I[m],I[m+1]);const p=a.length;y=d[_],this.drawChars_(l,p),l=p}}this.endGeometry(e)}else{let d=o.overflow?null:[];switch(c){case"Point":case"MultiPoint":h=t.getFlatCoordinates();break;case"LineString":h=t.getFlatMidpoint();break;case"Circle":h=t.getCenter();break;case"MultiLineString":h=t.getFlatMidpoints(),u=2;break;case"Polygon":h=t.getFlatInteriorPoint(),o.overflow||d.push(h[2]/this.resolution),u=3;break;case"MultiPolygon":const T=t.getFlatInteriorPoints();h=[];for(let I=0,L=T.length;I<L;I+=3)o.overflow||d.push(T[I+2]/this.resolution),h.push(T[I],T[I+1]);if(h.length===0)return;u=2;break}const f=this.appendFlatPointCoordinates(h,u);if(f===l)return;if(d&&(f-l)/2!==h.length/u){let T=l/2;d=d.filter((I,L)=>{const w=a[(T+L)*2]===h[L*u]&&a[(T+L)*2+1]===h[L*u+1];return w||--T,w})}this.saveTextStates_();const g=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,y=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(t,e,i);let _=o.padding;if(_!=pi&&(o.scale[0]<0||o.scale[1]<0)){let T=o.padding[0],I=o.padding[1],L=o.padding[2],w=o.padding[3];o.scale[0]<0&&(I=-I,w=-w),o.scale[1]<0&&(T=-T,L=-L),_=[T,I,L,w]}const b=this.pixelRatio;this.instructions.push([G.DRAW_IMAGE,l,f,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,_==pi?pi:_.map(function(T){return T*b}),g,y,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,d]);const S=1/b,R=g?g.slice(0):null;R&&(R[1]=Jt),this.hitDetectionInstructions.push([G.DRAW_IMAGE,l,f,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[S,S],NaN,this.declutterMode_,this.declutterImageWithText_,_,R,y,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?Jt:this.fillKey_,this.textOffsetX_,this.textOffsetY_,d]),this.endGeometry(e)}}saveTextStates_(){const t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,r=this.strokeKey_;t&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:e.font,textAlign:e.textAlign||Es,justify:e.justify,textBaseline:e.textBaseline||Fo,scale:e.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(t,e){const i=this.textStrokeState_,r=this.textState_,s=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,c=zo[r.textBaseline],h=this.textOffsetY_*l,u=this.text_,d=i?i.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([G.DRAW_CHARS,t,e,c,r.overflow,a,r.maxAngle,l,h,s,d*l,u,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([G.DRAW_CHARS,t,e,c,r.overflow,a&&Jt,r.maxAngle,l,h,s,d*l,u,o,1/l,this.declutterMode_,this.textKeepUpright_])}setTextStyle(t,e){let i,r,s;if(!t)this.text_="";else{const o=t.getFill();o?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=Ue(o.getColor()||Jt)):(r=null,this.textFillState_=r);const a=t.getStroke();if(!a)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const y=a.getLineDash(),_=a.getLineDashOffset(),b=a.getWidth(),S=a.getMiterLimit();s.lineCap=a.getLineCap()||pr,s.lineDash=y?y.slice():hn,s.lineDashOffset=_===void 0?un:_,s.lineJoin=a.getLineJoin()||mr,s.lineWidth=b===void 0?xs:b,s.miterLimit=S===void 0?vs:S,s.strokeStyle=Ue(a.getColor()||bs)}i=this.textState_;const l=t.getFont()||ap;Xv(l);const c=t.getScaleArray();i.overflow=t.getOverflow(),i.font=l,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.repeat=t.getRepeat(),i.justify=t.getJustify(),i.textBaseline=t.getTextBaseline()||Fo,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||pi,i.scale=c===void 0?[1,1]:c;const h=t.getOffsetX(),u=t.getOffsetY(),d=t.getRotateWithView(),f=t.getKeepUpright(),g=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=h===void 0?0:h,this.textOffsetY_=u===void 0?0:u,this.textRotateWithView_=d===void 0?!1:d,this.textKeepUpright_=f===void 0?!0:f,this.textRotation_=g===void 0?0:g,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:nt(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=r&&r.fillStyle?typeof r.fillStyle=="string"?r.fillStyle:"|"+nt(r.fillStyle):""}this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}const qb={Circle:Fd,Default:qs,Image:Gb,LineString:Bb,Polygon:Fd,Text:Wb};class Hb{constructor(t,e,i,r){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=r,this.resolution_=i,this.buildersByZIndex_={}}finish(){const t={};for(const e in this.buildersByZIndex_){t[e]=t[e]||{};const i=this.buildersByZIndex_[e];for(const r in i){const s=i[r].finish();t[e][r]=s}}return t}getBuilder(t,e){const i=t!==void 0?t.toString():"0";let r=this.buildersByZIndex_[i];r===void 0&&(r={},this.buildersByZIndex_[i]=r);let s=r[e];if(s===void 0){const o=qb[e];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[e]=s}return s}}function Uh(n,t,e,i){let r=n[t],s=n[t+1],o=0;for(let a=t+i;a<e;a+=i){const l=n[a],c=n[a+1];o+=Math.sqrt((l-r)*(l-r)+(c-s)*(c-s)),r=l,s=c}return o}function Xb(n,t,e,i,r,s,o,a,l,c,h,u,d=!0){let f=n[t],g=n[t+1],y=0,_=0,b=0,S=0;function R(){y=f,_=g,t+=i,f=n[t],g=n[t+1],S+=b,b=Math.sqrt((f-y)*(f-y)+(g-_)*(g-_))}do R();while(t<e-i&&S+b<s);let T=b===0?0:(s-S)/b;const I=oe(y,f,T),L=oe(_,g,T),w=t-i,p=S,m=s+a*l(c,r,h);for(;t<e-i&&S+b<m;)R();T=b===0?0:(m-S)/b;const E=oe(y,f,T),x=oe(_,g,T);let C=!1;if(d)if(u){const D=[I,L,E,x];xg(D,0,4,2,u,D,D),C=D[0]>D[2]}else C=I>E;const v=Math.PI,M=[],F=w+i===t;t=w,b=0,S=p,f=n[t],g=n[t+1];let $;if(F){R(),$=Math.atan2(g-_,f-y),C&&($+=$>0?-v:v);const D=(E+I)/2,N=(x+L)/2;return M[0]=[D,N,(m-s)/2,$,r],M}r=r.replace(/\n/g," ");for(let D=0,N=r.length;D<N;){R();let B=Math.atan2(g-_,f-y);if(C&&(B+=B>0?-v:v),$!==void 0){let wt=B-$;if(wt+=wt>v?-2*v:wt<-v?2*v:0,Math.abs(wt)>o)return null}$=B;const Z=D;let lt=0;for(;D<N;++D){const wt=C?N-D-1:D,re=a*l(c,r[wt],h);if(t+i<e&&S+b<s+lt+re/2)break;lt+=re}if(D===Z)continue;const k=C?r.substring(N-Z,N-D):r.substring(Z,D);T=b===0?0:(s+lt/2-S)/b;const Nt=oe(y,f,T),Ut=oe(_,g,T);M.push([Nt,Ut,lt/2,B,k]),s+=lt}return M}const qi=Ce(),xn=[],en=[],nn=[],Cn=[];function Nd(n){return n[3].declutterBox}const $d=new RegExp("[֑-ࣿיִ-﷿ﹰ-ﻼࠀ-࿿-]");function Ll(n,t){return t==="start"?t=$d.test(n)?"right":"left":t==="end"&&(t=$d.test(n)?"left":"right"),zo[t]}function Kb(n,t,e){return e>0&&n.push(`
`,""),n.push(t,""),n}function Yb(n,t,e){return e%2===0&&(n+=t),n}class Zb{constructor(t,e,i,r,s){this.overlaps=i,this.pixelRatio=e,this.resolution=t,this.alignAndScaleFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=Pe(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new bp:null}getZIndexContext(){return this.zIndexContext_}createLabel(t,e,i,r){const s=t+e+i+r;if(this.labels_[s])return this.labels_[s];const o=r?this.strokeStates[r]:null,a=i?this.fillStates[i]:null,l=this.textStates[e],c=this.pixelRatio,h=[l.scale[0]*c,l.scale[1]*c],u=l.justify?zo[l.justify]:Ll(Array.isArray(t)?t[0]:t,l.textAlign||Es),d=r&&o.lineWidth?o.lineWidth:0,f=Array.isArray(t)?t:String(t).split(`
`).reduce(Kb,[]),{width:g,height:y,widths:_,heights:b,lineWidths:S}=Yv(l,f),R=g+d,T=[],I=(R+2)*h[0],L=(y+d)*h[1],w={width:I<0?Math.floor(I):Math.ceil(I),height:L<0?Math.floor(L):Math.ceil(L),contextInstructions:T};(h[0]!=1||h[1]!=1)&&T.push("scale",h),r&&(T.push("strokeStyle",o.strokeStyle),T.push("lineWidth",d),T.push("lineCap",o.lineCap),T.push("lineJoin",o.lineJoin),T.push("miterLimit",o.miterLimit),T.push("setLineDash",[o.lineDash]),T.push("lineDashOffset",o.lineDashOffset)),i&&T.push("fillStyle",a.fillStyle),T.push("textBaseline","middle"),T.push("textAlign","center");const p=.5-u;let m=u*R+p*d;const E=[],x=[];let C=0,v=0,M=0,F=0,$;for(let D=0,N=f.length;D<N;D+=2){const B=f[D];if(B===`
`){v+=C,C=0,m=u*R+p*d,++F;continue}const Z=f[D+1]||l.font;Z!==$&&(r&&E.push("font",Z),i&&x.push("font",Z),$=Z),C=Math.max(C,b[M]);const lt=[B,m+p*_[M]+u*(_[M]-S[F]),.5*(d+C)+v];m+=_[M],r&&E.push("strokeText",lt),i&&x.push("fillText",lt),++M}return Array.prototype.push.apply(T,E),Array.prototype.push.apply(T,x),this.labels_[s]=w,w}replayTextBackground_(t,e,i,r,s,o,a){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,r),t.lineTo.apply(t,s),t.lineTo.apply(t,e),o&&(this.alignAndScaleFill_=o[2],t.fillStyle=o[1],this.fill_(t)),a&&(this.setStrokeStyle_(t,a),t.stroke())}calculateImageOrLabelDimensions_(t,e,i,r,s,o,a,l,c,h,u,d,f,g,y,_){a*=d[0],l*=d[1];let b=i-a,S=r-l;const R=s+c>t?t-c:s,T=o+h>e?e-h:o,I=g[3]+R*d[0]+g[1],L=g[0]+T*d[1]+g[2],w=b-g[3],p=S-g[0];(y||u!==0)&&(xn[0]=w,Cn[0]=w,xn[1]=p,en[1]=p,en[0]=w+I,nn[0]=en[0],nn[1]=p+L,Cn[1]=nn[1]);let m;return u!==0?(m=gn(Pe(),i,r,1,1,u,-i,-r),Ot(m,xn),Ot(m,en),Ot(m,nn),Ot(m,Cn),dn(Math.min(xn[0],en[0],nn[0],Cn[0]),Math.min(xn[1],en[1],nn[1],Cn[1]),Math.max(xn[0],en[0],nn[0],Cn[0]),Math.max(xn[1],en[1],nn[1],Cn[1]),qi)):dn(Math.min(w,w+I),Math.min(p,p+L),Math.max(w,w+I),Math.max(p,p+L),qi),f&&(b=Math.round(b),S=Math.round(S)),{drawImageX:b,drawImageY:S,drawImageW:R,drawImageH:T,originX:c,originY:h,declutterBox:{minX:qi[0],minY:qi[1],maxX:qi[2],maxY:qi[3],value:_},canvasTransform:m,scale:d}}replayImageOrLabel_(t,e,i,r,s,o,a){const l=!!(o||a),c=r.declutterBox,h=a?a[2]*r.scale[0]/2:0;return c.minX-h<=e[0]&&c.maxX+h>=0&&c.minY-h<=e[1]&&c.maxY+h>=0&&(l&&this.replayTextBackground_(t,xn,en,nn,Cn,o,a),Zv(t,r.canvasTransform,s,i,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}fill_(t){const e=this.alignAndScaleFill_;if(e){const i=Ot(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;t.save(),t.translate(i[0]%r,i[1]%r),e!==1&&t.scale(e,e),t.rotate(this.viewRotation_)}t.fill(),e&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],e[1]&&(t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6]))}drawLabelWithPointPlacement_(t,e,i,r){const s=this.textStates[e],o=this.createLabel(t,e,r,i),a=this.strokeStates[i],l=this.pixelRatio,c=Ll(Array.isArray(t)?t[0]:t,s.textAlign||Es),h=zo[s.textBaseline||Fo],u=a&&a.lineWidth?a.lineWidth:0,d=o.width/l-2*s.scale[0],f=c*d+2*(.5-c)*u,g=h*o.height/l+2*(.5-h)*u;return{label:o,anchorX:f,anchorY:g}}execute_(t,e,i,r,s,o,a,l){const c=this.zIndexContext_;let h;this.pixelCoordinates_&&Qn(i,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=Vn(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),qy(this.renderedTransform_,i));let u=0;const d=r.length;let f=0,g,y,_,b,S,R,T,I,L,w,p,m,E,x=0,C=0;const v=this.coordinateCache_,M=this.viewRotation_,F=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,$={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:M},D=this.instructions!=r||this.overlaps?0:200;let N,B,Z,lt;for(;u<d;){const k=r[u];switch(k[0]){case G.BEGIN_GEOMETRY:N=k[1],lt=k[3],N.getGeometry()?a!==void 0&&!Qt(a,lt.getExtent())?u=k[2]+1:++u:u=k[2],c&&(c.zIndex=k[4]);break;case G.BEGIN_PATH:x>D&&(this.fill_(t),x=0),C>D&&(t.stroke(),C=0),!x&&!C&&(t.beginPath(),S=NaN,R=NaN),++u;break;case G.CIRCLE:f=k[1];const Ut=h[f],wt=h[f+1],re=h[f+2],$t=h[f+3],Fe=re-Ut,Ie=$t-wt,se=Math.sqrt(Fe*Fe+Ie*Ie);t.moveTo(Ut+se,wt),t.arc(Ut,wt,se,0,2*Math.PI,!0),++u;break;case G.CLOSE_PATH:t.closePath(),++u;break;case G.CUSTOM:f=k[1],g=k[2];const Js=k[3],Za=k[4],Nr=k[5];$.geometry=Js,$.feature=N,u in v||(v[u]=[]);const ei=v[u];Nr?Nr(h,f,g,2,ei):(ei[0]=h[f],ei[1]=h[f+1],ei.length=2),c&&(c.zIndex=k[6]),Za(ei,$),++u;break;case G.DRAW_IMAGE:f=k[1],g=k[2],L=k[3],y=k[4],_=k[5];let de=k[6];const Ne=k[7],Mi=k[8],Fi=k[9],$r=k[10];let ni=k[11];const Ni=k[12];let $i=k[13];b=k[14]||"declutter";const Pt=k[15];if(!L&&k.length>=20){w=k[19],p=k[20],m=k[21],E=k[22];const fe=this.drawLabelWithPointPlacement_(w,p,m,E);L=fe.label,k[3]=L;const ii=k[23];y=(fe.anchorX-ii)*this.pixelRatio,k[4]=y;const ge=k[24];_=(fe.anchorY-ge)*this.pixelRatio,k[5]=_,de=L.height,k[6]=de,$i=L.width,k[13]=$i}let Ja;k.length>25&&(Ja=k[25]);let Qa,Qs,to;k.length>17?(Qa=k[16],Qs=k[17],to=k[18]):(Qa=pi,Qs=null,to=null),$r&&F?ni+=M:!$r&&!F&&(ni-=M);let Km=0;for(;f<g;f+=2){if(Ja&&Ja[Km++]<$i/this.pixelRatio)continue;const fe=this.calculateImageOrLabelDimensions_(L.width,L.height,h[f],h[f+1],$i,de,y,_,Mi,Fi,ni,Ni,s,Qa,!!Qs||!!to,N),ii=[t,e,L,fe,Ne,Qs,to];if(l){let ge,$e,pe;if(Pt){const mt=g-f;if(!Pt[mt]){Pt[mt]={args:ii,declutterMode:b};continue}const jt=Pt[mt];ge=jt.args,$e=jt.declutterMode,delete Pt[mt],pe=Nd(ge)}let Ze,Je;if(ge&&($e!=="declutter"||!l.collides(pe))&&(Ze=!0),(b!=="declutter"||!l.collides(fe.declutterBox))&&(Je=!0),$e==="declutter"&&b==="declutter"){const mt=Ze&&Je;Ze=mt,Je=mt}Ze&&($e!=="none"&&l.insert(pe),this.replayImageOrLabel_.apply(this,ge)),Je&&(b!=="none"&&l.insert(fe.declutterBox),this.replayImageOrLabel_.apply(this,ii))}else this.replayImageOrLabel_.apply(this,ii)}++u;break;case G.DRAW_CHARS:const gu=k[1],pu=k[2],tl=k[3],Ym=k[4];E=k[5];const Zm=k[6],mu=k[7],_u=k[8];m=k[9];const el=k[10];w=k[11],Array.isArray(w)&&(w=w.reduce(Yb,"")),p=k[12];const yu=[k[13],k[13]];b=k[14]||"declutter";const Jm=k[15],nl=this.textStates[p],Vr=nl.font,zr=[nl.scale[0]*mu,nl.scale[1]*mu];let Gr;Vr in this.widths_?Gr=this.widths_[Vr]:(Gr={},this.widths_[Vr]=Gr);const wu=Uh(h,gu,pu,2),vu=Math.abs(zr[0])*vd(Vr,w,Gr);if(Ym||vu<=wu){const fe=this.textStates[p].textAlign,ii=(wu-vu)*Ll(w,fe),ge=Xb(h,gu,pu,2,w,ii,Zm,Math.abs(zr[0]),vd,Vr,Gr,F?0:this.viewRotation_,Jm);t:if(ge){const $e=[];let pe,Ze,Je,mt,jt;if(m)for(pe=0,Ze=ge.length;pe<Ze;++pe){jt=ge[pe],Je=jt[4],mt=this.createLabel(Je,p,"",m),y=jt[2]+(zr[0]<0?-el:el),_=tl*mt.height+(.5-tl)*2*el*zr[1]/zr[0]-_u;const Qe=this.calculateImageOrLabelDimensions_(mt.width,mt.height,jt[0],jt[1],mt.width,mt.height,y,_,0,0,jt[3],yu,!1,pi,!1,N);if(l&&b==="declutter"&&l.collides(Qe.declutterBox))break t;$e.push([t,e,mt,Qe,1,null,null])}if(E)for(pe=0,Ze=ge.length;pe<Ze;++pe){jt=ge[pe],Je=jt[4],mt=this.createLabel(Je,p,E,""),y=jt[2],_=tl*mt.height-_u;const Qe=this.calculateImageOrLabelDimensions_(mt.width,mt.height,jt[0],jt[1],mt.width,mt.height,y,_,0,0,jt[3],yu,!1,pi,!1,N);if(l&&b==="declutter"&&l.collides(Qe.declutterBox))break t;$e.push([t,e,mt,Qe,1,null,null])}l&&b!=="none"&&l.load($e.map(Nd));for(let Qe=0,Qm=$e.length;Qe<Qm;++Qe)this.replayImageOrLabel_.apply(this,$e[Qe])}}++u;break;case G.END_GEOMETRY:if(o!==void 0){N=k[1];const fe=o(N,lt,b);if(fe)return fe}++u;break;case G.FILL:D?x++:this.fill_(t),++u;break;case G.MOVE_TO_LINE_TO:for(f=k[1],g=k[2],B=h[f],Z=h[f+1],t.moveTo(B,Z),S=B+.5|0,R=Z+.5|0,f+=2;f<g;f+=2)B=h[f],Z=h[f+1],T=B+.5|0,I=Z+.5|0,(f==g-2||T!==S||I!==R)&&(t.lineTo(B,Z),S=T,R=I);++u;break;case G.SET_FILL_STYLE:this.alignAndScaleFill_=k[2],x&&(this.fill_(t),x=0,C&&(t.stroke(),C=0)),t.fillStyle=k[1],++u;break;case G.SET_STROKE_STYLE:C&&(t.stroke(),C=0),this.setStrokeStyle_(t,k),++u;break;case G.STROKE:D?C++:t.stroke(),++u;break;default:++u;break}}x&&this.fill_(t),C&&t.stroke()}execute(t,e,i,r,s,o){this.viewRotation_=r,this.execute_(t,e,i,this.instructions,s,void 0,void 0,o)}executeHitDetection(t,e,i,r,s){return this.viewRotation_=i,this.execute_(t,[t.canvas.width,t.canvas.height],e,this.hitDetectionInstructions,!0,r,s)}}const ui=["Polygon","Circle","LineString","Image","Text","Default"],Cp=["Image","Text"],Jb=ui.filter(n=>!Cp.includes(n));class Qb{constructor(t,e,i,r,s,o,a){this.maxExtent_=t,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=e,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Pe(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,a)}clip(t,e){const i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()}createExecutors_(t,e){for(const i in t){let r=this.executorsByZIndex_[i];r===void 0&&(r={},this.executorsByZIndex_[i]=r);const s=t[i];for(const o in s){const a=s[o];r[o]=new Zb(this.resolution_,this.pixelRatio_,this.overlaps_,a,e)}}}hasExecutors(t){for(const e in this.executorsByZIndex_){const i=this.executorsByZIndex_[e];for(let r=0,s=t.length;r<s;++r)if(t[r]in i)return!0}return!1}forEachFeatureAtCoordinate(t,e,i,r,s,o){r=Math.round(r);const a=r*2+1,l=gn(this.hitDetectionTransform_,r+.5,r+.5,1/e,-1/e,-i,-t[0],-t[1]),c=!this.hitDetectionContext_;c&&(this.hitDetectionContext_=Rt(a,a));const h=this.hitDetectionContext_;h.canvas.width!==a||h.canvas.height!==a?(h.canvas.width=a,h.canvas.height=a):c||h.clearRect(0,0,a,a);let u;this.renderBuffer_!==void 0&&(u=Ce(),is(u,t),th(u,e*(this.renderBuffer_+r),u));const d=t1(r);let f;function g(I,L,w){const p=h.getImageData(0,0,a,a).data;for(let m=0,E=d.length;m<E;m++)if(p[d[m]]>0){if(!o||w==="none"||f!=="Image"&&f!=="Text"||o.includes(I)){const x=(d[m]-3)/4,C=r-x%a,v=r-(x/a|0),M=s(I,L,C*C+v*v);if(M)return M}h.clearRect(0,0,a,a);break}}const y=Object.keys(this.executorsByZIndex_).map(Number);y.sort(ln);let _,b,S,R,T;for(_=y.length-1;_>=0;--_){const I=y[_].toString();for(S=this.executorsByZIndex_[I],b=ui.length-1;b>=0;--b)if(f=ui[b],R=S[f],R!==void 0&&(T=R.executeHitDetection(h,l,i,g,u),T))return T}}getClipCoords(t){const e=this.maxExtent_;if(!e)return null;const i=e[0],r=e[1],s=e[2],o=e[3],a=[i,r,i,o,s,o,s,r];return Vn(a,0,8,2,t,a),a}isEmpty(){return bi(this.executorsByZIndex_)}execute(t,e,i,r,s,o,a){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(a?Y_:ln),o=o||ui;const c=ui.length;for(let h=0,u=l.length;h<u;++h){const d=l[h].toString(),f=this.executorsByZIndex_[d];for(let g=0,y=o.length;g<y;++g){const _=o[g],b=f[_];if(b!==void 0){const S=a===null?void 0:b.getZIndexContext(),R=S?S.getContext():t,T=this.maxExtent_&&_!=="Image"&&_!=="Text";if(T&&(R.save(),this.clip(R,i)),!S||_==="Text"||_==="Image"?b.execute(R,e,i,r,s,a):S.pushFunction(I=>b.execute(I,e,i,r,s,a)),T&&R.restore(),S){S.offset();const I=l[h]*c+ui.indexOf(_);this.deferredZIndexContexts_[I]||(this.deferredZIndexContexts_[I]=[]),this.deferredZIndexContexts_[I].push(S)}}}}this.renderedContext_=t}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const t=this.deferredZIndexContexts_,e=Object.keys(t).map(Number).sort(ln);for(let i=0,r=e.length;i<r;++i)t[e[i]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),t[e[i]].length=0}}const Ol={};function t1(n){if(Ol[n]!==void 0)return Ol[n];const t=n*2+1,e=n*n,i=new Array(e+1);for(let s=0;s<=n;++s)for(let o=0;o<=n;++o){const a=s*s+o*o;if(a>e)break;let l=i[a];l||(l=[],i[a]=l),l.push(((n+s)*t+(n+o))*4+3),s>0&&l.push(((n-s)*t+(n+o))*4+3),o>0&&(l.push(((n+s)*t+(n-o))*4+3),s>0&&l.push(((n-s)*t+(n-o))*4+3))}const r=[];for(let s=0,o=i.length;s<o;++s)i[s]&&r.push(...i[s]);return Ol[n]=r,r}class e1 extends xp{constructor(t,e,i,r,s,o,a){super(),this.context_=t,this.pixelRatio_=e,this.extent_=i,this.transform_=r,this.transformRotation_=r?ga(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Pe()}drawImages_(t,e,i,r){if(!this.image_)return;const s=Vn(t,e,i,r,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,l=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=l*this.imageOpacity_);let c=this.imageRotation_;this.transformRotation_===0&&(c-=this.viewRotation_),this.imageRotateWithView_&&(c+=this.viewRotation_);for(let h=0,u=s.length;h<u;h+=2){const d=s[h]-this.imageAnchorX_,f=s[h+1]-this.imageAnchorY_;if(c!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const g=d+this.imageAnchorX_,y=f+this.imageAnchorY_;gn(a,g,y,1,1,c,-g,-y),o.save(),o.transform.apply(o,a),o.translate(g,y),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,d,f,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=l)}drawText_(t,e,i,r){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=Vn(t,e,i,r,this.transform_,this.pixelCoordinates_),o=this.context_;let a=this.textRotation_;for(this.transformRotation_===0&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);e<i;e+=r){const l=s[e]+this.textOffsetX_,c=s[e+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(l-this.textOffsetX_,c-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,l,c),this.textFillState_&&o.fillText(this.text_,l,c))}}moveToLineTo_(t,e,i,r,s){const o=this.context_,a=Vn(t,e,i,r,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);let l=a.length;s&&(l-=2);for(let c=2;c<l;c+=2)o.lineTo(a[c],a[c+1]);return s&&o.closePath(),i}drawRings_(t,e,i,r){for(let s=0,o=i.length;s<o;++s)e=this.moveToLineTo_(t,e,i[s],r,!0);return e}drawCircle(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Qt(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=tw(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],r=e[3]-e[1],s=Math.sqrt(i*i+r*r),o=this.context_;o.beginPath(),o.arc(e[0],e[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t);break}}drawFeature(t,e){const i=e.getGeometryFunction()(t);i&&(this.setStyle(e),this.drawGeometry(i))}drawGeometryCollection(t){const e=t.getGeometriesArray();for(let i=0,r=e.length;i<r;++i)this.drawGeometry(e[i])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),this.text_!==""&&this.drawText_(e,0,e.length,i)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),this.text_!==""&&this.drawText_(e,0,e.length,i)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Qt(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(this.text_!==""){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getExtent();if(Qt(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,r=t.getFlatCoordinates();let s=0;const o=t.getEnds(),a=t.getStride();i.beginPath();for(let l=0,c=o.length;l<c;++l)s=this.moveToLineTo_(r,s,o[l],a,!1);i.stroke()}if(this.text_!==""){const i=t.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Qt(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Qt(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getOrientedFlatCoordinates();let r=0;const s=t.getEndss(),o=t.getStride();e.beginPath();for(let a=0,l=s.length;a<l;++a){const c=s[a];r=this.drawRings_(i,r,c,o)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}}setContextFillState_(t){const e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,e.lineCap=t.lineCap),Qn(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const e=this.context_,i=this.contextTextState_,r=t.textAlign?t.textAlign:Es;i?(i.font!=t.font&&(i.font=t.font,e.font=t.font),i.textAlign!=r&&(i.textAlign=r,e.textAlign=r),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=r,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:r,textBaseline:t.textBaseline})}setFillStrokeStyle(t,e){if(!t)this.fillState_=null;else{const i=t.getColor();this.fillState_={fillStyle:Ue(i||Jt)}}if(!e)this.strokeState_=null;else{const i=e.getColor(),r=e.getLineCap(),s=e.getLineDash(),o=e.getLineDashOffset(),a=e.getLineJoin(),l=e.getWidth(),c=e.getMiterLimit(),h=s||hn;this.strokeState_={lineCap:r!==void 0?r:pr,lineDash:this.pixelRatio_===1?h:h.map(u=>u*this.pixelRatio_),lineDashOffset:(o||un)*this.pixelRatio_,lineJoin:a!==void 0?a:mr,lineWidth:(l!==void 0?l:xs)*this.pixelRatio_,miterLimit:c!==void 0?c:vs,strokeStyle:Ue(i||bs)}}}setImageStyle(t){let e;if(!t||!(e=t.getSize())){this.image_=null;return}const i=t.getPixelRatio(this.pixelRatio_),r=t.getAnchor(),s=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*i,this.imageAnchorY_=r[1]*i,this.imageHeight_=e[1]*i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const o=t.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=e[0]*i}setTextStyle(t){if(!t)this.text_="";else{const e=t.getFill();if(!e)this.textFillState_=null;else{const f=e.getColor();this.textFillState_={fillStyle:Ue(f||Jt)}}const i=t.getStroke();if(!i)this.textStrokeState_=null;else{const f=i.getColor(),g=i.getLineCap(),y=i.getLineDash(),_=i.getLineDashOffset(),b=i.getLineJoin(),S=i.getWidth(),R=i.getMiterLimit();this.textStrokeState_={lineCap:g!==void 0?g:pr,lineDash:y||hn,lineDashOffset:_||un,lineJoin:b!==void 0?b:mr,lineWidth:S!==void 0?S:xs,miterLimit:R!==void 0?R:vs,strokeStyle:Ue(f||bs)}}const r=t.getFont(),s=t.getOffsetX(),o=t.getOffsetY(),a=t.getRotateWithView(),l=t.getRotation(),c=t.getScaleArray(),h=t.getText(),u=t.getTextAlign(),d=t.getTextBaseline();this.textState_={font:r!==void 0?r:ap,textAlign:u!==void 0?u:Es,textBaseline:d!==void 0?d:Fo},this.text_=h!==void 0?Array.isArray(h)?h.reduce((f,g,y)=>f+=y%2?" ":g,""):h:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=a!==void 0?a:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*c[0],this.pixelRatio_*c[1]]}}}const Ge=.5;function n1(n,t,e,i,r,s,o,a,l){const c=l?Po(r,l):r,h=n[0]*Ge,u=n[1]*Ge,d=Rt(h,u);d.imageSmoothingEnabled=!1;const f=d.canvas,g=new e1(d,Ge,r,null,o,a,l?zs(Ao(),l):null),y=e.length,_=Math.floor((256*256*256-1)/y),b={};for(let R=1;R<=y;++R){const T=e[R-1],I=T.getStyleFunction()||i;if(!I)continue;let L=I(T,s);if(!L)continue;Array.isArray(L)||(L=[L]);const p=(R*_).toString(16).padStart(7,"#00000");for(let m=0,E=L.length;m<E;++m){const x=L[m],C=x.getGeometryFunction()(T);if(!C||!Qt(c,C.getExtent()))continue;const v=x.clone(),M=v.getFill();M&&M.setColor(p);const F=v.getStroke();F&&(F.setColor(p),F.setLineDash(null)),v.setText(void 0);const $=x.getImage();if($){const Z=$.getImageSize();if(!Z)continue;const lt=Rt(Z[0],Z[1],void 0,{alpha:!1}),k=lt.canvas;lt.fillStyle=p,lt.fillRect(0,0,k.width,k.height),v.setImage(new La({img:k,anchor:$.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:$.getOrigin(),opacity:1,size:$.getSize(),scale:$.getScale(),rotation:$.getRotation(),rotateWithView:$.getRotateWithView()}))}const D=v.getZIndex()||0;let N=b[D];N||(N={},b[D]=N,N.Polygon=[],N.Circle=[],N.LineString=[],N.Point=[]);const B=C.getType();if(B==="GeometryCollection"){const Z=C.getGeometriesArrayRecursive();for(let lt=0,k=Z.length;lt<k;++lt){const Nt=Z[lt];N[Nt.getType().replace("Multi","")].push(Nt,v)}}else N[B.replace("Multi","")].push(C,v)}}const S=Object.keys(b).map(Number).sort(ln);for(let R=0,T=S.length;R<T;++R){const I=b[S[R]];for(const L in I){const w=I[L];for(let p=0,m=w.length;p<m;p+=2){g.setStyle(w[p+1]);for(let E=0,x=t.length;E<x;++E)g.setTransform(t[E]),g.drawGeometry(w[p])}}}return d.getImageData(0,0,f.width,f.height)}function i1(n,t,e){const i=[];if(e){const r=Math.floor(Math.round(n[0])*Ge),s=Math.floor(Math.round(n[1])*Ge),o=(pt(r,0,e.width-1)+pt(s,0,e.height-1)*e.width)*4,a=e.data[o],l=e.data[o+1],h=e.data[o+2]+256*(l+256*a),u=Math.floor((256*256*256-1)/t.length);h&&h%u===0&&i.push(t[h/u-1])}return i}const r1=.5,Sp={Point:d1,LineString:c1,Polygon:g1,MultiPoint:f1,MultiLineString:h1,MultiPolygon:u1,GeometryCollection:l1,Circle:o1};function s1(n,t){return parseInt(nt(n),10)-parseInt(nt(t),10)}function Vd(n,t){const e=Tp(n,t);return e*e}function Tp(n,t){return r1*n/t}function o1(n,t,e,i,r){const s=e.getFill(),o=e.getStroke();if(s||o){const l=n.getBuilder(e.getZIndex(),"Circle");l.setFillStrokeStyle(s,o),l.drawCircle(t,i,r)}const a=e.getText();if(a&&a.getText()){const l=n.getBuilder(e.getZIndex(),"Text");l.setTextStyle(a),l.drawText(t,i)}}function zd(n,t,e,i,r,s,o,a){const l=[],c=e.getImage();if(c){let d=!0;const f=c.getImageState();f==K.LOADED||f==K.ERROR?d=!1:f==K.IDLE&&c.load(),d&&l.push(c.ready())}const h=e.getFill();h&&h.loading()&&l.push(h.ready());const u=l.length>0;return u&&Promise.all(l).then(()=>r(null)),a1(n,t,e,i,s,o,a),u}function a1(n,t,e,i,r,s,o){const a=e.getGeometryFunction()(t);if(!a)return;const l=a.simplifyTransformed(i,r);if(e.getRenderer())Ip(n,l,e,t,o);else{const h=Sp[l.getType()];h(n,l,e,t,o,s)}}function Ip(n,t,e,i,r){if(t.getType()=="GeometryCollection"){const o=t.getGeometries();for(let a=0,l=o.length;a<l;++a)Ip(n,o[a],e,i,r);return}n.getBuilder(e.getZIndex(),"Default").drawCustom(t,i,e.getRenderer(),e.getHitDetectionRenderer(),r)}function l1(n,t,e,i,r,s){const o=t.getGeometriesArray();let a,l;for(a=0,l=o.length;a<l;++a){const c=Sp[o[a].getType()];c(n,o[a],e,i,r,s)}}function c1(n,t,e,i,r){const s=e.getStroke();if(s){const a=n.getBuilder(e.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawLineString(t,i,r)}const o=e.getText();if(o&&o.getText()){const a=n.getBuilder(e.getZIndex(),"Text");a.setTextStyle(o),a.drawText(t,i,r)}}function h1(n,t,e,i,r){const s=e.getStroke();if(s){const a=n.getBuilder(e.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawMultiLineString(t,i,r)}const o=e.getText();if(o&&o.getText()){const a=n.getBuilder(e.getZIndex(),"Text");a.setTextStyle(o),a.drawText(t,i,r)}}function u1(n,t,e,i,r){const s=e.getFill(),o=e.getStroke();if(o||s){const l=n.getBuilder(e.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawMultiPolygon(t,i,r)}const a=e.getText();if(a&&a.getText()){const l=n.getBuilder(e.getZIndex(),"Text");l.setTextStyle(a),l.drawText(t,i,r)}}function d1(n,t,e,i,r,s){const o=e.getImage(),a=e.getText(),l=a&&a.getText(),c=s&&o&&l?{}:void 0;if(o){if(o.getImageState()!=K.LOADED)return;const h=n.getBuilder(e.getZIndex(),"Image");h.setImageStyle(o,c),h.drawPoint(t,i,r)}if(l){const h=n.getBuilder(e.getZIndex(),"Text");h.setTextStyle(a,c),h.drawText(t,i,r)}}function f1(n,t,e,i,r,s){const o=e.getImage(),a=o&&o.getOpacity()!==0,l=e.getText(),c=l&&l.getText(),h=s&&a&&c?{}:void 0;if(a){if(o.getImageState()!=K.LOADED)return;const u=n.getBuilder(e.getZIndex(),"Image");u.setImageStyle(o,h),u.drawMultiPoint(t,i,r)}if(c){const u=n.getBuilder(e.getZIndex(),"Text");u.setTextStyle(l,h),u.drawText(t,i,r)}}function g1(n,t,e,i,r){const s=e.getFill(),o=e.getStroke();if(s||o){const l=n.getBuilder(e.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawPolygon(t,i,r)}const a=e.getText();if(a&&a.getText()){const l=n.getBuilder(e.getZIndex(),"Text");l.setTextStyle(a),l.drawText(t,i,r)}}class p1 extends Ep{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Ce(),this.wrappedRenderedExtent_=Ce(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(t,e,i){const r=e.extent,s=e.viewState,o=s.center,a=s.resolution,l=s.projection,c=s.rotation,h=l.getExtent(),u=this.getLayer().getSource(),d=this.getLayer().getDeclutter(),f=e.pixelRatio,g=e.viewHints,y=!(g[Bt.ANIMATING]||g[Bt.INTERACTING]),_=this.context,b=Math.round(at(r)/a*f),S=Math.round(Ht(r)/a*f),R=u.getWrapX()&&l.canWrapX(),T=R?at(h):null,I=R?Math.ceil((r[2]-h[2])/T)+1:1;let L=R?Math.floor((r[0]-h[0])/T):0;do{let w=this.getRenderTransform(o,a,0,f,b,S,L*T);e.declutter&&(w=w.slice(0)),t.execute(_,[_.canvas.width,_.canvas.height],w,c,y,i===void 0?ui:i?Cp:Jb,i?d&&e.declutter[d]:void 0)}while(++L<I)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=Rt(this.context.canvas.width,this.context.canvas.height,kd))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const t=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=t,Ta(this.context),kd.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(t){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,t,!0)}renderDeferredInternal(t){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(t,e){const i=t.layerStatesArray[t.layerIndex];this.opacity_=i.opacity;const r=t.viewState;this.prepareContainer(t,e);const s=this.context,o=this.replayGroup_;let a=o&&!o.isEmpty();if(!a&&!(this.getLayer().hasListener(ve.PRERENDER)||this.getLayer().hasListener(ve.POSTRENDER)))return this.container;this.setDrawContext_(),this.preRender(s,t);const l=r.projection;if(this.clipped_=!1,a&&i.extent&&this.clipping){const c=Dn(i.extent,l);a=Qt(c,t.extent),this.clipped_=a&&!Kr(c,t.extent),this.clipped_&&this.clipUnrotated(s,t,c)}return a&&this.renderWorlds(o,t,this.getLayer().getDeclutter()?!1:void 0),!t.declutter&&this.clipped_&&s.restore(),this.postRender(s,t),this.renderedRotation_!==r.rotation&&(this.renderedRotation_=r.rotation,this.hitDetectionImageData_=null),t.declutter||this.resetDrawContext_(),this.container}getFeatures(t){return new Promise(e=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=this.frameState.size.slice(),r=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,l=this.wrappedRenderedExtent_,c=this.getLayer(),h=[],u=i[0]*Ge,d=i[1]*Ge;h.push(this.getRenderTransform(r,s,o,Ge,u,d,0).slice());const f=c.getSource(),g=a.getExtent();if(f.getWrapX()&&a.canWrapX()&&!Kr(g,l)){let _=l[0];const b=at(g);let S=0,R;for(;_<g[0];)--S,R=b*S,h.push(this.getRenderTransform(r,s,o,Ge,u,d,R).slice()),_+=b;for(S=0,_=l[2];_>g[2];)++S,R=b*S,h.push(this.getRenderTransform(r,s,o,Ge,u,d,R).slice()),_-=b}const y=Ao();this.hitDetectionImageData_=n1(i,h,this.renderedFeatures_,c.getStyleFunction(),l,s,o,Vd(s,this.renderedPixelRatio_),y?a:null)}e(i1(t,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(t,e,i,r,s){if(!this.replayGroup_)return;const o=e.viewState.resolution,a=e.viewState.rotation,l=this.getLayer(),c={},h=function(d,f,g){const y=nt(d),_=c[y];if(_){if(_!==!0&&g<_.distanceSq){if(g===0)return c[y]=!0,s.splice(s.lastIndexOf(_),1),r(d,l,f);_.geometry=f,_.distanceSq=g}}else{if(g===0)return c[y]=!0,r(d,l,f);s.push(c[y]={feature:d,layer:l,geometry:f,distanceSq:g,callback:r})}},u=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(t,o,a,i,h,u?e.declutter?.[u]?.all().map(d=>d.value):null)}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}prepareFrame(t){const e=this.getLayer(),i=e.getSource();if(!i)return!1;const r=t.viewHints[Bt.ANIMATING],s=t.viewHints[Bt.INTERACTING],o=e.getUpdateWhileAnimating(),a=e.getUpdateWhileInteracting();if(this.ready&&!o&&r||!a&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=t.extent,c=t.viewState,h=c.projection,u=c.resolution,d=t.pixelRatio,f=e.getRevision(),g=e.getRenderBuffer();let y=e.getRenderOrder();y===void 0&&(y=s1);const _=c.center.slice(),b=th(l,g*u),S=b.slice(),R=[b.slice()],T=h.getExtent();if(i.getWrapX()&&h.canWrapX()&&!Kr(T,t.extent)){const F=at(T),$=Math.max(at(b)/2,F);b[0]=T[0]-$,b[2]=T[2]+$,pg(_,h);const D=ug(R[0],h);D[0]<T[0]&&D[2]<T[2]?R.push([D[0]+F,D[1],D[2]+F,D[3]]):D[0]>T[0]&&D[2]>T[2]&&R.push([D[0]-F,D[1],D[2]-F,D[3]])}if(this.ready&&this.renderedResolution_==u&&this.renderedRevision_==f&&this.renderedRenderOrder_==y&&this.renderedFrameDeclutter_===!!t.declutter&&Kr(this.wrappedRenderedExtent_,b))return Qn(this.renderedExtent_,S)||(this.hitDetectionImageData_=null,this.renderedExtent_=S),this.renderedCenter_=_,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const I=new Hb(Tp(u,d),b,u,d),L=Ao();let w;if(L){for(let F=0,$=R.length;F<$;++F){const D=R[F],N=Po(D,h);i.loadFeatures(N,jy(u,h),L)}w=zs(L,h)}else for(let F=0,$=R.length;F<$;++F)i.loadFeatures(R[F],u,h);const p=Vd(u,d);let m=!0;const E=(F,$)=>{let D;const N=F.getStyleFunction()||e.getStyleFunction();if(N&&(D=N(F,u)),D){const B=this.renderFeature(F,p,D,I,w,this.getLayer().getDeclutter(),$);m=m&&!B}},x=Po(b,h),C=i.getFeaturesInExtent(x);y&&C.sort(y);for(let F=0,$=C.length;F<$;++F)E(C[F],F);this.renderedFeatures_=C,this.ready=m;const v=I.finish(),M=new Qb(b,u,d,i.getOverlaps(),v,e.getRenderBuffer(),!!t.declutter);return this.renderedResolution_=u,this.renderedRevision_=f,this.renderedRenderOrder_=y,this.renderedFrameDeclutter_=!!t.declutter,this.renderedExtent_=S,this.wrappedRenderedExtent_=b,this.renderedCenter_=_,this.renderedProjection_=h,this.renderedPixelRatio_=d,this.replayGroup_=M,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(t,e,i,r,s,o,a){if(!i)return!1;let l=!1;if(Array.isArray(i))for(let c=0,h=i.length;c<h;++c)l=zd(r,t,i[c],e,this.boundHandleStyleImageChange_,s,o,a)||l;else l=zd(r,t,i,e,this.boundHandleStyleImageChange_,s,o,a);return l}}class Gd extends pp{constructor(t){super(t)}createRenderer(){return new p1(this)}}let m1=!1;function _1(n,t,e,i,r,s,o){const a=new XMLHttpRequest;a.open("GET",typeof n=="function"?n(e,i,r):n,!0),t.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=m1,a.onload=function(l){if(!a.status||a.status>=200&&a.status<300){const c=t.getType();try{let h;c=="text"||c=="json"?h=a.responseText:c=="xml"?h=a.responseXML||a.responseText:c=="arraybuffer"&&(h=a.response),h?s(t.readFeatures(h,{extent:e,featureProjection:r}),t.readProjection(h)):o()}catch{o()}}else o()},a.onerror=o,a.send()}function Bd(n,t){return function(e,i,r,s,o){_1(n,t,e,i,r,(a,l)=>{this.addFeatures(a),s!==void 0&&s(a)},()=>{this.changed(),o!==void 0&&o()})}}function y1(n,t){return[[-1/0,-1/0,1/0,1/0]]}class vi extends Ke{constructor(t){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t)if(typeof t.getSimplifiedGeometry=="function"){const e=t;this.setGeometry(e)}else{const e=t;this.setProperties(e)}}clone(){const t=new vi(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());const e=this.getGeometry();e&&t.setGeometry(e.clone());const i=this.getStyle();return i&&t.setStyle(i),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(ut(this.geometryChangeKey_),this.geometryChangeKey_=null);const t=this.getGeometry();t&&(this.geometryChangeKey_=et(t,H.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?w1(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function w1(n){if(typeof n=="function")return n;let t;return Array.isArray(n)?t=n:(rt(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),t=[n]),function(){return t}}function Rp(n,t,e,i){const r=[];let s=Ce();for(let o=0,a=e.length;o<a;++o){const l=e[o];s=nh(n,t,l[0],i),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),t=l[l.length-1]}return r}function Go(n,t,e,i,r,s,o){let a,l;const c=(e-t)/i;if(c===1)a=t;else if(c===2)a=t,l=r;else if(c!==0){let h=n[t],u=n[t+1],d=0;const f=[0];for(let _=t+i;_<e;_+=i){const b=n[_],S=n[_+1];d+=Math.sqrt((b-h)*(b-h)+(S-u)*(S-u)),f.push(d),h=b,u=S}const g=r*d,y=K_(f,g);y<0?(l=(g-f[-y-2])/(f[-y-1]-f[-y-2]),a=t+(-y-2)*i):a=t+y*i}o=o>1?o:2,s=s||new Array(o);for(let h=0;h<o;++h)s[h]=a===void 0?NaN:l===void 0?n[a+h]:oe(n[a+h],n[a+i+h],l);return s}function wc(n,t,e,i,r,s){if(e==t)return null;let o;if(r<n[t+i-1])return s?(o=n.slice(t,t+i),o[i-1]=r,o):null;if(n[e-1]<r)return s?(o=n.slice(e-i,e),o[i-1]=r,o):null;if(r==n[t+i-1])return n.slice(t,t+i);let a=t/i,l=e/i;for(;a<l;){const d=a+l>>1;r<n[(d+1)*i-1]?l=d:a=d+1}const c=n[a*i-1];if(r==c)return n.slice((a-1)*i,(a-1)*i+i);const h=n[(a+1)*i-1],u=(r-c)/(h-c);o=[];for(let d=0;d<i-1;++d)o.push(oe(n[(a-1)*i+d],n[a*i+d],u));return o.push(r),o}function v1(n,t,e,i,r,s,o){if(o)return wc(n,t,e[e.length-1],i,r,s);let a;if(r<n[i-1])return s?(a=n.slice(0,i),a[i-1]=r,a):null;if(n[n.length-1]<r)return s?(a=n.slice(n.length-i),a[i-1]=r,a):null;for(let l=0,c=e.length;l<c;++l){const h=e[l];if(t!=h){if(r<n[t+i-1])return null;if(r<=n[h-1])return wc(n,t,h,i,r,!1);t=h}}return null}class Bo extends Cg{constructor(t){super(),this.geometries_=t,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(ut),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const t=this.geometries_;for(let e=0,i=t.length;e<i;++e)this.changeEventsKeys_.push(et(t[e],H.CHANGE,this.changed,this))}clone(){const t=new Bo(kl(this.geometries_));return t.applyProperties(this),t}closestPointXY(t,e,i,r){if(r<Ai(this.getExtent(),t,e))return r;const s=this.geometries_;for(let o=0,a=s.length;o<a;++o)r=s[o].closestPointXY(t,e,i,r);return r}containsXY(t,e){const i=this.geometries_;for(let r=0,s=i.length;r<s;++r)if(i[r].containsXY(t,e))return!0;return!1}computeExtent(t){Ir(t);const e=this.geometries_;for(let i=0,r=e.length;i<r;++i)ag(t,e[i].getExtent());return t}getGeometries(){return kl(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let t=[];const e=this.geometries_;for(let i=0,r=e.length;i<r;++i)e[i].getType()===this.getType()?t=t.concat(e[i].getGeometriesArrayRecursive()):t.push(e[i]);return t}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=[],i=this.geometries_;let r=!1;for(let s=0,o=i.length;s<o;++s){const a=i[s],l=a.getSimplifiedGeometry(t);e.push(l),l!==a&&(r=!0)}return r?new Bo(e):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getType(){return"GeometryCollection"}intersectsExtent(t){const e=this.geometries_;for(let i=0,r=e.length;i<r;++i)if(e[i].intersectsExtent(t))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(t,e){const i=this.geometries_;for(let r=0,s=i.length;r<s;++r)i[r].rotate(t,e);this.changed()}scale(t,e,i){i||(i=fn(this.getExtent()));const r=this.geometries_;for(let s=0,o=r.length;s<o;++s)r[s].scale(t,e,i);this.changed()}setGeometries(t){this.setGeometriesArray(kl(t))}setGeometriesArray(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()}applyTransform(t){const e=this.geometries_;for(let i=0,r=e.length;i<r;++i)e[i].applyTransform(t);this.changed()}translate(t,e){const i=this.geometries_;for(let r=0,s=i.length;r<s;++r)i[r].translate(t,e);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function kl(n){return n.map(t=>t.clone())}class Si extends Li{constructor(t,e){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendCoordinate(t){je(this.flatCoordinates,t),this.changed()}clone(){const t=new Si(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,r){return r<Ai(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(hh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),dh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,r))}forEachSegment(t){return Pg(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinateAtM(t,e){return this.layout!="XYM"&&this.layout!="XYZM"?null:(e=e!==void 0?e:!1,wc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e))}getCoordinates(){return Mn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(t,e){return Go(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}getLength(){return Uh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(t){const e=[];return e.length=Ea(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new Si(e,"XY")}getType(){return"LineString"}intersectsExtent(t){return xa(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,this.getExtent())}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ba(this.flatCoordinates,0,t,this.stride),this.changed()}}class Uo extends Li{constructor(t,e,i){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(t[0]))this.setCoordinates(t,e);else if(e!==void 0&&i)this.setFlatCoordinates(e,t),this.ends_=i;else{const r=t,s=[],o=[];for(let l=0,c=r.length;l<c;++l){const h=r[l];je(s,h.getFlatCoordinates()),o.push(s.length)}const a=r.length===0?this.getLayout():r[0].getLayout();this.setFlatCoordinates(a,s),this.ends_=o}}appendLineString(t){je(this.flatCoordinates,t.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new Uo(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,r){return r<Ai(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(uh(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),fh(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,i,r))}getCoordinateAtM(t,e,i){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(e=e!==void 0?e:!1,i=i!==void 0?i:!1,v1(this.flatCoordinates,0,this.ends_,this.stride,t,e,i))}getCoordinates(){return ms(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(t){return t<0||this.ends_.length<=t?null:new Si(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLineStrings(){const t=this.flatCoordinates,e=this.ends_,i=this.layout,r=[];let s=0;for(let o=0,a=e.length;o<a;++o){const l=e[o],c=new Si(t.slice(s,l),i);r.push(c),s=l}return r}getLength(){const t=this.ends_;let e=0,i=0;for(let r=0,s=t.length;r<s;++r)i+=Uh(this.flatCoordinates,e,t[r],this.stride),e=t[r];return i}getFlatMidpoints(){const t=[],e=this.flatCoordinates;let i=0;const r=this.ends_,s=this.stride;for(let o=0,a=r.length;o<a;++o){const l=r[o],c=Go(e,i,l,s,.5);je(t,c),i=l}return t}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=Rg(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,i),new Uo(e,"XY",i)}getType(){return"MultiLineString"}intersectsExtent(t){return cw(this.flatCoordinates,0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=Gs(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}class Ma extends Li{constructor(t,e){super(),e&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendPoint(t){je(this.flatCoordinates,t.getFlatCoordinates()),this.changed()}clone(){const t=new Ma(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,r){if(r<Ai(this.getExtent(),t,e))return r;const s=this.flatCoordinates,o=this.stride;for(let a=0,l=s.length;a<l;a+=o){const c=yi(t,e,s[a],s[a+1]);if(c<r){r=c;for(let h=0;h<o;++h)i[h]=s[a+h];i.length=o}}return r}getCoordinates(){return Mn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(t){const e=this.flatCoordinates.length/this.stride;return t<0||e<=t?null:new cn(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}getPoints(){const t=this.flatCoordinates,e=this.layout,i=this.stride,r=[];for(let s=0,o=t.length;s<o;s+=i){const a=new cn(t.slice(s,s+i),e);r.push(a)}return r}getType(){return"MultiPoint"}intersectsExtent(t){const e=this.flatCoordinates,i=this.stride;for(let r=0,s=e.length;r<s;r+=i){const o=e[r],a=e[r+1];if(eh(t,o,a))return!0}return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ba(this.flatCoordinates,0,t,this.stride),this.changed()}}class jo extends Li{constructor(t,e,i){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!i&&!Array.isArray(t[0])){const r=t,s=[],o=[];for(let a=0,l=r.length;a<l;++a){const c=r[a],h=s.length,u=c.getEnds();for(let d=0,f=u.length;d<f;++d)u[d]+=h;je(s,c.getFlatCoordinates()),o.push(u)}e=r.length===0?this.getLayout():r[0].getLayout(),t=s,i=o}e!==void 0&&i?(this.setFlatCoordinates(e,t),this.endss_=i):this.setCoordinates(t,e)}appendPolygon(t){let e;if(!this.flatCoordinates)this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();else{const i=this.flatCoordinates.length;je(this.flatCoordinates,t.getFlatCoordinates()),e=t.getEnds().slice();for(let r=0,s=e.length;r<s;++r)e[r]+=i}this.endss_.push(e),this.changed()}clone(){const t=this.endss_.length,e=new Array(t);for(let r=0;r<t;++r)e[r]=this.endss_[r].slice();const i=new jo(this.flatCoordinates.slice(),this.layout,e);return i.applyProperties(this),i}closestPointXY(t,e,i,r){return r<Ai(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(nw(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),iw(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,i,r))}containsXY(t,e){return lw(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)}getArea(){return ew(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),sc(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,rc(e,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const t=Rp(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=Ag(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new Ma(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;kg(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=sc(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=ow(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,i),new jo(e,"XY",i)}getPolygon(t){if(t<0||this.endss_.length<=t)return null;let e;if(t===0)e=0;else{const s=this.endss_[t-1];e=s[s.length-1]}const i=this.endss_[t].slice(),r=i[i.length-1];if(e!==0)for(let s=0,o=i.length;s<o;++s)i[s]-=e;return new jn(this.flatCoordinates.slice(e,r),this.layout,i)}getPolygons(){const t=this.layout,e=this.flatCoordinates,i=this.endss_,r=[];let s=0;for(let o=0,a=i.length;o<a;++o){const l=i[o].slice(),c=l[l.length-1];if(s!==0)for(let u=0,d=l.length;u<d;++u)l[u]-=s;const h=new jn(e.slice(s,c),t,l);r.push(h),s=c}return r}getType(){return"MultiPolygon"}intersectsExtent(t){return hw(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);const i=Ig(this.flatCoordinates,0,t,this.stride,this.endss_);if(i.length===0)this.flatCoordinates.length=0;else{const r=i[i.length-1];this.flatCoordinates.length=r.length===0?0:r[r.length-1]}this.changed()}}const Ud=Pe();class ae{constructor(t,e,i,r,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=t,this.flatCoordinates_=e,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=s,this.squaredTolerance_,this.stride_=r,this.simplifiedGeometry_}get(t){return this.properties_[t]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?og(this.flatCoordinates_):nh(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const t=fn(this.getExtent());this.flatInteriorPoints_=mh(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const t=dw(this.flatCoordinates_,this.ends_),e=Rp(this.flatCoordinates_,0,t,2);this.flatInteriorPoints_=Ag(this.flatCoordinates_,0,t,2,e)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=Go(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const t=this.flatCoordinates_;let e=0;const i=this.ends_;for(let r=0,s=i.length;r<s;++r){const o=i[r],a=Go(t,e,o,2,.5);je(this.flatMidpoints_,a),e=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(t){return this}simplifyTransformed(t,e){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(t){t=dt(t);const e=t.getExtent(),i=t.getWorldExtent();if(e&&i){const r=Ht(i)/Ht(e);gn(Ud,i[0],i[3],r,-r,0,0,0),Vn(this.flatCoordinates_,0,this.flatCoordinates_.length,2,Ud,this.flatCoordinates_)}}applyTransform(t){t(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new ae(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=fg((t,e)=>{if(t===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),e&&this.simplifiedGeometry_.applyTransform(e);const i=this.simplifiedGeometry_.getFlatCoordinates();let r;switch(this.type_){case"LineString":i.length=Ea(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,t,i,0),r=[i.length];break;case"MultiLineString":r=[],i.length=Rg(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,t,i,0,r);break;case"Polygon":r=[],i.length=gh(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(t),i,0,r);break}return r&&(this.simplifiedGeometry_=new ae(this.type_,i,r,2,this.properties_,this.id_)),this.squaredTolerance_=t,this.simplifiedGeometry_}),this}}ae.prototype.getFlatCoordinates=ae.prototype.getOrientedFlatCoordinates;class jd{constructor(t){this.rbush_=new Xf(t),this.items_={}}insert(t,e){const i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[nt(e)]=i}load(t,e){const i=new Array(e.length);for(let r=0,s=e.length;r<s;r++){const o=t[r],a=e[r],l={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};i[r]=l,this.items_[nt(a)]=l}this.rbush_.load(i)}remove(t){const e=nt(t),i=this.items_[e];return delete this.items_[e],this.rbush_.remove(i)!==null}update(t,e){const i=this.items_[nt(e)],r=[i.minX,i.minY,i.maxX,i.maxY];ds(r,t)||(this.remove(e),this.insert(t,e))}getAll(){return this.rbush_.all().map(function(e){return e.value})}getInExtent(t){const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map(function(r){return r.value})}forEach(t){return this.forEach_(this.getAll(),t)}forEachInExtent(t,e){return this.forEach_(this.getInExtent(t),e)}forEach_(t,e){let i;for(let r=0,s=t.length;r<s;r++)if(i=e(t[r]),i)return i;return i}isEmpty(){return bi(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(t){const e=this.rbush_.toJSON();return dn(e.minX,e.minY,e.maxX,e.maxY,t)}concat(t){this.rbush_.load(t.rbush_.all());for(const e in t.items_)this.items_[e]=t.items_[e]}}class Ap extends Ke{constructor(t){super(),this.projection=dt(t.projection),this.attributions_=Wd(t.attributions),this.attributionsCollapsible_=t.attributionsCollapsible??!0,this.loading=!1,this.state_=t.state!==void 0?t.state:"ready",this.wrapX_=t.wrapX!==void 0?t.wrapX:!1,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;const e=this;this.viewPromise_=new Promise(function(i,r){e.viewResolver=i,e.viewRejector=r})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(t){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=Wd(t),this.changed()}setState(t){this.state_=t,this.changed()}}function Wd(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),t=>n):null}const me={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class Sn extends yn{constructor(t,e,i){super(t),this.feature=e,this.features=i}}class qd extends Ap{constructor(t){t=t||{},super({attributions:t.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:t.wrapX!==void 0?t.wrapX:!0}),this.on,this.once,this.un,this.loader_=gs,this.format_=t.format||null,this.overlaps_=t.overlaps===void 0?!0:t.overlaps,this.url_=t.url,t.loader!==void 0?this.loader_=t.loader:this.url_!==void 0&&(rt(this.format_,"`format` must be set when `url` is set"),this.loader_=Bd(this.url_,this.format_)),this.strategy_=t.strategy!==void 0?t.strategy:y1;const e=t.useSpatialIndex!==void 0?t.useSpatialIndex:!0;this.featuresRtree_=e?new jd:null,this.loadedExtentsRtree_=new jd,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,r;Array.isArray(t.features)?r=t.features:t.features&&(i=t.features,r=i.getArray()),!e&&i===void 0&&(i=new we(r)),r!==void 0&&this.addFeaturesInternal(r),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(t){this.addFeatureInternal(t),this.changed()}addFeatureInternal(t){const e=nt(t);if(!this.addToIndex_(e,t)){this.featuresCollection_&&this.featuresCollection_.remove(t);return}this.setupChangeEvents_(e,t);const i=t.getGeometry();if(i){const r=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new Sn(me.ADDFEATURE,t))}setupChangeEvents_(t,e){e instanceof ae||(this.featureChangeKeys_[t]=[et(e,H.CHANGE,this.handleFeatureChange_,this),et(e,hr.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(t,e){let i=!0;if(e.getId()!==void 0){const r=String(e.getId());if(!(r in this.idIndex_))this.idIndex_[r]=e;else if(e instanceof ae){const s=this.idIndex_[r];s instanceof ae?Array.isArray(s)?s.push(e):this.idIndex_[r]=[s,e]:i=!1}else i=!1}return i&&(rt(!(t in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[t]=e),i}addFeatures(t){this.addFeaturesInternal(t),this.changed()}addFeaturesInternal(t){const e=[],i=[],r=[];for(let s=0,o=t.length;s<o;s++){const a=t[s],l=nt(a);this.addToIndex_(l,a)&&i.push(a)}for(let s=0,o=i.length;s<o;s++){const a=i[s],l=nt(a);this.setupChangeEvents_(l,a);const c=a.getGeometry();if(c){const h=c.getExtent();e.push(h),r.push(a)}else this.nullGeometryFeatures_[l]=a}if(this.featuresRtree_&&this.featuresRtree_.load(e,r),this.hasListener(me.ADDFEATURE))for(let s=0,o=i.length;s<o;s++)this.dispatchEvent(new Sn(me.ADDFEATURE,i[s]))}bindFeaturesCollection_(t){let e=!1;this.addEventListener(me.ADDFEATURE,function(i){e||(e=!0,t.push(i.feature),e=!1)}),this.addEventListener(me.REMOVEFEATURE,function(i){e||(e=!0,t.remove(i.feature),e=!1)}),t.addEventListener(Yt.ADD,i=>{e||(e=!0,this.addFeature(i.element),e=!1)}),t.addEventListener(Yt.REMOVE,i=>{e||(e=!0,this.removeFeature(i.element),e=!1)}),this.featuresCollection_=t}clear(t){if(t){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(ut);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(i=>{this.removeFeatureInternal(i)});for(const i in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const e=new Sn(me.CLEAR);this.dispatchEvent(e),this.changed()}forEachFeature(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureAtCoordinateDirect(t,e){const i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,function(r){const s=r.getGeometry();if(s instanceof ae||s.intersectsCoordinate(t))return e(r)})}forEachFeatureInExtent(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureIntersectingExtent(t,e){return this.forEachFeatureInExtent(t,function(i){const r=i.getGeometry();if(r instanceof ae||r.intersectsExtent(t)){const s=e(i);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),bi(this.nullGeometryFeatures_)||je(t,Object.values(this.nullGeometryFeatures_))),t}getFeaturesAtCoordinate(t){const e=[];return this.forEachFeatureAtCoordinateDirect(t,function(i){e.push(i)}),e}getFeaturesInExtent(t,e){if(this.featuresRtree_){if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);const r=dg(t,e);return[].concat(...r.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(t,e){const i=t[0],r=t[1];let s=null;const o=[NaN,NaN];let a=1/0;const l=[-1/0,-1/0,1/0,1/0];return e=e||fs,this.featuresRtree_.forEachInExtent(l,function(c){if(e(c)){const h=c.getGeometry(),u=a;if(a=h instanceof ae?0:h.closestPointXY(i,r,o,a),a<u){s=c;const d=Math.sqrt(a);l[0]=i-d,l[1]=r-d,l[2]=i+d,l[3]=r+d}}}),s}getExtent(t){return this.featuresRtree_.getExtent(t)}getFeatureById(t){const e=this.idIndex_[t.toString()];return e!==void 0?e:null}getFeatureByUid(t){const e=this.uidIndex_[t];return e!==void 0?e:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(t){const e=t.target,i=nt(e),r=e.getGeometry();if(!r)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);else{const o=r.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,e)):this.featuresRtree_&&this.featuresRtree_.update(o,e)}const s=e.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[o]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[i]=e;this.changed(),this.dispatchEvent(new Sn(me.CHANGEFEATURE,e))}hasFeature(t){const e=t.getId();return e!==void 0?e in this.idIndex_:nt(t)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&bi(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(t,e,i){const r=this.loadedExtentsRtree_,s=this.strategy_(t,e,i);for(let o=0,a=s.length;o<a;++o){const l=s[o];r.forEachInExtent(l,function(h){return Kr(h.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new Sn(me.FEATURESLOADSTART)),this.loader_.call(this,l,e,i,h=>{--this.loadingExtentsCount_,this.dispatchEvent(new Sn(me.FEATURESLOADEND,void 0,h))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Sn(me.FEATURESLOADERROR))}),r.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(t){const e=this.loadedExtentsRtree_,i=e.forEachInExtent(t,function(r){if(ds(r.extent,t))return r});i&&e.remove(i)}removeFeatures(t){let e=!1;for(let i=0,r=t.length;i<r;++i)e=this.removeFeatureInternal(t[i])||e;e&&this.changed()}removeFeature(t){if(!t)return;this.removeFeatureInternal(t)&&this.changed()}removeFeatureInternal(t){const e=nt(t);if(!(e in this.uidIndex_))return!1;e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.featureChangeKeys_[e]?.forEach(ut),delete this.featureChangeKeys_[e];const r=t.getId();if(r!==void 0){const s=r.toString(),o=this.idIndex_[s];o===t?delete this.idIndex_[s]:Array.isArray(o)&&(o.splice(o.indexOf(t),1),o.length===1&&(this.idIndex_[s]=o[0]))}return delete this.uidIndex_[e],this.hasListener(me.REMOVEFEATURE)&&this.dispatchEvent(new Sn(me.REMOVEFEATURE,t)),!0}removeFromIdIndex_(t){for(const e in this.idIndex_)if(this.idIndex_[e]===t){delete this.idIndex_[e];break}}setLoader(t){this.loader_=t}setUrl(t){rt(this.format_,"`format` must be set when `url` is set"),this.url_=t,this.setLoader(Bd(t,this.format_))}setOverlaps(t){this.overlaps_=t,this.changed()}}class b1{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=vi,this.supportedMediaTypes=null}getReadOptions(t,e){if(e){let i=e.dataProjection?dt(e.dataProjection):this.readProjection(t);e.extent&&i&&i.getUnits()==="tile-pixels"&&(i=dt(i),i.setWorldExtent(e.extent)),e={dataProjection:i,featureProjection:e.featureProjection}}return this.adaptOptions(e)}adaptOptions(t){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},t)}getType(){return W()}readFeature(t,e){return W()}readFeatures(t,e){return W()}readGeometry(t,e){return W()}readProjection(t){return W()}writeFeature(t,e){return W()}writeFeatures(t,e){return W()}writeGeometry(t,e){return W()}}function jh(n,t,e){const i=e?dt(e.featureProjection):null,r=e?dt(e.dataProjection):null;let s=n;if(i&&r&&!rs(i,r)){t&&(s=n.clone());const o=t?i:r,a=t?r:i;o.getUnits()==="tile-pixels"?s.transform(o,a):s.applyTransform(dr(o,a))}if(t&&e&&e.decimals!==void 0){const o=Math.pow(10,e.decimals),a=function(l){for(let c=0,h=l.length;c<h;++c)l[c]=Math.round(l[c]*o)/o;return l};s===n&&(s=n.clone()),s.applyTransform(a)}return s}const E1={Point:cn,LineString:Si,Polygon:jn,MultiPoint:Ma,MultiLineString:Uo,MultiPolygon:jo};function x1(n,t,e){return Array.isArray(t[0])?(kg(n,0,t,e)||(n=n.slice(),sc(n,0,t,e)),n):(yh(n,0,t,e)||(n=n.slice(),Lo(n,0,t,e)),n)}function Pp(n,t){const e=n.geometry;if(!e)return[];if(Array.isArray(e))return e.map(s=>Pp({...n,geometry:s})).flat();const i=e.type==="MultiPolygon"?"Polygon":e.type;if(i==="GeometryCollection"||i==="Circle")throw new Error("Unsupported geometry type: "+i);const r=e.layout.length;return jh(new ae(i,i==="Polygon"?x1(e.flatCoordinates,e.ends,r):e.flatCoordinates,e.ends?.flat(),r,n.properties||{},n.id).enableSimplifyTransformed(),!1,t)}function Wh(n,t){if(!n)return null;if(Array.isArray(n)){const i=n.map(r=>Wh(r,t));return new Bo(i)}const e=E1[n.type];return jh(new e(n.flatCoordinates,n.layout||"XY",n.ends),!1,t)}class C1 extends b1{constructor(){super()}getType(){return"json"}readFeature(t,e){return this.readFeatureFromObject(fo(t),this.getReadOptions(t,e))}readFeatures(t,e){return this.readFeaturesFromObject(fo(t),this.getReadOptions(t,e))}readFeatureFromObject(t,e){return W()}readFeaturesFromObject(t,e){return W()}readGeometry(t,e){return this.readGeometryFromObject(fo(t),this.getReadOptions(t,e))}readGeometryFromObject(t,e){return W()}readProjection(t){return this.readProjectionFromObject(fo(t))}readProjectionFromObject(t){return W()}writeFeature(t,e){return JSON.stringify(this.writeFeatureObject(t,e))}writeFeatureObject(t,e){return W()}writeFeatures(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))}writeFeaturesObject(t,e){return W()}writeGeometry(t,e){return JSON.stringify(this.writeGeometryObject(t,e))}writeGeometryObject(t,e){return W()}}function fo(n){if(typeof n=="string"){const t=JSON.parse(n);return t||null}return n!==null?n:null}class S1 extends C1{constructor(t){t=t||{},super(),this.dataProjection=dt(t.dataProjection?t.dataProjection:"EPSG:4326"),t.featureProjection&&(this.defaultFeatureProjection=dt(t.featureProjection)),t.featureClass&&(this.featureClass=t.featureClass),this.geometryName_=t.geometryName,this.extractGeometryName_=t.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(t,e){let i=null;t.type==="Feature"?i=t:i={type:"Feature",geometry:t,properties:null};const r=qh(i.geometry);if(this.featureClass===ae)return Pp({geometry:r,id:i.id,properties:i.properties},e);const s=new vi;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&i.geometry_name&&s.setGeometryName(i.geometry_name),s.setGeometry(Wh(r,e)),"id"in i&&s.setId(i.id),i.properties&&s.setProperties(i.properties,!0),s}readFeaturesFromObject(t,e){const i=t;let r=null;if(i.type==="FeatureCollection"){const s=t;r=[];const o=s.features;for(let a=0,l=o.length;a<l;++a){const c=this.readFeatureFromObject(o[a],e);c&&r.push(c)}}else r=[this.readFeatureFromObject(t,e)];return r.flat()}readGeometryFromObject(t,e){return T1(t,e)}readProjectionFromObject(t){const e=t.crs;let i;if(e)if(e.type=="name")i=dt(e.properties.name);else if(e.type==="EPSG")i=dt("EPSG:"+e.properties.code);else throw new Error("Unknown SRS type");else i=this.dataProjection;return i}writeFeatureObject(t,e){e=this.adaptOptions(e);const i={type:"Feature",geometry:null,properties:null},r=t.getId();if(r!==void 0&&(i.id=r),!t.hasProperties())return i;const s=t.getProperties(),o=t.getGeometry();return o&&(i.geometry=vc(o,e),delete s[t.getGeometryName()]),bi(s)||(i.properties=s),i}writeFeaturesObject(t,e){e=this.adaptOptions(e);const i=[];for(let r=0,s=t.length;r<s;++r)i.push(this.writeFeatureObject(t[r],e));return{type:"FeatureCollection",features:i}}writeGeometryObject(t,e){return vc(t,this.adaptOptions(e))}}function qh(n,t){if(!n)return null;let e;switch(n.type){case"Point":{e=R1(n);break}case"LineString":{e=A1(n);break}case"Polygon":{e=k1(n);break}case"MultiPoint":{e=L1(n);break}case"MultiLineString":{e=P1(n);break}case"MultiPolygon":{e=O1(n);break}case"GeometryCollection":{e=I1(n);break}default:throw new Error("Unsupported GeoJSON type: "+n.type)}return e}function T1(n,t){const e=qh(n);return Wh(e,t)}function I1(n,t){return n.geometries.map(function(i){return qh(i)})}function R1(n){const t=n.coordinates;return{type:"Point",flatCoordinates:t,layout:Oi(t.length)}}function A1(n){const t=n.coordinates,e=t.flat();return{type:"LineString",flatCoordinates:e,ends:[e.length],layout:Oi(t[0]?.length||2)}}function P1(n){const t=n.coordinates,e=t[0]?.[0]?.length||2,i=[],r=Gs(i,0,t,e);return{type:"MultiLineString",flatCoordinates:i,ends:r,layout:Oi(e)}}function L1(n){const t=n.coordinates;return{type:"MultiPoint",flatCoordinates:t.flat(),layout:Oi(t[0]?.length||2)}}function O1(n){const t=n.coordinates,e=[],i=t[0]?.[0]?.[0].length||2,r=Ig(e,0,t,i);return{type:"MultiPolygon",flatCoordinates:e,ends:r,layout:Oi(i)}}function k1(n){const t=n.coordinates,e=[],i=t[0]?.[0]?.length,r=Gs(e,0,t,i);return{type:"Polygon",flatCoordinates:e,ends:r,layout:Oi(i)}}function vc(n,t){n=jh(n,!0,t);const e=n.getType();let i;switch(e){case"Point":{i=V1(n);break}case"LineString":{i=M1(n);break}case"Polygon":{i=z1(n,t);break}case"MultiPoint":{i=N1(n);break}case"MultiLineString":{i=F1(n);break}case"MultiPolygon":{i=$1(n,t);break}case"GeometryCollection":{i=D1(n,t);break}case"Circle":{i={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+e)}return i}function D1(n,t){return t=Object.assign({},t),delete t.featureProjection,{type:"GeometryCollection",geometries:n.getGeometriesArray().map(function(i){return vc(i,t)})}}function M1(n,t){return{type:"LineString",coordinates:n.getCoordinates()}}function F1(n,t){return{type:"MultiLineString",coordinates:n.getCoordinates()}}function N1(n,t){return{type:"MultiPoint",coordinates:n.getCoordinates()}}function $1(n,t){let e;return t&&(e=t.rightHanded),{type:"MultiPolygon",coordinates:n.getCoordinates(e)}}function V1(n,t){return{type:"Point",coordinates:n.getCoordinates()}}function z1(n,t){let e;return t&&(e=t.rightHanded),{type:"Polygon",coordinates:n.getCoordinates(e)}}const Hi=[0,0,0],Tn=5;class Lp{constructor(t){this.minZoom=t.minZoom!==void 0?t.minZoom:0,this.resolutions_=t.resolutions,rt(J_(this.resolutions_,(r,s)=>s-r),"`resolutions` must be sorted in descending order");let e;if(!t.origins){for(let r=0,s=this.resolutions_.length-1;r<s;++r)if(!e)e=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==e){e=void 0;break}}this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=t.origin!==void 0?t.origin:null,this.origins_=null,t.origins!==void 0&&(this.origins_=t.origins,rt(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=t.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Pi(i)),rt(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,t.tileSizes!==void 0&&(this.tileSizes_=t.tileSizes,rt(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=t.tileSize!==void 0?t.tileSize:this.tileSizes_?null:Ah,rt(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],t.sizes!==void 0?this.fullTileRanges_=t.sizes.map((r,s)=>{const o=new Bh(Math.min(0,r[0]),Math.max(r[0]-1,-1),Math.min(0,r[1]),Math.max(r[1]-1,-1));if(i){const a=this.getTileRangeForExtentAndZ(i,s);o.minX=Math.max(a.minX,o.minX),o.maxX=Math.min(a.maxX,o.maxX),o.minY=Math.max(a.minY,o.minY),o.maxY=Math.min(a.maxY,o.maxY)}return o}):i&&this.calculateTileRanges_(i)}forEachTileCoord(t,e,i){const r=this.getTileRangeForExtentAndZ(t,e);for(let s=r.minX,o=r.maxX;s<=o;++s)for(let a=r.minY,l=r.maxY;a<=l;++a)i([e,s,a])}forEachTileCoordParentTileRange(t,e,i,r){let s,o,a,l=null,c=t[0]-1;for(this.zoomFactor_===2?(o=t[1],a=t[2]):l=this.getTileCoordExtent(t,r);c>=this.minZoom;){if(o!==void 0&&a!==void 0?(o=Math.floor(o/2),a=Math.floor(a/2),s=Wi(o,o,a,a,i)):s=this.getTileRangeForExtentAndZ(l,c,i),e(c,s))return!0;--c}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(t){return this.origin_?this.origin_:this.origins_[t]}getResolution(t){return this.resolutions_[t]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(t,e,i){if(t[0]<this.maxZoom){if(this.zoomFactor_===2){const s=t[1]*2,o=t[2]*2;return Wi(s,s+1,o,o+1,e)}const r=this.getTileCoordExtent(t,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,t[0]+1,e)}return null}getTileRangeForTileCoordAndZ(t,e,i){if(e>this.maxZoom||e<this.minZoom)return null;const r=t[0],s=t[1],o=t[2];if(e===r)return Wi(s,o,s,o,i);if(this.zoomFactor_){const l=Math.pow(this.zoomFactor_,e-r),c=Math.floor(s*l),h=Math.floor(o*l);if(e<r)return Wi(c,c,h,h,i);const u=Math.floor(l*(s+1))-1,d=Math.floor(l*(o+1))-1;return Wi(c,u,h,d,i)}const a=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,e,i)}getTileRangeForExtentAndZ(t,e,i){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,Hi);const r=Hi[1],s=Hi[2];this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,Hi);const o=Hi[1],a=Hi[2];return Wi(r,o,s,a,i)}getTileCoordCenter(t){const e=this.getOrigin(t[0]),i=this.getResolution(t[0]),r=ne(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*r[0]*i,e[1]-(t[2]+.5)*r[1]*i]}getTileCoordExtent(t,e){const i=this.getOrigin(t[0]),r=this.getResolution(t[0]),s=ne(this.getTileSize(t[0]),this.tmpSize_),o=i[0]+t[1]*s[0]*r,a=i[1]-(t[2]+1)*s[1]*r,l=o+s[0]*r,c=a+s[1]*r;return dn(o,a,l,c,e)}getTileCoordForCoordAndResolution(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)}getTileCoordForXYAndResolution_(t,e,i,r,s){const o=this.getZForResolution(i),a=i/this.getResolution(o),l=this.getOrigin(o),c=ne(this.getTileSize(o),this.tmpSize_);let h=a*(t-l[0])/i/c[0],u=a*(l[1]-e)/i/c[1];return r?(h=no(h,Tn)-1,u=no(u,Tn)-1):(h=eo(h,Tn),u=eo(u,Tn)),Vo(o,h,u,s)}getTileCoordForXYAndZ_(t,e,i,r,s){const o=this.getOrigin(i),a=this.getResolution(i),l=ne(this.getTileSize(i),this.tmpSize_);let c=(t-o[0])/a/l[0],h=(o[1]-e)/a/l[1];return r?(c=no(c,Tn)-1,h=no(h,Tn)-1):(c=eo(c,Tn),h=eo(h,Tn)),Vo(i,c,h,s)}getTileCoordForCoordAndZ(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)}getTileCoordResolution(t){return this.resolutions_[t[0]]}getTileSize(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}getFullTileRange(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}getZForResolution(t,e){const i=Qc(this.resolutions_,t,e||0);return pt(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(t,e){return Lg(e,0,e.length,2,this.getTileCoordExtent(t))}calculateTileRanges_(t){const e=this.resolutions_.length,i=new Array(e);for(let r=this.minZoom;r<e;++r)i[r]=this.getTileRangeForExtentAndZ(t,r);this.fullTileRanges_=i}}function Op(n){let t=n.getDefaultTileGrid();return t||(t=j1(n),n.setDefaultTileGrid(t)),t}function G1(n,t,e){const i=t[0],r=n.getTileCoordCenter(t),s=Hh(e);if(!cr(s,r)){const o=at(s),a=Math.ceil((s[0]-r[0])/o);return r[0]+=o*a,n.getTileCoordForCoordAndZ(r,i)}return t}function B1(n,t,e,i){i=i!==void 0?i:"top-left";const r=kp(n,t,e);return new Lp({extent:n,origin:ey(n,i),resolutions:r,tileSize:e})}function U1(n){const t=n||{},e=t.extent||dt("EPSG:3857").getExtent(),i={extent:e,minZoom:t.minZoom,tileSize:t.tileSize,resolutions:kp(e,t.maxZoom,t.tileSize,t.maxResolution)};return new Lp(i)}function kp(n,t,e,i){t=t!==void 0?t:I0,e=ne(e!==void 0?e:Ah);const r=Ht(n),s=at(n);i=i>0?i:Math.max(s/e[0],r/e[1]);const o=t+1,a=new Array(o);for(let l=0;l<o;++l)a[l]=i/Math.pow(2,l);return a}function j1(n,t,e,i){const r=Hh(n);return B1(r,t,e,i)}function Hh(n){n=dt(n);let t=n.getExtent();if(!t){const e=180*rh.degrees/n.getMetersPerUnit();t=dn(-e,-e,e,e)}return t}const W1=/\{z\}/g,q1=/\{x\}/g,H1=/\{y\}/g,X1=/\{-y\}/g;function K1(n,t,e,i,r){return n.replace(W1,t.toString()).replace(q1,e.toString()).replace(H1,i.toString()).replace(X1,function(){if(r===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(r-i).toString()})}function Y1(n){const t=[];let e=/\{([a-z])-([a-z])\}/.exec(n);if(e){const i=e[1].charCodeAt(0),r=e[2].charCodeAt(0);let s;for(s=i;s<=r;++s)t.push(n.replace(e[0],String.fromCharCode(s)));return t}if(e=/\{(\d+)-(\d+)\}/.exec(n),e){const i=parseInt(e[2],10);for(let r=parseInt(e[1],10);r<=i;r++)t.push(n.replace(e[0],r.toString()));return t}return t.push(n),t}function Z1(n,t){return(function(e,i,r){if(!e)return;let s;const o=e[0];if(t){const a=t.getFullTileRange(o);a&&(s=a.getHeight()-1)}return K1(n,o,e[1],e[2],s)})}function J1(n,t){const e=n.length,i=new Array(e);for(let r=0;r<e;++r)i[r]=Z1(n[r],t);return Q1(i)}function Q1(n){return n.length===1?n[0]:(function(t,e,i){if(!t)return;const r=Lb(t),s=nr(r,n.length);return n[s](t,e,i)})}class tE extends Ap{constructor(t){super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=t.tilePixelRatio!==void 0?t.tilePixelRatio:1,this.tileGrid=t.tileGrid!==void 0?t.tileGrid:null;const e=[256,256];this.tileGrid&&ne(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),e),this.tmpSize=[0,0],this.key_=t.key||nt(this),this.tileOptions={transition:t.transition,interpolate:t.interpolate},this.zDirection=t.zDirection?t.zDirection:0}getGutterForProjection(t){return 0}getKey(){return this.key_}setKey(t){this.key_!==t&&(this.key_=t,this.changed())}getResolutions(t){const e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}getTile(t,e,i,r,s,o){return W()}getTileGrid(){return this.tileGrid}getTileGridForProjection(t){return this.tileGrid?this.tileGrid:Op(t)}getTilePixelRatio(t){return this.tilePixelRatio_}getTilePixelSize(t,e,i){const r=this.getTileGridForProjection(i),s=this.getTilePixelRatio(e),o=ne(r.getTileSize(t),this.tmpSize);return s==1?o:mv(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(t,e){const i=e!==void 0?e:this.getProjection(),r=e!==void 0?this.getTileGridForProjection(i):this.tileGrid||this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(t=G1(r,t,i)),kb(t,r)?t:null}clear(){}refresh(){this.clear(),super.refresh()}}class eE extends yn{constructor(t,e){super(t),this.tile=e}}const Dl={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class Xh extends tE{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===Xh.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(t){const e=t.target,i=nt(e),r=e.getState();let s;r==z.LOADING?(this.tileLoadingKeys_[i]=!0,s=Dl.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=r==z.ERROR?Dl.TILELOADERROR:r==z.LOADED?Dl.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new eE(s,e))}setTileLoadFunction(t){this.tileLoadFunction=t,this.changed()}setTileUrlFunction(t,e){this.tileUrlFunction=t,typeof e<"u"?this.setKey(e):this.changed()}setUrl(t){const e=Y1(t);this.urls=e,this.setUrls(e)}setUrls(t){this.urls=t;const e=t.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(J1(t,this.tileGrid),e):this.setKey(e)}tileUrlFunction(t,e,i){}}class nE extends Xh{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:Dp,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate!==void 0?t.interpolate:!0,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=t.crossOrigin!==void 0?t.crossOrigin:null,this.tileClass=t.tileClass!==void 0?t.tileClass:wp,this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(t){return this.getProjection()&&t&&!rs(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getTileGridForProjection(t){const e=this.getProjection();if(this.tileGrid&&(!e||rs(e,t)))return this.tileGrid;const i=nt(t);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=Op(t)),this.tileGridForProjection[i]}createTile_(t,e,i,r,s,o){const a=[t,e,i],l=this.getTileCoordForTileUrlFunction(a,s),c=l?this.tileUrlFunction(l,r,s):void 0,h=new this.tileClass(a,c!==void 0?z.IDLE:z.EMPTY,c!==void 0?c:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return h.key=o,h.addEventListener(H.CHANGE,this.handleTileChange.bind(this)),h}getTile(t,e,i,r,s,o){const a=this.getProjection();if(!a||!s||rs(a,s))return this.getTileInternal(t,e,i,r,a||s);const l=[t,e,i],c=this.getKey(),h=this.getTileGridForProjection(a),u=this.getTileGridForProjection(s),d=this.getTileCoordForTileUrlFunction(l,s),f=new vp(a,h,s,u,l,d,this.getTilePixelRatio(r),this.getGutter(),(g,y,_,b)=>this.getTileInternal(g,y,_,b,a,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return f.key=c,f}getTileInternal(t,e,i,r,s,o){const a=this.getKey(),l=bo(this,a,t,e,i);if(o&&o.containsKey(l))return o.get(l);const c=this.createTile_(t,e,i,r,s,a);return o?.set(l,c),c}setRenderReprojectionEdges(t){this.renderReprojectionEdges_!=t&&(this.renderReprojectionEdges_=t,this.changed())}setTileGridForProjection(t,e){const i=dt(t);if(i){const r=nt(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=e)}}}function Dp(n,t){if(ce){const e=n.getCrossOrigin();let i="same-origin",r="same-origin";e==="anonymous"||e===""?(i="cors",r="omit"):e==="use-credentials"&&(i="cors",r="include"),fetch(t,{mode:i,credentials:r}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{const o=n.getImage();o.width=s.width,o.height=s.height,o.getContext("2d").drawImage(s,0,0),s.close?.(),o.dispatchEvent(new Event("load"))}).catch(()=>{n.getImage().dispatchEvent(new Event("error"))});return}n.getImage().src=t}class iE extends nE{constructor(t){t=t||{};const e=t.projection!==void 0?t.projection:"EPSG:3857",i=t.tileGrid!==void 0?t.tileGrid:U1({extent:Hh(e),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:e,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX!==void 0?t.wrapX:!0,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.gutter_=t.gutter!==void 0?t.gutter:0}getGutter(){return this.gutter_}}const rE='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class sE extends iE{constructor(t){t=t||{};let e;t.attributions!==void 0?e=t.attributions:e=[rE];const i=t.crossOrigin!==void 0?t.crossOrigin:"anonymous",r=t.url!==void 0?t.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:e,attributionsCollapsible:!1,cacheSize:t.cacheSize,crossOrigin:i,interpolate:t.interpolate,maxZoom:t.maxZoom!==void 0?t.maxZoom:19,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:(s,o)=>{const a=s.getImage();!ce&&a instanceof HTMLImageElement&&(a.referrerPolicy="origin-when-cross-origin"),(t.tileLoadFunction||Dp)(s,o)},transition:t.transition,url:r,wrapX:t.wrapX,zDirection:t.zDirection})}}function oE(n){return{...n,cameraPosition:null,guessedPosition:null,score:null,distance:null,scores:[]}}function Hd(n,t){if(n.country==null)throw new Error("Cannot start round without a selected country");return{...n,cameraPosition:t,guessedPosition:null,score:null,distance:null}}function aE(n,t){const e=Jl(n.cameraPosition,t);let i=n.score||0;return i+=pw(e,n.country),{...n,guessedPosition:t,distance:e,score:i,scores:[...n.scores,i]}}function bc(n){return Math.round(n.scores.reduce((t,e)=>t+e,0)/n.scores.length)}function Mp(n){return n.scores.length===n.roundPerGame}function Ml(n){return n.country!==null&&n.cameraPosition!==null}const Fa="game-state";var lE=Object.defineProperty,cE=Object.getOwnPropertyDescriptor,Na=(n,t,e,i)=>{for(var r=i>1?void 0:i?cE(t,e):t,s=n.length-1,o;s>=0;s--)(o=n[s])&&(r=(i?o(t,e,r):o(r))||r);return i&&r&&lE(t,e,r),r};Uy();const hE=[{filter:["==",["get","type"],"guessed"],style:{"circle-radius":8,"circle-fill-color":"#fff","circle-stroke-color":"#f00","circle-stroke-width":3}},{filter:["==",["get","type"],"camera"],style:{"circle-radius":8,"circle-fill-color":"#fff","circle-stroke-color":"#000","circle-stroke-width":3}},{filter:["==",["get","type"],"line"],style:{"stroke-width":6,"stroke-color":"#000","stroke-line-dash":[6,12]}}];let yr=class extends Xt{constructor(){super(),this.showResult=!1,this.guessedFeature=new vi({type:"guessed"}),this.cameraFeature=new vi({type:"camera"}),this.lineFeature=new vi({type:"line"}),this.maskSource=new qd({features:[]}),this.map=new wb({controls:[],layers:[new zb({source:new sE}),new Gd({source:new qd({features:[this.guessedFeature,this.cameraFeature,this.lineFeature]}),style:hE})]});const n=new Gd({style:{"fill-color":"rgba(0, 0, 0, 1.0)"},className:"ol-layer mask",updateWhileInteracting:!0,source:this.maskSource});n.on("prerender",uE),this.map.addLayer(n),this.map.on("click",t=>{const e=rr[this.gameState.country];ig(t.coordinate,e)!==!1&&(this.guessedFeature.setGeometry(new cn(t.coordinate)),this.dispatchEvent(new CustomEvent("map-click",{detail:t.coordinate})))})}shouldUpdate(){return this.gameState.country!==null}willUpdate(){if(this.showResult&&this.gameState.cameraPosition&&this.gameState.guessedPosition?(this.guessedFeature.setGeometry(new cn(this.gameState.guessedPosition)),this.cameraFeature.setGeometry(new cn(this.gameState.cameraPosition)),this.lineFeature.setGeometry(new Si([this.gameState.cameraPosition,this.gameState.guessedPosition])),this.map.getView().fit(this.lineFeature.getGeometry().getExtent())):(this.guessedFeature.setGeometry(void 0),this.cameraFeature.setGeometry(void 0),this.lineFeature.setGeometry(void 0),this.map.getView().fit(this.getCountryExtent())),this.gameState.country!==null){const n=rr[this.gameState.country];this.maskSource.clear();const t=new S1;this.maskSource.addFeature(t.readFeature(n))}}render(){return U`<div class="map"></div>`}firstUpdated(){this.map.setTarget(this.mapElement);const n=this.getCountryExtent();this.map.setView(new ze({extent:n,center:fn(n),zoom:4}))}getCountryExtent(){return mw(fw[this.gameState.country],1.5)}};yr.styles=Qf`
    :host {
      display: block;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }
    .map {
      width: 100%;
      height: 100%;
      cursor: crosshair;
    }
    .ol-layer.mask {
      filter: blur(5px);
      opacity: 0.5;
    }
  `;Na([Jc({context:Fa,subscribe:!0})],yr.prototype,"gameState",2);Na([P({attribute:"show-result",type:Boolean})],yr.prototype,"showResult",2);Na([At(".map")],yr.prototype,"mapElement",2);yr=Na([bt("element-map")],yr);function uE(n){const t=n.context;t.globalCompositeOperation="copy",t.fillStyle="rgba(0, 0, 0, 1.0)",t.fillRect(0,0,t.canvas.width,t.canvas.height),t.globalCompositeOperation="destination-out"}var dE=Object.defineProperty,fE=Object.getOwnPropertyDescriptor,Fp=(n,t,e,i)=>{for(var r=i>1?void 0:i?fE(t,e):t,s=n.length-1,o;s>=0;s--)(o=n[s])&&(r=(i?o(t,e,r):o(r))||r);return i&&r&&dE(t,e,r),r};let Ec=class extends Xt{constructor(){super(...arguments),this.localize=new Jn(this),this.guessedPosition=null}render(){return U`
      <wa-card>
        <div slot="header">${this.localize.term("where_are_you")}</div>
        <element-map @map-click="${this.handleMapClick}"></element-map>
        <div slot="footer">
          <wa-button
            variant="brand"
            ?disabled="${this.guessedPosition==null}"
            @click="${this.validateGuess}"
            >${this.localize.term("guess")}</wa-button
          >
        </div>
      </wa-card>
    `}handleMapClick(n){this.guessedPosition=n.detail}validateGuess(){this.dispatchEvent(new CustomEvent("guess",{detail:this.guessedPosition})),this.guessedPosition=null}createRenderRoot(){return this}};Fp([Ft()],Ec.prototype,"guessedPosition",2);Ec=Fp([bt("element-guess")],Ec);function gE(n,t){return{top:Math.round(n.getBoundingClientRect().top-t.getBoundingClientRect().top),left:Math.round(n.getBoundingClientRect().left-t.getBoundingClientRect().left)}}var xc=new Set;function pE(){const n=document.documentElement.clientWidth;return Math.abs(window.innerWidth-n)}function mE(){const n=Number(getComputedStyle(document.body).paddingRight.replace(/px/,""));return isNaN(n)||!n?0:n}function Xd(n){if(xc.add(n),!document.documentElement.classList.contains("wa-scroll-lock")){const t=pE()+mE();let e=getComputedStyle(document.documentElement).scrollbarGutter;(!e||e==="auto")&&(e="stable"),t<2&&(e=""),document.documentElement.style.setProperty("--wa-scroll-lock-gutter",e),document.documentElement.classList.add("wa-scroll-lock"),document.documentElement.style.setProperty("--wa-scroll-lock-size",`${t}px`)}}function Kd(n){xc.delete(n),xc.size===0&&(document.documentElement.classList.remove("wa-scroll-lock"),document.documentElement.style.removeProperty("--wa-scroll-lock-size"))}function _E(n,t,e="vertical",i="smooth"){const r=gE(n,t),s=r.top+t.scrollTop,o=r.left+t.scrollLeft,a=t.scrollLeft,l=t.scrollLeft+t.offsetWidth,c=t.scrollTop,h=t.scrollTop+t.offsetHeight;(e==="horizontal"||e==="both")&&(o<a?t.scrollTo({left:o,behavior:i}):o+n.clientWidth>l&&t.scrollTo({left:o-t.offsetWidth+n.clientWidth,behavior:i})),(e==="vertical"||e==="both")&&(s<c?t.scrollTo({top:s,behavior:i}):s+n.clientHeight>h&&t.scrollTo({top:s-t.offsetHeight+n.clientHeight,behavior:i}))}function yE(n){return n.split(" ").map(t=>t.trim()).filter(t=>t!=="")}var Np=class extends Event{constructor(){super("wa-after-hide",{bubbles:!0,cancelable:!1,composed:!0})}},$p=class extends Event{constructor(){super("wa-after-show",{bubbles:!0,cancelable:!1,composed:!0})}},Vp=class extends Event{constructor(n){super("wa-hide",{bubbles:!0,cancelable:!0,composed:!0}),this.detail=n}},zp=class extends Event{constructor(){super("wa-show",{bubbles:!0,cancelable:!0,composed:!0})}};function er(n,t){return new Promise(e=>{const i=new AbortController,{signal:r}=i;if(n.classList.contains(t))return;n.classList.remove(t),n.classList.add(t);let s=()=>{n.classList.remove(t),e(),i.abort()};n.addEventListener("animationend",s,{once:!0,signal:r}),n.addEventListener("animationcancel",s,{once:!0,signal:r})})}var wE=`:host {
  --width: 31rem;
  --spacing: var(--wa-space-l);
  --show-duration: 200ms;
  --hide-duration: 200ms;

  display: none;
}

:host([open]) {
  display: block;
}

.dialog {
  display: flex;
  flex-direction: column;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  width: var(--width);
  max-width: calc(100% - var(--wa-space-2xl));
  max-height: calc(100% - var(--wa-space-2xl));
  background-color: var(--wa-color-surface-raised);
  border-radius: var(--wa-panel-border-radius);
  border: none;
  box-shadow: var(--wa-shadow-l);
  padding: 0;
  margin: auto;

  &.show {
    animation: show-dialog var(--show-duration) ease;

    &::backdrop {
      animation: show-backdrop var(--show-duration, 200ms) ease;
    }
  }

  &.hide {
    animation: show-dialog var(--hide-duration) ease reverse;

    &::backdrop {
      animation: show-backdrop var(--hide-duration, 200ms) ease reverse;
    }
  }

  &.pulse {
    animation: pulse 250ms ease;
  }
}

.dialog:focus {
  outline: none;
}

/* Ensure there's enough vertical padding for phones that don't update vh when chrome appears (e.g. iPhone) */
@media screen and (max-width: 420px) {
  .dialog {
    max-height: 80vh;
  }
}

.open {
  display: flex;
  opacity: 1;
}

.header {
  flex: 0 0 auto;
  display: flex;
  flex-wrap: nowrap;

  padding-inline-start: var(--spacing);
  padding-block-end: 0;

  /* Subtract the close button's padding so that the X is visually aligned with the edges of the dialog content */
  padding-inline-end: calc(var(--spacing) - var(--wa-form-control-padding-block));
  padding-block-start: calc(var(--spacing) - var(--wa-form-control-padding-block));
}

.title {
  align-self: center;
  flex: 1 1 auto;
  font-family: inherit;
  font-size: var(--wa-font-size-l);
  font-weight: var(--wa-font-weight-heading);
  line-height: var(--wa-line-height-condensed);
  margin: 0;
}

.header-actions {
  align-self: start;
  display: flex;
  flex-shrink: 0;
  flex-wrap: wrap;
  justify-content: end;
  gap: var(--wa-space-2xs);
  padding-inline-start: var(--spacing);
}

.header-actions wa-button,
.header-actions ::slotted(wa-button) {
  flex: 0 0 auto;
  display: flex;
  align-items: center;
}

.body {
  flex: 1 1 auto;
  display: block;
  padding: var(--spacing);
  overflow: auto;
  -webkit-overflow-scrolling: touch;

  &:focus {
    outline: none;
  }

  &:focus-visible {
    outline: var(--wa-focus-ring);
    outline-offset: var(--wa-focus-ring-offset);
  }
}

.footer {
  flex: 0 0 auto;
  display: flex;
  flex-wrap: wrap;
  gap: var(--wa-space-xs);
  justify-content: end;
  padding: var(--spacing);
  padding-block-start: 0;
}

.footer ::slotted(wa-button:not(:first-of-type)) {
  margin-inline-start: var(--wa-spacing-xs);
}

.dialog::backdrop {
  /*
    NOTE: the ::backdrop element doesn't inherit properly in Safari yet, but it will in 17.4! At that time, we can
    remove the fallback values here.
  */
  background-color: var(--wa-color-overlay-modal, rgb(0 0 0 / 0.25));
}

@keyframes pulse {
  0% {
    scale: 1;
  }
  50% {
    scale: 1.02;
  }
  100% {
    scale: 1;
  }
}

@keyframes show-dialog {
  from {
    opacity: 0;
    scale: 0.8;
  }
  to {
    opacity: 1;
    scale: 1;
  }
}

@keyframes show-backdrop {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@media (forced-colors: active) {
  .dialog {
    border: solid 1px white;
  }
}
`,pn=class extends ue{constructor(){super(...arguments),this.localize=new wn(this),this.hasSlotController=new Bs(this,"footer","header-actions","label"),this.open=!1,this.label="",this.withoutHeader=!1,this.lightDismiss=!1,this.handleDocumentKeyDown=n=>{n.key==="Escape"&&this.open&&(n.preventDefault(),n.stopPropagation(),this.requestClose(this.dialog))}}firstUpdated(){this.open&&(this.addOpenListeners(),this.dialog.showModal(),Xd(this))}disconnectedCallback(){super.disconnectedCallback(),Kd(this),this.removeOpenListeners()}async requestClose(n){const t=new Vp({source:n});if(this.dispatchEvent(t),t.defaultPrevented){this.open=!0,er(this.dialog,"pulse");return}this.removeOpenListeners(),await er(this.dialog,"hide"),this.open=!1,this.dialog.close(),Kd(this);const e=this.originalTrigger;typeof e?.focus=="function"&&setTimeout(()=>e.focus()),this.dispatchEvent(new Np)}addOpenListeners(){document.addEventListener("keydown",this.handleDocumentKeyDown)}removeOpenListeners(){document.removeEventListener("keydown",this.handleDocumentKeyDown)}handleDialogCancel(n){n.preventDefault(),!this.dialog.classList.contains("hide")&&n.target===this.dialog&&this.requestClose(this.dialog)}handleDialogClick(n){const e=n.target.closest('[data-dialog="close"]');e&&(n.stopPropagation(),this.requestClose(e))}async handleDialogPointerDown(n){n.target===this.dialog&&(this.lightDismiss?this.requestClose(this.dialog):await er(this.dialog,"pulse"))}handleOpenChange(){this.open&&!this.dialog.open?this.show():!this.open&&this.dialog.open&&(this.open=!0,this.requestClose(this.dialog))}async show(){const n=new zp;if(this.dispatchEvent(n),n.defaultPrevented){this.open=!1;return}this.addOpenListeners(),this.originalTrigger=document.activeElement,this.open=!0,this.dialog.showModal(),Xd(this),requestAnimationFrame(()=>{const t=this.querySelector("[autofocus]");t&&typeof t.focus=="function"?t.focus():this.dialog.focus()}),await er(this.dialog,"show"),this.dispatchEvent(new $p)}render(){const n=!this.withoutHeader,t=this.hasSlotController.test("footer");return U`
      <dialog
        part="dialog"
        class=${zn({dialog:!0,open:this.open})}
        @cancel=${this.handleDialogCancel}
        @click=${this.handleDialogClick}
        @pointerdown=${this.handleDialogPointerDown}
      >
        ${n?U`
              <header part="header" class="header">
                <h2 part="title" class="title" id="title">
                  <!-- If there's no label, use an invisible character to prevent the header from collapsing -->
                  <slot name="label"> ${this.label.length>0?this.label:"​"} </slot>
                </h2>
                <div part="header-actions" class="header-actions">
                  <slot name="header-actions"></slot>
                  <wa-button
                    part="close-button"
                    exportparts="base:close-button__base"
                    class="close"
                    appearance="plain"
                    @click="${e=>this.requestClose(e.target)}"
                  >
                    <wa-icon
                      name="xmark"
                      label=${this.localize.term("close")}
                      library="system"
                      variant="solid"
                    ></wa-icon>
                  </wa-button>
                </div>
              </header>
            `:""}

        <div part="body" class="body"><slot></slot></div>

        ${t?U`
              <footer part="footer" class="footer">
                <slot name="footer"></slot>
              </footer>
            `:""}
      </dialog>
    `}};pn.css=wE;A([At(".dialog")],pn.prototype,"dialog",2);A([P({type:Boolean,reflect:!0})],pn.prototype,"open",2);A([P({reflect:!0})],pn.prototype,"label",2);A([P({attribute:"without-header",type:Boolean,reflect:!0})],pn.prototype,"withoutHeader",2);A([P({attribute:"light-dismiss",type:Boolean})],pn.prototype,"lightDismiss",2);A([ti("open",{waitUntilFirstUpdate:!0})],pn.prototype,"handleOpenChange",1);pn=A([bt("wa-dialog")],pn);document.addEventListener("click",n=>{const t=n.target.closest("[data-dialog]");if(t instanceof Element){const[e,i]=yE(t.getAttribute("data-dialog")||"");if(e==="open"&&i?.length){const s=t.getRootNode().getElementById(i);s?.localName==="wa-dialog"?s.open=!0:console.warn(`A dialog with an ID of "${i}" could not be found in this document.`)}}});document.addEventListener("pointerdown",()=>{});var vE=Object.defineProperty,bE=(n,t,e,i)=>{for(var r=void 0,s=n.length-1,o;s>=0;s--)(o=n[s])&&(r=o(t,e,r)||r);return r&&vE(t,e,r),r};const Hs=n=>{class t extends n{constructor(){super(...arguments),this.open=!1}updated(i){if(i.has("open")){const r=this.firstElementChild;r.open!==this.open&&(r.open=this.open)}}firstUpdated(){this.firstElementChild?.addEventListener("wa-hide",i=>{i.defaultPrevented||this.firstElementChild===i.target&&(this.open=!1,this.dispatchEvent(new CustomEvent("close")))}),this.firstElementChild?.addEventListener("wa-show",i=>{i.defaultPrevented||this.firstElementChild===i.target&&(this.open=!0,this.dispatchEvent(new CustomEvent("open")))})}}return bE([P({type:Boolean,reflect:!0})],t.prototype,"open"),t};function EE(n,t,e){const i=r=>Object.is(r,-0)?0:r;return n<t?i(t):n>e?i(e):i(n)}var xE=`:host {
  --track-height: 1rem;
  --track-color: var(--wa-color-neutral-fill-normal);
  --indicator-color: var(--wa-color-brand-fill-loud);

  display: flex;
}

.progress-bar {
  flex: 1 1 auto;
  display: flex;
  position: relative;
  overflow: hidden;
  height: var(--track-height);
  border-radius: var(--wa-border-radius-pill);
  background-color: var(--track-color);
  color: var(--wa-color-brand-on-loud);
  font-size: var(--wa-font-size-s);
}

.indicator {
  width: var(--percentage);
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: var(--indicator-color);
  text-align: center;
  white-space: nowrap;
  overflow: hidden;
  line-height: 1;
  font-weight: var(--wa-font-weight-semibold);
  transition: all var(--wa-transition-slow, 200ms) var(--wa-transition-easing, ease);
  user-select: none;
  -webkit-user-select: none;
}

/* Indeterminate */
:host([indeterminate]) .indicator {
  position: absolute;
  inset-block: 0;
  inline-size: 50%;
  animation: wa-progress-indeterminate 2.5s infinite cubic-bezier(0.37, 0, 0.63, 1);
}

@media (forced-colors: active) {
  .progress-bar {
    outline: solid 1px SelectedItem;
    background-color: var(--wa-color-surface-default);
  }

  .indicator {
    outline: solid 1px SelectedItem;
    background-color: SelectedItem;
  }
}

@keyframes wa-progress-indeterminate {
  0% {
    inset-inline-start: -50%;
  }

  75%,
  100% {
    inset-inline-start: 100%;
  }
}
`,wr=class extends ue{constructor(){super(...arguments),this.localize=new wn(this),this.value=0,this.indeterminate=!1,this.label=""}updated(n){n.has("value")&&requestAnimationFrame(()=>{this.style.setProperty("--percentage",`${EE(this.value,0,100)}%`)})}render(){return U`
      <div
        part="base"
        class="progress-bar"
        role="progressbar"
        title=${ft(this.title)}
        aria-label=${this.label.length>0?this.label:this.localize.term("progress")}
        aria-valuemin="0"
        aria-valuemax="100"
        aria-valuenow=${this.indeterminate?"0":this.value}
      >
        <div part="indicator" class="indicator">
          ${this.indeterminate?"":U` <slot part="label" class="label"></slot> `}
        </div>
      </div>
    `}};wr.css=xE;A([P({type:Number,reflect:!0})],wr.prototype,"value",2);A([P({type:Boolean,reflect:!0})],wr.prototype,"indeterminate",2);A([P()],wr.prototype,"label",2);wr=A([bt("wa-progress-bar")],wr);var CE=Object.defineProperty,SE=Object.getOwnPropertyDescriptor,Gp=(n,t,e,i)=>{for(var r=i>1?void 0:i?SE(t,e):t,s=n.length-1,o;s>=0;s--)(o=n[s])&&(r=(i?o(t,e,r):o(r))||r);return i&&r&&CE(t,e,r),r};let Cc=class extends Hs(Xt){constructor(){super(...arguments),this.localize=new Jn(this)}shouldUpdate(){return this.gameState.score!=null}render(){const n=Mp(this.gameState);return U`
      <wa-dialog label="${this.localize.term("round")} ${this.gameState.scores.length}/${this.gameState.roundPerGame}" open>
        <div class="wa-stack wa-gap-2xs">
          <element-map show-result></element-map>
          <div class="wa-body-xl">${Math.round(this.gameState.score)} ${this.localize.term("points")}</div>
          <!-- <wa-progress-bar value="${this.gameState.score/5e3*100}" style="--track-height: 6px;"></wa-progress-bar> -->
          <div>${this.formatDistance(this.gameState.distance)}</div>
        </div>
        <div slot="footer">
          <wa-button slot="footer" variant="brand" data-dialog="close" class="${n?"hidden":""}">
            ${this.localize.term("next_round")}
            <wa-icon slot="end" name="arrow-right" variant="solid"></wa-icon>
          </wa-button>
          <wa-button slot="footer" variant="brand" data-dialog="close" @click="${this.handleGameOver}" class="${n?"":"hidden"}">
            ${this.localize.term("scores")}
            <wa-icon slot="end" name="trophy" variant="solid"></wa-icon>
          </wa-button>
        </div>
      </wa-dialog>
        `}formatDistance(n){return this.localize.number(n/1e3,{style:"unit",unit:"kilometer",maximumFractionDigits:1})}handleGameOver(){this.dispatchEvent(new CustomEvent("gameOver"))}createRenderRoot(){return this}};Gp([Jc({context:Fa,subscribe:!0})],Cc.prototype,"gameState",2);Cc=Gp([bt("element-result")],Cc);var Bp=class extends Event{constructor(){super("wa-clear",{bubbles:!0,cancelable:!1,composed:!0})}};var TE=(n={})=>{let{validationElement:t,validationProperty:e}=n;t||(t=Object.assign(document.createElement("input"),{required:!0})),e||(e="value");const i={observedAttributes:["required"],message:t.validationMessage,checkValidity(r){const s={message:"",isValid:!0,invalidKeys:[]};return(r.required??r.hasAttribute("required"))&&!r[e]&&(s.message=typeof i.message=="function"?i.message(r):i.message||"",s.isValid=!1,s.invalidKeys.push("valueMissing")),s}};return i};var Up=`:host {
  display: flex;
  flex-direction: column;
}

/* Label */
:is([part~='form-control-label'], [part~='label']):has(*:not(:empty)) {
  display: inline-flex;
  color: var(--wa-form-control-label-color);
  font-weight: var(--wa-form-control-label-font-weight);
  line-height: var(--wa-form-control-label-line-height);
  margin-block-end: 0.5em;
}

:host([required]) :is([part~='form-control-label'], [part~='label'])::after {
  content: var(--wa-form-control-required-content);
  margin-inline-start: var(--wa-form-control-required-content-offset);
  color: var(--wa-form-control-required-content-color);
}

/* Help text */
[part~='hint'] {
  display: block;
  color: var(--wa-form-control-hint-color);
  font-weight: var(--wa-form-control-hint-font-weight);
  line-height: var(--wa-form-control-hint-line-height);
  margin-block-start: 0.5em;
  font-size: var(--wa-font-size-smaller);
  line-height: var(--wa-form-control-label-line-height);

  &:not(.has-slotted) {
    display: none;
  }
}
`;function Yd(n,t){return new Promise(e=>{function i(r){r.target===n&&(n.removeEventListener(t,i),e())}n.addEventListener(t,i)})}let Sc=class extends Sh{constructor(t){if(super(t),this.it=yt,t.type!==Pn.CHILD)throw Error(this.constructor.directiveName+"() can only be used in child bindings")}render(t){if(t===yt||t==null)return this._t=void 0,this.it=t;if(t===ye)return t;if(typeof t!="string")throw Error(this.constructor.directiveName+"() called with a non-string value");if(t===this.it)return this._t;this.it=t;const e=[t];return e.raw=e,this._t={_$litType$:this.constructor.resultType,strings:e,values:[]}}};Sc.directiveName="unsafeHTML",Sc.resultType=1;const IE=Ch(Sc);var RE=`:host {
  --tag-max-size: 10ch;
  --show-duration: 100ms;
  --hide-duration: 100ms;
}

/* Add ellipses to multi select options */
:host wa-tag::part(content) {
  display: initial;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
  max-width: var(--tag-max-size);
}

:host .disabled [part~='combobox'] {
  opacity: 0.5;
  cursor: not-allowed;
  outline: none;
}

:host .enabled:is(.open, :focus-within) [part~='combobox'] {
  outline: var(--wa-focus-ring);
  outline-offset: var(--wa-focus-ring-offset);
}

/** The popup */
.select {
  flex: 1 1 auto;
  display: inline-flex;
  width: 100%;
  position: relative;
  vertical-align: middle;

  /* Pass through from select to the popup */
  --show-duration: inherit;
  --hide-duration: inherit;

  &::part(popup) {
    z-index: 900;
  }

  &[data-current-placement^='top']::part(popup) {
    transform-origin: bottom;
  }

  &[data-current-placement^='bottom']::part(popup) {
    transform-origin: top;
  }
}

/* Combobox */
.combobox {
  flex: 1;
  display: flex;
  width: 100%;
  min-width: 0;
  align-items: center;
  justify-content: start;

  min-height: var(--wa-form-control-height);

  background-color: var(--wa-form-control-background-color);
  border-color: var(--wa-form-control-border-color);
  border-radius: var(--wa-form-control-border-radius);
  border-style: var(--wa-form-control-border-style);
  border-width: var(--wa-form-control-border-width);
  color: var(--wa-form-control-value-color);
  cursor: pointer;
  font-family: inherit;
  font-weight: var(--wa-form-control-value-font-weight);
  line-height: var(--wa-form-control-value-line-height);
  overflow: hidden;
  padding: 0 var(--wa-form-control-padding-inline);
  position: relative;
  vertical-align: middle;
  width: 100%;
  transition:
    background-color var(--wa-transition-normal),
    border var(--wa-transition-normal),
    outline var(--wa-transition-fast);
  transition-timing-function: var(--wa-transition-easing);

  :host([multiple]) .select:not(.placeholder-visible) & {
    padding-inline-start: 0;
    padding-block: calc(var(--wa-form-control-height) * 0.1 - var(--wa-form-control-border-width));
  }

  /* Pills */
  :host([pill]) & {
    border-radius: var(--wa-border-radius-pill);
  }
}

/* Appearance modifiers */
:host([appearance='outlined']) .combobox {
  background-color: var(--wa-form-control-background-color);
  border-color: var(--wa-form-control-border-color);
}

:host([appearance='filled']) .combobox {
  background-color: var(--wa-color-neutral-fill-quiet);
  border-color: var(--wa-color-neutral-fill-quiet);
}

:host([appearance='filled-outlined']) .combobox {
  background-color: var(--wa-color-neutral-fill-quiet);
  border-color: var(--wa-form-control-border-color);
}

.display-input {
  position: relative;
  width: 100%;
  font: inherit;
  border: none;
  background: none;
  line-height: var(--wa-form-control-value-line-height);
  color: var(--wa-form-control-value-color);
  cursor: inherit;
  overflow: hidden;
  padding: 0;
  margin: 0;
  -webkit-appearance: none;

  &:focus {
    outline: none;
  }

  &::placeholder {
    color: var(--wa-form-control-placeholder-color);
  }
}

/* Visually hide the display input when multiple is enabled */
:host([multiple]) .select:not(.placeholder-visible) .display-input {
  position: absolute;
  z-index: -1;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  opacity: 0;
}

.value-input {
  position: absolute;
  z-index: -1;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  opacity: 0;
  padding: 0;
  margin: 0;
}

.tags {
  display: flex;
  flex: 1;
  align-items: center;
  flex-wrap: wrap;
  margin-inline-start: 0.25em;
  gap: 0.25em;

  &::slotted(wa-tag) {
    cursor: pointer !important;
  }

  .disabled &,
  .disabled &::slotted(wa-tag) {
    cursor: not-allowed !important;
  }
}

/* Start and End */

.start,
.end {
  flex: 0;
  display: inline-flex;
  align-items: center;
  color: var(--wa-color-neutral-on-quiet);
}

.end::slotted(*) {
  margin-inline-start: var(--wa-form-control-padding-inline);
}

.start::slotted(*) {
  margin-inline-end: var(--wa-form-control-padding-inline);
}

:host([multiple]) .start::slotted(*) {
  margin-inline: var(--wa-form-control-padding-inline);
}

/* Clear button */
[part~='clear-button'] {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: inherit;
  color: var(--wa-color-neutral-on-quiet);
  border: none;
  background: none;
  padding: 0;
  transition: color var(--wa-transition-normal);
  cursor: pointer;
  margin-inline-start: var(--wa-form-control-padding-inline);

  &:focus {
    outline: none;
  }

  @media (hover: hover) {
    &:hover {
      color: color-mix(in oklab, currentColor, var(--wa-color-mix-hover));
    }
  }

  &:active {
    color: color-mix(in oklab, currentColor, var(--wa-color-mix-active));
  }
}

/* Expand icon */
.expand-icon {
  flex: 0 0 auto;
  display: flex;
  align-items: center;
  color: var(--wa-color-neutral-on-quiet);
  transition: rotate var(--wa-transition-slow) ease;
  rotate: 0deg;
  margin-inline-start: var(--wa-form-control-padding-inline);

  .open & {
    rotate: -180deg;
  }
}

/* Listbox */
.listbox {
  display: block;
  position: relative;
  font: inherit;
  box-shadow: var(--wa-shadow-m);
  background: var(--wa-color-surface-raised);
  border-color: var(--wa-color-surface-border);
  border-radius: var(--wa-border-radius-m);
  border-style: var(--wa-border-style);
  border-width: var(--wa-border-width-s);
  padding-block: 0.5em;
  padding-inline: 0;
  overflow: auto;
  overscroll-behavior: none;

  /* Make sure it adheres to the popup's auto size */
  max-width: var(--auto-size-available-width);
  max-height: var(--auto-size-available-height);

  &::slotted(wa-divider) {
    --spacing: 0.5em;
  }
}

slot:not([name])::slotted(small) {
  display: block;
  font-size: var(--wa-font-size-smaller);
  font-weight: var(--wa-font-weight-semibold);
  color: var(--wa-color-text-quiet);
  padding-block: 0.5em;
  padding-inline: 2.25em;
}
`,Q=class extends Te{constructor(){super(...arguments),this.assumeInteractionOn=["blur","input"],this.hasSlotController=new Bs(this,"hint","label"),this.localize=new wn(this),this.typeToSelectString="",this.displayLabel="",this.selectedOptions=[],this.name="",this._defaultValue=null,this.size="medium",this.placeholder="",this.multiple=!1,this.maxOptionsVisible=3,this.disabled=!1,this.withClear=!1,this.open=!1,this.appearance="outlined",this.pill=!1,this.label="",this.placement="bottom",this.hint="",this.withLabel=!1,this.withHint=!1,this.form=null,this.required=!1,this.getTag=n=>U`
        <wa-tag
          part="tag"
          exportparts="
            base:tag__base,
            content:tag__content,
            remove-button:tag__remove-button,
            remove-button__base:tag__remove-button__base
          "
          ?pill=${this.pill}
          size=${this.size}
          with-remove
        >
          ${n.label}
        </wa-tag>
      `,this.handleDocumentFocusIn=n=>{const t=n.composedPath();this&&!t.includes(this)&&this.hide()},this.handleDocumentKeyDown=n=>{const t=n.target,e=t.closest('[part~="clear-button"]')!==null,i=t.closest("wa-button")!==null;if(!(e||i)){if(n.key==="Escape"&&this.open&&(n.preventDefault(),n.stopPropagation(),this.hide(),this.displayInput.focus({preventScroll:!0})),n.key==="Enter"||n.key===" "&&this.typeToSelectString===""){if(n.preventDefault(),n.stopImmediatePropagation(),!this.open){this.show();return}this.currentOption&&!this.currentOption.disabled&&(this.valueHasChanged=!0,this.hasInteracted=!0,this.multiple?this.toggleOptionSelection(this.currentOption):this.setSelectedOptions(this.currentOption),this.updateComplete.then(()=>{this.dispatchEvent(new InputEvent("input",{bubbles:!0,composed:!0})),this.dispatchEvent(new Event("change",{bubbles:!0,composed:!0}))}),this.multiple||(this.hide(),this.displayInput.focus({preventScroll:!0})));return}if(["ArrowUp","ArrowDown","Home","End"].includes(n.key)){const r=this.getAllOptions(),s=r.indexOf(this.currentOption);let o=Math.max(0,s);if(n.preventDefault(),!this.open&&(this.show(),this.currentOption))return;n.key==="ArrowDown"?(o=s+1,o>r.length-1&&(o=0)):n.key==="ArrowUp"?(o=s-1,o<0&&(o=r.length-1)):n.key==="Home"?o=0:n.key==="End"&&(o=r.length-1),this.setCurrentOption(r[o])}if(n.key?.length===1||n.key==="Backspace"){const r=this.getAllOptions();if(n.metaKey||n.ctrlKey||n.altKey)return;if(!this.open){if(n.key==="Backspace")return;this.show()}n.stopPropagation(),n.preventDefault(),clearTimeout(this.typeToSelectTimeout),this.typeToSelectTimeout=window.setTimeout(()=>this.typeToSelectString="",1e3),n.key==="Backspace"?this.typeToSelectString=this.typeToSelectString.slice(0,-1):this.typeToSelectString+=n.key.toLowerCase();for(const s of r)if(s.label.toLowerCase().startsWith(this.typeToSelectString)){this.setCurrentOption(s);break}}}},this.handleDocumentMouseDown=n=>{const t=n.composedPath();this&&!t.includes(this)&&this.hide()}}static get validators(){const n=[TE({validationElement:Object.assign(document.createElement("select"),{required:!0})})];return[...super.validators,...n]}get validationTarget(){return this.valueInput}set defaultValue(n){this._defaultValue=this.convertDefaultValue(n)}get defaultValue(){return this.convertDefaultValue(this._defaultValue)}convertDefaultValue(n){return!(this.multiple||this.hasAttribute("multiple"))&&Array.isArray(n)&&(n=n[0]),n}set value(n){let t=this.value;n instanceof FormData&&(n=n.getAll(this.name)),n!=null&&!Array.isArray(n)&&(n=[n]),this._value=n??null,this.value!==t&&(this.valueHasChanged=!0,this.requestUpdate("value",t))}get value(){let n=this._value??this.defaultValue??null;n!=null&&(n=Array.isArray(n)?n:[n]),n==null?this.optionValues=new Set(null):this.optionValues=new Set(this.getAllOptions().filter(e=>!e.disabled).map(e=>e.value));let t=n;return n!=null&&(t=n.filter(e=>this.optionValues.has(e)),t=this.multiple?t:t[0],t=t??null),t}connectedCallback(){super.connectedCallback(),this.handleDefaultSlotChange(),this.open=!1}updateDefaultValue(){const t=this.getAllOptions().filter(e=>e.hasAttribute("selected")||e.defaultSelected);if(t.length>0){const e=t.map(i=>i.value);this._defaultValue=this.multiple?e:e[0]}this.hasAttribute("value")&&(this._defaultValue=this.getAttribute("value")||null)}addOpenListeners(){document.addEventListener("focusin",this.handleDocumentFocusIn),document.addEventListener("keydown",this.handleDocumentKeyDown),document.addEventListener("mousedown",this.handleDocumentMouseDown),this.getRootNode()!==document&&this.getRootNode().addEventListener("focusin",this.handleDocumentFocusIn)}removeOpenListeners(){document.removeEventListener("focusin",this.handleDocumentFocusIn),document.removeEventListener("keydown",this.handleDocumentKeyDown),document.removeEventListener("mousedown",this.handleDocumentMouseDown),this.getRootNode()!==document&&this.getRootNode().removeEventListener("focusin",this.handleDocumentFocusIn)}handleFocus(){this.displayInput.setSelectionRange(0,0)}handleLabelClick(){this.displayInput.focus()}handleComboboxClick(n){n.preventDefault()}handleComboboxMouseDown(n){const e=n.composedPath().some(i=>i instanceof Element&&i.tagName.toLowerCase()==="wa-button");this.disabled||e||(n.preventDefault(),this.displayInput.focus({preventScroll:!0}),this.open=!this.open)}handleComboboxKeyDown(n){n.stopPropagation(),this.handleDocumentKeyDown(n)}handleClearClick(n){n.stopPropagation(),this.value!==null&&(this.setSelectedOptions([]),this.displayInput.focus({preventScroll:!0}),this.updateComplete.then(()=>{this.dispatchEvent(new Bp),this.dispatchEvent(new InputEvent("input",{bubbles:!0,composed:!0})),this.dispatchEvent(new Event("change",{bubbles:!0,composed:!0}))}))}handleClearMouseDown(n){n.stopPropagation(),n.preventDefault()}handleOptionClick(n){const e=n.target.closest("wa-option");e&&!e.disabled&&(this.hasInteracted=!0,this.valueHasChanged=!0,this.multiple?this.toggleOptionSelection(e):this.setSelectedOptions(e),this.updateComplete.then(()=>this.displayInput.focus({preventScroll:!0})),this.requestUpdate("value"),this.updateComplete.then(()=>{this.dispatchEvent(new InputEvent("input",{bubbles:!0,composed:!0})),this.dispatchEvent(new Event("change",{bubbles:!0,composed:!0}))}),this.multiple||(this.hide(),this.displayInput.focus({preventScroll:!0})))}handleDefaultSlotChange(){customElements.get("wa-option")||customElements.whenDefined("wa-option").then(()=>this.handleDefaultSlotChange());const n=this.getAllOptions();this.optionValues=void 0,this.updateDefaultValue();let t=this.value;if(t==null||!this.valueHasChanged&&!this.hasInteracted){this.selectionChanged();return}Array.isArray(t)||(t=[t]);const e=n.filter(i=>t.includes(i.value));this.setSelectedOptions(e)}handleTagRemove(n,t){if(n.stopPropagation(),this.disabled)return;let e=t;if(!e){const i=n.target.closest("wa-tag[part~=tag]");if(i){const r=this.shadowRoot?.querySelector('[part="tags"]');if(r){const o=Array.from(r.children).indexOf(i);o>=0&&o<this.selectedOptions.length&&(e=this.selectedOptions[o])}}}e&&(this.toggleOptionSelection(e,!1),this.updateComplete.then(()=>{this.dispatchEvent(new InputEvent("input",{bubbles:!0,composed:!0})),this.dispatchEvent(new Event("change",{bubbles:!0,composed:!0}))}))}getAllOptions(){return this?.querySelectorAll?[...this.querySelectorAll("wa-option")]:[]}getFirstOption(){return this.querySelector("wa-option")}setCurrentOption(n){this.getAllOptions().forEach(e=>{e.current=!1,e.tabIndex=-1}),n&&(this.currentOption=n,n.current=!0,n.tabIndex=0,n.focus())}setSelectedOptions(n){const t=this.getAllOptions(),e=Array.isArray(n)?n:[n];t.forEach(i=>{e.includes(i)||(i.selected=!1)}),e.length&&e.forEach(i=>i.selected=!0),this.selectionChanged()}toggleOptionSelection(n,t){t===!0||t===!1?n.selected=t:n.selected=!n.selected,this.selectionChanged()}selectionChanged(){const n=this.getAllOptions();this.selectedOptions=n.filter(e=>{if(!this.hasInteracted&&!this.valueHasChanged){const i=this.defaultValue,r=Array.isArray(i)?i:[i];return e.hasAttribute("selected")||e.defaultSelected||e.selected||r?.includes(e.value)}return e.selected});let t=new Set(this.selectedOptions.map(e=>e.value));if(t.size>0||this._value){const e=this._value;if(this._value==null){let i=this.defaultValue??[];this._value=Array.isArray(i)?i:[i]}this._value=this._value?.filter(i=>!this.optionValues?.has(i))??null,this._value?.unshift(...t),this.requestUpdate("value",e)}if(this.multiple)this.placeholder&&!this.value?.length?this.displayLabel="":this.displayLabel=this.localize.term("numOptionsSelected",this.selectedOptions.length);else{const e=this.selectedOptions[0];this.displayLabel=e?.label??""}this.updateComplete.then(()=>{this.updateValidity()})}get tags(){return this.selectedOptions.map((n,t)=>{if(t<this.maxOptionsVisible||this.maxOptionsVisible<=0){const e=this.getTag(n,t);return e?typeof e=="string"?IE(e):e:null}else if(t===this.maxOptionsVisible)return U`
          <wa-tag
            part="tag"
            exportparts="
              base:tag__base,
              content:tag__content,
              remove-button:tag__remove-button,
              remove-button__base:tag__remove-button__base
            "
            >+${this.selectedOptions.length-t}</wa-tag
          >
        `;return null})}updated(n){super.updated(n),n.has("value")&&this.customStates.set("blank",!this.value)}handleDisabledChange(){this.disabled&&this.open&&(this.open=!1)}handleValueChange(){const n=this.getAllOptions(),t=Array.isArray(this.value)?this.value:[this.value],e=n.filter(i=>t.includes(i.value));this.setSelectedOptions(e),this.updateValidity()}async handleOpenChange(){if(this.open&&!this.disabled){this.setCurrentOption(this.selectedOptions[0]||this.getFirstOption());const n=new zp;if(this.dispatchEvent(n),n.defaultPrevented){this.open=!1;return}this.addOpenListeners(),this.listbox.hidden=!1,this.popup.active=!0,requestAnimationFrame(()=>{this.setCurrentOption(this.currentOption)}),await er(this.popup.popup,"show"),this.currentOption&&_E(this.currentOption,this.listbox,"vertical","auto"),this.dispatchEvent(new $p)}else{const n=new Vp;if(this.dispatchEvent(n),n.defaultPrevented){this.open=!1;return}this.removeOpenListeners(),await er(this.popup.popup,"hide"),this.listbox.hidden=!0,this.popup.active=!1,this.dispatchEvent(new Np)}}async show(){if(this.open||this.disabled){this.open=!1;return}return this.open=!0,Yd(this,"wa-after-show")}async hide(){if(!this.open||this.disabled){this.open=!1;return}return this.open=!1,Yd(this,"wa-after-hide")}focus(n){this.displayInput.focus(n)}blur(){this.displayInput.blur()}formResetCallback(){this.value=this.defaultValue,super.formResetCallback(),this.handleValueChange(),this.updateComplete.then(()=>{this.dispatchEvent(new InputEvent("input",{bubbles:!0,composed:!0})),this.dispatchEvent(new Event("change",{bubbles:!0,composed:!0}))})}render(){const n=this.hasUpdated?this.hasSlotController.test("label"):this.withLabel,t=this.hasUpdated?this.hasSlotController.test("hint"):this.withHint,e=this.label?!0:!!n,i=this.hint?!0:!!t,r=(this.hasUpdated||Aw)&&this.withClear&&!this.disabled&&this.value&&this.value.length>0,s=!!(this.placeholder&&(!this.value||this.value.length===0));return U`
      <div
        part="form-control"
        class=${zn({"form-control":!0,"form-control-has-label":e})}
      >
        <label
          id="label"
          part="form-control-label label"
          class="label"
          aria-hidden=${e?"false":"true"}
          @click=${this.handleLabelClick}
        >
          <slot name="label">${this.label}</slot>
        </label>

        <div part="form-control-input" class="form-control-input">
          <wa-popup
            class=${zn({select:!0,open:this.open,disabled:this.disabled,enabled:!this.disabled,multiple:this.multiple,"placeholder-visible":s})}
            placement=${this.placement}
            flip
            shift
            sync="width"
            auto-size="vertical"
            auto-size-padding="10"
          >
            <div
              part="combobox"
              class="combobox"
              slot="anchor"
              @keydown=${this.handleComboboxKeyDown}
              @mousedown=${this.handleComboboxMouseDown}
              @click=${this.handleComboboxClick}
            >
              <slot part="start" name="start" class="start"></slot>

              <input
                part="display-input"
                class="display-input"
                type="text"
                placeholder=${this.placeholder}
                .disabled=${this.disabled}
                .value=${this.displayLabel}
                ?required=${this.required}
                autocomplete="off"
                spellcheck="false"
                autocapitalize="off"
                readonly
                aria-invalid=${!this.validity.valid}
                aria-controls="listbox"
                aria-expanded=${this.open?"true":"false"}
                aria-haspopup="listbox"
                aria-labelledby="label"
                aria-disabled=${this.disabled?"true":"false"}
                aria-describedby="hint"
                role="combobox"
                tabindex="0"
                @focus=${this.handleFocus}
              />

              <!-- Tags need to wait for first hydration before populating otherwise it will create a hydration mismatch. -->
              ${this.multiple&&this.hasUpdated?U`<div part="tags" class="tags" @wa-remove=${this.handleTagRemove}>${this.tags}</div>`:""}

              <input
                class="value-input"
                type="text"
                ?disabled=${this.disabled}
                ?required=${this.required}
                .value=${Array.isArray(this.value)?this.value.join(", "):this.value}
                tabindex="-1"
                aria-hidden="true"
                @focus=${()=>this.focus()}
              />

              ${r?U`
                    <button
                      part="clear-button"
                      type="button"
                      aria-label=${this.localize.term("clearEntry")}
                      @mousedown=${this.handleClearMouseDown}
                      @click=${this.handleClearClick}
                      tabindex="-1"
                    >
                      <slot name="clear-icon">
                        <wa-icon name="circle-xmark" library="system" variant="regular"></wa-icon>
                      </slot>
                    </button>
                  `:""}

              <slot name="end" part="end" class="end"></slot>

              <slot name="expand-icon" part="expand-icon" class="expand-icon">
                <wa-icon library="system" name="chevron-down" variant="solid"></wa-icon>
              </slot>
            </div>

            <div
              id="listbox"
              role="listbox"
              aria-expanded=${this.open?"true":"false"}
              aria-multiselectable=${this.multiple?"true":"false"}
              aria-labelledby="label"
              part="listbox"
              class="listbox"
              tabindex="-1"
              @mouseup=${this.handleOptionClick}
            >
              <slot @slotchange=${this.handleDefaultSlotChange}></slot>
            </div>
          </wa-popup>
        </div>

        <slot
          id="hint"
          name="hint"
          part="hint"
          class=${zn({"has-slotted":i})}
          aria-hidden=${i?"false":"true"}
          >${this.hint}</slot
        >
      </div>
    `}};Q.css=[RE,Up,Rr];A([At(".select")],Q.prototype,"popup",2);A([At(".combobox")],Q.prototype,"combobox",2);A([At(".display-input")],Q.prototype,"displayInput",2);A([At(".value-input")],Q.prototype,"valueInput",2);A([At(".listbox")],Q.prototype,"listbox",2);A([Ft()],Q.prototype,"displayLabel",2);A([Ft()],Q.prototype,"currentOption",2);A([Ft()],Q.prototype,"selectedOptions",2);A([Ft()],Q.prototype,"optionValues",2);A([P()],Q.prototype,"name",2);A([P({attribute:!1})],Q.prototype,"defaultValue",1);A([P({attribute:"value",reflect:!1})],Q.prototype,"value",1);A([P({reflect:!0})],Q.prototype,"size",2);A([P()],Q.prototype,"placeholder",2);A([P({type:Boolean,reflect:!0})],Q.prototype,"multiple",2);A([P({attribute:"max-options-visible",type:Number})],Q.prototype,"maxOptionsVisible",2);A([P({type:Boolean})],Q.prototype,"disabled",2);A([P({attribute:"with-clear",type:Boolean})],Q.prototype,"withClear",2);A([P({type:Boolean,reflect:!0})],Q.prototype,"open",2);A([P({reflect:!0})],Q.prototype,"appearance",2);A([P({type:Boolean,reflect:!0})],Q.prototype,"pill",2);A([P()],Q.prototype,"label",2);A([P({reflect:!0})],Q.prototype,"placement",2);A([P({attribute:"hint"})],Q.prototype,"hint",2);A([P({attribute:"with-label",type:Boolean})],Q.prototype,"withLabel",2);A([P({attribute:"with-hint",type:Boolean})],Q.prototype,"withHint",2);A([P({reflect:!0})],Q.prototype,"form",2);A([P({type:Boolean,reflect:!0})],Q.prototype,"required",2);A([P({attribute:!1})],Q.prototype,"getTag",2);A([ti("disabled",{waitUntilFirstUpdate:!0})],Q.prototype,"handleDisabledChange",1);A([ti("value",{waitUntilFirstUpdate:!0})],Q.prototype,"handleValueChange",1);A([ti("open",{waitUntilFirstUpdate:!0})],Q.prototype,"handleOpenChange",1);Q=A([bt("wa-select")],Q);var AE=class extends Event{constructor(){super("wa-remove",{bubbles:!0,cancelable:!1,composed:!0})}},PE=`@layer wa-component {
  :host {
    display: inline-flex;
    gap: 0.5em;
    border-radius: var(--wa-border-radius-m);
    align-items: center;
    background-color: var(--wa-color-fill-quiet, var(--wa-color-neutral-fill-quiet));
    border-color: var(--wa-color-border-normal, var(--wa-color-neutral-border-normal));
    border-style: var(--wa-border-style);
    border-width: var(--wa-border-width-s);
    color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
    font-size: inherit;
    line-height: 1;
    white-space: nowrap;
    user-select: none;
    -webkit-user-select: none;
    height: calc(var(--wa-form-control-height) * 0.8);
    line-height: calc(var(--wa-form-control-height) - var(--wa-form-control-border-width) * 2);
    padding: 0 0.75em;
  }

  /* Appearance modifiers */
  :host([appearance='outlined']) {
    color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
    background-color: transparent;
    border-color: var(--wa-color-border-loud, var(--wa-color-neutral-border-loud));
  }

  :host([appearance='filled']) {
    color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
    background-color: var(--wa-color-fill-quiet, var(--wa-color-neutral-fill-quiet));
    border-color: transparent;
  }

  :host([appearance='filled-outlined']) {
    color: var(--wa-color-on-quiet, var(--wa-color-neutral-on-quiet));
    background-color: var(--wa-color-fill-quiet, var(--wa-color-neutral-fill-quiet));
    border-color: var(--wa-color-border-normal, var(--wa-color-neutral-border-normal));
  }

  :host([appearance='accent']) {
    color: var(--wa-color-on-loud, var(--wa-color-neutral-on-loud));
    background-color: var(--wa-color-fill-loud, var(--wa-color-neutral-fill-loud));
    border-color: transparent;
  }
}

.content {
  font-size: var(--wa-font-size-smaller);
}

[part='remove-button'] {
  color: inherit;
  line-height: 1;
}

[part='remove-button']::part(base) {
  padding: 0;
  height: 1em;
  width: 1em;
}

@media (hover: hover) {
  :host(:hover) > [part='remove-button']::part(base) {
    color: color-mix(in oklab, currentColor, var(--wa-color-mix-hover));
  }
}

:host(:active) > [part='remove-button']::part(base) {
  color: color-mix(in oklab, currentColor, var(--wa-color-mix-active));
}

/*
 * Pill modifier
 */
:host([pill]) {
  border-radius: var(--wa-border-radius-pill);
}
`,qn=class extends ue{constructor(){super(...arguments),this.localize=new wn(this),this.variant="neutral",this.appearance="filled-outlined",this.size="medium",this.pill=!1,this.withRemove=!1}handleRemoveClick(){this.dispatchEvent(new AE)}render(){return U`
      <slot part="content" class="content"></slot>

      ${this.withRemove?U`
            <wa-button
              part="remove-button"
              exportparts="base:remove-button__base"
              class="remove"
              appearance="plain"
              @click=${this.handleRemoveClick}
              tabindex="-1"
            >
              <wa-icon name="xmark" library="system" variant="solid" label=${this.localize.term("remove")}></wa-icon>
            </wa-button>
          `:""}
    `}};qn.css=[PE,xh,Rr];A([P({reflect:!0})],qn.prototype,"variant",2);A([P({reflect:!0})],qn.prototype,"appearance",2);A([P({reflect:!0})],qn.prototype,"size",2);A([P({type:Boolean,reflect:!0})],qn.prototype,"pill",2);A([P({attribute:"with-remove",type:Boolean})],qn.prototype,"withRemove",2);qn=A([bt("wa-tag")],qn);function ts(n,t=0){if(!n||!globalThis.Node)return"";if(typeof n[Symbol.iterator]=="function")return(Array.isArray(n)?n:[...n]).map(r=>ts(r,--t)).join("");let e=n;if(e.nodeType===Node.TEXT_NODE)return e.textContent??"";if(e.nodeType===Node.ELEMENT_NODE){let i=e;if(i.hasAttribute("slot")||i.matches("style, script"))return"";if(i instanceof HTMLSlotElement){let r=i.assignedNodes({flatten:!0});if(r.length>0)return ts(r,--t)}return t>-1?ts(i,--t):i.textContent??""}return e.hasChildNodes()?ts(e.childNodes,--t):""}var LE=`:host {
  display: block;
  color: var(--wa-color-text-normal);
  -webkit-user-select: none;
  user-select: none;

  position: relative;
  display: flex;
  align-items: center;
  font: inherit;
  padding: 0.5em 1em 0.5em 0.25em;
  line-height: var(--wa-line-height-condensed);
  transition: fill var(--wa-transition-normal) var(--wa-transition-easing);
  cursor: pointer;
}

:host(:focus) {
  outline: none;
}

@media (hover: hover) {
  :host(:not([disabled], :state(current)):is(:state(hover), :hover)) {
    background-color: var(--wa-color-neutral-fill-normal);
    color: var(--wa-color-neutral-on-normal);
  }
}

:host(:state(current)),
:host([disabled]:state(current)) {
  background-color: var(--wa-color-brand-fill-loud);
  color: var(--wa-color-brand-on-loud);
  opacity: 1;
}

:host([disabled]) {
  outline: none;
  opacity: 0.5;
  cursor: not-allowed;
}

.label {
  flex: 1 1 auto;
  display: inline-block;
}

.check {
  flex: 0 0 auto;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: var(--wa-font-size-smaller);
  visibility: hidden;
  width: 2em;
}

:host(:state(selected)) .check {
  visibility: visible;
}

.start,
.end {
  flex: 0 0 auto;
  display: flex;
  align-items: center;
}

.start::slotted(*) {
  margin-inline-end: 0.5em;
}

.end::slotted(*) {
  margin-inline-start: 0.5em;
}

@media (forced-colors: active) {
  :host(:hover:not([aria-disabled='true'])) {
    outline: dashed 1px SelectedItem;
    outline-offset: -1px;
  }
}
`,Oe=class extends ue{constructor(){super(...arguments),this.localize=new wn(this),this.isInitialized=!1,this.current=!1,this.value="",this.disabled=!1,this.selected=!1,this.defaultSelected=!1,this._label="",this.defaultLabel="",this.handleHover=n=>{n.type==="mouseenter"?this.customStates.set("hover",!0):n.type==="mouseleave"&&this.customStates.set("hover",!1)}}set label(n){const t=this._label;this._label=n||"",this._label!==t&&this.requestUpdate("label",t)}get label(){return this._label?this._label:(this.defaultLabel||this.updateDefaultLabel(),this.defaultLabel)}connectedCallback(){super.connectedCallback(),this.setAttribute("role","option"),this.setAttribute("aria-selected","false"),this.addEventListener("mouseenter",this.handleHover),this.addEventListener("mouseleave",this.handleHover),this.updateDefaultLabel()}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("mouseenter",this.handleHover),this.removeEventListener("mouseleave",this.handleHover)}handleDefaultSlotChange(){this.updateDefaultLabel(),this.isInitialized?customElements.whenDefined("wa-select").then(()=>{const n=this.closest("wa-select");n&&(n.handleDefaultSlotChange(),n.selectionChanged?.())}):this.isInitialized=!0}willUpdate(n){if(n.has("defaultSelected")&&!this.closest("wa-select")?.hasInteracted){const t=this.selected;this.selected=this.defaultSelected,this.requestUpdate("selected",t)}super.willUpdate(n)}updated(n){super.updated(n),n.has("disabled")&&this.setAttribute("aria-disabled",this.disabled?"true":"false"),n.has("selected")&&(this.setAttribute("aria-selected",this.selected?"true":"false"),this.customStates.set("selected",this.selected),this.handleDefaultSlotChange()),n.has("value")&&(typeof this.value!="string"&&(this.value=String(this.value)),this.handleDefaultSlotChange()),n.has("current")&&this.customStates.set("current",this.current)}updateDefaultLabel(){let n=this.defaultLabel;this.defaultLabel=ts(this).trim();let t=this.defaultLabel!==n;return!this._label&&t&&this.requestUpdate("label",n),t}render(){return U`
      <wa-icon
        part="checked-icon"
        class="check"
        name="check"
        library="system"
        variant="solid"
        aria-hidden="true"
      ></wa-icon>
      <slot part="start" name="start" class="start"></slot>
      <slot part="label" class="label" @slotchange=${this.handleDefaultSlotChange}></slot>
      <slot part="end" name="end" class="end"></slot>
    `}};Oe.css=LE;A([At(".label")],Oe.prototype,"defaultSlot",2);A([Ft()],Oe.prototype,"current",2);A([P({reflect:!0})],Oe.prototype,"value",2);A([P({type:Boolean})],Oe.prototype,"disabled",2);A([P({type:Boolean,attribute:!1})],Oe.prototype,"selected",2);A([P({type:Boolean,attribute:"selected"})],Oe.prototype,"defaultSelected",2);A([P()],Oe.prototype,"label",1);A([Ft()],Oe.prototype,"defaultLabel",2);Oe=A([bt("wa-option")],Oe);var OE=class extends Event{constructor(){super("wa-reposition",{bubbles:!0,cancelable:!1,composed:!0})}};const Hn=Math.min,le=Math.max,Wo=Math.round,go=Math.floor,We=n=>({x:n,y:n}),kE={left:"right",right:"left",bottom:"top",top:"bottom"},DE={start:"end",end:"start"};function Tc(n,t,e){return le(n,Hn(t,e))}function Lr(n,t){return typeof n=="function"?n(t):n}function Xn(n){return n.split("-")[0]}function Or(n){return n.split("-")[1]}function jp(n){return n==="x"?"y":"x"}function Kh(n){return n==="y"?"height":"width"}const ME=new Set(["top","bottom"]);function on(n){return ME.has(Xn(n))?"y":"x"}function Yh(n){return jp(on(n))}function FE(n,t,e){e===void 0&&(e=!1);const i=Or(n),r=Yh(n),s=Kh(r);let o=r==="x"?i===(e?"end":"start")?"right":"left":i==="start"?"bottom":"top";return t.reference[s]>t.floating[s]&&(o=qo(o)),[o,qo(o)]}function NE(n){const t=qo(n);return[Ic(n),t,Ic(t)]}function Ic(n){return n.replace(/start|end/g,t=>DE[t])}const Zd=["left","right"],Jd=["right","left"],$E=["top","bottom"],VE=["bottom","top"];function zE(n,t,e){switch(n){case"top":case"bottom":return e?t?Jd:Zd:t?Zd:Jd;case"left":case"right":return t?$E:VE;default:return[]}}function GE(n,t,e,i){const r=Or(n);let s=zE(Xn(n),e==="start",i);return r&&(s=s.map(o=>o+"-"+r),t&&(s=s.concat(s.map(Ic)))),s}function qo(n){return n.replace(/left|right|bottom|top/g,t=>kE[t])}function BE(n){return{top:0,right:0,bottom:0,left:0,...n}}function Wp(n){return typeof n!="number"?BE(n):{top:n,right:n,bottom:n,left:n}}function Ho(n){const{x:t,y:e,width:i,height:r}=n;return{width:i,height:r,top:e,left:t,right:t+i,bottom:e+r,x:t,y:e}}function Qd(n,t,e){let{reference:i,floating:r}=n;const s=on(t),o=Yh(t),a=Kh(o),l=Xn(t),c=s==="y",h=i.x+i.width/2-r.width/2,u=i.y+i.height/2-r.height/2,d=i[a]/2-r[a]/2;let f;switch(l){case"top":f={x:h,y:i.y-r.height};break;case"bottom":f={x:h,y:i.y+i.height};break;case"right":f={x:i.x+i.width,y:u};break;case"left":f={x:i.x-r.width,y:u};break;default:f={x:i.x,y:i.y}}switch(Or(t)){case"start":f[o]-=d*(e&&c?-1:1);break;case"end":f[o]+=d*(e&&c?-1:1);break}return f}const UE=async(n,t,e)=>{const{placement:i="bottom",strategy:r="absolute",middleware:s=[],platform:o}=e,a=s.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(t));let c=await o.getElementRects({reference:n,floating:t,strategy:r}),{x:h,y:u}=Qd(c,i,l),d=i,f={},g=0;for(let y=0;y<a.length;y++){const{name:_,fn:b}=a[y],{x:S,y:R,data:T,reset:I}=await b({x:h,y:u,initialPlacement:i,placement:d,strategy:r,middlewareData:f,rects:c,platform:o,elements:{reference:n,floating:t}});h=S??h,u=R??u,f={...f,[_]:{...f[_],...T}},I&&g<=50&&(g++,typeof I=="object"&&(I.placement&&(d=I.placement),I.rects&&(c=I.rects===!0?await o.getElementRects({reference:n,floating:t,strategy:r}):I.rects),{x:h,y:u}=Qd(c,d,l)),y=-1)}return{x:h,y:u,placement:d,strategy:r,middlewareData:f}};async function Zh(n,t){var e;t===void 0&&(t={});const{x:i,y:r,platform:s,rects:o,elements:a,strategy:l}=n,{boundary:c="clippingAncestors",rootBoundary:h="viewport",elementContext:u="floating",altBoundary:d=!1,padding:f=0}=Lr(t,n),g=Wp(f),_=a[d?u==="floating"?"reference":"floating":u],b=Ho(await s.getClippingRect({element:(e=await(s.isElement==null?void 0:s.isElement(_)))==null||e?_:_.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:c,rootBoundary:h,strategy:l})),S=u==="floating"?{x:i,y:r,width:o.floating.width,height:o.floating.height}:o.reference,R=await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),T=await(s.isElement==null?void 0:s.isElement(R))?await(s.getScale==null?void 0:s.getScale(R))||{x:1,y:1}:{x:1,y:1},I=Ho(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:S,offsetParent:R,strategy:l}):S);return{top:(b.top-I.top+g.top)/T.y,bottom:(I.bottom-b.bottom+g.bottom)/T.y,left:(b.left-I.left+g.left)/T.x,right:(I.right-b.right+g.right)/T.x}}const jE=n=>({name:"arrow",options:n,async fn(t){const{x:e,y:i,placement:r,rects:s,platform:o,elements:a,middlewareData:l}=t,{element:c,padding:h=0}=Lr(n,t)||{};if(c==null)return{};const u=Wp(h),d={x:e,y:i},f=Yh(r),g=Kh(f),y=await o.getDimensions(c),_=f==="y",b=_?"top":"left",S=_?"bottom":"right",R=_?"clientHeight":"clientWidth",T=s.reference[g]+s.reference[f]-d[f]-s.floating[g],I=d[f]-s.reference[f],L=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let w=L?L[R]:0;(!w||!await(o.isElement==null?void 0:o.isElement(L)))&&(w=a.floating[R]||s.floating[g]);const p=T/2-I/2,m=w/2-y[g]/2-1,E=Hn(u[b],m),x=Hn(u[S],m),C=E,v=w-y[g]-x,M=w/2-y[g]/2+p,F=Tc(C,M,v),$=!l.arrow&&Or(r)!=null&&M!==F&&s.reference[g]/2-(M<C?E:x)-y[g]/2<0,D=$?M<C?M-C:M-v:0;return{[f]:d[f]+D,data:{[f]:F,centerOffset:M-F-D,...$&&{alignmentOffset:D}},reset:$}}}),WE=function(n){return n===void 0&&(n={}),{name:"flip",options:n,async fn(t){var e,i;const{placement:r,middlewareData:s,rects:o,initialPlacement:a,platform:l,elements:c}=t,{mainAxis:h=!0,crossAxis:u=!0,fallbackPlacements:d,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:y=!0,..._}=Lr(n,t);if((e=s.arrow)!=null&&e.alignmentOffset)return{};const b=Xn(r),S=on(a),R=Xn(a)===a,T=await(l.isRTL==null?void 0:l.isRTL(c.floating)),I=d||(R||!y?[qo(a)]:NE(a)),L=g!=="none";!d&&L&&I.push(...GE(a,y,g,T));const w=[a,...I],p=await Zh(t,_),m=[];let E=((i=s.flip)==null?void 0:i.overflows)||[];if(h&&m.push(p[b]),u){const M=FE(r,o,T);m.push(p[M[0]],p[M[1]])}if(E=[...E,{placement:r,overflows:m}],!m.every(M=>M<=0)){var x,C;const M=(((x=s.flip)==null?void 0:x.index)||0)+1,F=w[M];if(F&&(!(u==="alignment"?S!==on(F):!1)||E.every(N=>on(N.placement)===S?N.overflows[0]>0:!0)))return{data:{index:M,overflows:E},reset:{placement:F}};let $=(C=E.filter(D=>D.overflows[0]<=0).sort((D,N)=>D.overflows[1]-N.overflows[1])[0])==null?void 0:C.placement;if(!$)switch(f){case"bestFit":{var v;const D=(v=E.filter(N=>{if(L){const B=on(N.placement);return B===S||B==="y"}return!0}).map(N=>[N.placement,N.overflows.filter(B=>B>0).reduce((B,Z)=>B+Z,0)]).sort((N,B)=>N[1]-B[1])[0])==null?void 0:v[0];D&&($=D);break}case"initialPlacement":$=a;break}if(r!==$)return{reset:{placement:$}}}return{}}}},qE=new Set(["left","top"]);async function HE(n,t){const{placement:e,platform:i,elements:r}=n,s=await(i.isRTL==null?void 0:i.isRTL(r.floating)),o=Xn(e),a=Or(e),l=on(e)==="y",c=qE.has(o)?-1:1,h=s&&l?-1:1,u=Lr(t,n);let{mainAxis:d,crossAxis:f,alignmentAxis:g}=typeof u=="number"?{mainAxis:u,crossAxis:0,alignmentAxis:null}:{mainAxis:u.mainAxis||0,crossAxis:u.crossAxis||0,alignmentAxis:u.alignmentAxis};return a&&typeof g=="number"&&(f=a==="end"?g*-1:g),l?{x:f*h,y:d*c}:{x:d*c,y:f*h}}const XE=function(n){return n===void 0&&(n=0),{name:"offset",options:n,async fn(t){var e,i;const{x:r,y:s,placement:o,middlewareData:a}=t,l=await HE(t,n);return o===((e=a.offset)==null?void 0:e.placement)&&(i=a.arrow)!=null&&i.alignmentOffset?{}:{x:r+l.x,y:s+l.y,data:{...l,placement:o}}}}},KE=function(n){return n===void 0&&(n={}),{name:"shift",options:n,async fn(t){const{x:e,y:i,placement:r}=t,{mainAxis:s=!0,crossAxis:o=!1,limiter:a={fn:_=>{let{x:b,y:S}=_;return{x:b,y:S}}},...l}=Lr(n,t),c={x:e,y:i},h=await Zh(t,l),u=on(Xn(r)),d=jp(u);let f=c[d],g=c[u];if(s){const _=d==="y"?"top":"left",b=d==="y"?"bottom":"right",S=f+h[_],R=f-h[b];f=Tc(S,f,R)}if(o){const _=u==="y"?"top":"left",b=u==="y"?"bottom":"right",S=g+h[_],R=g-h[b];g=Tc(S,g,R)}const y=a.fn({...t,[d]:f,[u]:g});return{...y,data:{x:y.x-e,y:y.y-i,enabled:{[d]:s,[u]:o}}}}}},YE=function(n){return n===void 0&&(n={}),{name:"size",options:n,async fn(t){var e,i;const{placement:r,rects:s,platform:o,elements:a}=t,{apply:l=()=>{},...c}=Lr(n,t),h=await Zh(t,c),u=Xn(r),d=Or(r),f=on(r)==="y",{width:g,height:y}=s.floating;let _,b;u==="top"||u==="bottom"?(_=u,b=d===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(b=u,_=d==="end"?"top":"bottom");const S=y-h.top-h.bottom,R=g-h.left-h.right,T=Hn(y-h[_],S),I=Hn(g-h[b],R),L=!t.middlewareData.shift;let w=T,p=I;if((e=t.middlewareData.shift)!=null&&e.enabled.x&&(p=R),(i=t.middlewareData.shift)!=null&&i.enabled.y&&(w=S),L&&!d){const E=le(h.left,0),x=le(h.right,0),C=le(h.top,0),v=le(h.bottom,0);f?p=g-2*(E!==0||x!==0?E+x:le(h.left,h.right)):w=y-2*(C!==0||v!==0?C+v:le(h.top,h.bottom))}await l({...t,availableWidth:p,availableHeight:w});const m=await o.getDimensions(a.floating);return g!==m.width||y!==m.height?{reset:{rects:!0}}:{}}}};function $a(){return typeof window<"u"}function kr(n){return qp(n)?(n.nodeName||"").toLowerCase():"#document"}function he(n){var t;return(n==null||(t=n.ownerDocument)==null?void 0:t.defaultView)||window}function Ye(n){var t;return(t=(qp(n)?n.ownerDocument:n.document)||window.document)==null?void 0:t.documentElement}function qp(n){return $a()?n instanceof Node||n instanceof he(n).Node:!1}function ke(n){return $a()?n instanceof Element||n instanceof he(n).Element:!1}function Xe(n){return $a()?n instanceof HTMLElement||n instanceof he(n).HTMLElement:!1}function tf(n){return!$a()||typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof he(n).ShadowRoot}const ZE=new Set(["inline","contents"]);function Xs(n){const{overflow:t,overflowX:e,overflowY:i,display:r}=De(n);return/auto|scroll|overlay|hidden|clip/.test(t+i+e)&&!ZE.has(r)}const JE=new Set(["table","td","th"]);function QE(n){return JE.has(kr(n))}const t2=[":popover-open",":modal"];function Va(n){return t2.some(t=>{try{return n.matches(t)}catch{return!1}})}const e2=["transform","translate","scale","rotate","perspective"],n2=["transform","translate","scale","rotate","perspective","filter"],i2=["paint","layout","strict","content"];function za(n){const t=Jh(),e=ke(n)?De(n):n;return e2.some(i=>e[i]?e[i]!=="none":!1)||(e.containerType?e.containerType!=="normal":!1)||!t&&(e.backdropFilter?e.backdropFilter!=="none":!1)||!t&&(e.filter?e.filter!=="none":!1)||n2.some(i=>(e.willChange||"").includes(i))||i2.some(i=>(e.contain||"").includes(i))}function r2(n){let t=Kn(n);for(;Xe(t)&&!vr(t);){if(za(t))return t;if(Va(t))return null;t=Kn(t)}return null}function Jh(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const s2=new Set(["html","body","#document"]);function vr(n){return s2.has(kr(n))}function De(n){return he(n).getComputedStyle(n)}function Ga(n){return ke(n)?{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}:{scrollLeft:n.scrollX,scrollTop:n.scrollY}}function Kn(n){if(kr(n)==="html")return n;const t=n.assignedSlot||n.parentNode||tf(n)&&n.host||Ye(n);return tf(t)?t.host:t}function Hp(n){const t=Kn(n);return vr(t)?n.ownerDocument?n.ownerDocument.body:n.body:Xe(t)&&Xs(t)?t:Hp(t)}function br(n,t,e){var i;t===void 0&&(t=[]),e===void 0&&(e=!0);const r=Hp(n),s=r===((i=n.ownerDocument)==null?void 0:i.body),o=he(r);if(s){const a=Rc(o);return t.concat(o,o.visualViewport||[],Xs(r)?r:[],a&&e?br(a):[])}return t.concat(r,br(r,[],e))}function Rc(n){return n.parent&&Object.getPrototypeOf(n.parent)?n.frameElement:null}function Xp(n){const t=De(n);let e=parseFloat(t.width)||0,i=parseFloat(t.height)||0;const r=Xe(n),s=r?n.offsetWidth:e,o=r?n.offsetHeight:i,a=Wo(e)!==s||Wo(i)!==o;return a&&(e=s,i=o),{width:e,height:i,$:a}}function Qh(n){return ke(n)?n:n.contextElement}function ar(n){const t=Qh(n);if(!Xe(t))return We(1);const e=t.getBoundingClientRect(),{width:i,height:r,$:s}=Xp(t);let o=(s?Wo(e.width):e.width)/i,a=(s?Wo(e.height):e.height)/r;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const o2=We(0);function Kp(n){const t=he(n);return!Jh()||!t.visualViewport?o2:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function a2(n,t,e){return t===void 0&&(t=!1),!e||t&&e!==he(n)?!1:t}function Ti(n,t,e,i){t===void 0&&(t=!1),e===void 0&&(e=!1);const r=n.getBoundingClientRect(),s=Qh(n);let o=We(1);t&&(i?ke(i)&&(o=ar(i)):o=ar(n));const a=a2(s,e,i)?Kp(s):We(0);let l=(r.left+a.x)/o.x,c=(r.top+a.y)/o.y,h=r.width/o.x,u=r.height/o.y;if(s){const d=he(s),f=i&&ke(i)?he(i):i;let g=d,y=Rc(g);for(;y&&i&&f!==g;){const _=ar(y),b=y.getBoundingClientRect(),S=De(y),R=b.left+(y.clientLeft+parseFloat(S.paddingLeft))*_.x,T=b.top+(y.clientTop+parseFloat(S.paddingTop))*_.y;l*=_.x,c*=_.y,h*=_.x,u*=_.y,l+=R,c+=T,g=he(y),y=Rc(g)}}return Ho({width:h,height:u,x:l,y:c})}function Ba(n,t){const e=Ga(n).scrollLeft;return t?t.left+e:Ti(Ye(n)).left+e}function Yp(n,t){const e=n.getBoundingClientRect(),i=e.left+t.scrollLeft-Ba(n,e),r=e.top+t.scrollTop;return{x:i,y:r}}function l2(n){let{elements:t,rect:e,offsetParent:i,strategy:r}=n;const s=r==="fixed",o=Ye(i),a=t?Va(t.floating):!1;if(i===o||a&&s)return e;let l={scrollLeft:0,scrollTop:0},c=We(1);const h=We(0),u=Xe(i);if((u||!u&&!s)&&((kr(i)!=="body"||Xs(o))&&(l=Ga(i)),Xe(i))){const f=Ti(i);c=ar(i),h.x=f.x+i.clientLeft,h.y=f.y+i.clientTop}const d=o&&!u&&!s?Yp(o,l):We(0);return{width:e.width*c.x,height:e.height*c.y,x:e.x*c.x-l.scrollLeft*c.x+h.x+d.x,y:e.y*c.y-l.scrollTop*c.y+h.y+d.y}}function c2(n){return Array.from(n.getClientRects())}function h2(n){const t=Ye(n),e=Ga(n),i=n.ownerDocument.body,r=le(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),s=le(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight);let o=-e.scrollLeft+Ba(n);const a=-e.scrollTop;return De(i).direction==="rtl"&&(o+=le(t.clientWidth,i.clientWidth)-r),{width:r,height:s,x:o,y:a}}const ef=25;function u2(n,t){const e=he(n),i=Ye(n),r=e.visualViewport;let s=i.clientWidth,o=i.clientHeight,a=0,l=0;if(r){s=r.width,o=r.height;const h=Jh();(!h||h&&t==="fixed")&&(a=r.offsetLeft,l=r.offsetTop)}const c=Ba(i);if(c<=0){const h=i.ownerDocument,u=h.body,d=getComputedStyle(u),f=h.compatMode==="CSS1Compat"&&parseFloat(d.marginLeft)+parseFloat(d.marginRight)||0,g=Math.abs(i.clientWidth-u.clientWidth-f);g<=ef&&(s-=g)}else c<=ef&&(s+=c);return{width:s,height:o,x:a,y:l}}const d2=new Set(["absolute","fixed"]);function f2(n,t){const e=Ti(n,!0,t==="fixed"),i=e.top+n.clientTop,r=e.left+n.clientLeft,s=Xe(n)?ar(n):We(1),o=n.clientWidth*s.x,a=n.clientHeight*s.y,l=r*s.x,c=i*s.y;return{width:o,height:a,x:l,y:c}}function nf(n,t,e){let i;if(t==="viewport")i=u2(n,e);else if(t==="document")i=h2(Ye(n));else if(ke(t))i=f2(t,e);else{const r=Kp(n);i={x:t.x-r.x,y:t.y-r.y,width:t.width,height:t.height}}return Ho(i)}function Zp(n,t){const e=Kn(n);return e===t||!ke(e)||vr(e)?!1:De(e).position==="fixed"||Zp(e,t)}function g2(n,t){const e=t.get(n);if(e)return e;let i=br(n,[],!1).filter(a=>ke(a)&&kr(a)!=="body"),r=null;const s=De(n).position==="fixed";let o=s?Kn(n):n;for(;ke(o)&&!vr(o);){const a=De(o),l=za(o);!l&&a.position==="fixed"&&(r=null),(s?!l&&!r:!l&&a.position==="static"&&!!r&&d2.has(r.position)||Xs(o)&&!l&&Zp(n,o))?i=i.filter(h=>h!==o):r=a,o=Kn(o)}return t.set(n,i),i}function p2(n){let{element:t,boundary:e,rootBoundary:i,strategy:r}=n;const o=[...e==="clippingAncestors"?Va(t)?[]:g2(t,this._c):[].concat(e),i],a=o[0],l=o.reduce((c,h)=>{const u=nf(t,h,r);return c.top=le(u.top,c.top),c.right=Hn(u.right,c.right),c.bottom=Hn(u.bottom,c.bottom),c.left=le(u.left,c.left),c},nf(t,a,r));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function m2(n){const{width:t,height:e}=Xp(n);return{width:t,height:e}}function _2(n,t,e){const i=Xe(t),r=Ye(t),s=e==="fixed",o=Ti(n,!0,s,t);let a={scrollLeft:0,scrollTop:0};const l=We(0);function c(){l.x=Ba(r)}if(i||!i&&!s)if((kr(t)!=="body"||Xs(r))&&(a=Ga(t)),i){const f=Ti(t,!0,s,t);l.x=f.x+t.clientLeft,l.y=f.y+t.clientTop}else r&&c();s&&!i&&r&&c();const h=r&&!i&&!s?Yp(r,a):We(0),u=o.left+a.scrollLeft-l.x-h.x,d=o.top+a.scrollTop-l.y-h.y;return{x:u,y:d,width:o.width,height:o.height}}function Fl(n){return De(n).position==="static"}function rf(n,t){if(!Xe(n)||De(n).position==="fixed")return null;if(t)return t(n);let e=n.offsetParent;return Ye(n)===e&&(e=e.ownerDocument.body),e}function Jp(n,t){const e=he(n);if(Va(n))return e;if(!Xe(n)){let r=Kn(n);for(;r&&!vr(r);){if(ke(r)&&!Fl(r))return r;r=Kn(r)}return e}let i=rf(n,t);for(;i&&QE(i)&&Fl(i);)i=rf(i,t);return i&&vr(i)&&Fl(i)&&!za(i)?e:i||r2(n)||e}const y2=async function(n){const t=this.getOffsetParent||Jp,e=this.getDimensions,i=await e(n.floating);return{reference:_2(n.reference,await t(n.floating),n.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}};function w2(n){return De(n).direction==="rtl"}const Eo={convertOffsetParentRelativeRectToViewportRelativeRect:l2,getDocumentElement:Ye,getClippingRect:p2,getOffsetParent:Jp,getElementRects:y2,getClientRects:c2,getDimensions:m2,getScale:ar,isElement:ke,isRTL:w2};function Qp(n,t){return n.x===t.x&&n.y===t.y&&n.width===t.width&&n.height===t.height}function v2(n,t){let e=null,i;const r=Ye(n);function s(){var a;clearTimeout(i),(a=e)==null||a.disconnect(),e=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),s();const c=n.getBoundingClientRect(),{left:h,top:u,width:d,height:f}=c;if(a||t(),!d||!f)return;const g=go(u),y=go(r.clientWidth-(h+d)),_=go(r.clientHeight-(u+f)),b=go(h),R={rootMargin:-g+"px "+-y+"px "+-_+"px "+-b+"px",threshold:le(0,Hn(1,l))||1};let T=!0;function I(L){const w=L[0].intersectionRatio;if(w!==l){if(!T)return o();w?o(!1,w):i=setTimeout(()=>{o(!1,1e-7)},1e3)}w===1&&!Qp(c,n.getBoundingClientRect())&&o(),T=!1}try{e=new IntersectionObserver(I,{...R,root:r.ownerDocument})}catch{e=new IntersectionObserver(I,R)}e.observe(n)}return o(!0),s}function b2(n,t,e,i){i===void 0&&(i={});const{ancestorScroll:r=!0,ancestorResize:s=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=i,c=Qh(n),h=r||s?[...c?br(c):[],...br(t)]:[];h.forEach(b=>{r&&b.addEventListener("scroll",e,{passive:!0}),s&&b.addEventListener("resize",e)});const u=c&&a?v2(c,e):null;let d=-1,f=null;o&&(f=new ResizeObserver(b=>{let[S]=b;S&&S.target===c&&f&&(f.unobserve(t),cancelAnimationFrame(d),d=requestAnimationFrame(()=>{var R;(R=f)==null||R.observe(t)})),e()}),c&&!l&&f.observe(c),f.observe(t));let g,y=l?Ti(n):null;l&&_();function _(){const b=Ti(n);y&&!Qp(y,b)&&e(),y=b,g=requestAnimationFrame(_)}return e(),()=>{var b;h.forEach(S=>{r&&S.removeEventListener("scroll",e),s&&S.removeEventListener("resize",e)}),u?.(),(b=f)==null||b.disconnect(),f=null,l&&cancelAnimationFrame(g)}}const E2=XE,x2=KE,C2=WE,sf=YE,S2=jE,T2=(n,t,e)=>{const i=new Map,r={platform:Eo,...e},s={...r.platform,_c:i};return UE(n,t,{...r,platform:s})};function I2(n){return R2(n)}function Nl(n){return n.assignedSlot?n.assignedSlot:n.parentNode instanceof ShadowRoot?n.parentNode.host:n.parentNode}function R2(n){for(let t=n;t;t=Nl(t))if(t instanceof Element&&getComputedStyle(t).display==="none")return null;for(let t=Nl(n);t;t=Nl(t)){if(!(t instanceof Element))continue;const e=getComputedStyle(t);if(e.display!=="contents"&&(e.position!=="static"||za(e)||t.tagName==="BODY"))return t}return null}var A2=`:host {
  --arrow-color: black;
  --arrow-size: var(--wa-tooltip-arrow-size);
  --show-duration: 100ms;
  --hide-duration: 100ms;

  /*
     * These properties are computed to account for the arrow's dimensions after being rotated 45º. The constant
     * 0.7071 is derived from sin(45), which is the diagonal size of the arrow's container after rotating.
     */
  --arrow-size-diagonal: calc(var(--arrow-size) * 0.7071);
  --arrow-padding-offset: calc(var(--arrow-size-diagonal) - var(--arrow-size));

  display: contents;
}

.popup {
  position: absolute;
  isolation: isolate;
  max-width: var(--auto-size-available-width, none);
  max-height: var(--auto-size-available-height, none);

  /* Clear UA styles for [popover] */
  :where(&) {
    inset: unset;
    padding: unset;
    margin: unset;
    width: unset;
    height: unset;
    color: unset;
    background: unset;
    border: unset;
    overflow: unset;
  }
}

.popup-fixed {
  position: fixed;
}

.popup:not(.popup-active) {
  display: none;
}

.arrow {
  position: absolute;
  width: calc(var(--arrow-size-diagonal) * 2);
  height: calc(var(--arrow-size-diagonal) * 2);
  rotate: 45deg;
  background: var(--arrow-color);
  z-index: 3;
}

:host([data-current-placement~='left']) .arrow {
  rotate: -45deg;
}

:host([data-current-placement~='right']) .arrow {
  rotate: 135deg;
}

:host([data-current-placement~='bottom']) .arrow {
  rotate: 225deg;
}

/* Hover bridge */
.popup-hover-bridge:not(.popup-hover-bridge-visible) {
  display: none;
}

.popup-hover-bridge {
  position: fixed;
  z-index: 899;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  clip-path: polygon(
    var(--hover-bridge-top-left-x, 0) var(--hover-bridge-top-left-y, 0),
    var(--hover-bridge-top-right-x, 0) var(--hover-bridge-top-right-y, 0),
    var(--hover-bridge-bottom-right-x, 0) var(--hover-bridge-bottom-right-y, 0),
    var(--hover-bridge-bottom-left-x, 0) var(--hover-bridge-bottom-left-y, 0)
  );
}

/* Built-in animations */
.show {
  animation: show var(--show-duration) ease;
}

.hide {
  animation: show var(--hide-duration) ease reverse;
}

@keyframes show {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

.show-with-scale {
  animation: show-with-scale var(--show-duration) ease;
}

.hide-with-scale {
  animation: show-with-scale var(--hide-duration) ease reverse;
}

@keyframes show-with-scale {
  from {
    opacity: 0;
    scale: 0.8;
  }
  to {
    opacity: 1;
    scale: 1;
  }
}
`;function of(n){return n!==null&&typeof n=="object"&&"getBoundingClientRect"in n&&("contextElement"in n?n instanceof Element:!0)}var po=globalThis?.HTMLElement?.prototype.hasOwnProperty("popover"),ht=class extends ue{constructor(){super(...arguments),this.localize=new wn(this),this.active=!1,this.placement="top",this.boundary="viewport",this.distance=0,this.skidding=0,this.arrow=!1,this.arrowPlacement="anchor",this.arrowPadding=10,this.flip=!1,this.flipFallbackPlacements="",this.flipFallbackStrategy="best-fit",this.flipPadding=0,this.shift=!1,this.shiftPadding=0,this.autoSizePadding=0,this.hoverBridge=!1,this.updateHoverBridge=()=>{if(this.hoverBridge&&this.anchorEl){const n=this.anchorEl.getBoundingClientRect(),t=this.popup.getBoundingClientRect(),e=this.placement.includes("top")||this.placement.includes("bottom");let i=0,r=0,s=0,o=0,a=0,l=0,c=0,h=0;e?n.top<t.top?(i=n.left,r=n.bottom,s=n.right,o=n.bottom,a=t.left,l=t.top,c=t.right,h=t.top):(i=t.left,r=t.bottom,s=t.right,o=t.bottom,a=n.left,l=n.top,c=n.right,h=n.top):n.left<t.left?(i=n.right,r=n.top,s=t.left,o=t.top,a=n.right,l=n.bottom,c=t.left,h=t.bottom):(i=t.right,r=t.top,s=n.left,o=n.top,a=t.right,l=t.bottom,c=n.left,h=n.bottom),this.style.setProperty("--hover-bridge-top-left-x",`${i}px`),this.style.setProperty("--hover-bridge-top-left-y",`${r}px`),this.style.setProperty("--hover-bridge-top-right-x",`${s}px`),this.style.setProperty("--hover-bridge-top-right-y",`${o}px`),this.style.setProperty("--hover-bridge-bottom-left-x",`${a}px`),this.style.setProperty("--hover-bridge-bottom-left-y",`${l}px`),this.style.setProperty("--hover-bridge-bottom-right-x",`${c}px`),this.style.setProperty("--hover-bridge-bottom-right-y",`${h}px`)}}}async connectedCallback(){super.connectedCallback(),await this.updateComplete,this.start()}disconnectedCallback(){super.disconnectedCallback(),this.stop()}async updated(n){super.updated(n),n.has("active")&&(this.active?this.start():this.stop()),n.has("anchor")&&this.handleAnchorChange(),this.active&&(await this.updateComplete,this.reposition())}async handleAnchorChange(){if(await this.stop(),this.anchor&&typeof this.anchor=="string"){const n=this.getRootNode();this.anchorEl=n.getElementById(this.anchor)}else this.anchor instanceof Element||of(this.anchor)?this.anchorEl=this.anchor:this.anchorEl=this.querySelector('[slot="anchor"]');this.anchorEl instanceof HTMLSlotElement&&(this.anchorEl=this.anchorEl.assignedElements({flatten:!0})[0]),this.anchorEl&&this.start()}start(){!this.anchorEl||!this.active||(this.popup.showPopover?.(),this.cleanup=b2(this.anchorEl,this.popup,()=>{this.reposition()}))}async stop(){return new Promise(n=>{this.popup.hidePopover?.(),this.cleanup?(this.cleanup(),this.cleanup=void 0,this.removeAttribute("data-current-placement"),this.style.removeProperty("--auto-size-available-width"),this.style.removeProperty("--auto-size-available-height"),requestAnimationFrame(()=>n())):n()})}reposition(){if(!this.active||!this.anchorEl)return;const n=[E2({mainAxis:this.distance,crossAxis:this.skidding})];this.sync?n.push(sf({apply:({rects:i})=>{const r=this.sync==="width"||this.sync==="both",s=this.sync==="height"||this.sync==="both";this.popup.style.width=r?`${i.reference.width}px`:"",this.popup.style.height=s?`${i.reference.height}px`:""}})):(this.popup.style.width="",this.popup.style.height="");let t;po&&!of(this.anchor)&&this.boundary==="scroll"&&(t=br(this.anchorEl).filter(i=>i instanceof Element)),this.flip&&n.push(C2({boundary:this.flipBoundary||t,fallbackPlacements:this.flipFallbackPlacements,fallbackStrategy:this.flipFallbackStrategy==="best-fit"?"bestFit":"initialPlacement",padding:this.flipPadding})),this.shift&&n.push(x2({boundary:this.shiftBoundary||t,padding:this.shiftPadding})),this.autoSize?n.push(sf({boundary:this.autoSizeBoundary||t,padding:this.autoSizePadding,apply:({availableWidth:i,availableHeight:r})=>{this.autoSize==="vertical"||this.autoSize==="both"?this.style.setProperty("--auto-size-available-height",`${r}px`):this.style.removeProperty("--auto-size-available-height"),this.autoSize==="horizontal"||this.autoSize==="both"?this.style.setProperty("--auto-size-available-width",`${i}px`):this.style.removeProperty("--auto-size-available-width")}})):(this.style.removeProperty("--auto-size-available-width"),this.style.removeProperty("--auto-size-available-height")),this.arrow&&n.push(S2({element:this.arrowEl,padding:this.arrowPadding}));const e=po?i=>Eo.getOffsetParent(i,I2):Eo.getOffsetParent;T2(this.anchorEl,this.popup,{placement:this.placement,middleware:n,strategy:po?"absolute":"fixed",platform:{...Eo,getOffsetParent:e}}).then(({x:i,y:r,middlewareData:s,placement:o})=>{const a=this.localize.dir()==="rtl",l={top:"bottom",right:"left",bottom:"top",left:"right"}[o.split("-")[0]];if(this.setAttribute("data-current-placement",o),Object.assign(this.popup.style,{left:`${i}px`,top:`${r}px`}),this.arrow){const c=s.arrow.x,h=s.arrow.y;let u="",d="",f="",g="";if(this.arrowPlacement==="start"){const y=typeof c=="number"?`calc(${this.arrowPadding}px - var(--arrow-padding-offset))`:"";u=typeof h=="number"?`calc(${this.arrowPadding}px - var(--arrow-padding-offset))`:"",d=a?y:"",g=a?"":y}else if(this.arrowPlacement==="end"){const y=typeof c=="number"?`calc(${this.arrowPadding}px - var(--arrow-padding-offset))`:"";d=a?"":y,g=a?y:"",f=typeof h=="number"?`calc(${this.arrowPadding}px - var(--arrow-padding-offset))`:""}else this.arrowPlacement==="center"?(g=typeof c=="number"?"calc(50% - var(--arrow-size-diagonal))":"",u=typeof h=="number"?"calc(50% - var(--arrow-size-diagonal))":""):(g=typeof c=="number"?`${c}px`:"",u=typeof h=="number"?`${h}px`:"");Object.assign(this.arrowEl.style,{top:u,right:d,bottom:f,left:g,[l]:"calc(var(--arrow-size-diagonal) * -1)"})}}),requestAnimationFrame(()=>this.updateHoverBridge()),this.dispatchEvent(new OE)}render(){return U`
      <slot name="anchor" @slotchange=${this.handleAnchorChange}></slot>

      <span
        part="hover-bridge"
        class=${zn({"popup-hover-bridge":!0,"popup-hover-bridge-visible":this.hoverBridge&&this.active})}
      ></span>

      <div
        popover="manual"
        part="popup"
        class=${zn({popup:!0,"popup-active":this.active,"popup-fixed":!po,"popup-has-arrow":this.arrow})}
      >
        <slot></slot>
        ${this.arrow?U`<div part="arrow" class="arrow" role="presentation"></div>`:""}
      </div>
    `}};ht.css=A2;A([At(".popup")],ht.prototype,"popup",2);A([At(".arrow")],ht.prototype,"arrowEl",2);A([P()],ht.prototype,"anchor",2);A([P({type:Boolean,reflect:!0})],ht.prototype,"active",2);A([P({reflect:!0})],ht.prototype,"placement",2);A([P()],ht.prototype,"boundary",2);A([P({type:Number})],ht.prototype,"distance",2);A([P({type:Number})],ht.prototype,"skidding",2);A([P({type:Boolean})],ht.prototype,"arrow",2);A([P({attribute:"arrow-placement"})],ht.prototype,"arrowPlacement",2);A([P({attribute:"arrow-padding",type:Number})],ht.prototype,"arrowPadding",2);A([P({type:Boolean})],ht.prototype,"flip",2);A([P({attribute:"flip-fallback-placements",converter:{fromAttribute:n=>n.split(" ").map(t=>t.trim()).filter(t=>t!==""),toAttribute:n=>n.join(" ")}})],ht.prototype,"flipFallbackPlacements",2);A([P({attribute:"flip-fallback-strategy"})],ht.prototype,"flipFallbackStrategy",2);A([P({type:Object})],ht.prototype,"flipBoundary",2);A([P({attribute:"flip-padding",type:Number})],ht.prototype,"flipPadding",2);A([P({type:Boolean})],ht.prototype,"shift",2);A([P({type:Object})],ht.prototype,"shiftBoundary",2);A([P({attribute:"shift-padding",type:Number})],ht.prototype,"shiftPadding",2);A([P({attribute:"auto-size"})],ht.prototype,"autoSize",2);A([P()],ht.prototype,"sync",2);A([P({type:Object})],ht.prototype,"autoSizeBoundary",2);A([P({attribute:"auto-size-padding",type:Number})],ht.prototype,"autoSizePadding",2);A([P({attribute:"hover-bridge",type:Boolean})],ht.prototype,"hoverBridge",2);ht=A([bt("wa-popup")],ht);var P2=Object.defineProperty,L2=Object.getOwnPropertyDescriptor,tu=(n,t,e,i)=>{for(var r=i>1?void 0:i?L2(t,e):t,s=n.length-1,o;s>=0;s--)(o=n[s])&&(r=(i?o(t,e,r):o(r))||r);return i&&r&&P2(t,e,r),r};let Xo=class extends Hs(Xt){constructor(){super(...arguments),this.localize=new Jn(this),this.selectedCountry=null}render(){const n=this.localize.lang();return U`
      <wa-dialog without-header>
        <h2>${this.localize.term("choose_country")}</h2>
        <div class="wa-stack">
          <div class="wa-grid country-cards" style="--min-column-size: 20px;">
            <wa-card
              data-country="ch"
              class="wa-stack wa-align-items-center"
              @click=${this.selectCountry}
            >
              <div class="wa-stack wa-align-items-center">
                <div class="flag">🇨🇭</div>
                <div>${this.localize.term("switzerland")}</div>
              </div>
            </wa-card>
            <wa-card
              data-country="fr"
              class="wa-stack wa-align-items-center"
              @click=${this.selectCountry}
            >
              <div class="wa-stack wa-align-items-center">
                <div class="flag">🇫🇷</div>
                <div>${this.localize.term("france")}</div>
              </div>
            </wa-card>
            <wa-card
              data-country="de"
              class="wa-stack wa-align-items-center"
              @click=${this.selectCountry}
            >
              <div class="wa-stack wa-align-items-center">
                <div class="flag">🇩🇪</div>
                <div>${this.localize.term("germany")}</div>
              </div>
            </wa-card>
          </div>

          <wa-select @change="${this.selectLanguage}">
            <wa-option value="fr" ?selected=${n==="fr"}>Français</wa-option>
            <wa-option value="de" ?selected=${n==="de"}>Deutsch</wa-option>
            <wa-option value="en" ?selected=${n==="en"}>English</wa-option>
          </wa-select>
        </div>
        <wa-button slot="footer" variant="brand" @click=${this.confirm} ?disabled=${!this.selectedCountry}>
          ${this.localize.term("play")}
        </wa-button>
      </wa-dialog>
    `}selectCountry(n){this.countryCards.forEach(e=>e.classList.remove("selected"));const t=n.currentTarget;t.classList.add("selected"),this.selectedCountry=t.getAttribute("data-country")}confirm(){this.open=!1,this.dispatchEvent(new CustomEvent("country-selected",{detail:this.selectedCountry}))}selectLanguage(n){const t=n.target.value;document.documentElement.lang=t}createRenderRoot(){return this}};tu([Ft()],Xo.prototype,"selectedCountry",2);tu([T_(".country-cards wa-card")],Xo.prototype,"countryCards",2);Xo=tu([bt("element-country-selector")],Xo);var O2=`:host {
  display: flex;
  position: relative;
  align-items: stretch;
  border-radius: var(--wa-panel-border-radius);
  background-color: var(--wa-color-fill-quiet, var(--wa-color-brand-fill-quiet));
  border-color: var(--wa-color-border-quiet, var(--wa-color-brand-border-quiet));
  border-style: var(--wa-panel-border-style);
  border-width: var(--wa-panel-border-width);
  color: var(--wa-color-text-normal);
  padding: 1em;
}

/* Appearance modifiers */
:host([appearance~='plain']) {
  background-color: transparent;
  border-color: transparent;
}

:host([appearance~='outlined']) {
  background-color: transparent;
  border-color: var(--wa-color-border-loud, var(--wa-color-brand-border-loud));
}

:host([appearance~='filled']) {
  background-color: var(--wa-color-fill-quiet, var(--wa-color-brand-fill-quiet));
  border-color: transparent;
}

:host([appearance~='filled-outlined']) {
  border-color: var(--wa-color-border-quiet, var(--wa-color-brand-border-quiet));
}

:host([appearance~='accent']) {
  color: var(--wa-color-on-loud, var(--wa-color-brand-on-loud));
  background-color: var(--wa-color-fill-loud, var(--wa-color-brand-fill-loud));
  border-color: transparent;

  [part~='icon'] {
    color: currentColor;
  }
}

[part~='icon'] {
  flex: 0 0 auto;
  display: flex;
  align-items: center;
  color: var(--wa-color-on-quiet);
  font-size: 1.25em;
}

::slotted([slot='icon']) {
  margin-inline-end: var(--wa-form-control-padding-inline);
}

[part~='message'] {
  flex: 1 1 auto;
  display: block;
  overflow: hidden;
}
`,Er=class extends ue{constructor(){super(...arguments),this.variant="brand",this.size="medium"}render(){return U`
      <div part="icon">
        <slot name="icon"></slot>
      </div>

      <div part="message">
        <slot></slot>
      </div>
    `}};Er.css=[O2,xh,Rr];A([P({reflect:!0})],Er.prototype,"variant",2);A([P({reflect:!0})],Er.prototype,"appearance",2);A([P({reflect:!0})],Er.prototype,"size",2);Er=A([bt("wa-callout")],Er);function k2(n,t){const e=n.metaKey||n.ctrlKey||n.shiftKey||n.altKey;n.key==="Enter"&&!e&&setTimeout(()=>{!n.defaultPrevented&&!n.isComposing&&D2(t)})}function D2(n){let t=null;if("form"in n&&(t=n.form),!t&&"getForm"in n&&(t=n.getForm()),!t)return;const e=[...t.elements];if(e.length===1){t.requestSubmit(null);return}const i=e.find(r=>r.type==="submit"&&!r.matches(":disabled"));i&&(["input","button"].includes(i.localName)?t.requestSubmit(i):i.click())}const M2=Ch(class extends Sh{constructor(n){if(super(n),n.type!==Pn.PROPERTY&&n.type!==Pn.ATTRIBUTE&&n.type!==Pn.BOOLEAN_ATTRIBUTE)throw Error("The `live` directive is not allowed on child or event bindings");if(!o0(n))throw Error("`live` bindings can only contain a single expression")}render(n){return n}update(n,[t]){if(t===ye||t===yt)return t;const e=n.element,i=n.name;if(n.type===Pn.PROPERTY){if(t===e[i])return ye}else if(n.type===Pn.BOOLEAN_ATTRIBUTE){if(!!t===e.hasAttribute(i))return ye}else if(n.type===Pn.ATTRIBUTE&&e.getAttribute(i)===t+"")return ye;return l0(n),t}});var F2=`:host {
  border-width: 0;
}

.text-field {
  flex: auto;
  display: flex;
  align-items: stretch;
  justify-content: start;
  position: relative;
  transition: inherit;
  height: var(--wa-form-control-height);
  border-color: var(--wa-form-control-border-color);
  border-radius: var(--wa-form-control-border-radius);
  border-style: var(--wa-form-control-border-style);
  border-width: var(--wa-form-control-border-width);
  cursor: text;
  color: var(--wa-form-control-value-color);
  font-size: var(--wa-form-control-value-font-size);
  font-family: inherit;
  font-weight: var(--wa-form-control-value-font-weight);
  line-height: var(--wa-form-control-value-line-height);
  vertical-align: middle;
  width: 100%;
  transition:
    background-color var(--wa-transition-normal),
    border var(--wa-transition-normal),
    outline var(--wa-transition-fast);
  transition-timing-function: var(--wa-transition-easing);
  background-color: var(--wa-form-control-background-color);
  box-shadow: var(--box-shadow);
  padding: 0 var(--wa-form-control-padding-inline);

  &:focus-within {
    outline: var(--wa-focus-ring);
    outline-offset: var(--wa-focus-ring-offset);
  }

  /* Style disabled inputs */
  &:has(:disabled) {
    cursor: not-allowed;
    opacity: 0.5;
  }
}

/* Appearance modifiers */
:host([appearance='outlined']) .text-field {
  background-color: var(--wa-form-control-background-color);
  border-color: var(--wa-form-control-border-color);
}

:host([appearance='filled']) .text-field {
  background-color: var(--wa-color-neutral-fill-quiet);
  border-color: var(--wa-color-neutral-fill-quiet);
}

:host([appearance='filled-outlined']) .text-field {
  background-color: var(--wa-color-neutral-fill-quiet);
  border-color: var(--wa-form-control-border-color);
}

:host([pill]) .text-field {
  border-radius: var(--wa-border-radius-pill) !important;
}

.text-field {
  /* Show autofill styles over the entire text field, not just the native <input> */
  &:has(:autofill),
  &:has(:-webkit-autofill) {
    background-color: var(--wa-color-brand-fill-quiet) !important;
  }

  input,
  textarea {
    /*
    Fixes an alignment issue with placeholders.
    https://github.com/shoelace-style/webawesome/issues/342
  */
    height: 100%;

    padding: 0;
    border: none;
    outline: none;
    box-shadow: none;
    margin: 0;
    cursor: inherit;
    -webkit-appearance: none;
    font: inherit;

    /* Turn off Safari's autofill styles */
    &:-webkit-autofill,
    &:-webkit-autofill:hover,
    &:-webkit-autofill:focus,
    &:-webkit-autofill:active {
      -webkit-background-clip: text;
      background-color: transparent;
      -webkit-text-fill-color: inherit;
    }
  }
}

input {
  flex: 1 1 auto;
  min-width: 0;
  height: 100%;
  transition: inherit;

  /* prettier-ignore */
  background-color: rgb(118 118 118 / 0); /* ensures proper placeholder styles in webkit's date input */
  height: calc(var(--wa-form-control-height) - var(--border-width) * 2);
  padding-block: 0;
  color: inherit;

  &:autofill {
    &,
    &:hover,
    &:focus,
    &:active {
      box-shadow: none;
      caret-color: var(--wa-form-control-value-color);
    }
  }

  &::placeholder {
    color: var(--wa-form-control-placeholder-color);
    user-select: none;
    -webkit-user-select: none;
  }

  &::-webkit-search-decoration,
  &::-webkit-search-cancel-button,
  &::-webkit-search-results-button,
  &::-webkit-search-results-decoration {
    -webkit-appearance: none;
  }

  &:focus {
    outline: none;
  }
}

textarea {
  &:autofill {
    &,
    &:hover,
    &:focus,
    &:active {
      box-shadow: none;
      caret-color: var(--wa-form-control-value-color);
    }
  }

  &::placeholder {
    color: var(--wa-form-control-placeholder-color);
    user-select: none;
    -webkit-user-select: none;
  }
}

.start,
.end {
  display: inline-flex;
  flex: 0 0 auto;
  align-items: center;
  cursor: default;

  &::slotted(wa-icon) {
    color: var(--wa-color-neutral-on-quiet);
  }
}

.start::slotted(*) {
  margin-inline-end: var(--wa-form-control-padding-inline);
}

.end::slotted(*) {
  margin-inline-start: var(--wa-form-control-padding-inline);
}

/*
 * Clearable + Password Toggle
 */

.clear,
.password-toggle {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: inherit;
  color: var(--wa-color-neutral-on-quiet);
  border: none;
  background: none;
  padding: 0;
  transition: var(--wa-transition-normal) color;
  cursor: pointer;
  margin-inline-start: var(--wa-form-control-padding-inline);

  @media (hover: hover) {
    &:hover {
      color: color-mix(in oklab, currentColor, var(--wa-color-mix-hover));
    }
  }

  &:active {
    color: color-mix(in oklab, currentColor, var(--wa-color-mix-active));
  }

  &:focus {
    outline: none;
  }
}

/* Don't show the browser's password toggle in Edge */
::-ms-reveal {
  display: none;
}

/* Hide the built-in number spinner */
:host([without-spin-buttons]) input[type='number'] {
  -moz-appearance: textfield;

  &::-webkit-outer-spin-button,
  &::-webkit-inner-spin-button {
    -webkit-appearance: none;
    display: none;
  }
}
`,Y=class extends Te{constructor(){super(...arguments),this.assumeInteractionOn=["blur","input"],this.hasSlotController=new Bs(this,"hint","label"),this.localize=new wn(this),this.title="",this.type="text",this._value=null,this.defaultValue=this.getAttribute("value")||null,this.size="medium",this.appearance="outlined",this.pill=!1,this.label="",this.hint="",this.withClear=!1,this.placeholder="",this.readonly=!1,this.passwordToggle=!1,this.passwordVisible=!1,this.withoutSpinButtons=!1,this.form=null,this.required=!1,this.spellcheck=!0,this.withLabel=!1,this.withHint=!1}static get validators(){return[...super.validators,zg()]}get value(){return this.valueHasChanged?this._value:this._value??this.defaultValue}set value(n){this._value!==n&&(this.valueHasChanged=!0,this._value=n)}handleChange(n){this.value=this.input.value,this.relayNativeEvent(n,{bubbles:!0,composed:!0})}handleClearClick(n){n.preventDefault(),this.value!==""&&(this.value="",this.updateComplete.then(()=>{this.dispatchEvent(new Bp),this.dispatchEvent(new InputEvent("input",{bubbles:!0,composed:!0})),this.dispatchEvent(new Event("change",{bubbles:!0,composed:!0}))})),this.input.focus()}handleInput(){this.value=this.input.value}handleKeyDown(n){k2(n,this)}handlePasswordToggle(){this.passwordVisible=!this.passwordVisible}updated(n){super.updated(n),n.has("value")&&this.customStates.set("blank",!this.value)}handleStepChange(){this.input.step=String(this.step),this.updateValidity()}focus(n){this.input.focus(n)}blur(){this.input.blur()}select(){this.input.select()}setSelectionRange(n,t,e="none"){this.input.setSelectionRange(n,t,e)}setRangeText(n,t,e,i="preserve"){const r=t??this.input.selectionStart,s=e??this.input.selectionEnd;this.input.setRangeText(n,r,s,i),this.value!==this.input.value&&(this.value=this.input.value)}showPicker(){"showPicker"in HTMLInputElement.prototype&&this.input.showPicker()}stepUp(){this.input.stepUp(),this.value!==this.input.value&&(this.value=this.input.value)}stepDown(){this.input.stepDown(),this.value!==this.input.value&&(this.value=this.input.value)}formResetCallback(){this.value=this.defaultValue,super.formResetCallback()}render(){const n=this.hasUpdated?this.hasSlotController.test("label"):this.withLabel,t=this.hasUpdated?this.hasSlotController.test("hint"):this.withHint,e=this.label?!0:!!n,i=this.hint?!0:!!t,r=this.withClear&&!this.disabled&&!this.readonly,s=this.hasUpdated&&r&&(typeof this.value=="number"||this.value&&this.value.length>0);return U`
      <label part="form-control-label label" class="label" for="input" aria-hidden=${e?"false":"true"}>
        <slot name="label">${this.label}</slot>
      </label>

      <div part="base" class="text-field">
        <slot name="start" part="start" class="start"></slot>

        <input
          part="input"
          id="input"
          class="control"
          type=${this.type==="password"&&this.passwordVisible?"text":this.type}
          title=${this.title}
          name=${ft(this.name)}
          ?disabled=${this.disabled}
          ?readonly=${this.readonly}
          ?required=${this.required}
          placeholder=${ft(this.placeholder)}
          minlength=${ft(this.minlength)}
          maxlength=${ft(this.maxlength)}
          min=${ft(this.min)}
          max=${ft(this.max)}
          step=${ft(this.step)}
          .value=${M2(this.value??"")}
          autocapitalize=${ft(this.autocapitalize)}
          autocomplete=${ft(this.autocomplete)}
          autocorrect=${ft(this.autocorrect)}
          ?autofocus=${this.autofocus}
          spellcheck=${this.spellcheck}
          pattern=${ft(this.pattern)}
          enterkeyhint=${ft(this.enterkeyhint)}
          inputmode=${ft(this.inputmode)}
          aria-describedby="hint"
          @change=${this.handleChange}
          @input=${this.handleInput}
          @keydown=${this.handleKeyDown}
        />

        ${s?U`
              <button
                part="clear-button"
                class="clear"
                type="button"
                aria-label=${this.localize.term("clearEntry")}
                @click=${this.handleClearClick}
                tabindex="-1"
              >
                <slot name="clear-icon">
                  <wa-icon name="circle-xmark" library="system" variant="regular"></wa-icon>
                </slot>
              </button>
            `:""}
        ${this.passwordToggle&&!this.disabled?U`
              <button
                part="password-toggle-button"
                class="password-toggle"
                type="button"
                aria-label=${this.localize.term(this.passwordVisible?"hidePassword":"showPassword")}
                @click=${this.handlePasswordToggle}
                tabindex="-1"
              >
                ${this.passwordVisible?U`
                      <slot name="hide-password-icon">
                        <wa-icon name="eye-slash" library="system" variant="regular"></wa-icon>
                      </slot>
                    `:U`
                      <slot name="show-password-icon">
                        <wa-icon name="eye" library="system" variant="regular"></wa-icon>
                      </slot>
                    `}
              </button>
            `:""}

        <slot name="end" part="end" class="end"></slot>
      </div>

      <slot
        id="hint"
        part="hint"
        name="hint"
        class=${zn({"has-slotted":i})}
        aria-hidden=${i?"false":"true"}
        >${this.hint}</slot
      >
    `}};Y.css=[Rr,Up,F2];Y.shadowRootOptions={...Te.shadowRootOptions,delegatesFocus:!0};A([At("input")],Y.prototype,"input",2);A([P()],Y.prototype,"title",2);A([P({reflect:!0})],Y.prototype,"type",2);A([Ft()],Y.prototype,"value",1);A([P({attribute:"value",reflect:!0})],Y.prototype,"defaultValue",2);A([P({reflect:!0})],Y.prototype,"size",2);A([P({reflect:!0})],Y.prototype,"appearance",2);A([P({type:Boolean,reflect:!0})],Y.prototype,"pill",2);A([P()],Y.prototype,"label",2);A([P({attribute:"hint"})],Y.prototype,"hint",2);A([P({attribute:"with-clear",type:Boolean})],Y.prototype,"withClear",2);A([P()],Y.prototype,"placeholder",2);A([P({type:Boolean,reflect:!0})],Y.prototype,"readonly",2);A([P({attribute:"password-toggle",type:Boolean})],Y.prototype,"passwordToggle",2);A([P({attribute:"password-visible",type:Boolean})],Y.prototype,"passwordVisible",2);A([P({attribute:"without-spin-buttons",type:Boolean})],Y.prototype,"withoutSpinButtons",2);A([P({reflect:!0})],Y.prototype,"form",2);A([P({type:Boolean,reflect:!0})],Y.prototype,"required",2);A([P()],Y.prototype,"pattern",2);A([P({type:Number})],Y.prototype,"minlength",2);A([P({type:Number})],Y.prototype,"maxlength",2);A([P()],Y.prototype,"min",2);A([P()],Y.prototype,"max",2);A([P()],Y.prototype,"step",2);A([P()],Y.prototype,"autocapitalize",2);A([P()],Y.prototype,"autocorrect",2);A([P()],Y.prototype,"autocomplete",2);A([P({type:Boolean})],Y.prototype,"autofocus",2);A([P()],Y.prototype,"enterkeyhint",2);A([P({type:Boolean,converter:{fromAttribute:n=>!(!n||n==="false"),toAttribute:n=>n?"true":"false"}})],Y.prototype,"spellcheck",2);A([P()],Y.prototype,"inputmode",2);A([P({attribute:"with-label",type:Boolean})],Y.prototype,"withLabel",2);A([P({attribute:"with-hint",type:Boolean})],Y.prototype,"withHint",2);A([ti("step",{waitUntilFirstUpdate:!0})],Y.prototype,"handleStepChange",1);Y=A([bt("wa-input")],Y);var N2=Object.defineProperty,$2=Object.getOwnPropertyDescriptor,Ua=(n,t,e,i)=>{for(var r=i>1?void 0:i?$2(t,e):t,s=n.length-1,o;s>=0;s--)(o=n[s])&&(r=(i?o(t,e,r):o(r))||r);return i&&r&&N2(t,e,r),r};let Ts=class extends Xt{constructor(){super(...arguments),this.scores=[],this.username=null,this.maxEntries=10}render(){return U`
      <table>
        <tbody>
          ${this.scores.slice(0,this.maxEntries).map(n=>U`
              <tr class="${n.username===this.username?"highlight":""}">
                <td>${this.rankStyle(n.rank)}</td>
                <td>${n.username}</td>
                <td>${n.score}</td>
              </tr>
            `)}
        </tbody>
      </table>
    `}rankStyle(n){return n===1?U`<wa-icon name="trophy" variant="solid" style="color: #FFD700;"></wa-icon>`:n===2?U`<wa-icon name="trophy" variant="solid" style="color: #C0C0C0;"></wa-icon>`:n===3?U`<wa-icon name="trophy" variant="solid" style="color: #cd7f32;"></wa-icon>`:U`<span>${n}</span>`}createRenderRoot(){return this}};Ua([P({type:Array})],Ts.prototype,"scores",2);Ua([P({type:String})],Ts.prototype,"username",2);Ua([P({type:Number})],Ts.prototype,"maxEntries",2);Ts=Ua([bt("element-leaderboard")],Ts);var V2=Object.defineProperty,z2=Object.getOwnPropertyDescriptor,eu=(n,t,e,i)=>{for(var r=i>1?void 0:i?z2(t,e):t,s=n.length-1,o;s>=0;s--)(o=n[s])&&(r=(i?o(t,e,r):o(r))||r);return i&&r&&V2(t,e,r),r};let Ko=class extends Hs(Xt){constructor(){super(...arguments),this.localize=new Jn(this),this.valid=!1}render(){return U`
      <wa-dialog>
        <wa-input autofocus placeholder=${this.localize.term("username")}></wa-input>
        <wa-button slot="footer" variant="brand" @click="${this.save}">${this.localize.term("save")}</wa-button>
      </wa-dialog>
    `}async save(){const n=this.username.value?.trim();if(!n||n.length==0){this.username.hint=this.localize.term("no_username");return}if(await this.leaderboard.getUserId(n)){this.username.hint=this.localize.term("username_taken");return}this.valid=!0,this.dispatchEvent(new CustomEvent("username",{detail:n})),this.open=!1}firstUpdated(){this.firstElementChild?.addEventListener("wa-hide",n=>{this.valid||n.preventDefault()})}createRenderRoot(){return this}};eu([P({type:Object})],Ko.prototype,"leaderboard",2);eu([At("wa-input")],Ko.prototype,"username",2);Ko=eu([bt("element-username")],Ko);const G2=()=>{};var af={};const tm=function(n){const t=[];let e=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?t[e++]=r:r<2048?(t[e++]=r>>6|192,t[e++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),t[e++]=r>>18|240,t[e++]=r>>12&63|128,t[e++]=r>>6&63|128,t[e++]=r&63|128):(t[e++]=r>>12|224,t[e++]=r>>6&63|128,t[e++]=r&63|128)}return t},B2=function(n){const t=[];let e=0,i=0;for(;e<n.length;){const r=n[e++];if(r<128)t[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[e++];t[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=n[e++],o=n[e++],a=n[e++],l=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;t[i++]=String.fromCharCode(55296+(l>>10)),t[i++]=String.fromCharCode(56320+(l&1023))}else{const s=n[e++],o=n[e++];t[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return t.join("")},em={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,t){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],o=r+1<n.length,a=o?n[r+1]:0,l=r+2<n.length,c=l?n[r+2]:0,h=s>>2,u=(s&3)<<4|a>>4;let d=(a&15)<<2|c>>6,f=c&63;l||(f=64,o||(d=64)),i.push(e[h],e[u],e[d],e[f])}return i.join("")},encodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(n):this.encodeByteArray(tm(n),t)},decodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(n):B2(this.decodeStringToByteArray(n,t))},decodeStringToByteArray(n,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=e[n.charAt(r++)],a=r<n.length?e[n.charAt(r)]:0;++r;const c=r<n.length?e[n.charAt(r)]:64;++r;const u=r<n.length?e[n.charAt(r)]:64;if(++r,s==null||a==null||c==null||u==null)throw new U2;const d=s<<2|a>>4;if(i.push(d),c!==64){const f=a<<4&240|c>>2;if(i.push(f),u!==64){const g=c<<6&192|u;i.push(g)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class U2 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const j2=function(n){const t=tm(n);return em.encodeByteArray(t,!0)},Yo=function(n){return j2(n).replace(/\./g,"")},W2=function(n){try{return em.decodeString(n,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function q2(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const H2=()=>q2().__FIREBASE_DEFAULTS__,X2=()=>{if(typeof process>"u"||typeof af>"u")return;const n=af.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},K2=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=n&&W2(n[1]);return t&&JSON.parse(t)},nm=()=>{try{return G2()||H2()||X2()||K2()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Y2=n=>nm()?.emulatorHosts?.[n],Z2=n=>{const t=Y2(n);if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(e+1),10);return t[0]==="["?[t.substring(1,e-1),i]:[t.substring(0,e),i]},im=()=>nm()?.config;class J2{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,i)=>{e?this.reject(e):this.resolve(i),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,i))}}}function nu(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Q2(n){return(await fetch(n,{credentials:"include"})).ok}function tx(n,t){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const e={alg:"none",type:"JWT"},i=t||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Yo(JSON.stringify(e)),Yo(JSON.stringify(o)),""].join(".")}const os={};function ex(){const n={prod:[],emulator:[]};for(const t of Object.keys(os))os[t]?n.emulator.push(t):n.prod.push(t);return n}function nx(n){let t=document.getElementById(n),e=!1;return t||(t=document.createElement("div"),t.setAttribute("id",n),e=!0),{created:e,element:t}}let lf=!1;function ix(n,t){if(typeof window>"u"||typeof document>"u"||!nu(window.location.host)||os[n]===t||os[n]||lf)return;os[n]=t;function e(d){return`__firebase__banner__${d}`}const i="__firebase__banner",s=ex().prod.length>0;function o(){const d=document.getElementById(i);d&&d.remove()}function a(d){d.style.display="flex",d.style.background="#7faaf0",d.style.position="fixed",d.style.bottom="5px",d.style.left="5px",d.style.padding=".5em",d.style.borderRadius="5px",d.style.alignItems="center"}function l(d,f){d.setAttribute("width","24"),d.setAttribute("id",f),d.setAttribute("height","24"),d.setAttribute("viewBox","0 0 24 24"),d.setAttribute("fill","none"),d.style.marginLeft="-6px"}function c(){const d=document.createElement("span");return d.style.cursor="pointer",d.style.marginLeft="16px",d.style.fontSize="24px",d.innerHTML=" &times;",d.onclick=()=>{lf=!0,o()},d}function h(d,f){d.setAttribute("id",f),d.innerText="Learn more",d.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",d.setAttribute("target","__blank"),d.style.paddingLeft="5px",d.style.textDecoration="underline"}function u(){const d=nx(i),f=e("text"),g=document.getElementById(f)||document.createElement("span"),y=e("learnmore"),_=document.getElementById(y)||document.createElement("a"),b=e("preprendIcon"),S=document.getElementById(b)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(d.created){const R=d.element;a(R),h(_,y);const T=c();l(S,b),R.append(S,g,_,T),document.body.appendChild(R)}s?(g.innerText="Preview backend disconnected.",S.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(S.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,g.innerText="Preview backend running in this workspace."),g.setAttribute("id",f)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",u):u()}function rx(){try{return typeof indexedDB=="object"}catch{return!1}}function sx(){return new Promise((n,t)=>{try{let e=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),e||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{e=!1},r.onerror=()=>{t(r.error?.message||"")}}catch(e){t(e)}})}const ox="FirebaseError";class Dr extends Error{constructor(t,e,i){super(e),this.code=t,this.customData=i,this.name=ox,Object.setPrototypeOf(this,Dr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,rm.prototype.create)}}class rm{constructor(t,e,i){this.service=t,this.serviceName=e,this.errors=i}create(t,...e){const i=e[0]||{},r=`${this.service}/${t}`,s=this.errors[t],o=s?ax(s,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new Dr(r,a,i)}}function ax(n,t){return n.replace(lx,(e,i)=>{const r=t[i];return r!=null?String(r):`<${i}?>`})}const lx=/\{\$([^}]+)}/g;function Zo(n,t){if(n===t)return!0;const e=Object.keys(n),i=Object.keys(t);for(const r of e){if(!i.includes(r))return!1;const s=n[r],o=t[r];if(cf(s)&&cf(o)){if(!Zo(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!e.includes(r))return!1;return!0}function cf(n){return n!==null&&typeof n=="object"}function xr(n){return n&&n._delegate?n._delegate:n}class Is{constructor(t,e,i){this.name=t,this.instanceFactory=e,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const ci="[DEFAULT]";class cx{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const i=new J2;if(this.instancesDeferred.set(e,i),this.isInitialized(e)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:e});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){const e=this.normalizeInstanceIdentifier(t?.identifier),i=t?.optional??!1;if(this.isInitialized(e)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:e})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(ux(t))try{this.getOrInitializeService({instanceIdentifier:ci})}catch{}for(const[e,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(t=ci){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=ci){return this.instances.has(t)}getOptions(t=ci){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:e});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);i===a&&o.resolve(r)}return r}onInit(t,e){const i=this.normalizeInstanceIdentifier(e),r=this.onInitCallbacks.get(i)??new Set;r.add(t),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&t(s,i),()=>{r.delete(t)}}invokeOnInitCallbacks(t,e){const i=this.onInitCallbacks.get(e);if(i)for(const r of i)try{r(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:hx(t),options:e}),this.instances.set(t,i),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}return i||null}normalizeInstanceIdentifier(t=ci){return this.component?this.component.multipleInstances?t:ci:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function hx(n){return n===ci?void 0:n}function ux(n){return n.instantiationMode==="EAGER"}class dx{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new cx(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}var ct;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(ct||(ct={}));const fx={debug:ct.DEBUG,verbose:ct.VERBOSE,info:ct.INFO,warn:ct.WARN,error:ct.ERROR,silent:ct.SILENT},gx=ct.INFO,px={[ct.DEBUG]:"log",[ct.VERBOSE]:"log",[ct.INFO]:"info",[ct.WARN]:"warn",[ct.ERROR]:"error"},mx=(n,t,...e)=>{if(t<n.logLevel)return;const i=new Date().toISOString(),r=px[t];if(r)console[r](`[${i}]  ${n.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class sm{constructor(t){this.name=t,this._logLevel=gx,this._logHandler=mx,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in ct))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?fx[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,ct.DEBUG,...t),this._logHandler(this,ct.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,ct.VERBOSE,...t),this._logHandler(this,ct.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,ct.INFO,...t),this._logHandler(this,ct.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,ct.WARN,...t),this._logHandler(this,ct.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,ct.ERROR,...t),this._logHandler(this,ct.ERROR,...t)}}const _x=(n,t)=>t.some(e=>n instanceof e);let hf,uf;function yx(){return hf||(hf=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function wx(){return uf||(uf=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const om=new WeakMap,Ac=new WeakMap,am=new WeakMap,$l=new WeakMap,iu=new WeakMap;function vx(n){const t=new Promise((e,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{e(Gn(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return t.then(e=>{e instanceof IDBCursor&&om.set(e,n)}).catch(()=>{}),iu.set(t,n),t}function bx(n){if(Ac.has(n))return;const t=new Promise((e,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{e(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});Ac.set(n,t)}let Pc={get(n,t,e){if(n instanceof IDBTransaction){if(t==="done")return Ac.get(n);if(t==="objectStoreNames")return n.objectStoreNames||am.get(n);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return Gn(n[t])},set(n,t,e){return n[t]=e,!0},has(n,t){return n instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in n}};function Ex(n){Pc=n(Pc)}function xx(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){const i=n.call(Vl(this),t,...e);return am.set(i,t.sort?t.sort():[t]),Gn(i)}:wx().includes(n)?function(...t){return n.apply(Vl(this),t),Gn(om.get(this))}:function(...t){return Gn(n.apply(Vl(this),t))}}function Cx(n){return typeof n=="function"?xx(n):(n instanceof IDBTransaction&&bx(n),_x(n,yx())?new Proxy(n,Pc):n)}function Gn(n){if(n instanceof IDBRequest)return vx(n);if($l.has(n))return $l.get(n);const t=Cx(n);return t!==n&&($l.set(n,t),iu.set(t,n)),t}const Vl=n=>iu.get(n);function Sx(n,t,{blocked:e,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(n,t),a=Gn(o);return i&&o.addEventListener("upgradeneeded",l=>{i(Gn(o.result),l.oldVersion,l.newVersion,Gn(o.transaction),l)}),e&&o.addEventListener("blocked",l=>e(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),r&&l.addEventListener("versionchange",c=>r(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const Tx=["get","getKey","getAll","getAllKeys","count"],Ix=["put","add","delete","clear"],zl=new Map;function df(n,t){if(!(n instanceof IDBDatabase&&!(t in n)&&typeof t=="string"))return;if(zl.get(t))return zl.get(t);const e=t.replace(/FromIndex$/,""),i=t!==e,r=Ix.includes(e);if(!(e in(i?IDBIndex:IDBObjectStore).prototype)||!(r||Tx.includes(e)))return;const s=async function(o,...a){const l=this.transaction(o,r?"readwrite":"readonly");let c=l.store;return i&&(c=c.index(a.shift())),(await Promise.all([c[e](...a),r&&l.done]))[0]};return zl.set(t,s),s}Ex(n=>({...n,get:(t,e,i)=>df(t,e)||n.get(t,e,i),has:(t,e)=>!!df(t,e)||n.has(t,e)}));class Rx{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(Ax(e)){const i=e.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(e=>e).join(" ")}}function Ax(n){return n.getComponent()?.type==="VERSION"}const Lc="@firebase/app",ff="0.14.5";const mn=new sm("@firebase/app"),Px="@firebase/app-compat",Lx="@firebase/analytics-compat",Ox="@firebase/analytics",kx="@firebase/app-check-compat",Dx="@firebase/app-check",Mx="@firebase/auth",Fx="@firebase/auth-compat",Nx="@firebase/database",$x="@firebase/data-connect",Vx="@firebase/database-compat",zx="@firebase/functions",Gx="@firebase/functions-compat",Bx="@firebase/installations",Ux="@firebase/installations-compat",jx="@firebase/messaging",Wx="@firebase/messaging-compat",qx="@firebase/performance",Hx="@firebase/performance-compat",Xx="@firebase/remote-config",Kx="@firebase/remote-config-compat",Yx="@firebase/storage",Zx="@firebase/storage-compat",Jx="@firebase/firestore",Qx="@firebase/ai",tC="@firebase/firestore-compat",eC="firebase",nC="12.5.0";const Oc="[DEFAULT]",iC={[Lc]:"fire-core",[Px]:"fire-core-compat",[Ox]:"fire-analytics",[Lx]:"fire-analytics-compat",[Dx]:"fire-app-check",[kx]:"fire-app-check-compat",[Mx]:"fire-auth",[Fx]:"fire-auth-compat",[Nx]:"fire-rtdb",[$x]:"fire-data-connect",[Vx]:"fire-rtdb-compat",[zx]:"fire-fn",[Gx]:"fire-fn-compat",[Bx]:"fire-iid",[Ux]:"fire-iid-compat",[jx]:"fire-fcm",[Wx]:"fire-fcm-compat",[qx]:"fire-perf",[Hx]:"fire-perf-compat",[Xx]:"fire-rc",[Kx]:"fire-rc-compat",[Yx]:"fire-gcs",[Zx]:"fire-gcs-compat",[Jx]:"fire-fst",[tC]:"fire-fst-compat",[Qx]:"fire-vertex","fire-js":"fire-js",[eC]:"fire-js-all"};const Jo=new Map,rC=new Map,kc=new Map;function gf(n,t){try{n.container.addComponent(t)}catch(e){mn.debug(`Component ${t.name} failed to register with FirebaseApp ${n.name}`,e)}}function Qo(n){const t=n.name;if(kc.has(t))return mn.debug(`There were multiple attempts to register component ${t}.`),!1;kc.set(t,n);for(const e of Jo.values())gf(e,n);for(const e of rC.values())gf(e,n);return!0}function sC(n,t){const e=n.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),n.container.getProvider(t)}function oC(n){return n==null?!1:n.settings!==void 0}const aC={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Bn=new rm("app","Firebase",aC);class lC{constructor(t,e,i){this._isDeleted=!1,this._options={...t},this._config={...e},this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Is("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Bn.create("app-deleted",{appName:this._name})}}const cC=nC;function lm(n,t={}){let e=n;typeof t!="object"&&(t={name:t});const i={name:Oc,automaticDataCollectionEnabled:!0,...t},r=i.name;if(typeof r!="string"||!r)throw Bn.create("bad-app-name",{appName:String(r)});if(e||(e=im()),!e)throw Bn.create("no-options");const s=Jo.get(r);if(s){if(Zo(e,s.options)&&Zo(i,s.config))return s;throw Bn.create("duplicate-app",{appName:r})}const o=new dx(r);for(const l of kc.values())o.addComponent(l);const a=new lC(e,i,o);return Jo.set(r,a),a}function hC(n=Oc){const t=Jo.get(n);if(!t&&n===Oc&&im())return lm();if(!t)throw Bn.create("no-app",{appName:n});return t}function lr(n,t,e){let i=iC[n]??n;e&&(i+=`-${e}`);const r=i.match(/\s|\//),s=t.match(/\s|\//);if(r||s){const o=[`Unable to register library "${i}" with version "${t}":`];r&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&s&&o.push("and"),s&&o.push(`version name "${t}" contains illegal characters (whitespace or "/")`),mn.warn(o.join(" "));return}Qo(new Is(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}const uC="firebase-heartbeat-database",dC=1,Rs="firebase-heartbeat-store";let Gl=null;function cm(){return Gl||(Gl=Sx(uC,dC,{upgrade:(n,t)=>{switch(t){case 0:try{n.createObjectStore(Rs)}catch(e){console.warn(e)}}}}).catch(n=>{throw Bn.create("idb-open",{originalErrorMessage:n.message})})),Gl}async function fC(n){try{const e=(await cm()).transaction(Rs),i=await e.objectStore(Rs).get(hm(n));return await e.done,i}catch(t){if(t instanceof Dr)mn.warn(t.message);else{const e=Bn.create("idb-get",{originalErrorMessage:t?.message});mn.warn(e.message)}}}async function pf(n,t){try{const i=(await cm()).transaction(Rs,"readwrite");await i.objectStore(Rs).put(t,hm(n)),await i.done}catch(e){if(e instanceof Dr)mn.warn(e.message);else{const i=Bn.create("idb-set",{originalErrorMessage:e?.message});mn.warn(i.message)}}}function hm(n){return`${n.name}!${n.options.appId}`}const gC=1024,pC=30;class mC{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new yC(e),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=mf();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(r=>r.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:e}),this._heartbeatsCache.heartbeats.length>pC){const r=wC(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(t){mn.warn(t)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=mf(),{heartbeatsToSend:e,unsentEntries:i}=_C(this._heartbeatsCache.heartbeats),r=Yo(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(t){return mn.warn(t),""}}}function mf(){return new Date().toISOString().substring(0,10)}function _C(n,t=gC){const e=[];let i=n.slice();for(const r of n){const s=e.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),_f(e)>t){s.dates.pop();break}}else if(e.push({agent:r.agent,dates:[r.date]}),_f(e)>t){e.pop();break}i=i.slice(1)}return{heartbeatsToSend:e,unsentEntries:i}}class yC{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return rx()?sx().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const e=await fC(this.app);return e?.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const i=await this.read();return pf(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const i=await this.read();return pf(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}else return}}function _f(n){return Yo(JSON.stringify({version:2,heartbeats:n})).length}function wC(n){if(n.length===0)return-1;let t=0,e=n[0].date;for(let i=1;i<n.length;i++)n[i].date<e&&(e=n[i].date,t=i);return t}function vC(n){Qo(new Is("platform-logger",t=>new Rx(t),"PRIVATE")),Qo(new Is("heartbeat",t=>new mC(t),"PRIVATE")),lr(Lc,ff,n),lr(Lc,ff,"esm2020"),lr("fire-js","")}vC("");var bC="firebase",EC="12.5.0";lr(bC,EC,"app");var yf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var um;(function(){var n;function t(w,p){function m(){}m.prototype=p.prototype,w.F=p.prototype,w.prototype=new m,w.prototype.constructor=w,w.D=function(E,x,C){for(var v=Array(arguments.length-2),M=2;M<arguments.length;M++)v[M-2]=arguments[M];return p.prototype[x].apply(E,v)}}function e(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}t(i,e),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(w,p,m){m||(m=0);const E=Array(16);if(typeof p=="string")for(var x=0;x<16;++x)E[x]=p.charCodeAt(m++)|p.charCodeAt(m++)<<8|p.charCodeAt(m++)<<16|p.charCodeAt(m++)<<24;else for(x=0;x<16;++x)E[x]=p[m++]|p[m++]<<8|p[m++]<<16|p[m++]<<24;p=w.g[0],m=w.g[1],x=w.g[2];let C=w.g[3],v;v=p+(C^m&(x^C))+E[0]+3614090360&4294967295,p=m+(v<<7&4294967295|v>>>25),v=C+(x^p&(m^x))+E[1]+3905402710&4294967295,C=p+(v<<12&4294967295|v>>>20),v=x+(m^C&(p^m))+E[2]+606105819&4294967295,x=C+(v<<17&4294967295|v>>>15),v=m+(p^x&(C^p))+E[3]+3250441966&4294967295,m=x+(v<<22&4294967295|v>>>10),v=p+(C^m&(x^C))+E[4]+4118548399&4294967295,p=m+(v<<7&4294967295|v>>>25),v=C+(x^p&(m^x))+E[5]+1200080426&4294967295,C=p+(v<<12&4294967295|v>>>20),v=x+(m^C&(p^m))+E[6]+2821735955&4294967295,x=C+(v<<17&4294967295|v>>>15),v=m+(p^x&(C^p))+E[7]+4249261313&4294967295,m=x+(v<<22&4294967295|v>>>10),v=p+(C^m&(x^C))+E[8]+1770035416&4294967295,p=m+(v<<7&4294967295|v>>>25),v=C+(x^p&(m^x))+E[9]+2336552879&4294967295,C=p+(v<<12&4294967295|v>>>20),v=x+(m^C&(p^m))+E[10]+4294925233&4294967295,x=C+(v<<17&4294967295|v>>>15),v=m+(p^x&(C^p))+E[11]+2304563134&4294967295,m=x+(v<<22&4294967295|v>>>10),v=p+(C^m&(x^C))+E[12]+1804603682&4294967295,p=m+(v<<7&4294967295|v>>>25),v=C+(x^p&(m^x))+E[13]+4254626195&4294967295,C=p+(v<<12&4294967295|v>>>20),v=x+(m^C&(p^m))+E[14]+2792965006&4294967295,x=C+(v<<17&4294967295|v>>>15),v=m+(p^x&(C^p))+E[15]+1236535329&4294967295,m=x+(v<<22&4294967295|v>>>10),v=p+(x^C&(m^x))+E[1]+4129170786&4294967295,p=m+(v<<5&4294967295|v>>>27),v=C+(m^x&(p^m))+E[6]+3225465664&4294967295,C=p+(v<<9&4294967295|v>>>23),v=x+(p^m&(C^p))+E[11]+643717713&4294967295,x=C+(v<<14&4294967295|v>>>18),v=m+(C^p&(x^C))+E[0]+3921069994&4294967295,m=x+(v<<20&4294967295|v>>>12),v=p+(x^C&(m^x))+E[5]+3593408605&4294967295,p=m+(v<<5&4294967295|v>>>27),v=C+(m^x&(p^m))+E[10]+38016083&4294967295,C=p+(v<<9&4294967295|v>>>23),v=x+(p^m&(C^p))+E[15]+3634488961&4294967295,x=C+(v<<14&4294967295|v>>>18),v=m+(C^p&(x^C))+E[4]+3889429448&4294967295,m=x+(v<<20&4294967295|v>>>12),v=p+(x^C&(m^x))+E[9]+568446438&4294967295,p=m+(v<<5&4294967295|v>>>27),v=C+(m^x&(p^m))+E[14]+3275163606&4294967295,C=p+(v<<9&4294967295|v>>>23),v=x+(p^m&(C^p))+E[3]+4107603335&4294967295,x=C+(v<<14&4294967295|v>>>18),v=m+(C^p&(x^C))+E[8]+1163531501&4294967295,m=x+(v<<20&4294967295|v>>>12),v=p+(x^C&(m^x))+E[13]+2850285829&4294967295,p=m+(v<<5&4294967295|v>>>27),v=C+(m^x&(p^m))+E[2]+4243563512&4294967295,C=p+(v<<9&4294967295|v>>>23),v=x+(p^m&(C^p))+E[7]+1735328473&4294967295,x=C+(v<<14&4294967295|v>>>18),v=m+(C^p&(x^C))+E[12]+2368359562&4294967295,m=x+(v<<20&4294967295|v>>>12),v=p+(m^x^C)+E[5]+4294588738&4294967295,p=m+(v<<4&4294967295|v>>>28),v=C+(p^m^x)+E[8]+2272392833&4294967295,C=p+(v<<11&4294967295|v>>>21),v=x+(C^p^m)+E[11]+1839030562&4294967295,x=C+(v<<16&4294967295|v>>>16),v=m+(x^C^p)+E[14]+4259657740&4294967295,m=x+(v<<23&4294967295|v>>>9),v=p+(m^x^C)+E[1]+2763975236&4294967295,p=m+(v<<4&4294967295|v>>>28),v=C+(p^m^x)+E[4]+1272893353&4294967295,C=p+(v<<11&4294967295|v>>>21),v=x+(C^p^m)+E[7]+4139469664&4294967295,x=C+(v<<16&4294967295|v>>>16),v=m+(x^C^p)+E[10]+3200236656&4294967295,m=x+(v<<23&4294967295|v>>>9),v=p+(m^x^C)+E[13]+681279174&4294967295,p=m+(v<<4&4294967295|v>>>28),v=C+(p^m^x)+E[0]+3936430074&4294967295,C=p+(v<<11&4294967295|v>>>21),v=x+(C^p^m)+E[3]+3572445317&4294967295,x=C+(v<<16&4294967295|v>>>16),v=m+(x^C^p)+E[6]+76029189&4294967295,m=x+(v<<23&4294967295|v>>>9),v=p+(m^x^C)+E[9]+3654602809&4294967295,p=m+(v<<4&4294967295|v>>>28),v=C+(p^m^x)+E[12]+3873151461&4294967295,C=p+(v<<11&4294967295|v>>>21),v=x+(C^p^m)+E[15]+530742520&4294967295,x=C+(v<<16&4294967295|v>>>16),v=m+(x^C^p)+E[2]+3299628645&4294967295,m=x+(v<<23&4294967295|v>>>9),v=p+(x^(m|~C))+E[0]+4096336452&4294967295,p=m+(v<<6&4294967295|v>>>26),v=C+(m^(p|~x))+E[7]+1126891415&4294967295,C=p+(v<<10&4294967295|v>>>22),v=x+(p^(C|~m))+E[14]+2878612391&4294967295,x=C+(v<<15&4294967295|v>>>17),v=m+(C^(x|~p))+E[5]+4237533241&4294967295,m=x+(v<<21&4294967295|v>>>11),v=p+(x^(m|~C))+E[12]+1700485571&4294967295,p=m+(v<<6&4294967295|v>>>26),v=C+(m^(p|~x))+E[3]+2399980690&4294967295,C=p+(v<<10&4294967295|v>>>22),v=x+(p^(C|~m))+E[10]+4293915773&4294967295,x=C+(v<<15&4294967295|v>>>17),v=m+(C^(x|~p))+E[1]+2240044497&4294967295,m=x+(v<<21&4294967295|v>>>11),v=p+(x^(m|~C))+E[8]+1873313359&4294967295,p=m+(v<<6&4294967295|v>>>26),v=C+(m^(p|~x))+E[15]+4264355552&4294967295,C=p+(v<<10&4294967295|v>>>22),v=x+(p^(C|~m))+E[6]+2734768916&4294967295,x=C+(v<<15&4294967295|v>>>17),v=m+(C^(x|~p))+E[13]+1309151649&4294967295,m=x+(v<<21&4294967295|v>>>11),v=p+(x^(m|~C))+E[4]+4149444226&4294967295,p=m+(v<<6&4294967295|v>>>26),v=C+(m^(p|~x))+E[11]+3174756917&4294967295,C=p+(v<<10&4294967295|v>>>22),v=x+(p^(C|~m))+E[2]+718787259&4294967295,x=C+(v<<15&4294967295|v>>>17),v=m+(C^(x|~p))+E[9]+3951481745&4294967295,w.g[0]=w.g[0]+p&4294967295,w.g[1]=w.g[1]+(x+(v<<21&4294967295|v>>>11))&4294967295,w.g[2]=w.g[2]+x&4294967295,w.g[3]=w.g[3]+C&4294967295}i.prototype.v=function(w,p){p===void 0&&(p=w.length);const m=p-this.blockSize,E=this.C;let x=this.h,C=0;for(;C<p;){if(x==0)for(;C<=m;)r(this,w,C),C+=this.blockSize;if(typeof w=="string"){for(;C<p;)if(E[x++]=w.charCodeAt(C++),x==this.blockSize){r(this,E),x=0;break}}else for(;C<p;)if(E[x++]=w[C++],x==this.blockSize){r(this,E),x=0;break}}this.h=x,this.o+=p},i.prototype.A=function(){var w=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);w[0]=128;for(var p=1;p<w.length-8;++p)w[p]=0;p=this.o*8;for(var m=w.length-8;m<w.length;++m)w[m]=p&255,p/=256;for(this.v(w),w=Array(16),p=0,m=0;m<4;++m)for(let E=0;E<32;E+=8)w[p++]=this.g[m]>>>E&255;return w};function s(w,p){var m=a;return Object.prototype.hasOwnProperty.call(m,w)?m[w]:m[w]=p(w)}function o(w,p){this.h=p;const m=[];let E=!0;for(let x=w.length-1;x>=0;x--){const C=w[x]|0;E&&C==p||(m[x]=C,E=!1)}this.g=m}var a={};function l(w){return-128<=w&&w<128?s(w,function(p){return new o([p|0],p<0?-1:0)}):new o([w|0],w<0?-1:0)}function c(w){if(isNaN(w)||!isFinite(w))return u;if(w<0)return _(c(-w));const p=[];let m=1;for(let E=0;w>=m;E++)p[E]=w/m|0,m*=4294967296;return new o(p,0)}function h(w,p){if(w.length==0)throw Error("number format error: empty string");if(p=p||10,p<2||36<p)throw Error("radix out of range: "+p);if(w.charAt(0)=="-")return _(h(w.substring(1),p));if(w.indexOf("-")>=0)throw Error('number format error: interior "-" character');const m=c(Math.pow(p,8));let E=u;for(let C=0;C<w.length;C+=8){var x=Math.min(8,w.length-C);const v=parseInt(w.substring(C,C+x),p);x<8?(x=c(Math.pow(p,x)),E=E.j(x).add(c(v))):(E=E.j(m),E=E.add(c(v)))}return E}var u=l(0),d=l(1),f=l(16777216);n=o.prototype,n.m=function(){if(y(this))return-_(this).m();let w=0,p=1;for(let m=0;m<this.g.length;m++){const E=this.i(m);w+=(E>=0?E:4294967296+E)*p,p*=4294967296}return w},n.toString=function(w){if(w=w||10,w<2||36<w)throw Error("radix out of range: "+w);if(g(this))return"0";if(y(this))return"-"+_(this).toString(w);const p=c(Math.pow(w,6));var m=this;let E="";for(;;){const x=T(m,p).g;m=b(m,x.j(p));let C=((m.g.length>0?m.g[0]:m.h)>>>0).toString(w);if(m=x,g(m))return C+E;for(;C.length<6;)C="0"+C;E=C+E}},n.i=function(w){return w<0?0:w<this.g.length?this.g[w]:this.h};function g(w){if(w.h!=0)return!1;for(let p=0;p<w.g.length;p++)if(w.g[p]!=0)return!1;return!0}function y(w){return w.h==-1}n.l=function(w){return w=b(this,w),y(w)?-1:g(w)?0:1};function _(w){const p=w.g.length,m=[];for(let E=0;E<p;E++)m[E]=~w.g[E];return new o(m,~w.h).add(d)}n.abs=function(){return y(this)?_(this):this},n.add=function(w){const p=Math.max(this.g.length,w.g.length),m=[];let E=0;for(let x=0;x<=p;x++){let C=E+(this.i(x)&65535)+(w.i(x)&65535),v=(C>>>16)+(this.i(x)>>>16)+(w.i(x)>>>16);E=v>>>16,C&=65535,v&=65535,m[x]=v<<16|C}return new o(m,m[m.length-1]&-2147483648?-1:0)};function b(w,p){return w.add(_(p))}n.j=function(w){if(g(this)||g(w))return u;if(y(this))return y(w)?_(this).j(_(w)):_(_(this).j(w));if(y(w))return _(this.j(_(w)));if(this.l(f)<0&&w.l(f)<0)return c(this.m()*w.m());const p=this.g.length+w.g.length,m=[];for(var E=0;E<2*p;E++)m[E]=0;for(E=0;E<this.g.length;E++)for(let x=0;x<w.g.length;x++){const C=this.i(E)>>>16,v=this.i(E)&65535,M=w.i(x)>>>16,F=w.i(x)&65535;m[2*E+2*x]+=v*F,S(m,2*E+2*x),m[2*E+2*x+1]+=C*F,S(m,2*E+2*x+1),m[2*E+2*x+1]+=v*M,S(m,2*E+2*x+1),m[2*E+2*x+2]+=C*M,S(m,2*E+2*x+2)}for(w=0;w<p;w++)m[w]=m[2*w+1]<<16|m[2*w];for(w=p;w<2*p;w++)m[w]=0;return new o(m,0)};function S(w,p){for(;(w[p]&65535)!=w[p];)w[p+1]+=w[p]>>>16,w[p]&=65535,p++}function R(w,p){this.g=w,this.h=p}function T(w,p){if(g(p))throw Error("division by zero");if(g(w))return new R(u,u);if(y(w))return p=T(_(w),p),new R(_(p.g),_(p.h));if(y(p))return p=T(w,_(p)),new R(_(p.g),p.h);if(w.g.length>30){if(y(w)||y(p))throw Error("slowDivide_ only works with positive integers.");for(var m=d,E=p;E.l(w)<=0;)m=I(m),E=I(E);var x=L(m,1),C=L(E,1);for(E=L(E,2),m=L(m,2);!g(E);){var v=C.add(E);v.l(w)<=0&&(x=x.add(m),C=v),E=L(E,1),m=L(m,1)}return p=b(w,x.j(p)),new R(x,p)}for(x=u;w.l(p)>=0;){for(m=Math.max(1,Math.floor(w.m()/p.m())),E=Math.ceil(Math.log(m)/Math.LN2),E=E<=48?1:Math.pow(2,E-48),C=c(m),v=C.j(p);y(v)||v.l(w)>0;)m-=E,C=c(m),v=C.j(p);g(C)&&(C=d),x=x.add(C),w=b(w,v)}return new R(x,w)}n.B=function(w){return T(this,w).h},n.and=function(w){const p=Math.max(this.g.length,w.g.length),m=[];for(let E=0;E<p;E++)m[E]=this.i(E)&w.i(E);return new o(m,this.h&w.h)},n.or=function(w){const p=Math.max(this.g.length,w.g.length),m=[];for(let E=0;E<p;E++)m[E]=this.i(E)|w.i(E);return new o(m,this.h|w.h)},n.xor=function(w){const p=Math.max(this.g.length,w.g.length),m=[];for(let E=0;E<p;E++)m[E]=this.i(E)^w.i(E);return new o(m,this.h^w.h)};function I(w){const p=w.g.length+1,m=[];for(let E=0;E<p;E++)m[E]=w.i(E)<<1|w.i(E-1)>>>31;return new o(m,w.h)}function L(w,p){const m=p>>5;p%=32;const E=w.g.length-m,x=[];for(let C=0;C<E;C++)x[C]=p>0?w.i(C+m)>>>p|w.i(C+m+1)<<32-p:w.i(C+m);return new o(x,w.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=h,um=o}).apply(typeof yf<"u"?yf:typeof self<"u"?self:typeof window<"u"?window:{});const wf="4.9.2";class Kt{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Kt.UNAUTHENTICATED=new Kt(null),Kt.GOOGLE_CREDENTIALS=new Kt("google-credentials-uid"),Kt.FIRST_PARTY=new Kt("first-party-uid"),Kt.MOCK_USER=new Kt("mock-user");let Mr="12.3.0";const Cr=new sm("@firebase/firestore");function ta(n,...t){if(Cr.logLevel<=ct.DEBUG){const e=t.map(su);Cr.debug(`Firestore (${Mr}): ${n}`,...e)}}function ru(n,...t){if(Cr.logLevel<=ct.ERROR){const e=t.map(su);Cr.error(`Firestore (${Mr}): ${n}`,...e)}}function dm(n,...t){if(Cr.logLevel<=ct.WARN){const e=t.map(su);Cr.warn(`Firestore (${Mr}): ${n}`,...e)}}function su(n){if(typeof n=="string")return n;try{return(function(e){return JSON.stringify(e)})(n)}catch{return n}}function vt(n,t,e){let i="Unexpected state";typeof t=="string"?i=t:e=t,fm(n,i,e)}function fm(n,t,e){let i=`FIRESTORE (${Mr}) INTERNAL ASSERTION FAILED: ${t} (ID: ${n.toString(16)})`;if(e!==void 0)try{i+=" CONTEXT: "+JSON.stringify(e)}catch{i+=" CONTEXT: "+e}throw ru(i),new Error(i)}function Yn(n,t,e,i){let r="Unexpected state";typeof e=="string"?r=e:i=e,n||fm(t,r,i)}function ja(n,t){return n}const vf="ok",xC="cancelled",as="unknown",q="invalid-argument",CC="deadline-exceeded",SC="not-found",TC="permission-denied",Dc="unauthenticated",IC="resource-exhausted",Sr="failed-precondition",RC="aborted",AC="out-of-range",gm="unimplemented",PC="internal",LC="unavailable";class V extends Dr{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class pm{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class OC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(Kt.UNAUTHENTICATED)))}shutdown(){}}class kC{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class DC{constructor(t){this.auth=null,t.onInit((e=>{this.auth=e}))}getToken(){return this.auth?this.auth.getToken().then((t=>t?(Yn(typeof t.accessToken=="string",42297,{t}),new pm(t.accessToken,new Kt(this.auth.getUid()))):null)):Promise.resolve(null)}invalidateToken(){}start(t,e){}shutdown(){}}class MC{constructor(t,e,i){this.i=t,this.o=e,this.u=i,this.type="FirstParty",this.user=Kt.FIRST_PARTY,this.l=new Map}h(){return this.u?this.u():null}get headers(){this.l.set("X-Goog-AuthUser",this.i);const t=this.h();return t&&this.l.set("Authorization",t),this.o&&this.l.set("X-Goog-Iam-Authorization-Token",this.o),this.l}}class FC{constructor(t,e,i){this.i=t,this.o=e,this.u=i}getToken(){return Promise.resolve(new MC(this.i,this.o,this.u))}start(t,e){t.enqueueRetryable((()=>e(Kt.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class bf{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class NC{constructor(t,e){this.m=e,this.appCheck=null,this.T=null,oC(t)&&t.settings.appCheckToken&&(this.T=t.settings.appCheckToken),e.onInit((i=>{this.appCheck=i}))}getToken(){return this.T?Promise.resolve(new bf(this.T)):this.appCheck?this.appCheck.getToken().then((t=>t?(Yn(typeof t.token=="string",3470,{tokenResult:t}),new bf(t.token)):null)):Promise.resolve(null)}invalidateToken(){}start(t,e){}shutdown(){}}class $C{constructor(t,e,i,r,s,o,a,l,c,h){this.databaseId=t,this.appId=e,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=h}}const Mc="(default)";class As{constructor(t,e){this.projectId=t,this.database=e||Mc}static empty(){return new As("","")}get isDefaultDatabase(){return this.database===Mc}isEqual(t){return t instanceof As&&t.projectId===this.projectId&&t.database===this.database}}function VC(n){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(n);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(e);else for(let i=0;i<n;i++)e[i]=Math.floor(256*Math.random());return e}class zC{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=VC(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<e&&(i+=t.charAt(r[s]%62))}return i}}function Et(n,t){return n<t?-1:n>t?1:0}function Fc(n,t){const e=Math.min(n.length,t.length);for(let i=0;i<e;i++){const r=n.charAt(i),s=t.charAt(i);if(r!==s)return Bl(r)===Bl(s)?Et(r,s):Bl(r)?1:-1}return Et(n.length,t.length)}const GC=55296,BC=57343;function Bl(n){const t=n.charCodeAt(0);return t>=GC&&t<=BC}function mm(n,t,e){return n.length===t.length&&n.every(((i,r)=>e(i,t[r])))}const Ef="__name__";class Ve{constructor(t,e,i){e===void 0?e=0:e>t.length&&vt(637,{offset:e,range:t.length}),i===void 0?i=t.length-e:i>t.length-e&&vt(1746,{length:i,range:t.length-e}),this.segments=t,this.offset=e,this.len=i}get length(){return this.len}isEqual(t){return Ve.comparator(this,t)===0}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Ve?t.forEach((i=>{e.push(i)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,i=this.limit();e<i;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const i=Math.min(t.length,e.length);for(let r=0;r<i;r++){const s=Ve.compareSegments(t.get(r),e.get(r));if(s!==0)return s}return Et(t.length,e.length)}static compareSegments(t,e){const i=Ve.isNumericId(t),r=Ve.isNumericId(e);return i&&!r?-1:!i&&r?1:i&&r?Ve.extractNumericId(t).compare(Ve.extractNumericId(e)):Fc(t,e)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return um.fromString(t.substring(4,t.length-2))}}class Ct extends Ve{construct(t,e,i){return new Ct(t,e,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const i of t){if(i.indexOf("//")>=0)throw new V(q,`Invalid segment (${i}). Paths must not contain // in them.`);e.push(...i.split("/").filter((r=>r.length>0)))}return new Ct(e)}static emptyPath(){return new Ct([])}}const UC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ee extends Ve{construct(t,e,i){return new ee(t,e,i)}static isValidIdentifier(t){return UC.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ee.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Ef}static keyField(){return new ee([Ef])}static fromServerFormat(t){const e=[];let i="",r=0;const s=()=>{if(i.length===0)throw new V(q,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(i),i=""};let o=!1;for(;r<t.length;){const a=t[r];if(a==="\\"){if(r+1===t.length)throw new V(q,"Path has trailing escape character: "+t);const l=t[r+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new V(q,"Path has invalid escape sequence: "+t);i+=l,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(i+=a,r++):(s(),r++)}if(s(),o)throw new V(q,"Unterminated ` in path: "+t);return new ee(e)}static emptyPath(){return new ee([])}}class kt{constructor(t){this.path=t}static fromPath(t){return new kt(Ct.fromString(t))}static fromName(t){return new kt(Ct.fromString(t).popFirst(5))}static empty(){return new kt(Ct.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&Ct.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,e){return Ct.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new kt(new Ct(t.slice()))}}function _m(n,t,e){if(!e)throw new V(q,`Function ${n}() cannot be called with an empty ${t}.`)}function xf(n){if(!kt.isDocumentKey(n))throw new V(q,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Cf(n){if(kt.isDocumentKey(n))throw new V(q,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function ym(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Wa(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const t=(function(i){return i.constructor?i.constructor.name:null})(n);return t?`a custom ${t} object`:"an object"}}return typeof n=="function"?"a function":vt(12329,{type:typeof n})}function ou(n,t){if("_delegate"in n&&(n=n._delegate),!(n instanceof t)){if(t.name===n.constructor.name)throw new V(q,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=Wa(n);throw new V(q,`Expected type '${t.name}', but it was: ${e}`)}}return n}function wm(n){const t={};return n.timeoutSeconds!==void 0&&(t.timeoutSeconds=n.timeoutSeconds),t}let mo=null;function jC(){return mo===null?mo=(function(){return 268435456+Math.round(2147483648*Math.random())})():mo++,"0x"+mo.toString(16)}function WC(n){return n==null}function ea(n){return n===0&&1/n==-1/0}const Ul="RestConnection",qC={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class HC{get P(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.A=e+"://"+t.host,this.R=`projects/${i}/databases/${r}`,this.V=this.databaseId.database===Mc?`project_id=${i}`:`project_id=${i}&database_id=${r}`}I(t,e,i,r,s){const o=jC(),a=this.p(t,e.toUriEncodedString());ta(Ul,`Sending RPC '${t}' ${o}:`,a,i);const l={"google-cloud-resource-prefix":this.R,"x-goog-request-params":this.V};this.F(l,r,s);const{host:c}=new URL(a),h=nu(c);return this.v(t,a,l,i,h).then((u=>(ta(Ul,`Received RPC '${t}' ${o}: `,u),u)),(u=>{throw dm(Ul,`RPC '${t}' ${o} failed with error: `,u,"url: ",a,"request:",i),u}))}D(t,e,i,r,s,o){return this.I(t,e,i,r,s)}F(t,e,i){t["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Mr})(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((r,s)=>t[s]=r)),i&&i.headers.forEach(((r,s)=>t[s]=r))}p(t,e){const i=qC[t];return`${this.A}/v1/${e}:${i}`}terminate(){}}var Sf,tt;function Tf(n){if(n===void 0)return ru("RPC_ERROR","HTTP error has no status"),as;switch(n){case 200:return vf;case 400:return Sr;case 401:return Dc;case 403:return TC;case 404:return SC;case 409:return RC;case 416:return AC;case 429:return IC;case 499:return xC;case 500:return as;case 501:return gm;case 503:return LC;case 504:return CC;default:return n>=200&&n<300?vf:n>=400&&n<500?Sr:n>=500&&n<600?PC:as}}(tt=Sf||(Sf={}))[tt.OK=0]="OK",tt[tt.CANCELLED=1]="CANCELLED",tt[tt.UNKNOWN=2]="UNKNOWN",tt[tt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",tt[tt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",tt[tt.NOT_FOUND=5]="NOT_FOUND",tt[tt.ALREADY_EXISTS=6]="ALREADY_EXISTS",tt[tt.PERMISSION_DENIED=7]="PERMISSION_DENIED",tt[tt.UNAUTHENTICATED=16]="UNAUTHENTICATED",tt[tt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",tt[tt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",tt[tt.ABORTED=10]="ABORTED",tt[tt.OUT_OF_RANGE=11]="OUT_OF_RANGE",tt[tt.UNIMPLEMENTED=12]="UNIMPLEMENTED",tt[tt.INTERNAL=13]="INTERNAL",tt[tt.UNAVAILABLE=14]="UNAVAILABLE",tt[tt.DATA_LOSS=15]="DATA_LOSS";class XC extends HC{S(t,e){throw new Error("Not supported by FetchConnection")}async v(t,e,i,r,s){const o=JSON.stringify(r);let a;try{const l={method:"POST",headers:i,body:o};s&&(l.credentials="include"),a=await fetch(e,l)}catch(l){const c=l;throw new V(Tf(c.status),"Request failed with error: "+c.statusText)}if(!a.ok){let l=await a.json();Array.isArray(l)&&(l=l[0]);const c=l?.error?.message;throw new V(Tf(a.status),`Request failed with error: ${c??a.statusText}`)}return a.json()}}function If(n){let t=0;for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t++;return t}function qa(n,t){for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t(e,n[e])}class KC extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class _n{constructor(t){this.binaryString=t}static fromBase64String(t){const e=(function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new KC("Invalid base64 string: "+s):s}})(t);return new _n(e)}static fromUint8Array(t){const e=(function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s})(t);return new _n(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(e){return btoa(e)})(this.binaryString)}toUint8Array(){return(function(e){const i=new Uint8Array(e.length);for(let r=0;r<e.length;r++)i[r]=e.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Et(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}_n.EMPTY_BYTE_STRING=new _n("");const YC=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ii(n){if(Yn(!!n,39018),typeof n=="string"){let t=0;const e=YC.exec(n);if(Yn(!!e,46558,{timestamp:n}),e[1]){let r=e[1];r=(r+"000000000").substr(0,9),t=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:xt(n.seconds),nanos:xt(n.nanos)}}function xt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ps(n){return typeof n=="string"?_n.fromBase64String(n):_n.fromUint8Array(n)}function xe(n,t){const e={typeString:n};return t&&(e.value=t),e}function Ks(n,t){if(!ym(n))throw new V(q,"JSON must be an object");let e;for(const i in t)if(t[i]){const r=t[i].typeString,s="value"in t[i]?{value:t[i].value}:void 0;if(!(i in n)){e=`JSON missing required field: '${i}'`;break}const o=n[i];if(r&&typeof o!==r){e=`JSON field '${i}' must be a ${r}.`;break}if(s!==void 0&&o!==s.value){e=`Expected '${i}' field to equal '${s.value}'`;break}}if(e)throw new V(q,e);return!0}const Rf=-62135596800,Af=1e6;class Tt{static now(){return Tt.fromMillis(Date.now())}static fromDate(t){return Tt.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),i=Math.floor((t-1e3*e)*Af);return new Tt(e,i)}constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new V(q,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new V(q,"Timestamp nanoseconds out of range: "+e);if(t<Rf)throw new V(q,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new V(q,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Af}_compareTo(t){return this.seconds===t.seconds?Et(this.nanoseconds,t.nanoseconds):Et(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Tt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(Ks(t,Tt._jsonSchema))return new Tt(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-Rf;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Tt._jsonSchemaVersion="firestore/timestamp/1.0",Tt._jsonSchema={type:xe("string",Tt._jsonSchemaVersion),seconds:xe("number"),nanoseconds:xe("number")};function vm(n){return(n?.mapValue?.fields||{}).__type__?.stringValue==="server_timestamp"}function bm(n){const t=n.mapValue.fields.__previous_value__;return vm(t)?bm(t):t}function Ls(n){const t=Ii(n.mapValue.fields.__local_write_time__.timestampValue);return new Tt(t.seconds,t.nanos)}const Em="__type__",ZC="__max__",_o={},xm="__vector__",na="value";function Ri(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?vm(n)?4:(function(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===ZC})(n)?9007199254740991:(function(e){return(e?.mapValue?.fields||{})[Em]?.stringValue===xm})(n)?10:11:vt(28295,{value:n})}function ia(n,t){if(n===t)return!0;const e=Ri(n);if(e!==Ri(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===t.booleanValue;case 4:return Ls(n).isEqual(Ls(t));case 3:return(function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=Ii(r.timestampValue),a=Ii(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos})(n,t);case 5:return n.stringValue===t.stringValue;case 6:return(function(r,s){return Ps(r.bytesValue).isEqual(Ps(s.bytesValue))})(n,t);case 7:return n.referenceValue===t.referenceValue;case 8:return(function(r,s){return xt(r.geoPointValue.latitude)===xt(s.geoPointValue.latitude)&&xt(r.geoPointValue.longitude)===xt(s.geoPointValue.longitude)})(n,t);case 2:return(function(r,s){if("integerValue"in r&&"integerValue"in s)return xt(r.integerValue)===xt(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=xt(r.doubleValue),a=xt(s.doubleValue);return o===a?ea(o)===ea(a):isNaN(o)&&isNaN(a)}return!1})(n,t);case 9:return mm(n.arrayValue.values||[],t.arrayValue.values||[],ia);case 10:case 11:return(function(r,s){const o=r.mapValue.fields||{},a=s.mapValue.fields||{};if(If(o)!==If(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!ia(o[l],a[l])))return!1;return!0})(n,t);default:return vt(52216,{left:n})}}function Os(n,t){return(n.values||[]).find((e=>ia(e,t)))!==void 0}function ra(n,t){if(n===t)return 0;const e=Ri(n),i=Ri(t);if(e!==i)return Et(e,i);switch(e){case 0:case 9007199254740991:return 0;case 1:return Et(n.booleanValue,t.booleanValue);case 2:return(function(s,o){const a=xt(s.integerValue||s.doubleValue),l=xt(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1})(n,t);case 3:return Pf(n.timestampValue,t.timestampValue);case 4:return Pf(Ls(n),Ls(t));case 5:return Fc(n.stringValue,t.stringValue);case 6:return(function(s,o){const a=Ps(s),l=Ps(o);return a.compareTo(l)})(n.bytesValue,t.bytesValue);case 7:return(function(s,o){const a=s.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const h=Et(a[c],l[c]);if(h!==0)return h}return Et(a.length,l.length)})(n.referenceValue,t.referenceValue);case 8:return(function(s,o){const a=Et(xt(s.latitude),xt(o.latitude));return a!==0?a:Et(xt(s.longitude),xt(o.longitude))})(n.geoPointValue,t.geoPointValue);case 9:return Lf(n.arrayValue,t.arrayValue);case 10:return(function(s,o){const a=s.fields||{},l=o.fields||{},c=a[na]?.arrayValue,h=l[na]?.arrayValue,u=Et(c?.values?.length||0,h?.values?.length||0);return u!==0?u:Lf(c,h)})(n.mapValue,t.mapValue);case 11:return(function(s,o){if(s===_o&&o===_o)return 0;if(s===_o)return 1;if(o===_o)return-1;const a=s.fields||{},l=Object.keys(a),c=o.fields||{},h=Object.keys(c);l.sort(),h.sort();for(let u=0;u<l.length&&u<h.length;++u){const d=Fc(l[u],h[u]);if(d!==0)return d;const f=ra(a[l[u]],c[h[u]]);if(f!==0)return f}return Et(l.length,h.length)})(n.mapValue,t.mapValue);default:throw vt(23264,{C:e})}}function Pf(n,t){if(typeof n=="string"&&typeof t=="string"&&n.length===t.length)return Et(n,t);const e=Ii(n),i=Ii(t),r=Et(e.seconds,i.seconds);return r!==0?r:Et(e.nanos,i.nanos)}function Lf(n,t){const e=n.values||[],i=t.values||[];for(let r=0;r<e.length&&r<i.length;++r){const s=ra(e[r],i[r]);if(s)return s}return Et(e.length,i.length)}function Of(n,t){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${t.path.canonicalString()}`}}function Cm(n){return!!n&&"arrayValue"in n}function kf(n){return!!n&&"nullValue"in n}function Df(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function jl(n){return!!n&&"mapValue"in n}function ls(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const t={mapValue:{fields:{}}};return qa(n.mapValue.fields,((e,i)=>t.mapValue.fields[e]=ls(i))),t}if(n.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(n.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=ls(n.arrayValue.values[e]);return t}return{...n}}class Mf{constructor(t,e){this.position=t,this.inclusive=e}}class Sm{}class Me extends Sm{constructor(t,e,i){super(),this.field=t,this.op=e,this.value=i}static create(t,e,i){return t.isKeyField()?e==="in"||e==="not-in"?this.createKeyFieldInFilter(t,e,i):new JC(t,e,i):e==="array-contains"?new eS(t,i):e==="in"?new nS(t,i):e==="not-in"?new iS(t,i):e==="array-contains-any"?new rS(t,i):new Me(t,e,i)}static createKeyFieldInFilter(t,e,i){return e==="in"?new QC(t,i):new tS(t,i)}matches(t){const e=t.data.field(this.field);return this.op==="!="?e!==null&&e.nullValue===void 0&&this.matchesComparison(ra(e,this.value)):e!==null&&Ri(this.value)===Ri(e)&&this.matchesComparison(ra(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return vt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ys extends Sm{constructor(t,e){super(),this.filters=t,this.op=e,this.N=null}static create(t,e){return new Ys(t,e)}matches(t){return(function(i){return i.op==="and"})(this)?this.filters.find((e=>!e.matches(t)))===void 0:this.filters.find((e=>e.matches(t)))!==void 0}getFlattenedFilters(){return this.N!==null||(this.N=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.N}getFilters(){return Object.assign([],this.filters)}}class JC extends Me{constructor(t,e,i){super(t,e,i),this.key=kt.fromName(i.referenceValue)}matches(t){const e=kt.comparator(t.key,this.key);return this.matchesComparison(e)}}class QC extends Me{constructor(t,e){super(t,"in",e),this.keys=Tm("in",e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class tS extends Me{constructor(t,e){super(t,"not-in",e),this.keys=Tm("not-in",e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function Tm(n,t){return(t.arrayValue?.values||[]).map((e=>kt.fromName(e.referenceValue)))}class eS extends Me{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Cm(e)&&Os(e.arrayValue,this.value)}}class nS extends Me{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return e!==null&&Os(this.value.arrayValue,e)}}class iS extends Me{constructor(t,e){super(t,"not-in",e)}matches(t){if(Os(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return e!==null&&e.nullValue===void 0&&!Os(this.value.arrayValue,e)}}class rS extends Me{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Cm(e)||!e.arrayValue.values)&&e.arrayValue.values.some((i=>Os(this.value.arrayValue,i)))}}class Nc{constructor(t,e="asc"){this.field=t,this.dir=e}}class Gt{static fromTimestamp(t){return new Gt(t)}static min(){return new Gt(new Tt(0,0))}static max(){return new Gt(new Tt(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class sa{constructor(t,e){this.comparator=t,this.root=e||Dt.EMPTY}insert(t,e){return new sa(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,Dt.BLACK,null,null))}remove(t){return new sa(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Dt.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const i=this.comparator(t,e.key);if(i===0)return e.value;i<0?e=e.left:i>0&&(e=e.right)}return null}indexOf(t){let e=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(t,i.key);if(r===0)return e+i.left.size;r<0?i=i.left:(e+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,i)=>(t(e,i),!1)))}toString(){const t=[];return this.inorderTraversal(((e,i)=>(t.push(`${e}:${i}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new yo(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new yo(this.root,t,this.comparator,!1)}getReverseIterator(){return new yo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new yo(this.root,t,this.comparator,!0)}}class yo{constructor(t,e,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=e?i(t.key,e):1,e&&r&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(s===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Dt{constructor(t,e,i,r,s){this.key=t,this.value=e,this.color=i??Dt.RED,this.left=r??Dt.EMPTY,this.right=s??Dt.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,i,r,s){return new Dt(t??this.key,e??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,i){let r=this;const s=i(t,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(t,e,i),null):s===0?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Dt.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let i,r=this;if(e(t,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),e(t,r.key)===0){if(r.right.isEmpty())return Dt.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Dt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Dt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw vt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw vt(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw vt(27949);return t+(this.isRed()?0:1)}}Dt.EMPTY=null,Dt.RED=!0,Dt.BLACK=!1;Dt.EMPTY=new class{constructor(){this.size=0}get key(){throw vt(57766)}get value(){throw vt(16141)}get color(){throw vt(16727)}get left(){throw vt(29726)}get right(){throw vt(36894)}copy(t,e,i,r,s){return this}insert(t,e,i){return new Dt(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class ks{constructor(t){this.comparator=t,this.data=new sa(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,i)=>(t(e),!1)))}forEachInRange(t,e){const i=this.data.getIteratorFrom(t[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}}forEachWhile(t,e){let i;for(i=e!==void 0?this.data.getIteratorFrom(e):this.data.getIterator();i.hasNext();)if(!t(i.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new Ff(this.data.getIterator())}getIteratorFrom(t){return new Ff(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((i=>{e=e.add(i)})),e}isEqual(t){if(!(t instanceof ks)||this.size!==t.size)return!1;const e=this.data.getIterator(),i=t.data.getIterator();for(;e.hasNext();){const r=e.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new ks(this.comparator);return e.data=t,e}}class Ff{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Ds{constructor(t){this.fields=t,t.sort(ee.comparator)}static empty(){return new Ds([])}unionWith(t){let e=new ks(ee.comparator);for(const i of this.fields)e=e.add(i);for(const i of t)e=e.add(i);return new Ds(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return mm(this.fields,t.fields,((e,i)=>e.isEqual(i)))}}class Be{constructor(t){this.value=t}static empty(){return new Be({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let i=0;i<t.length-1;++i)if(e=(e.mapValue.fields||{})[t.get(i)],!jl(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=ls(e)}setAll(t){let e=ee.emptyPath(),i={},r=[];t.forEach(((o,a)=>{if(!e.isImmediateParentOf(a)){const l=this.getFieldsMap(e);this.applyChanges(l,i,r),i={},r=[],e=a.popLast()}o?i[a.lastSegment()]=ls(o):r.push(a.lastSegment())}));const s=this.getFieldsMap(e);this.applyChanges(s,i,r)}delete(t){const e=this.field(t.popLast());jl(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return ia(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let i=0;i<t.length;++i){let r=e.mapValue.fields[t.get(i)];jl(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(i)]=r),e=r}return e.mapValue.fields}applyChanges(t,e,i){qa(e,((r,s)=>t[r]=s));for(const r of i)delete t[r]}clone(){return new Be(ls(this.value))}}class On{constructor(t,e,i,r,s,o,a){this.key=t,this.documentType=e,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(t){return new On(t,0,Gt.min(),Gt.min(),Gt.min(),Be.empty(),0)}static newFoundDocument(t,e,i,r){return new On(t,1,e,Gt.min(),i,r,0)}static newNoDocument(t,e){return new On(t,2,e,Gt.min(),Gt.min(),Be.empty(),0)}static newUnknownDocument(t,e){return new On(t,3,e,Gt.min(),Gt.min(),Be.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(Gt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Be.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Be.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Gt.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof On&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new On(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class sS{constructor(t,e=null,i=[],r=[],s=null,o=null,a=null){this.path=t,this.collectionGroup=e,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=a,this.O=null}}function Nf(n,t=null,e=[],i=[],r=null,s=null,o=null){return new sS(n,t,e,i,r,s,o)}class Im{constructor(t,e=null,i=[],r=[],s=null,o="F",a=null,l=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.q=null,this.B=null,this.$=null,this.startAt,this.endAt}}function oS(n){return n.collectionGroup!==null}function aS(n){const t=ja(n);if(t.q===null){t.q=[];const e=new Set;for(const s of t.explicitOrderBy)t.q.push(s),e.add(s.field.canonicalString());const i=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new ks(ee.comparator);return o.filters.forEach((l=>{l.getFlattenedFilters().forEach((c=>{c.isInequality()&&(a=a.add(c.field))}))})),a})(t).forEach((s=>{e.has(s.canonicalString())||s.isKeyField()||t.q.push(new Nc(s,i))})),e.has(ee.keyField().canonicalString())||t.q.push(new Nc(ee.keyField(),i))}return t.q}function lS(n){const t=ja(n);return t.B||(t.B=cS(t,aS(n))),t.B}function cS(n,t){if(n.limitType==="F")return Nf(n.path,n.collectionGroup,t,n.filters,n.limit,n.startAt,n.endAt);{t=t.map((r=>{const s=r.dir==="desc"?"asc":"desc";return new Nc(r.field,s)}));const e=n.endAt?new Mf(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Mf(n.startAt.position,n.startAt.inclusive):null;return Nf(n.path,n.collectionGroup,t,n.filters,n.limit,e,i)}}function $c(n,t){const e=n.filters.concat([t]);return new Im(n.path,n.collectionGroup,n.explicitOrderBy.slice(),e,n.limit,n.limitType,n.startAt,n.endAt)}function Rm(n,t){if(n.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ea(t)?"-0":t}}function hS(n,t){return(function(i){return typeof i=="number"&&Number.isInteger(i)&&!ea(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER})(t)?(function(i){return{integerValue:""+i}})(t):Rm(n,t)}class Ha{constructor(){this._=void 0}}class uS extends Ha{}class dS extends Ha{constructor(t){super(),this.elements=t}}class fS extends Ha{constructor(t){super(),this.elements=t}}class gS extends Ha{constructor(t,e){super(),this.serializer=t,this.k=e}}class cs{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new cs}static exists(t){return new cs(void 0,t)}static updateTime(t){return new cs(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}class Xa{}class Am extends Xa{constructor(t,e,i,r=[]){super(),this.key=t,this.value=e,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Pm extends Xa{constructor(t,e,i,r,s=[]){super(),this.key=t,this.data=e,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}class pS extends Xa{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class mS extends Xa{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}const _S={asc:"ASCENDING",desc:"DESCENDING"},yS={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},wS={and:"AND",or:"OR"};class vS{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function Vc(n,t){return n.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function bS(n,t){return n.useProto3Json?t.toBase64():t.toUint8Array()}function ES(n,t){return Vc(n,t.toTimestamp())}function $f(n){return Yn(!!n,49232),Gt.fromTimestamp((function(e){const i=Ii(e);return new Tt(i.seconds,i.nanos)})(n))}function au(n,t){return zc(n,t).canonicalString()}function zc(n,t){const e=(function(r){return new Ct(["projects",r.projectId,"databases",r.database])})(n).child("documents");return t===void 0?e:e.child(t)}function Gc(n,t){return au(n.databaseId,t.path)}function xS(n,t){const e=(function(r){const s=Ct.fromString(r);return Yn(Om(s),10190,{key:s.toString()}),s})(t);if(e.get(1)!==n.databaseId.projectId)throw new V(q,"Tried to deserialize key from different project: "+e.get(1)+" vs "+n.databaseId.projectId);if(e.get(3)!==n.databaseId.database)throw new V(q,"Tried to deserialize key from different database: "+e.get(3)+" vs "+n.databaseId.database);return new kt((function(r){return Yn(r.length>4&&r.get(4)==="documents",29091,{key:r.toString()}),r.popFirst(5)})(e))}function Vf(n,t,e){return{name:Gc(n,t),fields:e.value.mapValue.fields}}function CS(n,t){let e;if(t instanceof Am)e={update:Vf(n,t.key,t.value)};else if(t instanceof pS)e={delete:Gc(n,t.key)};else if(t instanceof Pm)e={update:Vf(n,t.key,t.data),updateMask:AS(t.fieldMask)};else{if(!(t instanceof mS))return vt(16599,{L:t.type});e={verify:Gc(n,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map((i=>(function(s,o){const a=o.transform;if(a instanceof uS)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof dS)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof fS)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof gS)return{fieldPath:o.field.canonicalString(),increment:a.k};throw vt(20930,{transform:o.transform})})(0,i)))),t.precondition.isNone||(e.currentDocument=(function(r,s){return s.updateTime!==void 0?{updateTime:ES(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:vt(27497)})(n,t.precondition)),e}function SS(n,t){const e={structuredQuery:{}},i=t.path;let r;t.collectionGroup!==null?(r=i,e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(r=i.popLast(),e.structuredQuery.from=[{collectionId:i.lastSegment()}]),e.parent=(function(c,h){return au(c.databaseId,h)})(n,r);const s=(function(c){if(c.length!==0)return Lm(Ys.create(c,"and"))})(t.filters);s&&(e.structuredQuery.where=s);const o=(function(c){if(c.length!==0)return c.map((h=>(function(d){return{field:Ji(d.field),direction:TS(d.dir)}})(h)))})(t.orderBy);o&&(e.structuredQuery.orderBy=o);const a=(function(c,h){return c.useProto3Json||WC(h)?h:{value:h}})(n,t.limit);return a!==null&&(e.structuredQuery.limit=a),t.startAt&&(e.structuredQuery.startAt=(function(c){return{before:c.inclusive,values:c.position}})(t.startAt)),t.endAt&&(e.structuredQuery.endAt=(function(c){return{before:!c.inclusive,values:c.position}})(t.endAt)),{M:e,parent:r}}function TS(n){return _S[n]}function IS(n){return yS[n]}function RS(n){return wS[n]}function Ji(n){return{fieldPath:n.canonicalString()}}function Lm(n){return n instanceof Me?(function(e){if(e.op==="=="){if(Df(e.value))return{unaryFilter:{field:Ji(e.field),op:"IS_NAN"}};if(kf(e.value))return{unaryFilter:{field:Ji(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(Df(e.value))return{unaryFilter:{field:Ji(e.field),op:"IS_NOT_NAN"}};if(kf(e.value))return{unaryFilter:{field:Ji(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ji(e.field),op:IS(e.op),value:e.value}}})(n):n instanceof Ys?(function(e){const i=e.getFilters().map((r=>Lm(r)));return i.length===1?i[0]:{compositeFilter:{op:RS(e.op),filters:i}}})(n):vt(54877,{filter:n})}function AS(n){const t=[];return n.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function Om(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function lu(n){return new vS(n,!0)}class PS{}class LS extends PS{constructor(t,e,i,r){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=i,this.serializer=r,this.et=!1}rt(){if(this.et)throw new V(Sr,"The client has already been terminated.")}I(t,e,i,r){return this.rt(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.I(t,zc(e,i),r,s,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===Dc&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new V(as,s.toString())}))}D(t,e,i,r,s){return this.rt(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,a])=>this.connection.D(t,zc(e,i),r,o,a,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===Dc&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new V(as,o.toString())}))}terminate(){this.et=!0,this.connection.terminate()}}async function OS(n,t){const e=ja(n),i={writes:t.map((r=>CS(e.serializer,r)))};await e.I("Commit",e.serializer.databaseId,Ct.emptyPath(),i)}async function kS(n,t){const e=ja(n),{M:i,parent:r}=SS(e.serializer,lS(t));return(await e.D("RunQuery",e.serializer.databaseId,r,{structuredQuery:i.structuredQuery})).filter((s=>!!s.document)).map((s=>(function(a,l,c){const h=xS(a,l.name),u=$f(l.updateTime),d=l.createTime?$f(l.createTime):Gt.min(),f=new Be({mapValue:{fields:l.fields}}),g=On.newFoundDocument(h,u,d,f);return c?g.setHasCommittedMutations():g})(e.serializer,s.document,void 0)))}const km="ComponentProvider",hs=new Map;function Dm(n){if(n._terminated)throw new V(Sr,"The client has already been terminated.");if(!hs.has(n)){ta(km,"Initializing Datastore");const t=(function(s){return new XC(s)})((function(s,o,a,l){return new $C(s,o,a,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,wm(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator)})(n._databaseId,n.app.options.appId||"",n._persistenceKey,n._freezeSettings())),e=lu(n._databaseId),i=(function(s,o,a,l){return new LS(s,o,a,l)})(n._authCredentials,n._appCheckCredentials,t,e);hs.set(n,i)}return hs.get(n)}const DS=1048576,Mm="firestore.googleapis.com",zf=!0;class Gf{constructor(t){if(t.host===void 0){if(t.ssl!==void 0)throw new V(q,"Can't provide ssl option if host option is not set");this.host=Mm,this.ssl=zf}else this.host=t.host,this.ssl=t.ssl??zf;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<DS)throw new V(q,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}(function(i,r,s,o){if(r===!0&&o===!0)throw new V(q,`${i} and ${s} cannot be used together.`)})("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=wm(t.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new V(q,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new V(q,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new V(q,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Ka{constructor(t,e,i,r){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Gf({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new V(Sr,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new V(Sr,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Gf(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new OC;switch(i.type){case"firstParty":return new FC(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new V(q,"makeAuthCredentialsProvider failed due to invalid credential type")}})(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(e){const i=hs.get(e);i&&(ta(km,"Removing Datastore"),hs.delete(e),i.terminate())})(this),Promise.resolve()}}function MS(n,t){const e=typeof n=="object"?n:hC(),i=typeof n=="string"?n:"(default)",r=sC(e,"firestore/lite").getImmediate({identifier:i});if(!r._initialized){const s=Z2("firestore");s&&FS(r,...s)}return r}function FS(n,t,e,i={}){n=ou(n,Ka);const r=nu(t),s=n._getSettings(),o={...s,emulatorOptions:n._getEmulatorOptions()},a=`${t}:${e}`;r&&(Q2(`https://${a}`),ix("Firestore",!0)),s.host!==Mm&&s.host!==a&&dm("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:a,ssl:r,emulatorOptions:i};if(!Zo(l,o)&&(n._setSettings(l),i.mockUserToken)){let c,h;if(typeof i.mockUserToken=="string")c=i.mockUserToken,h=Kt.MOCK_USER;else{c=tx(i.mockUserToken,n._app?.options.projectId);const u=i.mockUserToken.sub||i.mockUserToken.user_id;if(!u)throw new V(q,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Kt(u)}n._authCredentials=new kC(new pm(c,h))}}class Fr{constructor(t,e,i){this.converter=e,this._query=i,this.type="query",this.firestore=t}withConverter(t){return new Fr(this.firestore,t,this._query)}}class It{constructor(t,e,i){this.converter=e,this._key=i,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Un(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new It(this.firestore,t,this._key)}toJSON(){return{type:It._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,e,i){if(Ks(e,It._jsonSchema))return new It(t,i||null,new kt(Ct.fromString(e.referencePath)))}}It._jsonSchemaVersion="firestore/documentReference/1.0",It._jsonSchema={type:xe("string",It._jsonSchemaVersion),referencePath:xe("string")};class Un extends Fr{constructor(t,e,i){super(t,e,(function(s){return new Im(s)})(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new It(this.firestore,null,new kt(t))}withConverter(t){return new Un(this.firestore,t,this._path)}}function Bc(n,t,...e){if(n=xr(n),_m("collection","path",t),n instanceof Ka){const i=Ct.fromString(t,...e);return Cf(i),new Un(n,null,i)}{if(!(n instanceof It||n instanceof Un))throw new V(q,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Ct.fromString(t,...e));return Cf(i),new Un(n.firestore,null,i)}}function NS(n,t,...e){if(n=xr(n),arguments.length===1&&(t=zC.newId()),_m("doc","path",t),n instanceof Ka){const i=Ct.fromString(t,...e);return xf(i),new It(n,null,new kt(i))}{if(!(n instanceof It||n instanceof Un))throw new V(q,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Ct.fromString(t,...e));return xf(i),new It(n.firestore,n instanceof Un?n.converter:null,new kt(i))}}class _e{constructor(t){this._byteString=t}static fromBase64String(t){try{return new _e(_n.fromBase64String(t))}catch(e){throw new V(q,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new _e(_n.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:_e._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(Ks(t,_e._jsonSchema))return _e.fromBase64String(t.bytes)}}_e._jsonSchemaVersion="firestore/bytes/1.0",_e._jsonSchema={type:xe("string",_e._jsonSchemaVersion),bytes:xe("string")};class cu{constructor(...t){for(let e=0;e<t.length;++e)if(t[e].length===0)throw new V(q,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ee(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class Fm{constructor(t){this._methodName=t}}class qe{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new V(q,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new V(q,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return Et(this._lat,t._lat)||Et(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:qe._jsonSchemaVersion}}static fromJSON(t){if(Ks(t,qe._jsonSchema))return new qe(t.latitude,t.longitude)}}qe._jsonSchemaVersion="firestore/geoPoint/1.0",qe._jsonSchema={type:xe("string",qe._jsonSchemaVersion),latitude:xe("number"),longitude:xe("number")};class He{constructor(t){this._values=(t||[]).map((e=>e))}toArray(){return this._values.map((t=>t))}isEqual(t){return(function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0})(this._values,t._values)}toJSON(){return{type:He._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(Ks(t,He._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every((e=>typeof e=="number")))return new He(t.vectorValues);throw new V(q,"Expected 'vectorValues' field to be a number array")}}}He._jsonSchemaVersion="firestore/vectorValue/1.0",He._jsonSchema={type:xe("string",He._jsonSchemaVersion),vectorValues:xe("object")};const $S=/^__.*__$/;class VS{constructor(t,e,i){this.data=t,this.fieldMask=e,this.fieldTransforms=i}toMutation(t,e){return this.fieldMask!==null?new Pm(t,this.data,this.fieldMask,e,this.fieldTransforms):new Am(t,this.data,e,this.fieldTransforms)}}function Nm(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw vt(40011,{it:n})}}class hu{constructor(t,e,i,r,s,o){this.settings=t,this.databaseId=e,this.serializer=i,this.ignoreUndefinedProperties=r,s===void 0&&this.st(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get it(){return this.settings.it}ot(t){return new hu({...this.settings,...t},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ut(t){const e=this.path?.child(t),i=this.ot({path:e,_t:!1});return i.ct(t),i}lt(t){const e=this.path?.child(t),i=this.ot({path:e,_t:!1});return i.st(),i}ht(t){return this.ot({path:void 0,_t:!0})}ft(t){return oa(t,this.settings.methodName,this.settings.dt||!1,this.path,this.settings.Et)}contains(t){return this.fieldMask.find((e=>t.isPrefixOf(e)))!==void 0||this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))!==void 0}st(){if(this.path)for(let t=0;t<this.path.length;t++)this.ct(this.path.get(t))}ct(t){if(t.length===0)throw this.ft("Document fields must not be empty");if(Nm(this.it)&&$S.test(t))throw this.ft('Document fields cannot begin and end with "__"')}}class zS{constructor(t,e,i){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=i||lu(t)}Tt(t,e,i,r=!1){return new hu({it:t,methodName:e,Et:i,path:ee.emptyPath(),_t:!1,dt:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function $m(n){const t=n._freezeSettings(),e=lu(n._databaseId);return new zS(n._databaseId,!!t.ignoreUndefinedProperties,e)}function GS(n,t,e,i,r,s={}){const o=n.Tt(s.merge||s.mergeFields?2:0,t,e,r);Gm("Data must be an object, but it was:",o,i);const a=Vm(i,o);let l,c;if(s.merge)l=new Ds(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const h=[];for(const u of s.mergeFields){const d=US(t,u,e);if(!o.contains(d))throw new V(q,`Field '${d}' is specified in your field mask but missing from your input data.`);WS(h,d)||h.push(d)}l=new Ds(h),c=o.fieldTransforms.filter((u=>l.covers(u.field)))}else l=null,c=o.fieldTransforms;return new VS(new Be(a),l,c)}function BS(n,t,e,i=!1){return uu(e,n.Tt(i?4:3,t))}function uu(n,t){if(zm(n=xr(n)))return Gm("Unsupported field value:",t,n),Vm(n,t);if(n instanceof Fm)return(function(i,r){if(!Nm(r.it))throw r.ft(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.ft(`${i._methodName}() is not currently supported inside arrays`);const s=i._toFieldTransform(r);s&&r.fieldTransforms.push(s)})(n,t),null;if(n===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),n instanceof Array){if(t.settings._t&&t.it!==4)throw t.ft("Nested arrays are not supported");return(function(i,r){const s=[];let o=0;for(const a of i){let l=uu(a,r.ht(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}})(n,t)}return(function(i,r){if((i=xr(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return hS(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const s=Tt.fromDate(i);return{timestampValue:Vc(r.serializer,s)}}if(i instanceof Tt){const s=new Tt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Vc(r.serializer,s)}}if(i instanceof qe)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof _e)return{bytesValue:bS(r.serializer,i._byteString)};if(i instanceof It){const s=r.databaseId,o=i.firestore._databaseId;if(!o.isEqual(s))throw r.ft(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:au(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof He)return(function(o,a){return{mapValue:{fields:{[Em]:{stringValue:xm},[na]:{arrayValue:{values:o.toArray().map((c=>{if(typeof c!="number")throw a.ft("VectorValues must only contain numeric values.");return Rm(a.serializer,c)}))}}}}}})(i,r);throw r.ft(`Unsupported field value: ${Wa(i)}`)})(n,t)}function Vm(n,t){const e={};return(function(r){for(const s in r)if(Object.prototype.hasOwnProperty.call(r,s))return!1;return!0})(n)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):qa(n,((i,r)=>{const s=uu(r,t.ut(i));s!=null&&(e[i]=s)})),{mapValue:{fields:e}}}function zm(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Tt||n instanceof qe||n instanceof _e||n instanceof It||n instanceof Fm||n instanceof He)}function Gm(n,t,e){if(!zm(e)||!ym(e)){const i=Wa(e);throw i==="an object"?t.ft(n+" a custom object"):t.ft(n+" "+i)}}function US(n,t,e){if((t=xr(t))instanceof cu)return t._internalPath;if(typeof t=="string")return Bm(n,t);throw oa("Field path arguments must be of type string or ",n,!1,void 0,e)}const jS=new RegExp("[~\\*/\\[\\]]");function Bm(n,t,e){if(t.search(jS)>=0)throw oa(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,e);try{return new cu(...t.split("."))._internalPath}catch{throw oa(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,e)}}function oa(n,t,e,i,r){const s=i&&!i.isEmpty(),o=r!==void 0;let a=`Function ${t}() called with invalid data`;e&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${i}`),o&&(l+=` in document ${r}`),l+=")"),new V(q,a+n+l)}function WS(n,t){return n.some((e=>e.isEqual(t)))}class qS{constructor(t,e,i,r,s){this._firestore=t,this._userDataWriter=e,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new It(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new Um(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(jm("DocumentSnapshot.get",t));if(e!==null)return this._userDataWriter.convertValue(e)}}}class Um extends qS{data(){return super.data()}}class HS{constructor(t,e){this._docs=e,this.query=t}get docs(){return[...this._docs]}get size(){return this.docs.length}get empty(){return this.docs.length===0}forEach(t,e){this._docs.forEach(t,e)}}function jm(n,t){return typeof t=="string"?Bm(n,t):t instanceof cu?t._internalPath:t._delegate._internalPath}class du{}class XS extends du{}function Wm(n,t,...e){let i=[];t instanceof du&&i.push(t),i=i.concat(e),(function(s){const o=s.filter((l=>l instanceof fu)).length,a=s.filter((l=>l instanceof Ya)).length;if(o>1||o>0&&a>0)throw new V(q,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const r of i)n=r._apply(n);return n}class Ya extends XS{constructor(t,e,i){super(),this._field=t,this._op=e,this._value=i,this.type="where"}static _create(t,e,i){return new Ya(t,e,i)}_apply(t){const e=this._parse(t);return Hm(t._query,e),new Fr(t.firestore,t.converter,$c(t._query,e))}_parse(t){const e=$m(t.firestore);return(function(s,o,a,l,c,h,u){let d;if(c.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new V(q,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){Uf(u,h);const g=[];for(const y of u)g.push(Bf(l,s,y));d={arrayValue:{values:g}}}else d=Bf(l,s,u)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||Uf(u,h),d=BS(a,o,u,h==="in"||h==="not-in");return Me.create(c,h,d)})(t._query,"where",e,t.firestore._databaseId,this._field,this._op,this._value)}}function qm(n,t,e){const i=t,r=jm("where",n);return Ya._create(r,i,e)}class fu extends du{constructor(t,e){super(),this.type=t,this._queryConstraints=e}static _create(t,e){return new fu(t,e)}_parse(t){const e=this._queryConstraints.map((i=>i._parse(t))).filter((i=>i.getFilters().length>0));return e.length===1?e[0]:Ys.create(e,this._getOperator())}_apply(t){const e=this._parse(t);return e.getFilters().length===0?t:((function(r,s){let o=r;const a=s.getFlattenedFilters();for(const l of a)Hm(o,l),o=$c(o,l)})(t._query,e),new Fr(t.firestore,t.converter,$c(t._query,e)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Bf(n,t,e){if(typeof(e=xr(e))=="string"){if(e==="")throw new V(q,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!oS(t)&&e.indexOf("/")!==-1)throw new V(q,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${e}' contains a '/' character.`);const i=t.path.child(Ct.fromString(e));if(!kt.isDocumentKey(i))throw new V(q,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Of(n,new kt(i))}if(e instanceof It)return Of(n,e._key);throw new V(q,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Wa(e)}.`)}function Uf(n,t){if(!Array.isArray(n)||n.length===0)throw new V(q,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function Hm(n,t){const e=(function(r,s){for(const o of r)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null})(n.filters,(function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(t.op));if(e!==null)throw e===t.op?new V(q,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new V(q,`Invalid query. You cannot use '${t.op.toString()}' filters with '${e.toString()}' filters.`)}class KS{convertValue(t,e="none"){switch(Ri(t)){case 0:return null;case 1:return t.booleanValue;case 2:return xt(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Ps(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 11:return this.convertObject(t.mapValue,e);case 10:return this.convertVectorValue(t.mapValue);default:throw vt(62114,{value:t})}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const i={};return qa(t,((r,s)=>{i[r]=this.convertValue(s,e)})),i}convertVectorValue(t){const e=t.fields?.[na].arrayValue?.values?.map((i=>xt(i.doubleValue)));return new He(e)}convertGeoPoint(t){return new qe(xt(t.latitude),xt(t.longitude))}convertArray(t,e){return(t.values||[]).map((i=>this.convertValue(i,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const i=bm(t);return i==null?null:this.convertValue(i,e);case"estimate":return this.convertTimestamp(Ls(t));default:return null}}convertTimestamp(t){const e=Ii(t);return new Tt(e.seconds,e.nanos)}convertDocumentKey(t,e){const i=Ct.fromString(t);Yn(Om(i),9688,{name:t});const r=new As(i.get(1),i.get(3)),s=new kt(i.popFirst(5));return r.isEqual(e)||ru(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),s}}function YS(n,t,e){let i;return i=n?n.toFirestore(t):t,i}class ZS extends KS{constructor(t){super(),this.firestore=t}convertBytes(t){return new _e(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new It(this.firestore,null,e)}}function Uc(n){(function(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new V(gm,"limitToLast() queries require specifying at least one orderBy() clause")})((n=ou(n,Fr))._query);const t=Dm(n.firestore),e=new ZS(n.firestore);return kS(t,n._query).then((i=>{const r=i.map((s=>new Um(n.firestore,e,s.key,s,n.converter)));return n._query.limitType==="L"&&r.reverse(),new HS(n,r)}))}function JS(n,t,e){const i=YS((n=ou(n,It)).converter,t),r=GS($m(n.firestore),"setDoc",n._key,i,n.converter!==null,e);return OS(Dm(n.firestore),[r.toMutation(n._key,cs.none())])}(function(){(function(e){Mr=e})(`${cC}_lite`),Qo(new Is("firestore/lite",((t,{instanceIdentifier:e,options:i})=>{const r=t.getProvider("app").getImmediate(),s=new Ka(new DC(t.getProvider("auth-internal")),new NC(r,t.getProvider("app-check-internal")),(function(a,l){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new V(q,'"projectId" not provided in firebase.initializeApp.');return new As(a.options.projectId,l)})(r,e),r);return i&&s._setSettings(i),s}),"PUBLIC").setMultipleInstances(!0)),lr("firestore-lite",wf,""),lr("firestore-lite",wf,"esm2020")})();const la=class la{constructor(t,e){this.savePolicy=e,this.collection=t;const i=lm(la.firebaseConfig);this.database=MS(i)}async allowedToSubmitScore(t,e){return!t.username||!Mp(e)?!1:(console.log("Checking if allowed to submit score..."),this.savePolicy(this,t,e))}async saveScore(t,e,i){await JS(NS(this.database,this.collection,t),{userId:t,username:e,score:i})}async getLeaderboard(){const t=[];return(await Uc(Bc(this.database,this.collection))).forEach(i=>{const r=i.data();t.push({rank:NaN,username:r.username,score:r.score})}),t.sort((i,r)=>r.score-i.score),t.forEach((i,r)=>i.rank=r+1),t}async getUserId(t){const e=Wm(Bc(this.database,this.collection),qm("username","==",t)),i=await Uc(e);return i.size===0?null:i.docs[0].data().userId}};la.firebaseConfig={authDomain:"switzerland-guess.firebaseapp.com",projectId:"switzerland-guess",storageBucket:"switzerland-guess.appspot.com"};let jc=la;async function QS(n,t,e){const i=await tT(n,t.userId);return i===null?!0:bc(e)>i}function tT(n,t){return new Promise(async e=>{const i=Wm(Bc(n.database,n.collection),qm("userId","==",t)),r=await Uc(i);if(r.size===0){e(null);return}const o=r.docs[0].data();e(o.score)})}function eT(){let n=localStorage.getItem("userId");return n||(n=crypto.randomUUID(),localStorage.setItem("userId",n)),{userId:n,username:localStorage.getItem("username")}}function nT(n){localStorage.setItem("username",n)}var iT=Object.defineProperty,rT=Object.getOwnPropertyDescriptor,Di=(n,t,e,i)=>{for(var r=i>1?void 0:i?rT(t,e):t,s=n.length-1,o;s>=0;s--)(o=n[s])&&(r=(i?o(t,e,r):o(r))||r);return i&&r&&iT(t,e,r),r};let Zn=class extends Hs(Xt){constructor(){super(...arguments),this.localize=new Jn(this),this.userInfo=eT(),this.scores=[],this.allowedToSubmitScore=!1}async willUpdate(n){n.has("gameState")&&(this.gameState.country&&this.leaderboard?.collection!==this.gameState.country&&(this.leaderboard=new jc(this.gameState.country,QS),this.scores=await this.leaderboard.getLeaderboard()),this.leaderboard&&this.userInfo&&(this.allowedToSubmitScore=await this.leaderboard.allowedToSubmitScore(this.userInfo,this.gameState)))}render(){return U`
      <wa-dialog label="${this.localize.term("game_over")}">
        <div class="wa-stack wa-gap-2xl">
          <wa-callout variant="brand">
            <wa-icon slot="icon" name="thumbs-up" variant="solid"></wa-icon>
            ${this.localize.term("your_score")}: <strong>${bc(this.gameState)}</strong>
          </wa-callout>
          <!-- FIXME: check allowedToSubmitScore -->
          <wa-button class="save_score" variant="brand" @click="${this.saveScore}" ?disabled="${!!this.userInfo.username&&!this.allowedToSubmitScore}">
            ${this.localize.term("submit_score")}
          </wa-button>
          <element-leaderboard .scores="${this.scores}" .username="${this.userInfo.username}"></element-leaderboard>
        </div>
        <wa-button slot="footer" variant="brand" data-dialog="close">${this.localize.term("new_game")}</wa-button>
      </wa-dialog>
      <element-username .leaderboard="${this.leaderboard}" @username="${this.handleUsernameSet}"></element-username>
    `}async handleUsernameSet(n){const t=n.detail;this.userInfo={...this.userInfo,username:t},nT(t),this.allowedToSubmitScore=await this.leaderboard.allowedToSubmitScore(this.userInfo,this.gameState),await this.saveScoreToLeaderboard()}async saveScore(){this.userInfo.username===null?this.usernameElement.open=!0:await this.saveScoreToLeaderboard()}async saveScoreToLeaderboard(){this.allowedToSubmitScore&&(await this.leaderboard.saveScore(this.userInfo.userId,this.userInfo.username,bc(this.gameState)),this.allowedToSubmitScore=await this.leaderboard.allowedToSubmitScore(this.userInfo,this.gameState),this.scores=await this.leaderboard.getLeaderboard())}createRenderRoot(){return this}};Di([Jc({context:Fa,subscribe:!0}),Ft()],Zn.prototype,"gameState",2);Di([Ft()],Zn.prototype,"userInfo",2);Di([Ft()],Zn.prototype,"scores",2);Di([Ft()],Zn.prototype,"allowedToSubmitScore",2);Di([At("element-username")],Zn.prototype,"usernameElement",2);Di([At(".save_score")],Zn.prototype,"saveScoreButton",2);Zn=Di([bt("element-scores")],Zn);var sT=Object.getOwnPropertyDescriptor,oT=(n,t,e,i)=>{for(var r=i>1?void 0:i?sT(t,e):t,s=n.length-1,o;s>=0;s--)(o=n[s])&&(r=o(r)||r);return r};let jf=class extends Hs(Xt){constructor(){super(...arguments),this.localize=new Jn(this)}render(){return U`
      <wa-dialog label="${this.localize.term("about_us")}">
        <p>Hi! We’re Camptocamp, and we love maps.</p>
        <p>
          It all started over 20 years ago with an Open Source project for
          outdoor enthusiasts—camptocamp.org—and we’ve been mapping ever since.
          These days, we create smart, beautiful, and reliable maps for all
          kinds of clients: governments, non-profits, and companies of every
          shape and size.
        </p>
        <p>
          Our mission? To help people explore, understand, and navigate the
          world through intuitive, accurate, and innovative mapping tools.
        </p>
        <p>
          We also believe work should come with a good dose of fun, which is how
          XX Guess was born. At first, it was just an in-house challenge to see
          who knew their home country best. But then the competitive spirit
          kicked in, and we thought: why keep all this fun to ourselves?
        </p>
        <p>
          And while maps are our first love, they’re not our only one. We’re
          also a Gold Partner for the Open Source ERP software Odoo, and we keep
          IT infrastructures running smoothly so our clients can focus on what
          they do best. Our diverse set of skills are all united by our
          commitment to Open Source IT philosophy and our passion for creating
          digital experiences that are human and made to last.
        </p>
        <p>
          Curious about what we do or thinking about working together? Let us
          know. We’ll be in touch!
        </p>
        <p>(FIRST NAME), (LAST NAME), (EMAIL)</p>

        <div slot="footer">
          <wa-button slot="footer" variant="brand" data-dialog="close"
            >${this.localize.term("close")}</wa-button
          >
        </div>
      </wa-dialog>
    `}createRenderRoot(){return this}};jf=oT([bt("element-about")],jf);Object.assign(t_.requestsByServer,{"assets.ion.cesium.com:443":28,"wmts.geo.admin.ch:443":28,"3d.geo.admin.ch:443":28});h_.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI3NDYzNDViMS01OGZjLTRkMDMtOWQzYi00YTI2NDBmOWNjYzYiLCJpZCI6MjE3NTQsImlhdCI6MTcyODMwMTczM30.JlQVQBkpUc1LW65CyWbH_2ZLz-3u6WDkjR9nBI25VYI";let us;async function aT(n){const t=new e_(n,{scene3DOnly:!0,requestRenderMode:!0,baseLayer:i_.fromProviderAsync(r_.fromAssetId(3830182),{minimumTerrainLevel:10}),terrainProvider:await n_.fromIonAssetId(1),shouldAnimate:!0});t.scene.globe.showGroundAtmosphere=!0,t.scene.globe.enableLighting=!0,t.scene.globe.preloadSiblings=!0,t.scene.globe.maximumScreenSpaceError=1,t.scene.skyAtmosphere.hueShift=0,t.scene.skyAtmosphere.saturationShift=-.3,t.scene.skyAtmosphere.brightnessShift=-.15,t.scene.fog.enabled=!0,t.scene.fog.density=.005,t.scene.fog.minimumBrightness=.8,t.scene.fog.screenSpaceErrorFactor=4,t.scene.globe.tileCacheSize=2e3,t.scene.globe.baseColor=xo.TRANSPARENT,t.scene.globe.undergroundColor=xo.TRANSPARENT;const e=t.scene.screenSpaceCameraController;return e.enableTranslate=!1,e.enableZoom=!1,e.enableTilt=!1,e.enableRotate=!1,t}function Wf(n,t){n.camera.flyTo({destination:gt.fromDegrees(t[0],t[1],4e3),orientation:{heading:An.toRadians(Math.random()*360),pitch:0},duration:0,complete:()=>{uT(n.scene),Xm(n)}})}let Wl;const aa=12,Wc=1e5,lT=new ca(aa,aa),cT=new ca(aa*2,aa*2);let Xr=new gt;const hT=(n,t)=>{Xr=gt.normalize(t.position,Xr),gt.multiplyByScalar(Xr,An.randomBetween(-30,-300),Xr),t.velocity=gt.add(t.velocity,Xr,t.velocity);const e=gt.distance(n.camera.position,t.position);e>Wc?t.endColor.alpha=0:t.endColor.alpha=1/(e/Wc+.1)};function uT(n){Wl&&n.primitives.remove(Wl),Wl=n.primitives.add(new o_({modelMatrix:l_.fromTranslation(n.camera.position),minimumSpeed:5e3,maximumSpeed:25e3,lifetime:60,particleLife:10,emitter:new a_(Wc),startScale:.2,endScale:.7,image:"./images/snowflake.png",emissionRate:3e3,startColor:xo.WHITE.withAlpha(0),endColor:xo.WHITE.withAlpha(1),minimumImageSize:lT,maximumImageSize:cT,mass:29e-7,updateCallback:t=>hT(n,t)}))}const dT=["./models/santa_on_the_moon.glb","./models/santa_sleigh.glb"],fT=5e3,gT=1e4,pT=1e3;function Xm(n,t=dT,e=fT,i=gT,r=pT){if(us&&n.entities.removeById(us),!t||t.length===0){console.error("The modelUrls array cannot be empty.");return}if(e>=i){console.error("Minimum distance must be less than maximum distance.");return}const s=t[Math.floor(Math.random()*t.length)],o=new gt(Math.random()-.5,Math.random()-.5,Math.random()-.5);gt.normalize(o,o);const a=i-e,l=Math.random()*a+e,c=gt.multiplyByScalar(o,l,new gt),h=gt.add(n.camera.position,c,new gt),u=n.camera.positionCartographic,d=c_.fromCartesian(h);d.height<u.height-r?d.height=u.height-r:d.height>u.height+r&&(d.height=u.height+r);const f=gt.fromRadians(d.longitude,d.latitude,d.height),g=n.entities.add({name:"Clickable Random Model",position:f,model:{uri:s,minimumPixelSize:128}});return us=g.id,g}function mT(n,t){new s_(n.scene.canvas).setInputAction(i=>{if(!us)return;const r=n.scene.pick(i.position);if(bu(r)&&bu(r.id)){const s=r.id;s.id===us&&(console.log(`Clicked on model: ${s.id}`),t(),Xm(n))}},ai.LEFT_CLICK)}var _T=Object.defineProperty,yT=Object.getOwnPropertyDescriptor,Zs=(n,t,e,i)=>{for(var r=i>1?void 0:i?yT(t,e):t,s=n.length-1,o;s>=0;s--)(o=n[s])&&(r=(i?o(t,e,r):o(r))||r);return i&&r&&_T(t,e,r),r};let Tr=class extends Xt{constructor(){super(...arguments),this.localize=new Jn(this),this.gameState={country:null,cameraPosition:null,guessedPosition:null,score:null,distance:null,scores:[],roundPerGame:3},this.viewer=null}updated(){this.gameState.country!==null&&!Ml(this.gameState)&&(this.gameState=Hd(this.gameState,Ku(this.gameState.country)),Wf(this.viewer,this.gameState.cameraPosition))}render(){return U`
      <element-about></element-about>
      <element-country-selector .open="${this.gameState.country==null}"
        @country-selected="${this.handleCountrySelected}"
      ></element-country-selector>
      <div id="cesium"></div>
      <div class="header">
        <cesium-compass-bar></cesium-compass-bar>
        <wa-button variant="neutral" style="margin-left: auto;" @click="${()=>this.aboutElement.open=!0}">
          ${this.localize.term("about_us")}
        </wa-button>
      </div>
      <element-guess ?hidden="${!Ml(this.gameState)}" @guess="${this.handleGuess}"></element-guess>
      <element-result @close="${this.handleCloseResult}" @gameOver="${this.handleGameOver}"></element-result>
      <element-scores @close="${this.handleCloseScores}"></element-scores>
    `}async firstUpdated(){this.viewer=await aT(this.querySelector("#cesium")),mT(this.viewer,()=>{this.gameState.score=5});const n=new Ow(this.viewer);n.active=!0;const t=this.querySelector("cesium-compass-bar");t.scene=this.viewer.scene}handleCountrySelected(n){this.gameState={...this.gameState,country:n.detail}}handleGuess(n){this.resultElement.open=!0,this.gameState=aE(this.gameState,n.detail)}handleGameOver(){this.scoresElement.open=!0}handleCloseResult(){Ml(this.gameState)&&(this.gameState=Hd(this.gameState,Ku(this.gameState.country)),Wf(this.viewer,this.gameState.cameraPosition))}handleCloseScores(){this.gameState=oE(this.gameState)}createRenderRoot(){return this}};Zs([A_({context:Fa}),Ft()],Tr.prototype,"gameState",2);Zs([At("element-result")],Tr.prototype,"resultElement",2);Zs([At("element-scores")],Tr.prototype,"scoresElement",2);Zs([At("element-about")],Tr.prototype,"aboutElement",2);Tr=Zs([bt("element-app")],Tr);Xc(d_,u_,f_);const qf=["fr","de","en"],ql=new URL(location).searchParams.get("lang");if(ql&&qf.includes(ql))document.documentElement.lang=ql;else for(const n of navigator.languages){const t=n.substring(0,2);if(qf.includes(t)){document.documentElement.lang=t;break}}
